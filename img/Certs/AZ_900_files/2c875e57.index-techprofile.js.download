"use strict";(()=>{var xY=Object.create;var WC=Object.defineProperty;var yY=Object.getOwnPropertyDescriptor;var TY=Object.getOwnPropertyNames;var SY=Object.getPrototypeOf,EY=Object.prototype.hasOwnProperty;var wY=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var CY=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of TY(t))!EY.call(e,r)&&r!==o&&WC(e,r,{get:()=>t[r],enumerable:!(n=yY(t,r))||n.enumerable});return e};var kY=(e,t,o)=>(o=e!=null?xY(SY(e)):{},CY(t||!e||!e.__esModule?WC(o,"default",{value:e,enumerable:!0}):o,e));var QC=wY((Yx,KC)=>{(function(e,t){typeof Yx=="object"&&typeof KC<"u"?t():typeof define=="function"&&define.amd?define(t):t()})(Yx,function(){"use strict";function e(o){var n=!0,r=!1,i=null,a={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function s(E){return!!(E&&E!==document&&E.nodeName!=="HTML"&&E.nodeName!=="BODY"&&"classList"in E&&"contains"in E.classList)}function c(E){var O=E.type,k=E.tagName;return!!(k==="INPUT"&&a[O]&&!E.readOnly||k==="TEXTAREA"&&!E.readOnly||E.isContentEditable)}function l(E){E.classList.contains("focus-visible")||(E.classList.add("focus-visible"),E.setAttribute("data-focus-visible-added",""))}function u(E){!E.hasAttribute("data-focus-visible-added")||(E.classList.remove("focus-visible"),E.removeAttribute("data-focus-visible-added"))}function p(E){E.metaKey||E.altKey||E.ctrlKey||(s(o.activeElement)&&l(o.activeElement),n=!0)}function m(E){n=!1}function f(E){!s(E.target)||(n||c(E.target))&&l(E.target)}function h(E){!s(E.target)||(E.target.classList.contains("focus-visible")||E.target.hasAttribute("data-focus-visible-added"))&&(r=!0,window.clearTimeout(i),i=window.setTimeout(function(){r=!1},100),u(E.target))}function _(E){document.visibilityState==="hidden"&&(r&&(n=!0),g())}function g(){document.addEventListener("mousemove",x),document.addEventListener("mousedown",x),document.addEventListener("mouseup",x),document.addEventListener("pointermove",x),document.addEventListener("pointerdown",x),document.addEventListener("pointerup",x),document.addEventListener("touchmove",x),document.addEventListener("touchstart",x),document.addEventListener("touchend",x)}function v(){document.removeEventListener("mousemove",x),document.removeEventListener("mousedown",x),document.removeEventListener("mouseup",x),document.removeEventListener("pointermove",x),document.removeEventListener("pointerdown",x),document.removeEventListener("pointerup",x),document.removeEventListener("touchmove",x),document.removeEventListener("touchstart",x),document.removeEventListener("touchend",x)}function x(E){E.target.nodeName&&E.target.nodeName.toLowerCase()==="html"||(n=!1,v())}document.addEventListener("keydown",p,!0),document.addEventListener("mousedown",m,!0),document.addEventListener("pointerdown",m,!0),document.addEventListener("touchstart",m,!0),document.addEventListener("visibilitychange",_,!0),g(),o.addEventListener("focus",f,!0),o.addEventListener("blur",h,!0),o.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&o.host?o.host.setAttribute("data-js-focus-visible",""):o.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if(typeof window<"u"&&typeof document<"u"){window.applyFocusVisiblePolyfill=e;var t;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch{t=document.createEvent("CustomEvent"),t.initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}typeof document<"u"&&e(document)})});var Yze=kY(QC());var Gs=window;var he=Gs,ip=Gs.navigator,Y=Gs.document,IK=Gs.localStorage,Vs=Gs.history,de=Gs.location,PK=he.jQuery,RK=he.jQuery,w=he.msDocs,Dt=new Promise(e=>{Y.readyState==="loading"?Y.addEventListener("DOMContentLoaded",()=>e()):e()});var ap="__event_type_id__",AY=0,Ye=class{constructor(){this.callbacks={}}publish(t){let o=t.constructor[ap];if(o===void 0||this.callbacks[o]===void 0)return;let n=this.callbacks[o].slice(0);for(let r of n)r(t)}subscribe(t,o){t.hasOwnProperty(ap)||(t[ap]=AY++);let n=t[ap];this.callbacks[n]===void 0&&(this.callbacks[n]=[]);let r=this.callbacks[n];return r.indexOf(o)===-1&&r.push(o),()=>this.unsubscribe(t,o)}unsubscribe(t,o){let n=t[ap];if(n===void 0||this.callbacks[n]===void 0)return;let r=this.callbacks[n],i=r.indexOf(o);i!==-1&&r.splice(i,1)}dispose(){this.callbacks={}}},wn=new Ye;var rg=class{constructor(t){this.url=t}},_a=class{constructor(t,o,n){this.title=t;this.url=o;this.referrerUrl=n}};var js;function XC(){js={};let e=Y.head.querySelectorAll("meta[name],meta[property]");for(let t=0;t<e.length;t++){let o=e.item(t),n=o.name;n===""&&(n=o.getAttribute("property"),n==="")||(js[n]?js[n].push(o.content):js[n]=[o.content])}wn.subscribe(_a,XC)}function te(e){return js===void 0&&XC(),js[e]===void 0?void 0:js[e][0]}function PY(e){switch(e){case"docs.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"docs"};case"review.docs.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"docs"};case"dev.docs.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!1,siteName:"docs"};case"ppe.docs.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"docs"};case"learn.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"learn"};case"review.learn.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"learn"};case"dev.learn.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"learn"};case"rd.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"rd"};case"review.rd.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"rd"};case"dev.rd.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"rd"};case"docs.azure.cn":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"mooncake"};case"review.docs.azure.cn":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"mooncake"};case"dev.docs.azure.cn":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"mooncake"};case"developer.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"developer"};case"review.developer.microsoft.com":return{supportLevel:"production",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"developer"};case"dev.developer.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"developer"};case"localhost":return{supportLevel:"development",accessLevel:"local",reviewFeatures:!0,systemContent:!1,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"docs"};case"prdev.docs.microsoft.com":case"internal.docs.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!1,siteName:"docs"};case"isolated-dev.docs.microsoft.com":return{supportLevel:"development",accessLevel:"isolated",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!1,siteName:"docs"};case"prdev.learn.microsoft.com":return{supportLevel:"development",accessLevel:"online",reviewFeatures:!0,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!1,siteName:"learn"};default:return{supportLevel:"production",accessLevel:"online",reviewFeatures:!1,systemContent:!0,azurePortalHostname:"portal.azure.com",legacyHosting:!0,siteName:"docs"}}}var C=w?.environment?w.environment:PY(location.hostname);var nt={setItem(e,t){try{he.localStorage.setItem(e,t)}catch{}},getItem(e){try{return he.localStorage.getItem(e)}catch{return null}},removeItem(e){try{he.localStorage.removeItem(e)}catch{}},clear(){try{he.localStorage.clear()}catch{}}};var Gx="docs.preview",Vx=(new URLSearchParams(de.search).get("preview")||"").split(",").map(e=>e.trim().toLowerCase()).reduce((e,t)=>(t!==""&&(e[t]=1),e),{}),sp,RY=()=>{let e;return nt.getItem(Gx)?e=JSON.parse(nt.getItem(Gx)):e={},e},NY=(e,t)=>{sp=RY();let o=Vx[e]===1,n=!isNaN(sp[e]),r=o||n,i=Vx[`x-${e}`];return o?console.log(`Preview ${e} via query string`):n&&console.log(`Preview ${e} via local storage`),t&&(r||i)&&(r&&(sp[e]=Date.now()),i&&delete sp[e],nt.setItem(Gx,JSON.stringify(sp))),r},Zt=(e,t={require:!1,persist:!1})=>{let{require:o,persist:n}=t;return C.reviewFeatures&&Object.keys(Vx).length===0&&!o?!0:(e=e.toLowerCase(),NY(e,n))};function ig(e=de.search,t=C.reviewFeatures){let o="preview-date",n=new URLSearchParams(e),r=new Date(n.get(o)).getTime();return t&&!isNaN(r)&&r!==0?r:Date.now()}function JC(){let e=te("page_type"),t=te("page_kind");return e==="learn"||e==="profile"||t==="learn"&&(e==="browse"||e==="home")}var ko=class{static get contentDir(){return w.data.contentDir}static get contentLocale(){return w.data.contentLocale}static get userDir(){return w.data.userDir}static get userLocale(){return w.data.userLocale}static get hasLocSideBySideTranslation(){return te("enable_loc_sxs")==="true"||te("bilingual_type")==="hover over"}static get translationType(){return te("ms.translationtype")?.toUpperCase()}static get machineTranslated(){return this.translationType?/^(?:MT|MTE|MTE75|MTE95)$/i.test(this.translationType):!1}},fo=class{static get brand(){return w.data.brand}static get kind(){return te("page_kind")}static get type(){return te("page_type")}static get template(){return w.data.pageTemplate}};var Ne=DY();function DY(){return{apiBrowser:C.accessLevel!=="isolated"||location.hostname==="isolated-dev.docs.microsoft.com",applicationInsights:JC()&&C.accessLevel!=="isolated",assessments:C.accessLevel!=="isolated",assessmentBranches:C.accessLevel!=="isolated"&&C.supportLevel==="production"&&C.reviewFeatures,azureNotebooks:C.accessLevel!=="isolated",banner:!C.legacyHosting,binaryRating:C.accessLevel!=="isolated"&&w.data.hasBinaryRating,blogComments:C.accessLevel!=="isolated",blogHome:C.accessLevel!=="isolated",chromeless:w.data.context.chromeless,chapterMarking:C.accessLevel==="isolated"||Zt("chapter-marking",{require:!0}),codeSamples:C.accessLevel!=="isolated",contentBrowse:C.accessLevel!=="isolated"||te("page_type")==="browse"&&(te("page_kind")==="learn"||te("page_kind")==="certification"||te("page_kind")==="course")||Zt("isolated-contentbrowse",{require:!0}),cookieConsent:C.accessLevel!=="isolated",courseScheduling:C.accessLevel!=="isolated",enableQnAinContentArea:C.supportLevel==="development"&&C.accessLevel!=="isolated",externalLinkModal:C.accessLevel==="isolated"||Zt("external-link-modal",{require:!0}),feedbackReport:C.accessLevel!=="isolated"&&w.data.showFeedbackReport,gamification:C.accessLevel!=="isolated",gitContributors:C.accessLevel!=="isolated",githubIssues:C.accessLevel!=="isolated"&&w.data.hasGithubIssues,inlineEdit:C.accessLevel!=="isolated"&&Zt("inline-edit",{require:!0}),ilt:C.accessLevel!=="isolated"&&Zt("ilt",{require:!0}),inlineFeedback:C.accessLevel!=="isolated",interactivity:C.accessLevel!=="isolated",labsOnDemand:C.accessLevel!=="isolated",learnEventRebrand:C.accessLevel!=="isolated"&&Zt("learn-rebrand",{require:!0}),linkedSandbox:C.accessLevel!=="isolated"&&Zt("linked-sandbox",{require:!0}),marketing:C.accessLevel!=="isolated",mecMigration:C.accessLevel!=="isolated",moduleUnitFeedbackReport:C.accessLevel!=="isolated",oneCustomerVoiceFeedback:C.accessLevel!=="isolated",oneDS:C.accessLevel!=="isolated",pageRecommendations:(C.siteName==="docs"||C.siteName==="learn"||C.siteName==="mooncake")&&C.accessLevel!=="isolated"&&te("recommendations")!=="false"&&(te("page_type")==="conceptual"||w.data.pageTemplate==="FAQ"||w.data.pageTemplate==="Architecture"||w.data.pageTemplate==="Reference"||w.data.pageTemplate==="Sample"),pdfDownload:C.accessLevel!=="isolated",practiceAssessmentsPreview:C.accessLevel!=="isolated"&&Zt("practice-assessments",{require:!0}),previewRailEventCard:Zt("rail-event-card",{require:!0}),previewRailEventImageCard:Zt("rail-event-image-card",{require:!0}),previewRailRecommendations:Zt("rail-recommendations",{require:!0}),previewRailLearningResources:Zt("rail-learning-resources"),previewQnALink:Zt("rail-qna-link"),previewQnALinkSpecific:Zt("rail-qna-link-specific"),qna:C.accessLevel!=="isolated",reportWebVitalsAlways:Zt("report-web-vitals",{require:!0}),rss:C.accessLevel!=="isolated",sandbox:C.accessLevel!=="isolated",shareLink:C.accessLevel!=="isolated",siteSearchProducts:Zt("site-search-products",{require:!0}),skipToCompletedModal:Zt("completed-modal",{require:!0}),stayCurrentAllowParam:C.accessLevel!=="isolated"&&C.reviewFeatures&&(te("page_kind")==="certification"||te("page_kind")==="certificationrenewal"||te("page_kind")==="certificationRenewalAssessment"||te("page_kind")==="certificationRenewalAssessmentReport"),starRatings:C.accessLevel!=="isolated",surveyPopover:C.accessLevel!=="isolated"&&(location.hostname.endsWith("docs.microsoft.com")||C.accessLevel==="local"),systemDrivenAchievement:C.accessLevel!=="isolated",temporaryClientSideEventBanners:C.legacyHosting&&(location.origin.endsWith("docs.microsoft.com")||location.origin.endsWith("developer.microsoft.com")),tocSearch:w.data.brand!=="mooncake",translationFeedback:C.accessLevel!=="isolated"&&w.data.userLocale!=="en-us"&&te("ocv-translation-feedback")==="true"&&ko.machineTranslated,userFeedback:C.accessLevel!=="isolated"&&Zt("user-feedback",{require:!0}),userServices:C.accessLevel!=="isolated"}}var ZC="You have signed in with an account associated to an organisation ({email}). By becoming a member, <strong>you understand and acknowledge</strong> that your Microsoft Docs membership means our network of sites and applications will record and track your achievements and activities and we may share your results and activities with your organisation. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.",ek="About",tk="Accept",ok="Accept and continue";var ag="Accepted answer",sg="Accepted answers";var Ws="Active";var cp="Achievements",nk="has successfully completed",jx="Print your achievement",Wx="Your full name is required to print your achievement",rk="Enter your name as you'd like it to appear on your achievement.";var cg="Activity";var ik="a day ago";var ak="Advanced";var sk="You are all set";var ck="a minute ago",lk="a month ago";var uk="an hour ago";var dk="Answer",pk="Answers";var mk="Architecture";var ti="Are you sure?",lg="Deleting your data cannot be undone.";var fk="Article";var gk="a second ago";var hk="a week ago";var Cl="Back";var Kx="Back to prior menu";var kl="Badge",_k="Badges";var vk="Beginner";var bk="Blog";var Qx="Breadcrumb";var xk="Browse Certifications";var yk="Microsoft Build",Tk="May 24-26, 2022",Sk="Learn how to build the next generation of apps and connect with experts and peers.",Ek="Microsoft Build is LIVE now! Learn how to build the next generation of apps, connect with experts and peers, and discover how to adapt easily with a trusted, integrated data platform.",wk="Register now",Ck="Watch now";var Je="Cancel";var Al="Certification";var kk="Certification profile",Ak="Add your personal account",Ik="Add your personal account to this profile",Pk="Your Learn profile is using a work or school account. Certifications belong to you, so they are associated with a personal Microsoft account. You will need to add a personal Microsoft account to this Learn profile in order to connect a certification profile. Your certification data will continue to be associated with your personal account.",ug="No, not now";var Rk="Connect your certification profile",dg="Yes, connect this certification profile",pg='This certification profile will be permanently associated with your Learn profile. If you have multiple certification profiles, please merge them first by <a href="https://aka.ms/certhelp">contacting certification support</a>.',mg="Connecting will allow you to manage your certifications, exams, and appointments directly from your Learn profile.";var Nk="We encountered an error with your request. Please try again later. If this issue continues, please contact certification support.";var Dk="You have connected your certification profile to your Learn profile. Happy learning!",Lk="No certification profile found. Is your certification profile under another personal account?",Mk="No certification profile was found for your linked personal Microsoft account {msaEmail}. If you have a certification profile under a different account, you will need to follow the instructions to align the accounts between your certification profile and Learn profile before you can connect.",Ok="This certification profile is already connected",Uk="The MCID associated with your personal account is already connected with a different Learn profile. If you believe this is incorrect and need help, please contact certification support.",$k="Sorry, you can't connect while merging.",zk="This Learn profile is currently being merged. You can check the progress of the merge process in your account management settings.  Please sign out and sign in again to connect your certification profile.",Fk="Read instructions to align accounts";var fg="We found a certification profile for your personal account";var Hk="Connect certification profile",Xx="Contact certification support";var Jx="Expires on {date}";var qk="Online",Bk="Oops, something went wrong.";var Yk="Microsoft Certification";var rn="Certifications";var gg="Challenge";var Gk="Active from {start} until {end}";var Vk="See the challenge";var jk="Upcoming challenges";var lp="Challenges",Wk="Change your profile picture";var ze="Close";var Kk="Code Sample",Il="Code Samples";var hg="Collection",Qk="Official Collection",_g="Collections",Xk="A copy of this collection has been saved to your profile",Jk="Description (optional)",Zk="Delete section",eA="Deleting the section header will not delete the content within the section",tA="Edit section",oA="Max length is 550 characters.",nA="The section title cannot be the same as another title in the collection.",rA="New section",iA="Save section",Zx="Section {number}",aA="Section title (optional)",sA="Max length is 100 characters.",cA="The section title or description did not pass Microsoft's validation service.",lA="We were unable to save your section. Please try again.",uA="Add URL",dA="Page name",pA="Enter your title.",mA="The title must be between 2 and 100 characters.",fA="We could not save your URL. Please try again.",gA="URLs cannot be added to this collection.",hA="Your URL must start with http:// or https://. AKA links are permitted.",_A="The URL format is not valid.",vA="Add items";var bA='Microsoft employees are eligible to label a collection with "Created by Microsoft".',xA="More Information",Pl="Convert to an Official Collection",vg="An Official Collection represents Microsoft, so please ensure that your collection is complete, free of typographical errors, and that content is in the correct sequence. If not, please edit your collection as necessary. <strong>Once a collection is made official, it cannot be reverted.</strong>",yA="Collection unavailable",TA="Are you ready to convert this collection to an Official Collection?",SA="Create a new collection",bg='A collection already exists with the title "{title}". Collection titles should be unique.',xg="Title is required and up to 100 characters long.",yg="Description is optional and up to 550 characters long.",EA='Collections may be publicly viewable. <a href="/learn/support/faq?pivots=general#what-is-a-collection" >Learn more</a>',wA="{userDisplayName}'s Collection {index}",CA="Created by {name}",kA="Copy collection",AA="Delete collection",IA="Display my name";var Tg="Edit my collection",ey="add description",up="Edit description",dp="Edit title",ty="Title of this collection",PA="We were unable to save your title. Please try again.",RA="We were unable to save your description. Please try again.",oy="Favorites",NA="If this link was shared with you, request a new link.",Sg="Any edits will not affect the original collection";var DA="Items in this collection",LA="There are no items in this collection.",MA="{numberOf} Learning Paths",OA="{numberOf} Learning Path",Eg="Number of modules: {numberOf}",UA="{numberOf} Module";var $A="Move item down",zA="Move item up";var FA="Move section down",HA="Move section up";var qA="on behalf of";var BA="This collection does not exist or was removed.",YA='You can also return to <a href="{url}" class="color-text text-decoration-underline">collections</a>.';var GA="You can find this collection in your Learn profile";var VA="Comment",jA="Comments";var wg="Completed";var WA="Completed on";var KA="Contact customer support",QA="Contact email";var XA="Continue";var ny="Copy";var JA="Course";var Ks="Country/Region";var ZA="Create";var ry="Created by";var eI="By becoming a member, you understand and acknowledge that your Microsoft Docs membership means our network of sites and applications will record and track your achievements and activities. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.";var tI="Daily",oI="Dark";var iy="Day",ay="Days",nI="{duration} days ago";var Cg="Decline";var Ri="Delete";var rI="Delete current picture";var sy="Details",kg="Description";var Qs="Dismiss alert";var va="Documentation";var iI="Download";var Ag="Edit",aI="Edited on";var Ig="Email",Rl="Contact email for notifications",sI="Email is required.";var cI="Ended",lI="Ends {endDate}",uI="Ends soon";var Pg="Exam";var Rg="Facebook",dI="Favorites",pI="FAQ";var mI="Feedback";var fI="Follower",gI="Followers",hI="Following";var Ng="Global",cy="Global navigation";var _I='If you are unemployed or furloughed due to COVID-19, turn on email subscriptions to get updates about our <a href="https://opportunity.linkedin.com/">global skills initiative</a> to help you get back to work.',ly="Get updates about our global skills initiative";var vI="High contrast",bI="Home";var uy="Hour",dy="Hours",xI="{duration} hours ago";var yI="hr";var TI="{numberOfHours} hr {numberOfMinutes} min";var py="I agree";var SI="In person";var EI="Instant";var wI="Intermediate";var pp="Invalid email address. Please try again.";var mp='"{itemTitle}" will be permanently deleted.';var CI="just now";var kI="Known issue";var AI="Learn";var Dg="Learning Path",my="Learning Paths";var II="Episode";var PI="{count} Episodes";var RI="Event",Nl="Events",NI="Event Session";var DI="Last episode {date}";var LI="Published {date}",MI="Series",OI="Show",Dl="Shows";var fy="Level {number}",UI="You have lots of experience and are looking to learn about specialised topics",$I="You're starting out and want to learn the fundamentals",zI="You have some experience but want to learn more in-depth skills";var FI="Lifecycle",HI="Light";var qI="LinkedIn";var Ni="Loading...";var BI="Manage cookies",Xs="Manage email preferences";var fp="Microsoft Educator Center has moved to Learn",YI="We noticed you have badges on the Microsoft Educator Center that you have not yet moved to your Learn profile. Do you want to bring them over?",GI="The Microsoft Educator Center (MEC) is becoming a part of the Microsoft Learn family. To opt-in to this new experience, you'll want to link your MEC profile to the Learn profile. All your achievements and transcripts will transfer and if you have an existing Learn profile, we can merge those for you!",VI="If you choose to continue without opting-in, you may still use Microsoft Learn but you will lose your MEC achievements and course history.",jI="Don't import my data",gy="Migrate data to Learn",WI="Are you sure you want to delete your Microsoft Educator Center data?",KI="If you choose to delete your data, your badges and achievements will not be imported from Microsoft Education Center. All records will be permanently deleted. Are you sure you want to continue?",QI="Delete Now",XI="Profile Successfully Merged",JI="Your data has been deleted",ZI="You have successfully merged your profiles. Your data will be moved from Microsoft Education Center to Learn! Go to your learn profile to see your achievements and badges.",eP="Your data was not imported from Microsoft Education Center and your data has been deleted.";var tP="We are working hard to migrate your course history and achievements to Learn. At this time, however, only activity completed in Learn will appear here.",oP='To view your full transcript and/or the badges you have earned in the Microsoft Educator Centre and Learn, please go to your <a href="https://education.microsoft.com/profile">MEC profile</a>.',Lg="Microsoft Employee",nP="Microsoft Employee Privacy Notice",rP="You have signed in with an account associated to an organisation ({email}). By becoming a member, <strong>you understand and acknowledge</strong> that your Microsoft Docs membership means our network of sites and applications will record and track your achievements and activities and we may share your results and activities with your organisation. Additionally, your username, display name, profile picture, affiliation, achievements and activities will be publicly visible.",gp="Microsoft for Startups";var iP="Microsoft Docs will send email to you at the email you provide below.",Ll="Microsoft Privacy Notice",aP="You need to agree with the Microsoft Privacy Notice to keep your profile and relating data.";var sP="{numberOfMinutes} min";var cP="{numberOfMinutes} minutes";var lP="{duration} minutes ago",uP="1 minute";var Js="Module";var hy="Modules, Courses & More";var Ml="Modules";var dP="{duration} months ago";var Cn="More";var pP="Never",Tr="Next";var mP="New collection";var fP="No, thanks";var _y="I'm not sure yet",Mg="{number} item",Ol="{number} items";var kn="OK",gP="OK, got it.";var hP="Please make at least one selection";var _P="Select your level",vP="Select products you are interested in",bP="Select roles you are interested in";var xP="on {date}",hp="On this page";var yP='I would like to receive content updates, personalized recommendations, helpful tips, Q&A notifications and more! <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy Statement.</a>',TP="We have your email (above) on record and will follow the email regulations of your country.",SP="Sign me up for content updates, personalized recommendations, helpful tips and more!",EP='Sign me up for content updates, personalized recommendations, helpful tips and more! <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy Statement.</a>';var Ul="Select a country/region";var wP="Optional";var Og="Page {pageNumber} of {numberOfPages}";var CP="pagination";var _p="Past {numberOfDays} days";var kP="Please fill out this field.",$l="Please provide an email address.";var Ug="Preview";var $g="Previous";var AP="{productName} users:";var IP="AltspaceVR";var PP="Azure";var RP="Bing";var NP="Project Bonsai",DP="Clarity";var LP="Microsoft Connected Services Framework",MP="Consumer",OP="Customer Care Framework";var UP=".NET";var $P="Dynamics",zP="Dynamics 365";var FP="Expression";var HP="Flipgrid";var qP="GitHub",BP="HoloLens";var YP="Industry Solutions",GP="Internet Explorer",VP="JavaScript API",jP="Kinect";var WP="Microsoft 365";var KP="Microsoft MakeCode",QP="Microsoft Defender for Endpoint";var XP="Microsoft Endpoint Manager";var JP="Microsoft Advertising";var ZP="Microsoft Authentication Library";var eR="Microsoft Defender";var tR="Microsoft Edge",oR="Microsoft Education Center";var nR="Microsoft Managed Desktop",rR="Microsoft Mesh",iR="Microsoft Partner Center";var aR="Microsoft Servers";var sR="Minecraft";var cR="Mixed Reality Toolkit",lR="Microsoft Build of OpenJDK",uR="Microsoft Graph";var dR="Microsoft System Center";var pR="Office",mR="Office 365";var fR="Microsoft Teams";var gR="Microsoft Power Platform";var hR="Microsoft Priva",_R="Project Acoustics";var vR="Quantum Development Kit";var bR="Silverlight",xR="Skype",yR="SQL Server";var TR="Surface";var SR="TakeLessons",ER="Microsoft Viva";var wR="Visual Studio",CR="Visual Studio App Center",kR="Visual Studio Code";var AR="Windows";var IR="Xbox";var vp="Profile",zg='Ask or answer a question in <a href="https://docs.microsoft.com/answers">the community</a>',bp='Catch up on the latest <a href="https://docs.microsoft.com/teamblog">site news</a>',PR="Cloud Skills Challenge",xp='Explore <a href="https://docs.microsoft.com/">the documentation</a>',yp='Learn skills with <a href="https://docs.microsoft.com/learn">step-by-step guidance</a>';var RR="Complete a learning path or module to get a trophy or badge. Your achievements will show here.",NR="Start learning new skills. Your activities will show here.",DR="Welcome back! We have not seen you in a while. Start learning new skills.";var LR="Start learning new skills.",MR="Create collections with learning modules to customise your own curriculum.",OR="Follow your favorite threads, tags and users.";var UR="Start learning new skills.",$R="Complete a learning path or module and a transcript of your activity will be shown here.";var zR="QandA",FR="modified",HR="accepted",qR="answered",Fg="asked",BR="commented",YR="edited";var GR="labeled",VR="posted",jR="suggested",WR="voted",KR="the activity",QR="tag",XR="the tag",JR="the feedback",ZR="the question",eN="the question thread",tN="answers",oN="comments",nN="{displayName} accepted an answer to {activity}",rN="{displayName} added a comment to {activity}",iN="{displayName} created a new {activity}",aN="votes";var Hg="Question";var sN="{averageScore} out of five stars";var An="Reference";var Tp="Regional Directors",cN="Register";var lN="Related event";var Zs="Remove",uN="Remove {itemName}";var Sp="Renew";var dN="Report a concern";var pN="Thank you for reporting your concern to us. We review these submissions very carefully and will take appropriate steps to address this issue. Because of legal and privacy concerns, we may not provide you any additional updates about this submission. Thank you again for contacting us.";var qg="Reputation point",Bg="Reputation points";var mN="Administrator",fN="AI Edge Engineer",gN="AI Engineer",hN="Auditor",_N="Business Analyst",vN="Business Owner",bN="Business User",xN="Data Analyst",yN="Data Engineer",TN="Data Scientist",SN="Database Administrator",Ep="Developer",EN="DevOps Engineer",wN="Functional Consultant",CN="Higher Education Educator",kN="Identity And Access Administrator",AN="Information Protection Administrator",IN="K-12 Educator",PN="App Maker",RN="Network Engineer",NN="Parent/Guardian",DN="Privacy Manager",LN="Risk Practitioner",MN="School Leader",ON="Security Engineer",UN="Security Operations Analyst",$N="Service Adoption Specialist",zN="Solution Architect",FN="Student",HN="Support Engineer",qN="Technology Manager";var Bt="Save";var ec="Save successful.";var BN="Redeem your code now.";var YN="It looks like you have already redeemed this code.<br/>Go to your achievements page to view your achievements.";var GN="This code has hit its maximum.<br/>If you feel you are getting this message in error, please contact your instructor.",VN="We cannot find this code in our system. Please contact your instructor.";var jN="Copy URL";var WN="Enter your code to add your achievement(s) to your profile";var vy="We could not redeem your code at this time. Please try again.";var KN="Add your achievement(s) to your profile";var QN="Redeem",XN="Redeem your code";var JN="e.g. A2CD34",ZN="It might take a couple of minutes for the badges to appear.";var eD="You are signed in as",tD="We\u2019ve added your achievement(s) to your profile!";var oD="URL successfully copied!";var nD="Please enter a valid code.",rD="View profile",iD="Have an achievement code?";var tc="Search";var aD="Search previous versions";var sD="{duration} seconds ago";var cD="Section";var lD="See less";var by="See more",uD="Select a country or region";var zl="Settings",ba="Share",dD="Today I earned my {achievementTitle} {achievementType}! I am so proud to be celebrating this achievement and hope this inspires you to start your own @MicrosoftLearn journey!";var Yg="[Shared Article] {articleTitle}";var pD="Share this achievement",mD="Share this collection";var fD="Show less",xy="Show more";var wp="Sign in";var Fl="Sign out";var gD="Site";var hD="Cancel Search";var Gg="Skip";var Vg="Hmm, something went wrong",go="Something went wrong. Please try again.";var jg="Sorted from newest to oldest";var _D="Starts {startDate}";var yy="Start Learning";var vD="Member sign in",bD="Step {step-index} of {step-count}";var xD="Business applications";var yD="Data and AI";var TD="Digital and application innovation";var SD="Gaming";var ED="Infrastructure";var wD="Modern life",CD="Modern work";var kD="Professional social network";var AD="Search, ads, and news",ID="Security";var PD="Submit";var RD="Successfully Submitted!";var ND="Support";var DD="The file {fileName} is invalid. File type must be a valid gif, jpg, jpeg or png image.",LD="The file {fileName} is too large. File size cannot exceed five megabytes.",MD="{account} already has a profile",OD="You have reached your account limit",UD="No more than five school or work accounts can be linked to one profile. Please remove one account and try again.",$D="{account} linked",Wg="Account Management",zD='You can have up to five school or work accounts <figure class="image is-24x24 display-inline-block"><img alt="" aria-hidden="true" src="https://docs.microsoft.com/en-us/media/profile/aad-user.svg"/></figure> and one personal account <figure class="image is-24x24 display-inline-block"><img alt="" aria-hidden="true" src="https://docs.microsoft.com/en-us/media/profile/msa-user.svg"/></figure> linked to your profile. Linking a school or work account will allow your organisation to see your learning progress data.',FD="You already have a linked {organization} account.",HD="Account removal confirmation",qD="By removing this account, you will not be able to access your profile with it. The corresponding organisation will no longer receive your learning progress data.",BD="{account} removed",YD="Add account",GD="Please add another account and try again.",VD="Browse certifications and exams",jD=`You can only link accounts that don't have a registered profile. Please select a different account or see our <a href="https://docs.microsoft.com/en-us/learn/support/troubleshooting#user-content-account-linking">troubleshooting guidance <span class="docon docon-navigate-external" aria-hidden="true"></span></a> for more details.`,WD="The Certification Dashboard has become part of Microsoft Learn and you can now manage your certifications here directly.",KD="Certification profile account",QD="Connect a certification profile to:",Kg="Connected certification profile",Ty="connected with certification profile",XD="Do you have a certification profile?",JD="Don't have a certification profile yet? Register for an exam to create one.",ZD='Need help with managing your certification profile? <a href="https://aka.ms/certhelp">Contacting certification support</a>.',eL="Linked accounts",tL="You are adding a school or work account ({account}) to your profile. You understand and acknowledge that we may share your results and activities with your organization. You may choose to unlink this account at any time and your organisation will stop receiving your learning progress data.",oL="You have linked this account already",nL="{account} is a personal account. Please select a school or work account.",rL="Manage your legal name, exam discounts, and other certification details.",iL="Manage certification profile and exam discounts",aL="Manage your certifications, exams, and appointments",Hl="MCID",sL="Additionally, your affiliation with Microsoft will be publicly available.",cL="Your affiliation with Microsoft will be publicly available.",lL="You need at least one account linked to your profile.",uL="No accounts linked",dL="Only one account per organisation is supported.",pL="You can only have one personal account linked",mL="Profile is currently being merged",fL="Please wait until profile merge has completed and try again.",gL="Renew your expiring certifications",hL="Select account",Sy="Please select a different account",_L="There is already a certification profile connected to this profile",vL="In order to continue, please contact customer support to remove the current certification profile to proceed.",bL="Data from each profile will be combined into a single profile.",xL="Editable fields will remain unchanged and can be updated anytime.",Ey="Notify me when merging is complete",yL="Merging profiles can take several minutes. We will let you know when the process is complete. When you opt-in to this update, we may also send you personalised recommendations, helpful tips or Q and A notifications.",TL="We will continue to send notifications to {email}.",SL="Your email is not currently set to receive notifications and will not be enrolled after the merge.",EL='<a href="https://docs.microsoft.com/learn/support/faq?pivots=profile">Learn more</a> about merging profiles.',wL="This profile has been locked",CL="This profile is currently locked and is being merged with another profile. Please sign-in to a different profile.",kL="You are about to merge these two profiles.",AL="Profile merging is permanent and cannot be undone.",IL="Your profiles have been successfully merged.",PL='We ran into a problem merging your profiles. Please contact <a href="https://docs.microsoft.com/learn/support/troubleshooting#report-feedback">customer support</a>.',RL="Merging in progress. It may take several minutes to complete.",NL="Clicking 'Accept and continue' will begin the merging process. You can still use the profile you are currently signed-in with, but your other profile will be locked.",DL="The topics and people you follow in Q&A will remain unchanged.",LL="We will send you an update at {email} when your profiles have been successfully merged.",ML="You can use any account listed above to sign in.",OL="Your activity feed shows up to 30 interactions over the past 30 days.",UL="Keep up the hard work! Only {number} left on this module.",$L="You joined Microsoft Docs today. Welcome!",zL="You earned a badge by completing a module",FL="You earned a trophy by completing a learning path",HL="Well done! You completed a module.",qL="You passed the renewal assessment for a certification",BL="You started a module",wy="{displayName} accepted an answer to your question",Cy="{displayName} answered a question",ky="{displayName} asked a question",Ay="{displayName} left a comment",Iy="{displayName} made an edit",Py="{displayName} modified the {activityType}",Ry="{displayName} suggested feedback",Ny="{displayName} voted",YL="Upload limit exceeded. Please try again later.",GL="Date of achievement: {date}",VL="Appointment",jL="Certification Number: {number}",WL="Confirmation code",KL='If you need assistance, contact <a href="https://docs.microsoft.com/learn/certifications/help">certification support</a>.',QL="Coming up soon",Qg="Earned on";var Cp="Expired",kp="Extend to",Xg="Failed",XL="Get support";var Dy="Go to the exam",JL="has successfully achieved the certification",ZL="In person",eM="items";var tM="Legal name",oM="Location";var Ly="Online",Jg="Passed",ql="Past exams",Bl="Past renewal assessments",nM="Print certificate",rM="Print your certificate",Zg="Provided by";var iM="Renewal assessment",aM="Renewed on";var sM="Reschedule",Ap="Retired";var My="Run a system check before you start",cM="Show legal name",lM="Sorted by expiration date",uM="Sorted from newest to oldest";var dM="Time";var Yl="Upcoming exam appointments";var pM="Valid until: {date}",Oy="View all certifications",mM="View details on provider site",fM="View score report",gM="Your certification details";var hM="Active until {endDate}",_M="Ended on {endDate}",vM="Begins on {startDate}";var bM="Change picture",xM="Changing your username will break any existing links to your profile",yM="You edited the collection",TM="Deleting your information does not impact your Microsoft identity.",SM="Delete profile",eh="Delete your profile",EM="The name that appears on your public profile, printable achievements, certificates, and transcript.",th="Download your data";var wM="Invalid username. Username must start with a letter or number and can contain non-consecutive dashes. It must be 4 to 40 characters in length.";var oh="Personal info, username and URL",CM="{name}'s profile is private",nh="Print",kM="Cancel",Uy="Certificate settings";var AM="Edit name",rh="Edit display name";var IM="Save name",PM="Your profile will be set to private. Learn badges, trophies, and Q&A contributions will be hidden on your public profile, and shared achievements will not be viewable. Are you sure you want to hide your achievements and contributions?",RM="Your profile will be set to private",ih="Privacy Settings",NM="When private mode is on, your display name, Learn achievements, and Q&A contributions are hidden on your public profile and shared achievements will not be viewable.",DM="Private mode is on. Your display name, Learn achievements, and Q&A contributions are now hidden on your public profile and shared achievements will not be viewable.",LM="Private mode is off. Your display name, Learn achievements, Q&A contributions, and shared achievements are now viewable on your public profile.",MM="Private Mode",ah="Microsoft MVP";var OM="Before registering with this Microsoft Account, please check if you may have previously registered with a different account.",UM='I would like Microsoft and its family of companies to send me the Microsoft Source Developer Newsletter by email. To withdraw consent or manage your contact preferences, visit the <a href="https://go.microsoft.com/fwlink/?linkid=243191">Promotional Communications Manager</a>. <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy Statement.</a>',$M='If you would like to only receive emails related to the Cloud Skills Challenge please go to your <a href="https://docs.microsoft.com/users/me/settings">email preferences in your Docs Profile</a> and unsubscribe after completing your challenge registration.',zM="Certification Dashboard has moved to Learn",FM="Don\u2019t miss out on challenge updates, new content, personal recommendations and relevant notifications.",HM="Add your email to be eligible to participate in this challenge. You will also receive information on updated content, personal recommendations and relevant notifications.",qM="You have successfully created your profile.",sh="Create your profile",xa="Display name",BM="Learn new skills and enhance your career with product documentation, training, videos, code samples, certifications, forums and more.",YM="To view your certifications, you will need to connect your certification profile to a new Learn profile using the same personal Microsoft account.",GM='If you already have a Learn profile under a different account, you will need to follow the instructions to <a href="https://docs.microsoft.com/learn/certifications/aligning-accounts-between-certification-profile-and-learn-profile" class="has-text-docs-invert text-decoration-underline">align the accounts between your certification profile and Learn profile</a>.';var VM="Don't want to miss out on new and updated content, personalized recommendations, helpful tips or Q&A notifications? Let us keep in touch!",jM="Please agree to the privacy statement.",WM="It will be publicly visible.",KM="You can hide your achievements and activities under settings.";var QM="Return to step {stepnumber}",ch="You are signed in as",lh="Sign in with a different account",XM="Stay in the know",JM="Stay up to date",ZM="View your profile",e0="Welcome to Docs!",t0="Your email address",o0="All email",n0="Control whether to receive e-mail from Microsoft Q&A. You will still receive administrative emails even if this setting is turned off.",r0="Automatically add you as a follower for",i0="Questions you have asked",a0="Questions you have answered",s0="Questions you have commented on",c0="Questions in tags you follow",l0="Your feedback items",u0="Feedback items you post comments on",d0="Feedback in tags you follow",Gl="Q&A email notifications",p0="On the things I follow, send me a notification when there is",m0="A question is posted",f0="A question is edited",g0="An answer is posted",h0="An answer is accepted",_0="A comment to a question or answer is posted",v0="A feedback item is posted",b0="A comment on a feedback item is posted";var x0="An article is posted",y0="Following tags",T0="Following users",S0="Following Q&A threads",E0="Mentions",w0="Notifications when someone mentions you using @username notation.",C0="New Followers",k0="Notifications when someone follows you.",A0="New Post Moderation",I0="Notifications when a new post has entered moderation.",P0="Unanswered Questions",R0="Control whether to receive a daily digest email of unanswered questions.",N0='<a href="https://docs.microsoft.com/answers/index.html?filters=myActivity">Visit Q&A</a> for all questions and feedback',D0="You followed the {activityType}",L0="Active challenges";var M0="Past challenges";var $y="That username is unavailable. Please try another.",O0="Username and URL",U0="This is where you can download a copy of your data. Data available for renewal assessments will include exam scores without specific or selected answers.";var Vl="Title";var Ip="Training",Pp="Transcript";var $0="Enter your full name",z0="If this link was shared with you, ask the person who shared it to create and share a new link.";var F0="Legal name:",Rp="MCID:";var H0="More information",jl="N/A",q0="Oops... something went wrong. Please reload the page to try again.",B0="Oops... this transcript is no longer available.",Y0="Contact email:";var G0='Edit <span class="visually-hidden">contact email in settings</span>',V0='Edit <span class="visually-hidden">display name in settings</span>',j0="Username:",uh="Print";var W0="Records may take up to 24 hours to update.",K0="See this learner's profile",dh="Share Link",ph="Sorry, something went wrong. Please try again.",Q0="Duration of modules completed",X0="Number of active certifications",J0="Number of historical certifications",Z0="Number of exams passed",eO="Number of qualifications earned",tO="MCT status",oO="Number of modules completed",nO="Active certifications",rO="Microsoft Certified Trainer history",iO="Historical certifications",aO="Modules completed",sO="Passed exams",cO="Qualifications",lO="Achieved on",uO="Active from",zy="Certification number",Fy="Certification title",dO="Completed on",pO="Description",mO="Duration",Hy="Earned on",fO="Exam number",gO="Exam title",mh="Expired on",fh="Expires on",hO="MCT title",_O="Module title",vO="Passed date",bO="Qualification title",xO="State",yO="To";var TO="Copy link",SO="Create link",EO="Link",wO="Link successfully copied!",CO="We could not copy your link at this time. Please try again.",kO="<p>By creating a link, your transcript (including personal information) will be visible to anyone who you share the link with. You can control this information in transcript settings.</p><br/><p>If you remove the link, it will no longer work for those you shared it with and you will have to create a new link.</p>",AO="Remove Link",qy="Transcript settings",By="Add a contact email";var Yy="Show legal name",Gy="Show MCID",Vy="Show contact email";var IO="Trophies",Wl="Trophy";var PO="Tutorial";var RO="Congratulations!";var gh="Twitter";var NO='Microsoft Docs will send email to you at {email}. You can opt out by <a href="#" id="unsubscribe-from-learn-email" class="text-decoration-none">unsubscribing from Microsoft Docs</a>.',DO="Unsubscribe now",LO="Update";var MO="Upload new picture";var hh="URL";var _h="{text} cannot start or end with a period.",OO="{maxChars} characters max.",vh="{text} must be {minChars} to {maxChars} characters in length.",bh="{text} is required.";var oc="View all";var UO="View certification details";var $O="View results";var zO="Vote",FO="Votes";var HO="Web page";var jy="Week",qO="Weekly",Wy="Weeks";var BO="{duration} weeks ago";var YO='<span class="font-weight-semibold">Welcome</span> to Microsoft Docs!';var xh="{totalXP} XP";var Np="Yes, delete";var Sr="You";var GO="Your Account";var VO="Your recent activity";var jO="You will not be notified of future Microsoft Docs related news if you unsubscribe.";var yh=location.pathname.split("/").map(e=>e.toLowerCase()),LY=yh.length>2?yh[2]:"",nc=LY==="test";var MY=te("uhfHeaderId"),OY=MY,We=zY({brand:w.data.brand,pathnameSegments:yh,page_kind:te("page_kind"),page_type:te("page_type"),headerId:OY,isAdmin:te("is_admin")}),Ky=UY(We),WO=$Y(We);function UY(e){switch(e){case"Certifications":return rn;case"Code Samples":return Il;case"Learn":case"Profile":return"Learn";case"Admin":return"Admin";case"Q&A":return"Q&A";case"Regional Directors":return Tp;case"Developer":return Ep;case"Events":return Nl;case"Shows":return Dl;case"Startups":return gp;case"Assessments":case"Docs_Home":case"Documentation":case"Mooncake":case"Third-Party":default:return va}}function $Y(e){switch(e){case"Regional Directors":return Tp;case"Developer":return Ep;case"Startups":return gp;default:return"Docs"}}function zY(e){let{brand:t,pathnameSegments:o,page_kind:n,page_type:r,headerId:i,isAdmin:a}=e;if(a==="true")return"Admin";if(i==="MSDocsHeader-Archive")return"Archive";if(n==="docs"&&r==="home"||r==="welcome")return"Docs_Home";if(r==="profile")return"Profile";if(r==="locale")return"Locale";if(r==="search")return"Search";if(n==="assessments")return"Assessments";if(o[2]==="samples")return"Code Samples";if(o[2]==="legal")return"Legal";if(t==="mooncake")return"Mooncake";switch(i){case"startups":return"Startups";case"answers":case"answersv2":case"answersv2MOD":return"Q&A";case"mooncake":return"Mooncake";case"MSDocsHeader-Certifications":return"Certifications";case"MSDocsHeader-Events":return"Events";case"MSDocsHeader-Learn":return"Learn";case"MSDocsHeader-RegionalDirectors":return"Regional Directors";case"MSDocsHeader-Shows":return"Shows";case"DEV_Homeheader":case"MSDocsHeader-Advocates":case"devcenter-store-header":case"mixed-reality-header":case"win-dev-center-header":case"win-hardware-header":case"win-iot-devcenter-header":case"reactor":return"Developer";case"MSDocsHeader-DocsL1":return"Documentation";case"MSDocsHeader-Assessments":return"Assessments";default:return"Third-Party"}}function QO(e){let t=BY();if(!(!t||t==="exclude"))for(let o of e){let n=o?.id===t;if(n){o.current=n;break}}}var HY={id:"faq-help",pattern:"/answers/articles/38069/qa-help-articles",next:{id:"users",pattern:"/answers/users/",next:{id:"tags",pattern:"/answers/topics.html",next:{id:"tags",pattern:"/answers/topics/",next:{id:"feedback",pattern:"/answers/content/idea",next:{id:"feedback",pattern:"/answers/idea",next:{id:"questions",pattern:"/answers/questions",next:{id:"questions",pattern:"/answers/index.html"}}}}}}}},qY={id:"exclude",pattern:`/${w.data.userLocale}/learn/`,exact:!0,next:{id:"products",pattern:"/learn/paths",next:{id:"products",pattern:"/learn/browse",next:{id:"roles",pattern:"/learn/roles",next:{id:"learn-tv",pattern:"/learn/tv",next:{id:"certifications",pattern:"/certifications",next:{id:"faq-help",pattern:"/learn/support",next:{id:"products",pattern:"/learn/"}}}}}}}};function BY(e=te,t=We){return t==="Learn"?KO(qY):t==="Q&A"?KO(HY):e("activeMenuId")}function KO(e,t=location.pathname){let o,n=e;do(n.exact?t===n.pattern:t.indexOf(n.pattern)!==-1)&&(o=n.id),n=n.next;while(n&&!o);return o}function it(e){let t,o=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=a=>decodeURIComponent(a.replace(o," "));e===void 0&&(e=de.search),e=e.substring(1);let i={};for(;t=n.exec(e);)i[r(t[1])]=r(t[2]);return i}function Le(e,t=!1){let o=[];for(let n in e)e.hasOwnProperty(n)&&e[n]!==""&&e[n]!==null&&e[n]!==void 0&&(t&&Array.isArray(e[n])?e[n].forEach(r=>{o.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):o.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n].toString())));return o.join("&")}function oi(e,t,o){let n=it(),r=!1;for(let l in e)e.hasOwnProperty(l)&&n[l]!==String(e[l])&&(n[l]=e[l],r=!0);let i=de.hash;if(typeof o=="string"&&(o=o.trim(),o.substr(0,1)!=="#"&&o!==""&&(o=`#${o}`),i!==o&&(i=o,r=!0)),!r)return;let a=Le(n);a.length>0&&(a="?"+a);let s=`${de.protocol}//${de.host}${de.pathname}${a}${i}`,c=Vs.state||{};t==="pushState"?Vs.pushState(c,Y.title,s):t==="replaceState"?Vs.replaceState(c,Y.title,s):de.href=s}function XO(e,t=2e3,o=";"){let n=encodeURIComponent(o).length,r=[],i,a;for(let s of e){let c=encodeURIComponent(s).length;if(c>t)throw new Error(`The encoded length of "${s}" (${c}) is greater than the max partition length (${t}).`);(!i||a+c>t)&&(i=[],r.push(i),a=0),i.push(s),a+=c+n}return r}function Th(e=new URL(de.href)){let t=new URLSearchParams(e.search),o={};return t.forEach((n,r)=>o[r]=n),o}var YY="DEV_Homeheader",GY="MSDocsHeader-DocsL1",VY="MSDocsHeader-RegionalDirectors",jY="startups",Sh={Developer:YY,"Regional Directors":VY,Startups:jY};function WY(e){for(let t in Sh)if(e===Sh[t])return!0;return!1}function JO(e){return e in Sh?Sh[e]:GY}function ZO(){let e=te("uhfHeaderId"),t=e&&!WY(e)?e:void 0;return(C.reviewFeatures?it()["header-id"]:void 0)||w.data.context.uhfHeaderId||t}var KY={"https://review.docs.microsoft.com":{cloudShell:"https://ux.console.azure.com",ocvFeedback:"https://petrol-int.office.microsoft.com/v1/feedback",lists:"https://review.docs.microsoft.com/api/lists",gameStatus:"https://review.docs.microsoft.com/api/gamestatus"},"https://ppe.docs.microsoft.com":{cloudShell:"https://ux-rc.console.azure.com",ocvFeedback:"https://petrol-int.office.microsoft.com/v1/feedback"},"https://developer.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://review.developer.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://dev.developer.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://rd.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://review.rd.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://dev.rd.microsoft.com":{siteSearch:"https://docs.microsoft.com/api/search"},"https://localhost:3000":{siteSearch:"https://ppe.docs.microsoft.com/api/search",cloudShell:"https://ux.console.azure.com"},"http://localhost:3000":{siteSearch:"https://ppe.docs.microsoft.com/api/search",cloudShell:"https://ux.console.azure.com"}},QY={"https://review.docs.microsoft.com":{stayCurrent:"https://review.docs.microsoft.com/api/certification"}};function XY(e,t){let o=t.legacyHosting?t.supportLevel==="production"?"https://docs.microsoft.com":"https://ppe.docs.microsoft.com":e,n=t.systemContent?e:o,r=KY[e]||{},i=QY[e]||{};return{admin:JY(),selfAssessmentsAdmin:e6(),apiBrowser:`${o}/api/apibrowser`,assessments:`${n}/api/assessments`,assessmentsBranch:"https://review.docs.microsoft.com/api/assessments/branches",azureManagement:"https://management.azure.com",auth:{docs:`${o}/api/profiles/auth`,identityPlatform:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",signOut:`${o}/api/profiles/signout`},blogs:`${o}/api/archives/blogs/comments`,browse:{certification:`${o}/api/contentbrowser/search/certifications`,course:`${o}/api/contentbrowser/search/certifications/courses`,events:`${o}/api/contentbrowser/search/events`,learn:`${o}/api/contentbrowser/search`,learnHome:`${o}/api/contentbrowser/home/learn`,learnHomePersonalized:`${o}/api/contentbrowser/home/personalized/learn`,sample:`${o}/api/contentbrowser/search/samples`,lifecycle:`${o}/api/contentbrowser/search/lifecycles`,architecture:`${o}/api/contentbrowser/search/architectures`,windowsSafeguards:`${o}/api/contentbrowser/search/windowsSafeguards`,shows:`${o}/api/contentbrowser/search/shows`},buildAuthAdmin:t6(),certification:{appointments:`${o}/api/certification/appointments`,certifications:`${o}/api/certification/certifications`,dashboardSummary:`${o}/api/certification/dashboardsummary`,exams:`${o}/api/certification/exams`,linkedAccount:`${o}/api/certification/linkedAccount`,linkedMcId:`${o}/api/certification/linkedMcId`,printableCertification:`${o}/api/certification/printableCertification`,renewalAssessments:`${o}/api/certification/scoredsnapshots`},cloudShell:"https://ux.console.azure.com",contentNav:e,contentOrigin:n,forumSearch:{azureKbQuestionSuggestions:`${o}/api/qna/azurekb/searchMSDNThreads/v1.0`,forumInternalQuestionSuggestions:`${o}/answers/search.json`},gameStatus:`${o}/api/gamestatus`,github:"https://api.github.com",githubOAuth:"https://github.com/login/oauth/authorize",labOnDemand:`${o}/api/resources/labondemand`,learn:{achievementsByUids:`${o}/api/hierarchy/achievements`,achievement:`${o}/api/gamestatus/achievements`,batchItemSummaries:`${o}/api/hierarchy/items`,certification:`${o}/api/hierarchy/certification`,challenge:`${o}/api/challenges`,episode:`${o}/api/video/public/v1/entries`,exams:`${o}/api/hierarchy/exams`,iltCourses:{scheduling:`${o}/api/wwl/ilt-scheduling/offerings`,location:`${o}/api/wwl/ilt-scheduling/offerings/location`,languages:`${o}/api/wwl/ilt-scheduling/languages`},learningPath:`${o}/api/hierarchy/paths`,module:`${o}/api/hierarchy/modules`,progress:{batchUnit:`${o}/api/progress/units`,unit:`${o}/api/progress/units`,user:`${o}/api/progress`},show:{episodes:`${o}/api/hierarchy/shows`,videos:`${o}/api/video/public/v1/entries/batch`},skillAssessment:`${o}/api/skillassessment`,stayCurrent:`${o}/api/certification`,tvSchedule:"https://learntvpublicschedule.azureedge.net/public/schedule.json",pubbleAuth:`${o}/api/profiles/auth/pubble`,...i},lists:`${o}/api/lists`,monikers:t.accessLevel==="isolated"?`${n}/api/familyTrees`:`${n}/_api/familyTrees`,nextSteps:`${o}/api/nextsteps`,ocvFeedback:"https://petrol.office.microsoft.com/v1/feedback",privacy:{cookieConsentDeleteService:`${e}/api/privacy/cookieDelete`,delete:`${n}/api/privacy/delete`,partialDelete:`${n}/api/privacy/partialdelete`,export:`${n}/api/privacy/export`},profile:{acknowledgeMergeStatus:`${o}/api/profiles/merge/acknowledge`,acknowledgePrivacyNotice:`${o}/api/profiles/me/acknowledgePrivacyNotice`,avatar:`${o}/api/profiles/me/avatar`,avert:`${o}/api/profiles/avert`,certification:`${o}/api/profiles/certification/certifications`,challenge:`${o}/api/profiles/challenge`,deleteMecUserData:`${o}/api/profiles/mec/delete`,link:`${o}/api/profiles/link`,me:`${o}/api/profiles/me`,merge:`${o}/api/profiles/merge`,migrateMecUserData:`${o}/api/profiles/mec/migrate`,profiles:`${o}/api/profiles`,qnaFollowing:`${o}/api/qna/following`,reporting:`${o}/api/profiles/reporting`,validateMerge:`${o}/api/profiles/merge/validate`,transcript:{private:`${o}/api/profiles/transcript/me`,public:`${o}/api/profiles/transcript/share`,settings:{publicLink:`${o}/api/profiles/transcript/share`,transcript:`${o}/api/profiles/transcript/me/settings`}},achievement:`${o}/api/gamestatus/achievement`},qna:{admin:`${o}/api/questions/admin`,report:`${o}/api/questions/moderation/report`,tags:`${o}/api/questions/tags/autocomplete`},qnaSettings:`${o}/en-us/answers/users/{qnaId}/{username}/preferences.html`,rating:`${o}/api/rating`,recommendations:`${o}/api/recommendations`,sandbox:`${o}/api/resources/sandbox`,siteFeedback:`${o}/api/feedback/report`,siteSearch:`${e}/api/search`,uhf:{consentBanner:`${o}/api/GetConsentBanner`},video:ZY(),...r}}function JY(){return C.reviewFeatures&&C.supportLevel==="production"?"https://review.docs.microsoft.com/api/admin":C.supportLevel==="production"?"https://docs.microsoft.com/api/admin":"https://ppe.docs.microsoft.com/api/admin"}function ZY(){return C.reviewFeatures&&C.supportLevel==="production"?"https://review.docs.microsoft.com/api/admin":C.supportLevel==="production"?"https://docs.microsoft.com/api/admin":"https://ppe.docs.microsoft.com/api/admin"}function e6(){return"https://docs-rcs-pubdev.azurewebsites.net"}function t6(){return C.supportLevel==="production"?"https://docs.microsoft.com/api/build/":"https://ppe.docs.microsoft.com/api/build/"}var eU=["m365","azure"],tU=["microsoft.com","azure.com"],re=XY(location.origin,C);function Di(e=["api-branch","branch"],t=""){if(C.accessLevel==="local")return"main";if(C.reviewFeatures===!0){let o=it(de.search);return e.reduce((n,r)=>n||o[r],void 0)||t}return null}function Qy(e){return decodeURIComponent(atob(o6(e).replace(/_/g,"/").replace(/-/g,"+")).split("").map(t=>`%${("00"+t.charCodeAt(0).toString(16)).slice(-2)}`).join(""))}function o6(e){switch(e.length%4){case 0:return e;case 2:return e+"==";case 3:return e+"=";default:throw new Error("Illegal base64url string!")}}var Xy="id_token",Jy="docsAuthToken",Dp=class{constructor({detail:t}){this.message="invalid token",this.detail=t}},Er=class{constructor({detail:t}){this.message="invalid claim",this.detail=t}},Eh=class{constructor({detail:t}){this.message="malformed claim",this.detail=t}};function wh(e){nt.setItem(Xy,e)}function Ao(){return nt.getItem(Xy)}function Et(){nt.removeItem(Xy)}function Ch(e){nt.setItem(Jy,e)}function rc(){return nt.getItem(Jy)}function kh(){nt.removeItem(Jy)}function ya(e,t={nbfClockSkewInMilliseconds:2500}){try{if(!(e&&e.length&&e.indexOf(".")>-1))throw new Dp({detail:"Invalid JWT - no separators found."});let n=e.split("."),r=JSON.parse(Qy(n[1]));if(!r)throw new Dp({detail:"Invalid JWT - payload is missing."});if(r.hasOwnProperty("nbf")){let i=r.nbf;if(isNaN(i))throw new Eh({detail:"Invalid NBF claim - claim is malformed."});let a=new Date(0);a.setUTCSeconds(r.nbf);let s=new Date(Date.now()+t.nbfClockSkewInMilliseconds);if(a>s)throw new Er({detail:"Invalid NBF claim - token not yet valid."})}if(r.hasOwnProperty("exp")){let i=r.exp;if(isNaN(i))throw new Eh({detail:"Invalid EXP claim - claim is malformed."});let a=new Date(0);a.setUTCSeconds(r.exp);let s=new Date(Date.now());if(a<=s)throw new Er({detail:"Invalid EXP claim - token has expired."})}return r}finally{}}var oU=e=>{if(!(e&&e.length&&e.indexOf(".")>-1))throw new Dp({detail:"Invalid JWT - no separators found."});let o=e.split(".");return JSON.parse(Qy(o[1]))};var n6=30*1e3,J=async(e,t)=>{t=t||{};let o=new AbortController;t.signal=o.signal;let n=setTimeout(()=>o.abort(),n6),r=await fetch(e,t);return clearTimeout(n),r};function we(e,t,o=!0){t=t||{},t.mode="cors",o&&!t.credentials&&(t.credentials="omit");let n=new Request(e,t);return o&&rc()&&n.headers.set("Authorization",`Bearer ${rc()}`),(n.method==="PUT"||n.method==="POST")&&n.headers.set("Content-Type","application/json"),n}async function Zy(e,t=w.data.userLocale){let o={branch:Di(["contentnav-branch"],"main")},n="content-nav",r=`${re.contentNav}/${t}/${n}/${e}.json?${Le(o)}`,i=await J(r,{credentials:"include"});if(!i.ok){let s=new Error(`Content navigation JSON not found for ${e} in ${t}.`);return s.headerId=e,console.error(s),null}let a=await i.json();return C.accessLevel==="isolated"&&e==="azure"&&a.callToAction&&a.callToAction.secondary&&a.callToAction.secondary.href.toLowerCase().indexOf("portal.azure.com")!==-1&&(a.callToAction.secondary.href=`https://${C.azurePortalHostname}`),a.items.push({kind:"menu",title:Cn,items:[]}),a}var Lp=Ne.userServices&&C.siteName!=="mooncake"&&We!=="Developer"&&We!=="Startups"&&We!=="Regional Directors",Ah=We==="Third-Party"||We==="Developer"||We==="Assessments"||We==="Certifications"||We==="Learn"||We==="Mooncake"||We==="Q&A";var{userLocale:ic}=w.data,nU={category:{kind:"link",href:`/${ic}/`,title:"Developer"},items:[{kind:"link",href:`https://docs.microsoft.com/${ic}/`,title:va},{kind:"link",href:`https://docs.microsoft.com/${ic}/learn/`,title:"Learn"},{kind:"link",href:`https://docs.microsoft.com/${ic}/answers/products/`,title:"Q&A"},{kind:"link",href:`https://docs.microsoft.com/${ic}/samples/browse/`,title:Il},{kind:"link",href:`https://docs.microsoft.com/${ic}/shows/`,title:Dl},{kind:"link",href:`https://docs.microsoft.com/${ic}/events/`,title:Nl},{kind:"menu",title:Cn,items:[]}],cookieBanner:null};var{userLocale:Li}=w.data,Kl=location.hostname.endsWith("docs.azure.cn"),ac=Kl?"https://docs.microsoft.com":"",rU={category:{kind:"link",href:`/${Li}/`,title:"Docs"},items:[...Kl?[]:[{kind:"link",href:`${ac}/${Li}/documentation/`,title:va}],{kind:"link",href:`${ac}/${Li}/learn/`,title:"Learn"},{kind:"link",href:`${ac}/${Li}/certifications/`,title:rn},...Ne.qna&&!Kl?[{kind:"link",href:`${ac}/${Li}/answers/products/`,title:"Q&A"}]:[],...Ne.codeSamples&&!Kl?[{kind:"link",href:`${ac}/${Li}/samples/browse/`,title:Il}]:[],...Kl?[{kind:"link",href:`https://support.azure.cn/${Li}/support/contact/`,title:ND}]:[],...C.accessLevel!=="isolated"?[{kind:"link",href:`${ac}/${Li}/shows/`,title:Dl},{kind:"link",href:Kl?"https://chinaevent.microsoft.com/events":`${ac}/${Li}/events/`,title:Nl}]:[],{kind:"menu",title:Cn,items:[]}],cookieBanner:null};var{userLocale:iU}=w.data,aU={category:{kind:"link",href:`/${iU}/`,title:Tp},items:[{kind:"link",href:`/${iU}/about/`,title:ek},{kind:"menu",title:Cn,items:[]}],cookieBanner:null};var sU={category:{kind:"link",href:"/",title:gp},items:[{kind:"link",href:"https://docs.microsoft.com/en-us/learn/topics/startups",title:AI},{kind:"link",href:"/blog/",title:bk},{kind:"menu",title:Cn,items:[]}],callToAction:{primary:{kind:"link",href:"https://portal.startups.microsoft.com/",title:vD}},cookieBanner:null};var cU={DEV_Homeheader:nU,"MSDocsHeader-DocsL1":rU,"MSDocsHeader-RegionalDirectors":aU,startups:sU};function lU(e){return e in cU?cU[e]:null}var sc,wr,uU,tT=new Promise(e=>uU=e),eT,oT=new Promise(e=>eT=e),Ih,Mp=new Promise(e=>Ih=e);async function dU(){await Promise.all([oT,Mp]),uU()}async function pU(){let e=JO(We),t=lU(e);if(t){sc=t,eT();return}sc=await Zy(e),eT()}async function mU(){if(!Ah){wr=null,Ih();return}let e=ZO();if(!e){wr=null,Ih();return}wr=await Zy(e),wr&&QO(wr.items),Ih()}var r6="<wbr>",h7=`$1${r6}$2`;var i6=/[&<>"']/g,_7=RegExp(i6.source);function jo(e,t={year:"numeric",month:"short",day:"numeric"},o=w.data.userLocale){return new Date(e).toLocaleDateString(o,t).replace(/\u200E/g,"")}var At=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="none"><circle cx="16" cy="16" r="16" fill="#F4F5F6"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.11865 26.7162C6.1436 22.1697 10.7016 19 16 19C21.2983 19 25.8564 22.1697 27.8813 26.7162C24.9531 29.9608 20.7147 32 16 32C11.2853 32 7.04689 29.9608 4.11865 26.7162ZM23 10C23 13.866 19.866 17 16 17C12.134 17 8.99999 13.866 8.99999 10C8.99999 6.13401 12.134 3 16 3C19.866 3 23 6.13401 23 10Z" fill="#B8B9BA"/></svg>')}`,Ql=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 448"><path fill="#919191" d="M277.733 252.81c31.966-18.644 53.742-52.923 53.742-92.527 0-59.267-48.22-107.475-107.475-107.475-59.267 0-107.475 48.208-107.475 107.475 0 39.604 21.77 73.884 53.738 92.528C112.35 274.105 72 328.998 72 395.193h24.566c0-71.466 55.98-127.434 127.434-127.434 72.64 0 127.434 54.793 127.434 127.434H376c0-66.197-40.35-121.09-98.267-142.383zM141.09 160.282c0-45.713 37.197-82.91 82.91-82.91 45.725 0 82.91 37.197 82.91 82.91s-37.186 82.91-82.91 82.91c-45.713 0-82.91-37.197-82.91-82.91z"/></svg>')}`,Xl=`data:image/svg+xml;base64,${btoa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="3 3 42 42"><path d="M32.5 14a1.492 1.492 0 011.5 1.5v23a1.494 1.494 0 01-1.5 1.5h-17a1.494 1.494 0 01-1.5-1.5v-23a1.494 1.494 0 011.5-1.5h4.873l-3-6h2.25l3 6h2.751l3-6h2.25l-3 6zm-.5 2h-8.377l1.266 2.546A1.13 1.13 0 0125 19a1.009 1.009 0 01-1 1 1 1 0 01-.534-.149.974.974 0 01-.368-.4L21.375 16H16v22h16zM20 26a3.92 3.92 0 01.312-1.555 4.023 4.023 0 012.133-2.133 4.041 4.041 0 013.109 0 4.014 4.014 0 012.133 2.133A3.886 3.886 0 0128 26a3.937 3.937 0 01-.288 1.485 3.987 3.987 0 01-.8 1.266 5.7 5.7 0 011.288.949 5.907 5.907 0 01.968 1.251 6.388 6.388 0 01.616 1.461A5.786 5.786 0 0130 34h-2a3.877 3.877 0 00-.312-1.554 4 4 0 00-2.133-2.133 4.011 4.011 0 00-3.109 0 4.023 4.023 0 00-2.133 2.133A3.912 3.912 0 0020 33.995h-2a5.786 5.786 0 01.218-1.586 6.388 6.388 0 01.616-1.461A5.933 5.933 0 0119.8 29.7a5.694 5.694 0 011.288-.951 3.991 3.991 0 01-.8-1.267A3.945 3.945 0 0120 26zm6 0a1.92 1.92 0 00-.157-.781 2.039 2.039 0 00-1.061-1.062 2.024 2.024 0 00-1.563 0 2.048 2.048 0 00-1.061 1.062 2.021 2.021 0 000 1.562 2.042 2.042 0 001.061 1.061 2.024 2.024 0 001.563 0 2.032 2.032 0 001.061-1.061A1.927 1.927 0 0026 26z" fill="#919191"/></svg>')}`,_t=class{},Ta="72f988bf-86f1-41af-91ab-2d7cd011db47",a6="9188040d-6c67-4c5b-b112-36a304b66dad",nT={[Ta]:"microsoft",[a6]:"standard"},rT=new Date("2019-11-21T00:00:00.000Z"),Ut=(e,t)=>iT(e,t).toString(),Cr=class extends Ye{constructor(){super();this.setAnonymous()}setAnonymous(){this.isAuthenticated!==!1&&(this.userId="00000000-0000-0000-0000-000000000000",this.upn="anonymous@anonymous.com",this.email="anonymous@anonymous.com",this.userName="Anonymous",this.displayName="Anonymous",this.locale="en-us",this.country=null,this.contactPointTopicSetting=null,this.authenticationMode="AAD",this.authenticationModes=[],this.isAuthenticated=!1,this.avatarUrl=At,this.avatarThumbnailUrl=At,this.profileUrl="#",this.createdOn=null,this.userType="standard",this.acceptedPrivacyNotice=rT,this.isAvatarTakenDown=!1,this.followerCount=0,this.followingCount=0,this.answersAccepted=0,this.isMicrosoftUser=!1,this.isMvp=!1,this.reputationPoints=1,this.qnaUserId=0,this.interests=null,this.isPrivate=!1,this.gsi=null,this.tenantId=null,this.credentialId=null,this.source=null,this.publish(new _t))}mapIdTokenToProfile(o){this.email=o.email||o.preferred_username,this.upn=o.preferred_username,this.userName=o.name,this.displayName=o.name,this.authenticationMode=nT[o.tid]==="standard"?"MSA":"AAD",this.userType=nT[o.tid]||"aad",this.isAuthenticated=!0,this.country="",this.credentialId=this.authenticationMode==="AAD"?o.oid:o.puid,this.publish(new _t)}readUserProfile(o){this.userId=o.userId,this.email=o.email||"",this.userName=o.userName,this.displayName=o.displayName||o.userName||o.email,this.locale=o.locale,this.country=o.country,this.contactPointTopicSetting=o.contactPointTopicSetting,this.isAuthenticated=!0,this.avatarUrl=o.avatarUrl||At,this.avatarThumbnailUrl=o.avatarThumbnailUrl||o.avatarUrl||At,this.profileUrl=Ut(o.userName),this.authenticationModes=o.authenticationModes,this.userType=s6(o.authenticationModes),this.acceptedPrivacyNotice=new Date(o.acceptedPrivacyNotice),this.isAvatarTakenDown=o.isAvatarTakenDown,this.followingCount=o.followingCount,this.followerCount=o.followerCount,this.answersAccepted=o.answersAccepted,this.isMicrosoftUser=o.isMicrosoftUser,this.isMvp=o.isMvp,this.reputationPoints=o.reputationPoints,this.createdOn=new Date(o.createdOn),this.qnaUserId=o.qnaUserId,this.interests=o.interests,this.isPrivate=o.isPrivate,this.gsi=o.gsi,this.source=o.source,this.certificationSettings=o.certificationSettings,this.transcriptSettings=o.transcriptSettings,this.mcid=o.mcid,this.publish(new _t)}readUserFromToken(o){this.isAuthenticated=!0,this.instructor=o.instructor,this.isMecUser=o.is_mec_user,this.userId=o.sub,this.upn=o.cred_upn,this.tenantId=o.tid,this.credentialId=o.cred_id,this.userName=o.preferred_username,this.displayName=o.name||o.preferred_username||o.email,this.avatarUrl=o.picture||At,this.avatarThumbnailUrl=o.thumbnail||o.picture||At,this.authenticationMode=o.cred_type,this.locale=o.locale,this.acceptedPrivacyNotice=o.accepted_privacy_notice,this.userType=nT[o.tid]||"aad",this.profileUrl=Ut(o.preferred_username),this.publish(new _t)}whenAuthenticated(){return y.isAuthenticated?Promise.resolve():new Promise(o=>this.subscribe(_t,()=>{this.isAuthenticated&&o()}))}},y=new Cr,an=()=>y.email&&y.email.length>0&&y.email!=="anonymous@anonymous.com";var Mi=()=>y.profileUrl!=="#";function cc(e,t){Array.from(e.querySelectorAll("[data-profile-property]")).forEach(o=>{let n=o.getAttribute("data-profile-property"),r=t.profileUrl;o instanceof HTMLImageElement&&n==="avatarUrl"?(o.onerror=()=>o.src=At,o.src=t[n]):o instanceof HTMLImageElement&&n==="avatarThumbnailUrl"?(o.onerror=()=>o.src=t.avatarUrl||At,o.src=t[n]):o instanceof HTMLAnchorElement&&n==="profileUrl"?(o.href=Ut("me","activity"),r==="#"&&(o.href=new URL("./register",Oi()).toString())):o instanceof HTMLAnchorElement&&n==="bookmarksUrl"?(o.href=r+(C.reviewFeatures?"&section=collections&detail=bookmarks":"collections/bookmarks"),r==="#"&&o.parentElement.remove()):o instanceof HTMLAnchorElement&&n==="collectionsUrl"?(o.href=r+(C.reviewFeatures?"&section=collections":"collections"),r==="#"&&o.parentElement.remove()):o instanceof HTMLAnchorElement&&n==="settingsUrl"?o.href=Ut("me","settings"):o instanceof HTMLInputElement?o.type!=="file"&&(o.value=t[n]):n==="createdOn"?o.textContent=jo(t[n]):o.textContent=t[n]})}async function Sa(e){let t={displayName:"",userName:"",email:y.email,locale:y.locale,country:y.country,contactPointTopicSetting:y.contactPointTopicSetting,avatarImageBytes:null,avatarExtension:null,source:null,isPrivate:y.isPrivate,interests:y.interests,gsi:y.gsi,certificationSettings:y.certificationSettings,transcriptSettings:y.transcriptSettings,mcid:y.mcid};if(!e)return t;function o(n){return new Promise(r=>{let i=new FileReader;i.onloadend=()=>{r(i.result.split(",").pop())},i.readAsDataURL(n)})}for(let n of Array.from(e.querySelectorAll("[data-profile-property]"))){let r=n.getAttribute("data-profile-property");n instanceof HTMLInputElement?n.type==="file"?t[r]=await o(n.files[0]):t[r]=n.value:t[r]=n.textContent}return t.gsi=y.gsi,t}function iT(e,t){let o=Oi(),n=new URLSearchParams(de.search);if(te("page_type")==="profile"&&(n.has("section")&&o.searchParams.set("section",n.get("section")),o.hash=de.hash),C.reviewFeatures)n.has("branch")&&o.searchParams.set("branch",n.get("branch")),o.searchParams.set("username",e),t&&o.searchParams.set("section",t),n.has("themebranch")&&o.searchParams.set("themebranch",n.get("themebranch")),n.has("preview")&&o.searchParams.set("preview",n.get("preview"));else{let r=`./${e}/`;t&&(r+=`${t}/`);let i=new URL(r,o);i.hash=o.hash,i.search=o.search,o=i}return o}function Oi(e=w.data.userLocale){let t=new URL(`${e&&e.length?`/${e}`:""}/`,de.origin),o=new URL("./users/",t);return C.reviewFeatures&&(o=new URL("./test/profile/profile",t)),o}function s6(e){let t="standard";return e&&e.length&&(e.find(o=>o.tenantId===Ta)!==void 0?t="microsoft":e.find(o=>o.type==="AAD")!==void 0&&(t="aad")),t}function Ph(){let e=Ao();if(!e)return null;try{let t=ya(e),o=new Cr;return o.mapIdTokenToProfile(t),o}catch{return null}}var Op=class{};function Rh(e){let t={method:"GET"},o=we(re.auth.docs,t,!1);return o.headers.set("Authorization",`Bearer ${e}`),J(o).then(n=>{if(n.ok)return n.text();throw n.status===404||n.status===204?new Op:n.status===401?new Er({detail:"token not accepted"}):new Error(`get docs auth token failed (${n.status} ${n.statusText})`)})}function Wo(e,t=!0){try{if(e.ok&&e.headers.has("Authorization")){let o=e.headers.get("Authorization");if(o){let n=ya(o);Ch(o),t&&y.readUserFromToken(n)}}return e}catch{return e}}async function fU(e){let t={method:"POST",body:JSON.stringify(e)},o=await J(we(re.privacy.cookieConsentDeleteService,t));if(!o.ok)throw new Error(`Cookie Deletion Error ${o.status}: ${o.statusText}`)}var gU;(function(e){gU=e()})(function(){let e=function(){let o=0,n={};for(;o<arguments.length;o++){let r=arguments[o];for(let i in r)n[i]=r[i]}return n};function t(o){let n=function(r,i,a){let s;if(typeof document>"u")return;if(arguments.length>1){if(a=e({path:"/"},n.defaults,a),typeof a.expires=="number"){let m=new Date;m.setMilliseconds(m.getMilliseconds()+a.expires*864e5),a.expires=m}a.expires=a.expires?a.expires.toUTCString():"";try{s=JSON.stringify(i),/^[\{\[]/.test(s)&&(i=s)}catch{}o.write?i=o.write(i,r):i=encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),r=encodeURIComponent(String(r)),r=r.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),r=r.replace(/[\(\)]/g,escape);let p="";for(let m in a)!a[m]||(p+="; "+m,a[m]!==!0&&(p+="="+a[m]));return document.cookie=r+"="+i+p}r||(s={});let c=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,u=0;for(;u<c.length;u++){let p=c[u].split("="),m=p.slice(1).join("=");m.charAt(0)==='"'&&(m=m.slice(1,-1));try{let f=p[0].replace(l,decodeURIComponent);if(m=o.read?o.read(m,f):o(m,f)||m.replace(l,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch{}if(r===f){s=m;break}r||(s[f]=m)}catch{}}return s};return n.set=n,n.get=function(r){return n.call(n,r)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(r,i){n(r,"",e(i,{expires:-1}))},n.withConverter=t,n}return t(function(){})});var Nh=gU;function lc(){window.dispatchEvent(new CustomEvent("content-update"))}var hU=!!window.matchMedia,U7=window.matchMedia(`screen and (min-width: ${768}px), screen and (min-height: ${1024}px)`),Dh=window.matchMedia(`screen and (min-width: ${1088}px)`),Up=window.matchMedia(`screen and (min-width: ${768}px)`),$7=window.matchMedia(`screen and (max-width: ${768}px)`),_U=window.matchMedia("print"),vU=window.matchMedia("(prefers-color-scheme: dark)");var Lh="light",sT={light:{documentClass:"theme-light",name:"light",text:HI,icon:"docon-sun"},dark:{documentClass:"theme-dark",name:"dark",text:oI,icon:"docon-clear-night"},"high-contrast":{documentClass:"theme-high-contrast",name:"high-contrast",text:vI,icon:"docon-clear-night"}},c6=Object.keys(sT),l6=c6.map(e=>sT[e].documentClass),aT=class{constructor(t,o){this.currentTheme=t;this.previousTheme=o}};function u6(e,t,o){e.publish(new aT(t,o)),window.dispatchEvent(new CustomEvent("theme-changed",{detail:{currentTheme:t,previousTheme:o}}))}function d6(e){let t=document.documentElement.classList;for(let o of l6)t.remove(o);t.add(sT[e].documentClass)}function p6(e){return Lh=e}function bU(e){let t=Array.from(document.querySelectorAll(".theme-control[data-theme-to]"));for(let o of t)o.dataset.themeTo===e?(o.classList.add("is-selected"),o.setAttribute("aria-pressed","true")):(o.classList.remove("is-selected"),o.setAttribute("aria-pressed","false"))}function m6(e){nt.setItem("theme",e)}function f6(e=!1){let t=nt.getItem("theme");return/^light|dark|high-contrast$/.test(t)?t:e?"dark":"light"}function g6(e){cT(wn,e)}function cT(e,t){let o=Lh;p6(t),d6(t),o!==t&&u6(e,t,o)}async function xU(e){let t=h6();cT(e,t),_6(e),await Dt,bU(t),window.setTheme=g6}function h6(e=vU.matches){let t=it();return t.theme==="light"||t.theme==="dark"||t.theme==="high-contrast"?t.theme:f6(e)}function _6(e){window.addEventListener("click",({target:t})=>{let o=t instanceof Element&&t.closest(".theme-control[data-theme-to]");if(!o)return;let n=o.dataset.themeTo;bU(n),m6(n),cT(e,n)})}var $p,tQ=new Promise(e=>$p=e),uc,TU=new Promise(e=>uc=e),yU=e=>{for(let t of Object.values(e))if(!t)return!1;return!0};async function SU(){if(!Ne.cookieConsent)return;if(Ne.chromeless){uc(!0),$p();return}let e=Nh.get("MSCC")!==void 0,t=he.WcpConsent;if(t===void 0||typeof t.init!="function"){uc(!1);return}await Dt;let o=document.getElementById("cookie-consent-holder"),n=Array.from(document.querySelectorAll(".manage-cookies-holder"));if(!o||!n.length){console.log("No container for cookie banner");return}t.init(w.data.userLocale,o,function(r,i){if(r!==void 0){uc(!1);return}if(!i.isConsentRequired){uc(!0),$p();return}let a=document.createElement("button");if(a.setAttribute("data-bi-name","manageCookies"),a.textContent=BI,n.forEach(s=>{s.appendChild(a.cloneNode(!0)).addEventListener("click",()=>{i.manageConsent()}),s.hidden=!1}),o.hidden=!1,lc(),yU(i.getConsent())){uc(!0),$p();return}uc(!1)},async function(r){if(yU(r)){$p();return}await fU({domain:document.location.hostname,analytics:!r.Analytics,advertising:!r.Advertising,social:!r.SocialMedia}),e&&(he.location.href=he.location.pathname+he.location.search+he.location.hash)},Lh)}function EU(e=location.hostname){return{"developer.microsoft.com":"DevCenter","dev.docs.microsoft.com":"DocsDev","docs.azure.cn":"DocsCN","docs.microsoft.com":"Docs","learn.microsoft.com":"Docs","internal.docs.microsoft.com":"DocsInternal","ppe.docs.microsoft.com":"DocsPPE","review.docs.microsoft.com":"DocsReview","review.learn.microsoft.com":"DocsReview","startups.microsoft.com":"supcom"}[e]||"OneDSTest"}function wU(e=location.hostname){let t={"developer.microsoft.com":"d1574ad452ea4a37a5dda6f9f1fb5ef2-b55b2da9-95eb-4cf9-a633-191aa7b0ee25-6798","docs.azure.cn":"54ae4d70fff842118ff98bccfdc28deb-7f4f32ec-ae5a-4562-881c-5c0188170faf-7594","docs.microsoft.com":"c6c27850c9c24cbfae921778d2465031-4c28c161-db47-426b-9d28-733d45d05dd9-7278","learn.microsoft.com":"c6c27850c9c24cbfae921778d2465031-4c28c161-db47-426b-9d28-733d45d05dd9-7278","internal.docs.microsoft.com":"544ac96504db48bebdddbe3cf1e1f116-e2157ba3-a60b-464f-b49b-8dd89dac355f-7571","ppe.docs.microsoft.com":"1b68dbc9b56749fca3e6f2db2a7ff3f5-b0e31456-1fc6-40de-ad91-dad67a5c6e9e-7319","review.docs.microsoft.com":"d94fc739fadb4805bce966a4f24e2e21-a6b89116-ce98-4ffb-b1cf-d46e361ea690-7616","review.learn.microsoft.com":"d94fc739fadb4805bce966a4f24e2e21-a6b89116-ce98-4ffb-b1cf-d46e361ea690-7616","rd.microsoft.com":"066aa48b4fe64bd5aa1bfee3086793b0-2a9b1be5-d541-4bf6-9c2e-a5263feed23c-7531","startups.microsoft.com":"228c4e4af6ee4420925f1fa5cfd7dd7b-3090334e-ee46-4cbb-b357-8316634c0ed9-7369"},o="8617064329544862a1d4dbcc1cdda9d3-079a9ef7-af43-443d-a28b-f60ba4efc9ff-7531";return t[e]??o}var CU=!1;var v6={audience:"aud",author:"author",manager:"manager","ms.assetid":"asst","ms.author":"pgauth","ms.contentsource":"pgpubl","ms.custom":"custom","ms.date":"date",depot_name:"depotname","ms.devlang":"pgdevlng",gitcommit:"gitcommit",original_content_git_url:"giturl",updated_at:"publishtime","ms.lasthandoff":"lasthandoff","ms.locfileid":"locfileid","ms.prod":"product","ms.reviewer":"reviewer","ms.service":"pgsrvcs","ms.suite":"suite","ms.technology":"technology","ms.tgt_pltfrm":"pgtrgtplf","ms.topic":"pgtop","ms.workload":"workload","ms.search.region":"searchregion","ms.prod_service":"prod_service","ms.component":"component",experimental:"experimental",experiment_id:"experiment_id","ms.assigned_experiments":"assigned_experiments","ms.translationtype":"translationtype",document_version_independent_id:"document_version_independent_id","ms.collection":"collection","ms.subservice":"subservice"};function Mh(e){let t=document.querySelectorAll("meta");for(let o=0;o<t.length;o++){let n=t.item(o),r=v6[n.name];n.name==="ms.collection"||n.name==="ms.custom"?e[r]=e[r]?`${e[r]},${n.content}`:n.content:r&&(e[r]=n.content)}e.contentlocale=w.data.contentLocale,e.highContrast=CU.toString()}var kU;async function AU(){let e=window.awa;if(!Ne.oneDS||!e)return;let t=await TU;b6(e,t),kU(e)}function b6(e,t){let o={instrumentationKey:wU(),useShortNameForContentBlob:!1,syncMuid:t,urlCollectHash:!0,urlCollectQuery:!0,autoCapture:{pageView:!0,onLoad:!0,click:!0,scroll:!0,resize:!0,jsError:!0,addin:!0,msTags:!1,perf:!0,assets:!1,lineage:!0},coreData:{appId:EU(),pageName:te("document_id")||"missing document_id",market:w.data.userLocale,pageType:te("page_type"),pageTags:{}},callback:{signedinStatus:()=>y.isAuthenticated&&(y.authenticationMode==="MSA"||y.tenantId===Ta),pageViewPageTags:Oh,pageActionPageTags:Oh,contentUpdatePageTags:Oh,pageActionContentTags:Oh},shareAuthStatus:!0,isLoggedIn:!1};Mh(o.coreData.pageTags),o.coreData.pageTags.pageTemplate=w.data.pageTemplate,e.init(o)}function Oh(){return y.isAuthenticated?{"ext-app-user-id":`c:${y.userId}`}:{}}var Ea=new Promise(e=>kU=e);var Io={CLICKLEFT:"CL",CLICKRIGHT:"CR",CLICKMIDDLE:"CM",SCROLL:"S",ZOOM:"Z",RESIZE:"R",KEYBOARDENTER:"KE",KEYBOARDSPACE:"KS",GAMEPADA:"CGA",GAMEPADMENU:"CGM",OTHER:"O",AUTO:"A"},ho={UNDEFINED:0,NAVIGATIONBACK:1,NAVIGATION:2,NAVIGATIONFORWARD:3,APPLY:4,REMOVE:5,SORT:6,EXPAND:7,REDUCE:8,CONTEXTMENU:9,TAB:10,COPY:11,EXPERIMENTATION:12,PRINT:13,SHOW:14,HIDE:15,MAXIMIZE:16,MINIMIZE:17,BACKBUTTON:18,STARTPROCESS:20,PROCESSCHECKPOINT:21,COMPLETEPROCESS:22,SCENARIOCANCEL:23,DOWNLOADCOMMIT:40,DOWNLOAD:41,SEARCHAUTOCOMPLETE:60,SEARCH:61,SEARCHINITIATE:62,TEXTBOXINPUT:63,PURCHASE:80,ADDTOCART:81,VIEWCART:82,ADDWISHLIST:83,FINDSTORE:84,CHECKOUT:85,REMOVEFROMCART:86,PURCHASECOMPLETE:87,VIEWCHECKOUTPAGE:88,VIEWCARTPAGE:89,VIEWPDP:90,UPDATEITEMQUANTITY:91,INTENTTOBUY:92,PUSHTOINSTALL:93,SIGNIN:100,SIGNOUT:101,SOCIALSHARE:120,SOCIALLIKE:121,SOCIALREPLY:122,CALL:123,EMAIL:124,COMMUNITY:125,SOCIALFOLLOW:126,VOTE:140,SURVEYINITIATE:141,SURVEYCOMPLETE:142,REPORTAPPLICATION:143,REPORTREVIEW:144,SURVEYCHECKPOINT:145,CONTACT:160,REGISTRATIONINITIATE:161,REGISTRATIONCOMPLETE:162,CANCELSUBSCRIPTION:163,RENEWSUBSCRIPTION:164,CHANGESUBSCRIPTION:165,REGISTRATIONCHECKPOINT:166,CHATINITIATE:180,CHATEND:181,TRIALSIGNUP:200,TRIALINITIATE:201,SIGNUP:210,FREESIGNUP:211,PARTNERREFERRAL:220,LEARNLOWFUNNEL:230,LEARNHIGHFUNNEL:231,SHOPPINGINTENT:232,VIDEOSTART:240,VIDEOPAUSE:241,VIDEOCONTINUE:242,VIDEOCHECKPOINT:243,VIDEOJUMP:244,VIDEOCOMPLETE:245,VIDEOBUFFERING:246,VIDEOERROR:247,VIDEOMUTE:248,VIDEOUNMUTE:249,VIDEOFULLSCREEN:250,VIDEOUNFULLSCREEN:251,VIDEOREPLAY:252,VIDEOPLAYERLOAD:253,VIDEOPLAYERCLICK:254,VIDEOVOLUMECONTROL:255,VIDEOAUDIOTRACKCONTROL:256,VIDEOCLOSEDCAPTIONCONTROL:257,VIDEOCLOSEDCAPTIONSTYLE:258,VIDEORESOLUTIONCONTROL:259,VIRTUALEVENTJOIN:260,VIRTUALEVENTEND:261,IMPRESSION:280,CLICK:281,RICHMEDIACOMPLETE:282,ADBUFFERING:283,ADERROR:284,ADSTART:285,ADCOMPLETE:286,ADSKIP:287,ADTIMEOUT:288,OTHER:300},Jl={id:"data-bi-id",name:"data-bi-name",type:"data-bi-type",scenario:"data-bi-scn",scenarioStep:"data-bi-scnstp",scenarioStepNumber:"data-bi-subnm",satisfaction:"data-bi-sat"};var zp=e=>{for(;e&&e.hasAttribute&&!e.hasAttribute(Jl.name);)e=e.parentElement;return e?e.getAttribute(Jl.name):""},IU=()=>{Ea.then(e=>{e.sku.getAuthExtension().signOut()})},PU=(e,t)=>{Ea.then(o=>{let n=o.sku.getAuthExtension();if(!t){n.setAuthType(0);return}n.setAuthType(e==="MSA"?1:e==="AAD"?2:0)})},RU=e=>{Ea.then(t=>t.extendCoreData(e))},Zl=(e,t)=>{Ea.then(o=>o.ct.capturePageAction(e,t))},Po=e=>{Ea.then(t=>t.ct.captureContentPageAction(e))},lT=e=>{Ea.then(t=>t.ct.captureContentUpdate(e))},uT=e=>{Ea.then(t=>t.ct.capturePageView(e||{}))};function wa(e=null,t=`${de.origin}${de.pathname}`){let o=e?new URL(e):new URL(t);if(o.protocol==="https:"&&(o.hostname===de.hostname||o.hostname.endsWith("docs.microsoft.com")))return o;let n=`${de.origin}${de.pathname}`;return t===n?new URL(`${o.pathname}${o.search}${o.hash}`,`${de.origin}`):wa(t)}var dT=function(e,t){return dT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])},dT(e,t)};function et(e,t){dT(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}var oe=function(){return oe=Object.assign||function(t){for(var o,n=1,r=arguments.length;n<r;n++){o=arguments[n];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},oe.apply(this,arguments)};function D(e,t,o,n){function r(i){return i instanceof o?i:new o(function(a){a(i)})}return new(o||(o=Promise))(function(i,a){function s(u){try{l(n.next(u))}catch(p){a(p)}}function c(u){try{l(n.throw(u))}catch(p){a(p)}}function l(u){u.done?i(u.value):r(u.value).then(s,c)}l((n=n.apply(e,t||[])).next())})}function L(e,t){var o={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,r,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=l[0]&2?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){o=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(l[0]===6&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(u){l=[6,u],r=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function x6(e,t){var o=typeof Symbol=="function"&&e[Symbol.iterator];if(!o)return e;var n=o.call(e),r,i=[],a;try{for(;(t===void 0||t-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(a)throw a.error}}return i}function Uh(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(x6(arguments[t]));return e}var pT=function(e,t){return pT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])},pT(e,t)};function mt(e,t){pT(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}var pt=function(){return pt=Object.assign||function(t){for(var o,n=1,r=arguments.length;n<r;n++){o=arguments[n];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},pt.apply(this,arguments)};function pe(e,t,o,n){function r(i){return i instanceof o?i:new o(function(a){a(i)})}return new(o||(o=Promise))(function(i,a){function s(u){try{l(n.next(u))}catch(p){a(p)}}function c(u){try{l(n.throw(u))}catch(p){a(p)}}function l(u){u.done?i(u.value):r(u.value).then(s,c)}l((n=n.apply(e,t||[])).next())})}function me(e,t){var o={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,r,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(u){return c([l,u])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=l[0]&2?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){o=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){o.label=l[1];break}if(l[0]===6&&o.label<i[1]){o.label=i[1],i=l;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(l);break}i[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(u){l=[6,u],r=0}finally{n=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Ca(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;for(var n=Array(e),r=0,t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n}var T={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token"},Ar=[T.OPENID_SCOPE,T.PROFILE_SCOPE,T.OFFLINE_ACCESS_SCOPE],mT=Ca(Ar,[T.EMAIL_SCOPE]),Kn;(function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox",e.WWWAuthenticate="WWW-Authenticate",e.AuthenticationInfo="Authentication-Info"})(Kn||(Kn={}));var eo;(function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"})(eo||(eo={}));var Fp;(function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"})(Fp||(Fp={}));var Ce;(function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_APP_NAME="x-app-name",e.X_APP_VER="x-app-ver",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox",e.RETURN_SPA_CODE="return_spa_code",e.NATIVE_BROKER="nativebroker",e.LOGOUT_HINT="logout_hint"})(Ce||(Ce={}));var dc;(function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"})(dc||(dc={}));var Lt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"},eu;(function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"})(eu||(eu={}));var fT={PLAIN:"plain",S256:"S256"},pc;(function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"})(pc||(pc={}));var tu;(function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"})(tu||(tu={}));var kr;(function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"})(kr||(kr={}));var to;(function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."})(to||(to={}));var Re;(function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"})(Re||(Re={}));var ni;(function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"})(ni||(ni={}));var Qn;(function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"})(Qn||(Qn={}));var qp="appmetadata",NU="client_info",ou="1",fc={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},In;(function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network",e.HARDCODED_VALUES="hardcoded_values"})(In||(In={}));var oo={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Fe;(function(e){e.BEARER="Bearer",e.POP="pop",e.SSH="ssh-cert"})(Fe||(Fe={}));var Aa={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},gT={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Hp;(function(e){e.username="username",e.password="password"})(Hp||(Hp={}));var mc;(function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"})(mc||(mc={}));var Ui;(function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"})(Ui||(Ui={}));var ka;(function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"})(ka||(ka={}));var $i;(function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"})($i||($i={}));var $h;(function(e){e.Jwt="JWT",e.Jwk="JWK"})($h||($h={}));var zh={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},Z=function(e){mt(t,e);function t(o,n,r){var i=this,a=n?o+": "+n:o;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=o||T.EMPTY_STRING,i.errorMessage=n||T.EMPTY_STRING,i.subError=r||T.EMPTY_STRING,i.name="AuthError",i}return t.prototype.setCorrelationId=function(o){this.correlationId=o},t.createUnexpectedError=function(o){return new t(zh.unexpectedError.code,zh.unexpectedError.desc+": "+o)},t}(Error);var Ia={createNewGuid:function(){var e="Crypto interface - createNewGuid() has not been implemented";throw Z.createUnexpectedError(e)},base64Decode:function(){var e="Crypto interface - base64Decode() has not been implemented";throw Z.createUnexpectedError(e)},base64Encode:function(){var e="Crypto interface - base64Encode() has not been implemented";throw Z.createUnexpectedError(e)},generatePkceCodes:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - generatePkceCodes() has not been implemented",Z.createUnexpectedError(e)})})},getPublicKeyThumbprint:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - getPublicKeyThumbprint() has not been implemented",Z.createUnexpectedError(e)})})},removeTokenBindingKey:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - removeTokenBindingKey() has not been implemented",Z.createUnexpectedError(e)})})},clearKeystore:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - clearKeystore() has not been implemented",Z.createUnexpectedError(e)})})},signJwt:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - signJwt() has not been implemented",Z.createUnexpectedError(e)})})},hashString:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Crypto interface - hashString() has not been implemented",Z.createUnexpectedError(e)})})}};var j={clientInfoDecodingError:{code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},clientInfoEmptyError:{code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},tokenParsingError:{code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},nullOrEmptyToken:{code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},endpointResolutionError:{code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},networkError:{code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},unableToGetOpenidConfigError:{code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},hashNotDeserialized:{code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},blankGuidGenerated:{code:"blank_guid_generated",desc:"The guid generated was blank. Please review the trace to determine the root cause."},invalidStateError:{code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},stateMismatchError:{code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},stateNotFoundError:{code:"state_not_found",desc:"State not found"},nonceMismatchError:{code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},nonceNotFoundError:{code:"nonce_not_found",desc:"nonce not found"},noTokensFoundError:{code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},multipleMatchingTokens:{code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},multipleMatchingAccounts:{code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},multipleMatchingAppMetadata:{code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},tokenRequestCannotBeMade:{code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},appendEmptyScopeError:{code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},removeEmptyScopeError:{code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},appendScopeSetError:{code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},emptyInputScopeSetError:{code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},DeviceCodePollingCancelled:{code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},DeviceCodeExpired:{code:"device_code_expired",desc:"Device code is expired."},DeviceCodeUnknownError:{code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},NoAccountInSilentRequest:{code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},invalidCacheRecord:{code:"invalid_cache_record",desc:"Cache record object was null or undefined."},invalidCacheEnvironment:{code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},noAccountFound:{code:"no_account_found",desc:"No account found in cache for given key."},CachePluginError:{code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},noCryptoObj:{code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},unexpectedAccountType:{code:"unexpected_account_type",desc:"Unexpected account type."},unexpectedCredentialType:{code:"unexpected_credential_type",desc:"Unexpected credential type."},invalidAssertion:{code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},invalidClientCredential:{code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},tokenRefreshRequired:{code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},userTimeoutReached:{code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},tokenClaimsRequired:{code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},noAuthorizationCodeFromServer:{code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},noAzureRegionDetected:{code:"no_azure_region_detected",desc:"No azure region was detected and no fallback was made available"},accessTokenEntityNullError:{code:"access_token_entity_null",desc:"Access token entity is null, please check logs and cache to ensure a valid access token is present."},bindingKeyNotRemovedError:{code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},logoutNotSupported:{code:"end_session_endpoint_not_supported",desc:"Provided authority does not support logout."},keyIdMissing:{code:"key_id_missing",desc:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key."}},W=function(e){mt(t,e);function t(o,n){var r=e.call(this,o,n)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,t.prototype),r}return t.createClientInfoDecodingError=function(o){return new t(j.clientInfoDecodingError.code,j.clientInfoDecodingError.desc+" Failed with error: "+o)},t.createClientInfoEmptyError=function(){return new t(j.clientInfoEmptyError.code,""+j.clientInfoEmptyError.desc)},t.createTokenParsingError=function(o){return new t(j.tokenParsingError.code,j.tokenParsingError.desc+" Failed with error: "+o)},t.createTokenNullOrEmptyError=function(o){return new t(j.nullOrEmptyToken.code,j.nullOrEmptyToken.desc+" Raw Token Value: "+o)},t.createEndpointDiscoveryIncompleteError=function(o){return new t(j.endpointResolutionError.code,j.endpointResolutionError.desc+" Detail: "+o)},t.createNetworkError=function(o,n){return new t(j.networkError.code,j.networkError.desc+" | Fetch client threw: "+n+" | Attempted to reach: "+o.split("?")[0])},t.createUnableToGetOpenidConfigError=function(o){return new t(j.unableToGetOpenidConfigError.code,j.unableToGetOpenidConfigError.desc+" Attempted to retrieve endpoints from: "+o)},t.createHashNotDeserializedError=function(o){return new t(j.hashNotDeserialized.code,j.hashNotDeserialized.desc+" Given Object: "+o)},t.createInvalidStateError=function(o,n){return new t(j.invalidStateError.code,j.invalidStateError.desc+" Invalid State: "+o+", Root Err: "+n)},t.createStateMismatchError=function(){return new t(j.stateMismatchError.code,j.stateMismatchError.desc)},t.createStateNotFoundError=function(o){return new t(j.stateNotFoundError.code,j.stateNotFoundError.desc+":  "+o)},t.createNonceMismatchError=function(){return new t(j.nonceMismatchError.code,j.nonceMismatchError.desc)},t.createNonceNotFoundError=function(o){return new t(j.nonceNotFoundError.code,j.nonceNotFoundError.desc+":  "+o)},t.createMultipleMatchingTokensInCacheError=function(){return new t(j.multipleMatchingTokens.code,j.multipleMatchingTokens.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(j.multipleMatchingAccounts.code,j.multipleMatchingAccounts.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(j.multipleMatchingAppMetadata.code,j.multipleMatchingAppMetadata.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(j.tokenRequestCannotBeMade.code,j.tokenRequestCannotBeMade.desc)},t.createAppendEmptyScopeToSetError=function(o){return new t(j.appendEmptyScopeError.code,j.appendEmptyScopeError.desc+" Given Scope: "+o)},t.createRemoveEmptyScopeFromSetError=function(o){return new t(j.removeEmptyScopeError.code,j.removeEmptyScopeError.desc+" Given Scope: "+o)},t.createAppendScopeSetError=function(o){return new t(j.appendScopeSetError.code,j.appendScopeSetError.desc+" Detail Error: "+o)},t.createEmptyInputScopeSetError=function(){return new t(j.emptyInputScopeSetError.code,""+j.emptyInputScopeSetError.desc)},t.createDeviceCodeCancelledError=function(){return new t(j.DeviceCodePollingCancelled.code,""+j.DeviceCodePollingCancelled.desc)},t.createDeviceCodeExpiredError=function(){return new t(j.DeviceCodeExpired.code,""+j.DeviceCodeExpired.desc)},t.createDeviceCodeUnknownError=function(){return new t(j.DeviceCodeUnknownError.code,""+j.DeviceCodeUnknownError.desc)},t.createNoAccountInSilentRequestError=function(){return new t(j.NoAccountInSilentRequest.code,""+j.NoAccountInSilentRequest.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(j.invalidCacheRecord.code,j.invalidCacheRecord.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(j.invalidCacheEnvironment.code,j.invalidCacheEnvironment.desc)},t.createNoAccountFoundError=function(){return new t(j.noAccountFound.code,j.noAccountFound.desc)},t.createCachePluginError=function(){return new t(j.CachePluginError.code,""+j.CachePluginError.desc)},t.createNoCryptoObjectError=function(o){return new t(j.noCryptoObj.code,""+j.noCryptoObj.desc+o)},t.createInvalidCacheTypeError=function(){return new t(j.invalidCacheType.code,""+j.invalidCacheType.desc)},t.createUnexpectedAccountTypeError=function(){return new t(j.unexpectedAccountType.code,""+j.unexpectedAccountType.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(j.unexpectedCredentialType.code,""+j.unexpectedCredentialType.desc)},t.createInvalidAssertionError=function(){return new t(j.invalidAssertion.code,""+j.invalidAssertion.desc)},t.createInvalidCredentialError=function(){return new t(j.invalidClientCredential.code,""+j.invalidClientCredential.desc)},t.createRefreshRequiredError=function(){return new t(j.tokenRefreshRequired.code,j.tokenRefreshRequired.desc)},t.createUserTimeoutReachedError=function(){return new t(j.userTimeoutReached.code,j.userTimeoutReached.desc)},t.createTokenClaimsRequiredError=function(){return new t(j.tokenClaimsRequired.code,j.tokenClaimsRequired.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(j.noAuthorizationCodeFromServer.code,j.noAuthorizationCodeFromServer.desc)},t.createBindingKeyNotRemovedError=function(){return new t(j.bindingKeyNotRemovedError.code,j.bindingKeyNotRemovedError.desc)},t.createLogoutNotSupportedError=function(){return new t(j.logoutNotSupported.code,j.logoutNotSupported.desc)},t.createKeyIdMissingError=function(){return new t(j.keyIdMissing.code,j.keyIdMissing.desc)},t}(Z);var z=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw W.createTokenNullOrEmptyError(t);var o=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,n=o.exec(t);if(!n||n.length<4)throw W.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));var r={header:n[1],JWSPayload:n[2],JWSSig:n[3]};return r},e.isEmpty=function(t){return typeof t>"u"||!t||t.length===0},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var o=JSON.parse(t);return Object.keys(o).length===0}catch{}return!0},e.startsWith=function(t,o){return t.indexOf(o)===0},e.endsWith=function(t,o){return t.length>=o.length&&t.lastIndexOf(o)===t.length-o.length},e.queryStringToObject=function(t){var o={},n=t.split("&"),r=function(i){return decodeURIComponent(i.replace(/\+/g," "))};return n.forEach(function(i){if(i.trim()){var a=i.split(/=(.+)/g,2),s=a[0],c=a[1];s&&c&&(o[r(s)]=r(c))}}),o},e.trimArrayEntries=function(t){return t.map(function(o){return o.trim()})},e.removeEmptyStringsFromArray=function(t){return t.filter(function(o){return!e.isEmpty(o)})},e.jsonParseHelper=function(t){try{return JSON.parse(t)}catch{return null}},e.matchPattern=function(t,o){var n=new RegExp(t.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?"));return n.test(o)},e}();var vt;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"})(vt||(vt={}));var nu=function(){function e(t,o,n){this.level=vt.Info;var r=function(){};this.localCallback=t.loggerCallback||r,this.piiLoggingEnabled=t.piiLoggingEnabled||!1,this.level=typeof t.logLevel=="number"?t.logLevel:vt.Info,this.correlationId=t.correlationId||T.EMPTY_STRING,this.packageName=o||T.EMPTY_STRING,this.packageVersion=n||T.EMPTY_STRING}return e.prototype.clone=function(t,o,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,o)},e.prototype.logMessage=function(t,o){if(!(o.logLevel>this.level||!this.piiLoggingEnabled&&o.containsPii)){var n=new Date().toUTCString(),r;z.isEmpty(o.correlationId)?z.isEmpty(this.correlationId)?r="["+n+"]":r="["+n+"] : ["+this.correlationId+"]":r="["+n+"] : ["+o.correlationId+"]";var i=r+" : "+this.packageName+"@"+this.packageVersion+" : "+vt[o.logLevel]+" - "+t;this.executeCallback(o.logLevel,i,o.containsPii||!1)}},e.prototype.executeCallback=function(t,o,n){this.localCallback&&this.localCallback(t,o,n)},e.prototype.error=function(t,o){this.logMessage(t,{logLevel:vt.Error,containsPii:!1,correlationId:o||T.EMPTY_STRING})},e.prototype.errorPii=function(t,o){this.logMessage(t,{logLevel:vt.Error,containsPii:!0,correlationId:o||T.EMPTY_STRING})},e.prototype.warning=function(t,o){this.logMessage(t,{logLevel:vt.Warning,containsPii:!1,correlationId:o||T.EMPTY_STRING})},e.prototype.warningPii=function(t,o){this.logMessage(t,{logLevel:vt.Warning,containsPii:!0,correlationId:o||T.EMPTY_STRING})},e.prototype.info=function(t,o){this.logMessage(t,{logLevel:vt.Info,containsPii:!1,correlationId:o||T.EMPTY_STRING})},e.prototype.infoPii=function(t,o){this.logMessage(t,{logLevel:vt.Info,containsPii:!0,correlationId:o||T.EMPTY_STRING})},e.prototype.verbose=function(t,o){this.logMessage(t,{logLevel:vt.Verbose,containsPii:!1,correlationId:o||T.EMPTY_STRING})},e.prototype.verbosePii=function(t,o){this.logMessage(t,{logLevel:vt.Verbose,containsPii:!0,correlationId:o||T.EMPTY_STRING})},e.prototype.trace=function(t,o){this.logMessage(t,{logLevel:vt.Trace,containsPii:!1,correlationId:o||T.EMPTY_STRING})},e.prototype.tracePii=function(t,o){this.logMessage(t,{logLevel:vt.Trace,containsPii:!0,correlationId:o||T.EMPTY_STRING})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}();var DU="@azure/msal-common",Fh="7.1.0";var ri;(function(e){e[e.None=0]="None",e.AzurePublic="https://login.microsoftonline.com",e.AzurePpe="https://login.windows-ppe.net",e.AzureChina="https://login.chinacloudapi.cn",e.AzureGermany="https://login.microsoftonline.de",e.AzureUsGovernment="https://login.microsoftonline.us"})(ri||(ri={}));var zi=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},e.prototype.generateType=function(){switch(this.credentialType){case Re.ID_TOKEN:return Qn.ID_TOKEN;case Re.ACCESS_TOKEN:case Re.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Qn.ACCESS_TOKEN;case Re.REFRESH_TOKEN:return Qn.REFRESH_TOKEN;default:throw W.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(t){return t.indexOf(Re.ACCESS_TOKEN.toLowerCase())!==-1?t.indexOf(Re.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())!==-1?Re.ACCESS_TOKEN_WITH_AUTH_SCHEME:Re.ACCESS_TOKEN:t.indexOf(Re.ID_TOKEN.toLowerCase())!==-1?Re.ID_TOKEN:t.indexOf(Re.REFRESH_TOKEN.toLowerCase())!==-1?Re.REFRESH_TOKEN:T.NOT_DEFINED},e.generateCredentialCacheKey=function(t,o,n,r,i,a,s,c,l){var u=[this.generateAccountIdForCacheKey(t,o),this.generateCredentialIdForCacheKey(n,r,i,s),this.generateTargetForCacheKey(a),this.generateClaimsHashForCacheKey(l),this.generateSchemeForCacheKey(c)];return u.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(t,o){var n=[t,o];return n.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(t,o,n,r){var i=t===Re.REFRESH_TOKEN&&r||o,a=[t,i,n||T.EMPTY_STRING];return a.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(t){return(t||T.EMPTY_STRING).toLowerCase()},e.generateClaimsHashForCacheKey=function(t){return(t||T.EMPTY_STRING).toLowerCase()},e.generateSchemeForCacheKey=function(t){return t&&t.toLowerCase()!==Fe.BEARER.toLowerCase()?t.toLowerCase():T.EMPTY_STRING},e}();var ke={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"}},Ke=function(e){mt(t,e);function t(o,n){var r=e.call(this,o,n)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,t.prototype),r}return t.createRedirectUriEmptyError=function(){return new t(ke.redirectUriNotSet.code,ke.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(ke.postLogoutUriNotSet.code,ke.postLogoutUriNotSet.desc)},t.createClaimsRequestParsingError=function(o){return new t(ke.claimsRequestParsingError.code,ke.claimsRequestParsingError.desc+" Given value: "+o)},t.createInsecureAuthorityUriError=function(o){return new t(ke.authorityUriInsecure.code,ke.authorityUriInsecure.desc+" Given URI: "+o)},t.createUrlParseError=function(o){return new t(ke.urlParseError.code,ke.urlParseError.desc+" Given Error: "+o)},t.createUrlEmptyError=function(){return new t(ke.urlEmptyError.code,ke.urlEmptyError.desc)},t.createEmptyScopesArrayError=function(){return new t(ke.emptyScopesError.code,""+ke.emptyScopesError.desc)},t.createClientIdSingleScopeError=function(o){return new t(ke.clientIdSingleScopeError.code,ke.clientIdSingleScopeError.desc+" Given Scopes: "+o)},t.createInvalidPromptError=function(o){return new t(ke.invalidPrompt.code,ke.invalidPrompt.desc+" Given value: "+o)},t.createInvalidClaimsRequestError=function(){return new t(ke.invalidClaimsRequest.code,ke.invalidClaimsRequest.desc)},t.createEmptyLogoutRequestError=function(){return new t(ke.logoutRequestEmptyError.code,ke.logoutRequestEmptyError.desc)},t.createEmptyTokenRequestError=function(){return new t(ke.tokenRequestEmptyError.code,ke.tokenRequestEmptyError.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(ke.invalidCodeChallengeMethod.code,ke.invalidCodeChallengeMethod.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(ke.invalidCodeChallengeParams.code,ke.invalidCodeChallengeParams.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(ke.invalidCloudDiscoveryMetadata.code,ke.invalidCloudDiscoveryMetadata.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(ke.invalidAuthorityMetadata.code,ke.invalidAuthorityMetadata.desc)},t.createUntrustedAuthorityError=function(){return new t(ke.untrustedAuthority.code,ke.untrustedAuthority.desc)},t.createInvalidAzureCloudInstanceError=function(){return new t(ke.invalidAzureCloudInstance.code,ke.invalidAzureCloudInstance.desc)},t.createMissingSshJwkError=function(){return new t(ke.missingSshJwk.code,ke.missingSshJwk.desc)},t.createMissingSshKidError=function(){return new t(ke.missingSshKid.code,ke.missingSshKid.desc)},t.createMissingNonceAuthenticationHeadersError=function(){return new t(ke.missingNonceAuthenticationHeader.code,ke.missingNonceAuthenticationHeader.desc)},t.createInvalidAuthenticationHeaderError=function(o,n){return new t(ke.invalidAuthenticationHeader.code,ke.invalidAuthenticationHeader.desc+". Invalid header: "+o+". Details: "+n)},t}(W);var no=function(){function e(t){var o=this,n=t?z.trimArrayEntries(Ca(t)):[],r=n?z.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(function(i){return o.scopes.add(i)})}return e.fromString=function(t){var o=t||T.EMPTY_STRING,n=o.split(" ");return new e(n)},e.prototype.validateInputScopes=function(t){if(!t||t.length<1)throw Ke.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var o=this.printScopesLowerCase().split(" "),n=new e(o);return z.isEmpty(t)?!1:n.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(t){var o=this;return!t||t.scopes.size<=0?!1:this.scopes.size>=t.scopes.size&&t.asArray().every(function(n){return o.containsScope(n)})},e.prototype.containsOnlyOIDCScopes=function(){var t=this,o=0;return mT.forEach(function(n){t.containsScope(n)&&(o+=1)}),this.scopes.size===o},e.prototype.appendScope=function(t){z.isEmpty(t)||this.scopes.add(t.trim())},e.prototype.appendScopes=function(t){var o=this;try{t.forEach(function(n){return o.appendScope(n)})}catch(n){throw W.createAppendScopeSetError(n)}},e.prototype.removeScope=function(t){if(z.isEmpty(t))throw W.createRemoveEmptyScopeFromSetError(t);this.scopes.delete(t.trim())},e.prototype.removeOIDCScopes=function(){var t=this;mT.forEach(function(o){t.scopes.delete(o)})},e.prototype.unionScopeSets=function(t){if(!t)throw W.createEmptyInputScopeSetError();var o=new Set;return t.scopes.forEach(function(n){return o.add(n.toLowerCase())}),this.scopes.forEach(function(n){return o.add(n.toLowerCase())}),o},e.prototype.intersectingScopeSets=function(t){if(!t)throw W.createEmptyInputScopeSetError();t.containsOnlyOIDCScopes()||t.removeOIDCScopes();var o=this.unionScopeSets(t),n=t.getScopeCount(),r=this.getScopeCount(),i=o.size;return i<r+n},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var t=[];return this.scopes.forEach(function(o){return t.push(o)}),t},e.prototype.printScopes=function(){if(this.scopes){var t=this.asArray();return t.join(" ")}return T.EMPTY_STRING},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function gc(e,t){if(z.isEmpty(e))throw W.createClientInfoEmptyError();try{var o=t.base64Decode(e);return JSON.parse(o)}catch(n){throw W.createClientInfoDecodingError(n)}}function Pa(e){if(z.isEmpty(e))throw W.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(to.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?T.EMPTY_STRING:t[1]}}var sn;(function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"})(sn||(sn={}));var Tt=function(){function e(){}return e.prototype.generateAccountId=function(){var t=[this.homeAccountId,this.environment];return t.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case kr.ADFS_ACCOUNT_TYPE:return Qn.ADFS;case kr.MSAV1_ACCOUNT_TYPE:return Qn.MSA;case kr.MSSTS_ACCOUNT_TYPE:return Qn.MSSTS;case kr.GENERIC_ACCOUNT_TYPE:return Qn.GENERIC;default:throw W.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},e.generateAccountCacheKey=function(t){var o=[t.homeAccountId,t.environment||T.EMPTY_STRING,t.tenantId||T.EMPTY_STRING];return o.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,o,n,r,i,a,s,c){var l,u,p,m,f,h,_=new e;_.authorityType=kr.MSSTS_ACCOUNT_TYPE,_.clientInfo=t,_.homeAccountId=o,_.nativeAccountId=c;var g=s||r&&r.getPreferredCache();if(!g)throw W.createInvalidCacheEnvironmentError();return _.environment=g,_.realm=((l=n?.claims)===null||l===void 0?void 0:l.tid)||T.EMPTY_STRING,n&&(_.idTokenClaims=n.claims,_.localAccountId=((u=n?.claims)===null||u===void 0?void 0:u.oid)||((p=n?.claims)===null||p===void 0?void 0:p.sub)||T.EMPTY_STRING,_.username=((m=n?.claims)===null||m===void 0?void 0:m.preferred_username)||(!((f=n?.claims)===null||f===void 0)&&f.emails?n.claims.emails[0]:T.EMPTY_STRING),_.name=(h=n?.claims)===null||h===void 0?void 0:h.name),_.cloudGraphHostName=i,_.msGraphHost=a,_},e.createGenericAccount=function(t,o,n,r,i,a){var s,c,l,u,p=new e;p.authorityType=n&&n.authorityType===sn.Adfs?kr.ADFS_ACCOUNT_TYPE:kr.GENERIC_ACCOUNT_TYPE,p.homeAccountId=t,p.realm=T.EMPTY_STRING;var m=a||n&&n.getPreferredCache();if(!m)throw W.createInvalidCacheEnvironmentError();return o&&(p.localAccountId=((s=o?.claims)===null||s===void 0?void 0:s.oid)||((c=o?.claims)===null||c===void 0?void 0:c.sub)||T.EMPTY_STRING,p.username=((l=o?.claims)===null||l===void 0?void 0:l.upn)||T.EMPTY_STRING,p.name=((u=o?.claims)===null||u===void 0?void 0:u.name)||T.EMPTY_STRING,p.idTokenClaims=o?.claims),p.environment=m,p.cloudGraphHostName=r,p.msGraphHost=i,p},e.generateHomeAccountId=function(t,o,n,r,i){var a,s=!((a=i?.claims)===null||a===void 0)&&a.sub?i.claims.sub:T.EMPTY_STRING;if(o===sn.Adfs)return s;if(t)try{var c=gc(t,r);if(!z.isEmpty(c.uid)&&!z.isEmpty(c.utid))return""+c.uid+to.CLIENT_INFO_SEPARATOR+c.utid}catch{}return n.verbose("No client info in response"),s},e.isAccountEntity=function(t){return t?t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("localAccountId")&&t.hasOwnProperty("username")&&t.hasOwnProperty("authorityType"):!1},e.accountInfoIsEqual=function(t,o,n){if(!t||!o)return!1;var r=!0;if(n){var i=t.idTokenClaims||{},a=o.idTokenClaims||{};r=i.iat===a.iat&&i.nonce===a.nonce}return t.homeAccountId===o.homeAccountId&&t.localAccountId===o.localAccountId&&t.username===o.username&&t.tenantId===o.tenantId&&t.environment===o.environment&&t.nativeAccountId===o.nativeAccountId&&r},e}();var Ro=function(){function e(t,o){if(z.isEmpty(t))throw W.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,o)}return e.extractTokenClaims=function(t,o){var n=z.decodeAuthToken(t);try{var r=n.JWSPayload,i=o.base64Decode(r);return JSON.parse(i)}catch(a){throw W.createTokenParsingError(a)}},e}();var cn=function(){function e(t,o){this.clientId=t,this.cryptoImpl=o}return e.prototype.getAllAccounts=function(){var t=this,o=this.getAccountsFilteredBy(),n=Object.keys(o).map(function(a){return o[a]}),r=n.length;if(r<1)return[];var i=n.map(function(a){var s=e.toObject(new Tt,a),c=s.getAccountInfo(),l=t.readIdTokenFromCache(t.clientId,c);return l&&!c.idTokenClaims&&(c.idTokenClaims=new Ro(l.secret,t.cryptoImpl).claims),c});return i},e.prototype.saveCacheRecord=function(t){return pe(this,void 0,void 0,function(){return me(this,function(o){switch(o.label){case 0:if(!t)throw W.createNullOrUndefinedCacheRecord();return t.account&&this.setAccount(t.account),t.idToken&&this.setIdTokenCredential(t.idToken),t.accessToken?[4,this.saveAccessToken(t.accessToken)]:[3,2];case 1:o.sent(),o.label=2;case 2:return t.refreshToken&&this.setRefreshTokenCredential(t.refreshToken),t.appMetadata&&this.setAppMetadata(t.appMetadata),[2]}})})},e.prototype.saveAccessToken=function(t){return pe(this,void 0,void 0,function(){var o,n,r,i,a=this;return me(this,function(s){switch(s.label){case 0:return o=this.getCredentialsFilteredBy({clientId:t.clientId,credentialType:t.credentialType,environment:t.environment,homeAccountId:t.homeAccountId,realm:t.realm,tokenType:t.tokenType,requestedClaimsHash:t.requestedClaimsHash}),n=no.fromString(t.target),r=Object.keys(o.accessTokens).map(function(c){return o.accessTokens[c]}),r?(i=[],r.forEach(function(c){var l=no.fromString(c.target);l.intersectingScopeSets(n)&&i.push(a.removeCredential(c))}),[4,Promise.all(i)]):[3,2];case 1:s.sent(),s.label=2;case 2:return this.setAccessTokenCredential(t),[2]}})})},e.prototype.getAccountsFilteredBy=function(t){return this.getAccountsFilteredByInternal(t?t.homeAccountId:T.EMPTY_STRING,t?t.environment:T.EMPTY_STRING,t?t.realm:T.EMPTY_STRING)},e.prototype.getAccountsFilteredByInternal=function(t,o,n){var r=this,i=this.getKeys(),a={};return i.forEach(function(s){var c=r.getAccount(s);!c||!!t&&!r.matchHomeAccountId(c,t)||!!o&&!r.matchEnvironment(c,o)||!!n&&!r.matchRealm(c,n)||(a[s]=c)}),a},e.prototype.getCredentialsFilteredBy=function(t){return this.getCredentialsFilteredByInternal(t.homeAccountId,t.environment,t.credentialType,t.clientId,t.familyId,t.realm,t.target,t.userAssertionHash,t.tokenType,t.keyId,t.requestedClaimsHash)},e.prototype.getCredentialsFilteredByInternal=function(t,o,n,r,i,a,s,c,l,u,p){var m=this,f=this.getKeys(),h={idTokens:{},accessTokens:{},refreshTokens:{}};return f.forEach(function(_){var g=zi.getCredentialType(_);if(g!==T.NOT_DEFINED){var v=m.getSpecificCredential(_,g);if(!!v&&!(!!c&&!m.matchUserAssertionHash(v,c))&&!(!!t&&!m.matchHomeAccountId(v,t))&&!(!!o&&!m.matchEnvironment(v,o))&&!(!!a&&!m.matchRealm(v,a))&&!(!!n&&!m.matchCredentialType(v,n))&&!(!!r&&!m.matchClientId(v,r))&&!(!!i&&!m.matchFamilyId(v,i))&&!(!!s&&!m.matchTarget(v,s))&&!((p||v.requestedClaimsHash)&&v.requestedClaimsHash!==p)&&!(n===Re.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(!!l&&!m.matchTokenType(v,l)||l===Fe.SSH&&u&&!m.matchKeyId(v,u)))){var x=m.updateCredentialCacheKey(_,v);switch(g){case Re.ID_TOKEN:h.idTokens[x]=v;break;case Re.ACCESS_TOKEN:case Re.ACCESS_TOKEN_WITH_AUTH_SCHEME:h.accessTokens[x]=v;break;case Re.REFRESH_TOKEN:h.refreshTokens[x]=v;break}}}}),h},e.prototype.getAppMetadataFilteredBy=function(t){return this.getAppMetadataFilteredByInternal(t.environment,t.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(t,o){var n=this,r=this.getKeys(),i={};return r.forEach(function(a){if(!!n.isAppMetadata(a)){var s=n.getAppMetadata(a);!s||!!t&&!n.matchEnvironment(s,t)||!!o&&!n.matchClientId(s,o)||(i[a]=s)}}),i},e.prototype.getAuthorityMetadataByAlias=function(t){var o=this,n=this.getAuthorityMetadataKeys(),r=null;return n.forEach(function(i){if(!(!o.isAuthorityMetadata(i)||i.indexOf(o.clientId)===-1)){var a=o.getAuthorityMetadata(i);!a||a.aliases.indexOf(t)!==-1&&(r=a)}}),r},e.prototype.removeAllAccounts=function(){return pe(this,void 0,void 0,function(){var t,o,n=this;return me(this,function(r){switch(r.label){case 0:return t=this.getKeys(),o=[],t.forEach(function(i){var a=n.getAccount(i);!a||o.push(n.removeAccount(i))}),[4,Promise.all(o)];case 1:return r.sent(),[2,!0]}})})},e.prototype.removeAccount=function(t){return pe(this,void 0,void 0,function(){var o;return me(this,function(n){switch(n.label){case 0:if(o=this.getAccount(t),!o)throw W.createNoAccountFoundError();return[4,this.removeAccountContext(o)];case 1:return[2,n.sent()&&this.removeItem(t,ni.ACCOUNT)]}})})},e.prototype.removeAccountContext=function(t){return pe(this,void 0,void 0,function(){var o,n,r,i=this;return me(this,function(a){switch(a.label){case 0:return o=this.getKeys(),n=t.generateAccountId(),r=[],o.forEach(function(s){var c=zi.getCredentialType(s);if(c!==T.NOT_DEFINED){var l=i.getSpecificCredential(s,c);!!l&&n===l.generateAccountId()&&r.push(i.removeCredential(l))}}),[4,Promise.all(r)];case 1:return a.sent(),[2,!0]}})})},e.prototype.removeCredential=function(t){return pe(this,void 0,void 0,function(){var o,n,r;return me(this,function(i){switch(i.label){case 0:if(o=t.generateCredentialKey(),t.credentialType.toLowerCase()!==Re.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(t.tokenType!==Fe.POP)return[3,4];if(n=t,r=n.keyId,!r)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return i.sent(),[3,4];case 3:throw i.sent(),W.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(o,ni.CREDENTIAL)]}})})},e.prototype.removeAppMetadata=function(){var t=this,o=this.getKeys();return o.forEach(function(n){t.isAppMetadata(n)&&t.removeItem(n,ni.APP_METADATA)}),!0},e.prototype.readCacheRecord=function(t,o,n,r){var i=this.readAccountFromCache(t),a=this.readIdTokenFromCache(o,t),s=this.readAccessTokenFromCache(o,t,n),c=this.readRefreshTokenFromCache(o,t,!1),l=this.readAppMetadataFromCache(r,o);return i&&a&&(i.idTokenClaims=new Ro(a.secret,this.cryptoImpl).claims),{account:i,idToken:a,accessToken:s,refreshToken:c,appMetadata:l}},e.prototype.readAccountFromCache=function(t){var o=Tt.generateAccountCacheKey(t);return this.getAccount(o)},e.prototype.readIdTokenFromCache=function(t,o){var n={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:Re.ID_TOKEN,clientId:t,realm:o.tenantId},r=this.getCredentialsFilteredBy(n),i=Object.keys(r.idTokens).map(function(s){return r.idTokens[s]}),a=i.length;if(a<1)return null;if(a>1)throw W.createMultipleMatchingTokensInCacheError();return i[0]},e.prototype.readAccessTokenFromCache=function(t,o,n){var r=new no(n.scopes||[]),i=n.authenticationScheme||Fe.BEARER,a=i&&i.toLowerCase()!==Fe.BEARER.toLowerCase()?Re.ACCESS_TOKEN_WITH_AUTH_SCHEME:Re.ACCESS_TOKEN,s={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:a,clientId:t,realm:o.tenantId,target:r.printScopesLowerCase(),tokenType:i,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},c=this.getCredentialsFilteredBy(s),l=Object.keys(c.accessTokens).map(function(p){return c.accessTokens[p]}),u=l.length;if(u<1)return null;if(u>1)throw W.createMultipleMatchingTokensInCacheError();return l[0]},e.prototype.readRefreshTokenFromCache=function(t,o,n){var r=n?ou:void 0,i={homeAccountId:o.homeAccountId,environment:o.environment,credentialType:Re.REFRESH_TOKEN,clientId:t,familyId:r},a=this.getCredentialsFilteredBy(i),s=Object.keys(a.refreshTokens).map(function(l){return a.refreshTokens[l]}),c=s.length;return c<1?null:s[0]},e.prototype.readAppMetadataFromCache=function(t,o){var n={environment:t,clientId:o},r=this.getAppMetadataFilteredBy(n),i=Object.keys(r).map(function(s){return r[s]}),a=i.length;if(a<1)return null;if(a>1)throw W.createMultipleMatchingAppMetadataInCacheError();return i[0]},e.prototype.isAppMetadataFOCI=function(t,o){var n=this.readAppMetadataFromCache(t,o);return!!(n&&n.familyId===ou)},e.prototype.matchHomeAccountId=function(t,o){return!!(t.homeAccountId&&o===t.homeAccountId)},e.prototype.matchUserAssertionHash=function(t,o){return!!(t.userAssertionHash&&o===t.userAssertionHash)},e.prototype.matchEnvironment=function(t,o){var n=this.getAuthorityMetadataByAlias(o);return!!(n&&n.aliases.indexOf(t.environment)>-1)},e.prototype.matchCredentialType=function(t,o){return t.credentialType&&o.toLowerCase()===t.credentialType.toLowerCase()},e.prototype.matchClientId=function(t,o){return!!(t.clientId&&o===t.clientId)},e.prototype.matchFamilyId=function(t,o){return!!(t.familyId&&o===t.familyId)},e.prototype.matchRealm=function(t,o){return!!(t.realm&&o===t.realm)},e.prototype.matchTarget=function(t,o){var n=t.credentialType!==Re.ACCESS_TOKEN&&t.credentialType!==Re.ACCESS_TOKEN_WITH_AUTH_SCHEME;if(n||!t.target)return!1;var r=no.fromString(t.target),i=no.fromString(o);return i.containsOnlyOIDCScopes()?i.removeScope(T.OFFLINE_ACCESS_SCOPE):i.removeOIDCScopes(),r.containsScopeSet(i)},e.prototype.matchTokenType=function(t,o){return!!(t.tokenType&&t.tokenType===o)},e.prototype.matchKeyId=function(t,o){return!!(t.keyId&&t.keyId===o)},e.prototype.isAppMetadata=function(t){return t.indexOf(qp)!==-1},e.prototype.isAuthorityMetadata=function(t){return t.indexOf(fc.CACHE_KEY)!==-1},e.prototype.generateAuthorityMetadataCacheKey=function(t){return fc.CACHE_KEY+"-"+this.clientId+"-"+t},e.prototype.getSpecificCredential=function(t,o){switch(o){case Re.ID_TOKEN:return this.getIdTokenCredential(t);case Re.ACCESS_TOKEN:case Re.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(t);case Re.REFRESH_TOKEN:return this.getRefreshTokenCredential(t);default:return null}},e.toObject=function(t,o){for(var n in o)t[n]=o[n];return t},e}(),hT=function(e){mt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.setAccount=function(){var o="Storage interface - setAccount() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getAccount=function(){var o="Storage interface - getAccount() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setIdTokenCredential=function(){var o="Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getIdTokenCredential=function(){var o="Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setAccessTokenCredential=function(){var o="Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getAccessTokenCredential=function(){var o="Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setRefreshTokenCredential=function(){var o="Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getRefreshTokenCredential=function(){var o="Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setAppMetadata=function(){var o="Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getAppMetadata=function(){var o="Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setServerTelemetry=function(){var o="Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getServerTelemetry=function(){var o="Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setAuthorityMetadata=function(){var o="Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getAuthorityMetadata=function(){var o="Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getAuthorityMetadataKeys=function(){var o="Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.setThrottlingCache=function(){var o="Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getThrottlingCache=function(){var o="Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.removeItem=function(){var o="Storage interface - removeItem() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.containsKey=function(){var o="Storage interface - containsKey() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.getKeys=function(){var o="Storage interface - getKeys() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t.prototype.clear=function(){return pe(this,void 0,void 0,function(){var o;return me(this,function(n){throw o="Storage interface - clear() has not been implemented for the cacheStorage interface.",Z.createUnexpectedError(o)})})},t.prototype.updateCredentialCacheKey=function(){var o="Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.";throw Z.createUnexpectedError(o)},t}(cn);var y6=300,Hh={tokenRenewalOffsetSeconds:y6,preventCorsPreflight:!1,proxyUrl:T.EMPTY_STRING},T6={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:vt.Info,correlationId:T.EMPTY_STRING},S6={sendGetRequestAsync:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Network interface - sendGetRequestAsync() has not been implemented",Z.createUnexpectedError(e)})})},sendPostRequestAsync:function(){return pe(this,void 0,void 0,function(){var e;return me(this,function(t){throw e="Network interface - sendPostRequestAsync() has not been implemented",Z.createUnexpectedError(e)})})}},E6={sku:T.SKU,version:Fh,cpu:T.EMPTY_STRING,os:T.EMPTY_STRING},w6={clientSecret:T.EMPTY_STRING,clientAssertion:void 0},C6={azureCloudInstance:ri.None,tenant:""+T.DEFAULT_COMMON_TENANT},k6={application:{appName:"",appVersion:""}};function LU(e){var t=e.authOptions,o=e.systemOptions,n=e.loggerOptions,r=e.storageInterface,i=e.networkInterface,a=e.cryptoInterface,s=e.clientCredentials,c=e.libraryInfo,l=e.telemetry,u=e.serverTelemetryManager,p=e.persistencePlugin,m=e.serializableCache,f=pt(pt({},T6),n);return{authOptions:A6(t),systemOptions:pt(pt({},Hh),o),loggerOptions:f,storageInterface:r||new hT(t.clientId,Ia),networkInterface:i||S6,cryptoInterface:a||Ia,clientCredentials:s||w6,libraryInfo:pt(pt({},E6),c),telemetry:pt(pt({},k6),l),serverTelemetryManager:u||null,persistencePlugin:p||null,serializableCache:m||null}}function A6(e){return pt({clientCapabilities:[],azureCloudOptions:C6,skipAuthorityMetadataCache:!1},e)}var Ko=function(e){mt(t,e);function t(o,n,r){var i=e.call(this,o,n,r)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return t}(Z);var Ra=function(){function e(){}return e.generateThrottlingStorageKey=function(t){return Aa.THROTTLING_PREFIX+"."+JSON.stringify(t)},e.preProcess=function(t,o){var n,r=e.generateThrottlingStorageKey(o),i=t.getThrottlingCache(r);if(i){if(i.throttleTime<Date.now()){t.removeItem(r,ni.THROTTLING);return}throw new Ko(((n=i.errorCodes)===null||n===void 0?void 0:n.join(" "))||T.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,o,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var r={throttleTime:e.calculateThrottleTime(parseInt(n.headers[Kn.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(o),r)}},e.checkResponseStatus=function(t){return t.status===429||t.status>=500&&t.status<600},e.checkResponseForRetryAfter=function(t){return t.headers?t.headers.hasOwnProperty(Kn.RETRY_AFTER)&&(t.status<200||t.status>=300):!1},e.calculateThrottleTime=function(t){var o=t<=0?0:t,n=Date.now()/1e3;return Math.floor(Math.min(n+(o||Aa.DEFAULT_THROTTLE_TIME_SECONDS),n+Aa.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)},e.removeThrottle=function(t,o,n,r){var i={clientId:o,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:r,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(i);return t.removeItem(a,ni.THROTTLING)},e}();var MU=function(){function e(t,o){this.networkClient=t,this.cacheManager=o}return e.prototype.sendPostRequest=function(t,o,n){return pe(this,void 0,void 0,function(){var r,i;return me(this,function(a){switch(a.label){case 0:Ra.preProcess(this.cacheManager,t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(o,n)];case 2:return r=a.sent(),[3,4];case 3:throw i=a.sent(),i instanceof Z?i:W.createNetworkError(o,i);case 4:return Ra.postProcess(this.cacheManager,t,r),[2,r]}})})},e}();var _o;(function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"})(_o||(_o={}));var ru=function(){function e(t){this.config=LU(t),this.logger=new nu(this.config.loggerOptions,DU,Fh),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new MU(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(t){var o={};if(o[Kn.CONTENT_TYPE]=T.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case _o.HOME_ACCOUNT_ID:try{var n=Pa(t.credential);o[Kn.CCS_HEADER]="Oid:"+n.uid+"@"+n.utid}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case _o.UPN:o[Kn.CCS_HEADER]="UPN: "+t.credential;break}return o},e.prototype.executePostToTokenEndpoint=function(t,o,n,r){return pe(this,void 0,void 0,function(){var i;return me(this,function(a){switch(a.label){case 0:return[4,this.networkManager.sendPostRequest(r,t,{body:o,headers:n,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return i=a.sent(),this.config.serverTelemetryManager&&i.status<500&&i.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,i]}})})},e.prototype.updateAuthority=function(t){if(!t.discoveryComplete())throw W.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=t},e}();var Fi=function(){function e(){}return e.validateRedirectUri=function(t){if(z.isEmpty(t))throw Ke.createRedirectUriEmptyError()},e.validatePrompt=function(t){var o=[];for(var n in Lt)o.push(Lt[n]);if(o.indexOf(t)<0)throw Ke.createInvalidPromptError(t)},e.validateClaims=function(t){try{JSON.parse(t)}catch{throw Ke.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(t,o){if(z.isEmpty(t)||z.isEmpty(o))throw Ke.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(o)},e.validateCodeChallengeMethod=function(t){if([fT.PLAIN,fT.S256].indexOf(t)<0)throw Ke.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(t,o){return t?(o.forEach(function(n,r){t[r]&&delete t[r]}),t):{}},e}();var Na=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(Ce.RESPONSE_TYPE,encodeURIComponent(T.CODE_RESPONSE_TYPE))},e.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Ce.RESPONSE_TYPE,encodeURIComponent(T.TOKEN_RESPONSE_TYPE+" "+T.ID_TOKEN_RESPONSE_TYPE))},e.prototype.addResponseMode=function(t){this.parameters.set(Ce.RESPONSE_MODE,encodeURIComponent(t||pc.QUERY))},e.prototype.addNativeBroker=function(){this.parameters.set(Ce.NATIVE_BROKER,encodeURIComponent("1"))},e.prototype.addScopes=function(t,o){o===void 0&&(o=!0);var n=o?Ca(t||[],Ar):t||[],r=new no(n);this.parameters.set(Ce.SCOPE,encodeURIComponent(r.printScopes()))},e.prototype.addClientId=function(t){this.parameters.set(Ce.CLIENT_ID,encodeURIComponent(t))},e.prototype.addRedirectUri=function(t){Fi.validateRedirectUri(t),this.parameters.set(Ce.REDIRECT_URI,encodeURIComponent(t))},e.prototype.addPostLogoutRedirectUri=function(t){Fi.validateRedirectUri(t),this.parameters.set(Ce.POST_LOGOUT_URI,encodeURIComponent(t))},e.prototype.addIdTokenHint=function(t){this.parameters.set(Ce.ID_TOKEN_HINT,encodeURIComponent(t))},e.prototype.addDomainHint=function(t){this.parameters.set(eu.DOMAIN_HINT,encodeURIComponent(t))},e.prototype.addLoginHint=function(t){this.parameters.set(eu.LOGIN_HINT,encodeURIComponent(t))},e.prototype.addCcsUpn=function(t){this.parameters.set(Kn.CCS_HEADER,encodeURIComponent("UPN:"+t))},e.prototype.addCcsOid=function(t){this.parameters.set(Kn.CCS_HEADER,encodeURIComponent("Oid:"+t.uid+"@"+t.utid))},e.prototype.addSid=function(t){this.parameters.set(eu.SID,encodeURIComponent(t))},e.prototype.addClaims=function(t,o){var n=this.addClientCapabilitiesToClaims(t,o);Fi.validateClaims(n),this.parameters.set(Ce.CLAIMS,encodeURIComponent(n))},e.prototype.addCorrelationId=function(t){this.parameters.set(Ce.CLIENT_REQUEST_ID,encodeURIComponent(t))},e.prototype.addLibraryInfo=function(t){this.parameters.set(Ce.X_CLIENT_SKU,t.sku),this.parameters.set(Ce.X_CLIENT_VER,t.version),t.os&&this.parameters.set(Ce.X_CLIENT_OS,t.os),t.cpu&&this.parameters.set(Ce.X_CLIENT_CPU,t.cpu)},e.prototype.addApplicationTelemetry=function(t){t?.appName&&this.parameters.set(Ce.X_APP_NAME,t.appName),t?.appVersion&&this.parameters.set(Ce.X_APP_VER,t.appVersion)},e.prototype.addPrompt=function(t){Fi.validatePrompt(t),this.parameters.set(""+Ce.PROMPT,encodeURIComponent(t))},e.prototype.addState=function(t){z.isEmpty(t)||this.parameters.set(Ce.STATE,encodeURIComponent(t))},e.prototype.addNonce=function(t){this.parameters.set(Ce.NONCE,encodeURIComponent(t))},e.prototype.addCodeChallengeParams=function(t,o){if(Fi.validateCodeChallengeParams(t,o),t&&o)this.parameters.set(Ce.CODE_CHALLENGE,encodeURIComponent(t)),this.parameters.set(Ce.CODE_CHALLENGE_METHOD,encodeURIComponent(o));else throw Ke.createInvalidCodeChallengeParamsError()},e.prototype.addAuthorizationCode=function(t){this.parameters.set(Ce.CODE,encodeURIComponent(t))},e.prototype.addDeviceCode=function(t){this.parameters.set(Ce.DEVICE_CODE,encodeURIComponent(t))},e.prototype.addRefreshToken=function(t){this.parameters.set(Ce.REFRESH_TOKEN,encodeURIComponent(t))},e.prototype.addCodeVerifier=function(t){this.parameters.set(Ce.CODE_VERIFIER,encodeURIComponent(t))},e.prototype.addClientSecret=function(t){this.parameters.set(Ce.CLIENT_SECRET,encodeURIComponent(t))},e.prototype.addClientAssertion=function(t){z.isEmpty(t)||this.parameters.set(Ce.CLIENT_ASSERTION,encodeURIComponent(t))},e.prototype.addClientAssertionType=function(t){z.isEmpty(t)||this.parameters.set(Ce.CLIENT_ASSERTION_TYPE,encodeURIComponent(t))},e.prototype.addOboAssertion=function(t){this.parameters.set(Ce.OBO_ASSERTION,encodeURIComponent(t))},e.prototype.addRequestTokenUse=function(t){this.parameters.set(Ce.REQUESTED_TOKEN_USE,encodeURIComponent(t))},e.prototype.addGrantType=function(t){this.parameters.set(Ce.GRANT_TYPE,encodeURIComponent(t))},e.prototype.addClientInfo=function(){this.parameters.set(NU,"1")},e.prototype.addExtraQueryParameters=function(t){var o=this;Fi.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(n){o.parameters.set(n,t[n])})},e.prototype.addClientCapabilitiesToClaims=function(t,o){var n;if(!t)n={};else try{n=JSON.parse(t)}catch{throw Ke.createInvalidClaimsRequestError()}return o&&o.length>0&&(n.hasOwnProperty(dc.ACCESS_TOKEN)||(n[dc.ACCESS_TOKEN]={}),n[dc.ACCESS_TOKEN][dc.XMS_CC]={values:o}),JSON.stringify(n)},e.prototype.addUsername=function(t){this.parameters.set(Hp.username,encodeURIComponent(t))},e.prototype.addPassword=function(t){this.parameters.set(Hp.password,encodeURIComponent(t))},e.prototype.addPopToken=function(t){z.isEmpty(t)||(this.parameters.set(Ce.TOKEN_TYPE,Fe.POP),this.parameters.set(Ce.REQ_CNF,encodeURIComponent(t)))},e.prototype.addSshJwk=function(t){z.isEmpty(t)||(this.parameters.set(Ce.TOKEN_TYPE,Fe.SSH),this.parameters.set(Ce.REQ_CNF,encodeURIComponent(t)))},e.prototype.addServerTelemetry=function(t){this.parameters.set(Ce.X_CLIENT_CURR_TELEM,t.generateCurrentRequestHeaderValue()),this.parameters.set(Ce.X_CLIENT_LAST_TELEM,t.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(Ce.X_MS_LIB_CAPABILITY,Aa.X_MS_LIB_CAPABILITY_VALUE)},e.prototype.addLogoutHint=function(t){this.parameters.set(Ce.LOGOUT_HINT,encodeURIComponent(t))},e.prototype.createQueryString=function(){var t=new Array;return this.parameters.forEach(function(o,n){t.push(n+"="+o)}),t.join("&")},e}();var Da=function(e){mt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.createIdTokenEntity=function(o,n,r,i,a){var s=new t;return s.credentialType=Re.ID_TOKEN,s.homeAccountId=o,s.environment=n,s.clientId=i,s.secret=r,s.realm=a,s},t.isIdTokenEntity=function(o){return o?o.hasOwnProperty("homeAccountId")&&o.hasOwnProperty("environment")&&o.hasOwnProperty("credentialType")&&o.hasOwnProperty("realm")&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("secret")&&o.credentialType===Re.ID_TOKEN:!1},t}(zi);var Yt=function(){function e(){}return e.nowSeconds=function(){return Math.round(new Date().getTime()/1e3)},e.isTokenExpired=function(t,o){var n=Number(t)||0,r=e.nowSeconds()+o;return r>n},e.wasClockTurnedBack=function(t){var o=Number(t);return o>e.nowSeconds()},e.delay=function(t,o){return new Promise(function(n){return setTimeout(function(){return n(o)},t)})},e}();var La=function(e){mt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.createAccessTokenEntity=function(o,n,r,i,a,s,c,l,u,p,m,f,h,_,g){var v,x,E=new t;E.homeAccountId=o,E.credentialType=Re.ACCESS_TOKEN,E.secret=r;var O=Yt.nowSeconds();if(E.cachedAt=O.toString(),E.expiresOn=c.toString(),E.extendedExpiresOn=l.toString(),p&&(E.refreshOn=p.toString()),E.environment=n,E.clientId=i,E.realm=a,E.target=s,E.userAssertionHash=f,E.tokenType=z.isEmpty(m)?Fe.BEARER:m,_&&(E.requestedClaims=_,E.requestedClaimsHash=g),((v=E.tokenType)===null||v===void 0?void 0:v.toLowerCase())!==Fe.BEARER.toLowerCase())switch(E.credentialType=Re.ACCESS_TOKEN_WITH_AUTH_SCHEME,E.tokenType){case Fe.POP:var k=Ro.extractTokenClaims(r,u);if(!(!((x=k?.cnf)===null||x===void 0)&&x.kid))throw W.createTokenClaimsRequiredError();E.keyId=k.cnf.kid;break;case Fe.SSH:E.keyId=h}return E},t.isAccessTokenEntity=function(o){return o?o.hasOwnProperty("homeAccountId")&&o.hasOwnProperty("environment")&&o.hasOwnProperty("credentialType")&&o.hasOwnProperty("realm")&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("secret")&&o.hasOwnProperty("target")&&(o.credentialType===Re.ACCESS_TOKEN||o.credentialType===Re.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1},t}(zi);var iu=function(e){mt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.createRefreshTokenEntity=function(o,n,r,i,a,s){var c=new t;return c.clientId=i,c.credentialType=Re.REFRESH_TOKEN,c.environment=n,c.homeAccountId=o,c.secret=r,c.userAssertionHash=s,a&&(c.familyId=a),c},t.isRefreshTokenEntity=function(o){return o?o.hasOwnProperty("homeAccountId")&&o.hasOwnProperty("environment")&&o.hasOwnProperty("credentialType")&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("secret")&&o.credentialType===Re.REFRESH_TOKEN:!1},t}(zi);var OU=["interaction_required","consent_required","login_required"],I6=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Ma={noTokensFoundError:{code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},native_account_unavailable:{code:"native_account_unavailable",desc:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API."}},Gt=function(e){mt(t,e);function t(o,n,r){var i=e.call(this,o,n,r)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return t.isInteractionRequiredError=function(o,n,r){var i=!!o&&OU.indexOf(o)>-1,a=!!r&&I6.indexOf(r)>-1,s=!!n&&OU.some(function(c){return n.indexOf(c)>-1});return i||s||a},t.createNoTokensFoundError=function(){return new t(Ma.noTokensFoundError.code,Ma.noTokensFoundError.desc)},t.createNativeAccountUnavailableError=function(){return new t(Ma.native_account_unavailable.code,Ma.native_account_unavailable.desc)},t}(Z);var UU=function(){function e(t,o,n,r,i){this.account=t||null,this.idToken=o||null,this.accessToken=n||null,this.refreshToken=r||null,this.appMetadata=i||null}return e}();var No=function(){function e(){}return e.setRequestState=function(t,o,n){var r=e.generateLibraryState(t,n);return z.isEmpty(o)?r:""+r+T.RESOURCE_DELIM+o},e.generateLibraryState=function(t,o){if(!t)throw W.createNoCryptoObjectError("generateLibraryState");var n={id:t.createNewGuid()};o&&(n.meta=o);var r=JSON.stringify(n);return t.base64Encode(r)},e.parseRequestState=function(t,o){if(!t)throw W.createNoCryptoObjectError("parseRequestState");if(z.isEmpty(o))throw W.createInvalidStateError(o,"Null, undefined or empty state");try{var n=o.split(T.RESOURCE_DELIM),r=n[0],i=n.length>1?n.slice(1).join(T.RESOURCE_DELIM):T.EMPTY_STRING,a=t.base64Decode(r),s=JSON.parse(a);return{userRequestState:z.isEmpty(i)?T.EMPTY_STRING:i,libraryState:s}}catch(c){throw W.createInvalidStateError(o,c)}},e}();var Ee=function(){function e(t){if(this._urlString=t,z.isEmpty(this._urlString))throw Ke.createUrlEmptyError();z.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(t){if(t){var o=t.toLowerCase();return z.endsWith(o,"?")?o=o.slice(0,-1):z.endsWith(o,"?/")&&(o=o.slice(0,-2)),z.endsWith(o,"/")||(o+="/"),o}return t},e.prototype.validateAsUri=function(){var t;try{t=this.getUrlComponents()}catch(o){throw Ke.createUrlParseError(o)}if(!t.HostNameAndPort||!t.PathSegments)throw Ke.createUrlParseError("Given url string: "+this.urlString);if(!t.Protocol||t.Protocol.toLowerCase()!=="https:")throw Ke.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(t,o){return z.isEmpty(o)?t:t.indexOf("?")<0?t+"?"+o:t+"&"+o},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var o=this.getUrlComponents(),n=o.PathSegments;return t&&n.length!==0&&(n[0]===Fp.COMMON||n[0]===Fp.ORGANIZATIONS)&&(n[0]=t),e.constructAuthorityUriFromObject(o)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),o=this.urlString.match(t);if(!o)throw Ke.createUrlParseError("Given url string: "+this.urlString);var n={Protocol:o[1],HostNameAndPort:o[4],AbsolutePath:o[5],QueryString:o[7]},r=n.AbsolutePath.split("/");return r=r.filter(function(i){return i&&i.length>0}),n.PathSegments=r,!z.isEmpty(n.QueryString)&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n},e.getDomainFromUrl=function(t){var o=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=t.match(o);if(!n)throw Ke.createUrlParseError("Given url string: "+t);return n[2]},e.getAbsoluteUrl=function(t,o){if(t[0]===T.FORWARD_SLASH){var n=new e(o),r=n.getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+t}return t},e.parseHash=function(t){var o=t.indexOf("#"),n=t.indexOf("#/");return n>-1?t.substring(n+2):o>-1?t.substring(o+1):T.EMPTY_STRING},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(z.isEmpty(t))return{};var o=e.parseHash(t),n=z.queryStringToObject(z.isEmpty(o)?t:o);if(!n)throw W.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(z.isEmpty(t)||t.indexOf("=")<0)return!1;var o=e.getDeserializedHash(t);return!!(o.code||o.error_description||o.error||o.state)},e}();var _T;(function(e){e.SW="sw",e.UHW="uhw"})(_T||(_T={}));var Ir=function(){function e(t){this.cryptoUtils=t}return e.prototype.generateCnf=function(t){return pe(this,void 0,void 0,function(){var o,n,r;return me(this,function(i){switch(i.label){case 0:return[4,this.generateKid(t)];case 1:return o=i.sent(),n=this.cryptoUtils.base64Encode(JSON.stringify(o)),r={kid:o.kid,reqCnfString:n},[4,this.cryptoUtils.hashString(n)];case 2:return[2,(r.reqCnfHash=i.sent(),r)]}})})},e.prototype.generateKid=function(t){return pe(this,void 0,void 0,function(){var o;return me(this,function(n){switch(n.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(t)];case 1:return o=n.sent(),[2,{kid:o,xms_ksl:_T.SW}]}})})},e.prototype.signPopToken=function(t,o,n){return pe(this,void 0,void 0,function(){return me(this,function(r){return[2,this.signPayload(t,o,n)]})})},e.prototype.signPayload=function(t,o,n,r){return pe(this,void 0,void 0,function(){var i,a,s,c,l,u;return me(this,function(p){switch(p.label){case 0:return i=n.resourceRequestMethod,a=n.resourceRequestUri,s=n.shrClaims,c=n.shrNonce,l=a?new Ee(a):void 0,u=l?.getUrlComponents(),[4,this.cryptoUtils.signJwt(pt({at:t,ts:Yt.nowSeconds(),m:i?.toUpperCase(),u:u?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0},r),o,n.correlationId)];case 1:return[2,p.sent()]}})})},e}();var au=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(t,o){var n=[qp,t,o];return n.join(to.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,o,n){var r=new e;return r.clientId=t,r.environment=o,n&&(r.familyId=n),r},e.isAppMetadataEntity=function(t,o){return o?t.indexOf(qp)===0&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"):!1},e}();var $U=function(){function e(t,o){this.cache=t,this.hasChanged=o}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}();var hc=function(){function e(t,o,n,r,i,a){this.clientId=t,this.cacheStorage=o,this.cryptoObj=n,this.logger=r,this.serializableCache=i,this.persistencePlugin=a}return e.prototype.validateServerAuthorizationCodeResponse=function(t,o,n){if(!t.state||!o)throw t.state?W.createStateNotFoundError("Cached State"):W.createStateNotFoundError("Server State");if(decodeURIComponent(t.state)!==decodeURIComponent(o))throw W.createStateMismatchError();if(t.error||t.error_description||t.suberror)throw Gt.isInteractionRequiredError(t.error,t.error_description,t.suberror)?new Gt(t.error||T.EMPTY_STRING,t.error_description,t.suberror):new Ko(t.error||T.EMPTY_STRING,t.error_description,t.suberror);t.client_info&&gc(t.client_info,n)},e.prototype.validateTokenResponse=function(t){if(t.error||t.error_description||t.suberror){if(Gt.isInteractionRequiredError(t.error,t.error_description,t.suberror))throw new Gt(t.error,t.error_description,t.suberror);var o=t.error_codes+" - ["+t.timestamp+"]: "+t.error_description+" - Correlation ID: "+t.correlation_id+" - Trace ID: "+t.trace_id;throw new Ko(t.error,o,t.suberror)}},e.prototype.handleServerTokenResponse=function(t,o,n,r,i,a,s){return pe(this,void 0,void 0,function(){var c,l,u,p,m,f;return me(this,function(h){switch(h.label){case 0:if(t.id_token&&(c=new Ro(t.id_token||T.EMPTY_STRING,this.cryptoObj),i&&!z.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw W.createNonceMismatchError();this.homeAccountIdentifier=Tt.generateHomeAccountId(t.client_info||T.EMPTY_STRING,o.authorityType,this.logger,this.cryptoObj,c),!!i&&!!i.state&&(l=No.parseRequestState(this.cryptoObj,i.state)),t.key_id=t.key_id||r.sshKid||void 0,u=this.generateCacheRecord(t,o,n,r,c,a,i),h.label=1;case 1:return h.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new $U(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(p)]):[3,3];case 2:h.sent(),h.label=3;case 3:return s&&u.account&&(m=u.account.generateAccountKey(),f=this.cacheStorage.getAccount(m),!f)?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,o,u,!1,r,c,l)]):[4,this.cacheStorage.saveCacheRecord(u)];case 4:return h.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&p?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(p)]):[3,7];case 6:h.sent(),h.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,o,u,!1,r,c,l,t.spa_code)]}})})},e.prototype.generateCacheRecord=function(t,o,n,r,i,a,s){var c=o.getPreferredCache();if(z.isEmpty(c))throw W.createInvalidCacheEnvironmentError();var l,u;!z.isEmpty(t.id_token)&&!!i&&(l=Da.createIdTokenEntity(this.homeAccountIdentifier,c,t.id_token||T.EMPTY_STRING,this.clientId,i.claims.tid||T.EMPTY_STRING),u=this.generateAccountEntity(t,i,o,s));var p=null;if(!z.isEmpty(t.access_token)){var m=t.scope?no.fromString(t.scope):new no(r.scopes||[]),f=(typeof t.expires_in=="string"?parseInt(t.expires_in,10):t.expires_in)||0,h=(typeof t.ext_expires_in=="string"?parseInt(t.ext_expires_in,10):t.ext_expires_in)||0,_=(typeof t.refresh_in=="string"?parseInt(t.refresh_in,10):t.refresh_in)||void 0,g=n+f,v=g+h,x=_&&_>0?n+_:void 0;p=La.createAccessTokenEntity(this.homeAccountIdentifier,c,t.access_token||T.EMPTY_STRING,this.clientId,i?i.claims.tid||T.EMPTY_STRING:o.tenant,m.printScopes(),g,v,this.cryptoObj,x,t.token_type,a,t.key_id,r.claims,r.requestedClaimsHash)}var E=null;z.isEmpty(t.refresh_token)||(E=iu.createRefreshTokenEntity(this.homeAccountIdentifier,c,t.refresh_token||T.EMPTY_STRING,this.clientId,t.foci,a));var O=null;return z.isEmpty(t.foci)||(O=au.createAppMetadataEntity(this.clientId,c,t.foci)),new UU(u,l,p,E,O)},e.prototype.generateAccountEntity=function(t,o,n,r){var i=n.authorityType,a=r?r.cloud_graph_host_name:T.EMPTY_STRING,s=r?r.msgraph_host:T.EMPTY_STRING;if(i===sn.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Tt.createGenericAccount(this.homeAccountIdentifier,o,n,a,s);if(z.isEmpty(t.client_info)&&n.protocolMode==="AAD")throw W.createClientInfoEmptyError();return t.client_info?Tt.createAccount(t.client_info,this.homeAccountIdentifier,o,n,a,s):Tt.createGenericAccount(this.homeAccountIdentifier,o,n,a,s)},e.generateAuthenticationResult=function(t,o,n,r,i,a,s,c){var l,u,p;return pe(this,void 0,void 0,function(){var m,f,h,_,g,v,x,E,O,k,P;return me(this,function(Te){switch(Te.label){case 0:if(m=T.EMPTY_STRING,f=[],h=null,g=T.EMPTY_STRING,!n.accessToken)return[3,4];if(n.accessToken.tokenType!==Fe.POP)return[3,2];if(v=new Ir(t),x=n.accessToken,E=x.secret,O=x.keyId,!O)throw W.createKeyIdMissingError();return[4,v.signPopToken(E,O,i)];case 1:return m=Te.sent(),[3,3];case 2:m=n.accessToken.secret,Te.label=3;case 3:f=no.fromString(n.accessToken.target).asArray(),h=new Date(Number(n.accessToken.expiresOn)*1e3),_=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),Te.label=4;case 4:return n.appMetadata&&(g=n.appMetadata.familyId===ou?ou:T.EMPTY_STRING),k=a?.claims.oid||a?.claims.sub||T.EMPTY_STRING,P=a?.claims.tid||T.EMPTY_STRING,[2,{authority:o.canonicalAuthority,uniqueId:k,tenantId:P,scopes:f,account:n.account?n.account.getAccountInfo():null,idToken:a?a.rawToken:T.EMPTY_STRING,idTokenClaims:a?a.claims:{},accessToken:m,fromCache:r,expiresOn:h,correlationId:i.correlationId,extExpiresOn:_,familyId:g,tokenType:((l=n.accessToken)===null||l===void 0?void 0:l.tokenType)||T.EMPTY_STRING,state:s?s.userRequestState:T.EMPTY_STRING,cloudGraphHostName:((u=n.account)===null||u===void 0?void 0:u.cloudGraphHostName)||T.EMPTY_STRING,msGraphHost:((p=n.account)===null||p===void 0?void 0:p.msGraphHost)||T.EMPTY_STRING,code:c,fromNativeBroker:!1}]}})})},e}();var Bp=function(e){mt(t,e);function t(o){var n=e.call(this,o)||this;return n.includeRedirectUri=!0,n}return t.prototype.getAuthCodeUrl=function(o){return pe(this,void 0,void 0,function(){var n;return me(this,function(r){switch(r.label){case 0:return[4,this.createAuthCodeUrlQueryString(o)];case 1:return n=r.sent(),[2,Ee.appendQueryString(this.authority.authorizationEndpoint,n)]}})})},t.prototype.acquireToken=function(o,n){return pe(this,void 0,void 0,function(){var r,i,a;return me(this,function(s){switch(s.label){case 0:if(this.logger.info("in acquireToken call"),!o||z.isEmpty(o.code))throw W.createTokenRequestCannotBeMadeError();return r=Yt.nowSeconds(),[4,this.executeTokenRequest(this.authority,o)];case 1:return i=s.sent(),a=new hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),a.validateTokenResponse(i.body),[4,a.handleServerTokenResponse(i.body,this.authority,r,o,n)];case 2:return[2,s.sent()]}})})},t.prototype.handleFragmentResponse=function(o,n){var r=new hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),i=new Ee(o),a=Ee.getDeserializedHash(i.getHash());if(r.validateServerAuthorizationCodeResponse(a,n,this.cryptoUtils),!a.code)throw W.createNoAuthCodeInServerResponseError();return pt(pt({},a),{code:a.code})},t.prototype.getLogoutUri=function(o){if(!o)throw Ke.createEmptyLogoutRequestError();var n=this.createLogoutUrlQueryString(o);return Ee.appendQueryString(this.authority.endSessionEndpoint,n)},t.prototype.executeTokenRequest=function(o,n){return pe(this,void 0,void 0,function(){var r,i,a,s,c,l,u;return me(this,function(p){switch(p.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},[4,this.createTokenRequestBody(n)];case 1:if(i=p.sent(),a=this.createTokenQueryParameters(n),s=void 0,n.clientInfo)try{c=gc(n.clientInfo,this.cryptoUtils),s={credential:""+c.uid+to.CLIENT_INFO_SEPARATOR+c.utid,type:_o.HOME_ACCOUNT_ID}}catch(m){this.logger.verbose("Could not parse client info for CCS Header: "+m)}return l=this.createTokenRequestHeaders(s||n.ccsCredential),u=z.isEmpty(a)?o.tokenEndpoint:o.tokenEndpoint+"?"+a,[2,this.executePostToTokenEndpoint(u,i,l,r)]}})})},t.prototype.createTokenQueryParameters=function(o){var n=new Na;return o.tokenQueryParameters&&n.addExtraQueryParameters(o.tokenQueryParameters),n.createQueryString()},t.prototype.createTokenRequestBody=function(o){return pe(this,void 0,void 0,function(){var n,r,i,a,s,c,l,l,u;return me(this,function(p){switch(p.label){case 0:return n=new Na,n.addClientId(this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(o.redirectUri):Fi.validateRedirectUri(o.redirectUri),n.addScopes(o.scopes),n.addAuthorizationCode(o.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),o.codeVerifier&&n.addCodeVerifier(o.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,n.addClientAssertion(r.assertion),n.addClientAssertionType(r.assertionType)),n.addGrantType(tu.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),o.authenticationScheme!==Fe.POP?[3,2]:(i=new Ir(this.cryptoUtils),[4,i.generateCnf(o)]);case 1:return a=p.sent(),n.addPopToken(a.reqCnfString),[3,3];case 2:if(o.authenticationScheme===Fe.SSH)if(o.sshJwk)n.addSshJwk(o.sshJwk);else throw Ke.createMissingSshJwkError();p.label=3;case 3:if(s=o.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(s),(!z.isEmptyObj(o.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(o.claims,this.config.authOptions.clientCapabilities),c=void 0,o.clientInfo)try{l=gc(o.clientInfo,this.cryptoUtils),c={credential:""+l.uid+to.CLIENT_INFO_SEPARATOR+l.utid,type:_o.HOME_ACCOUNT_ID}}catch(m){this.logger.verbose("Could not parse client info for CCS Header: "+m)}else c=o.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&c)switch(c.type){case _o.HOME_ACCOUNT_ID:try{l=Pa(c.credential),n.addCcsOid(l)}catch(m){this.logger.verbose("Could not parse home account ID for CCS Header: "+m)}break;case _o.UPN:n.addCcsUpn(c.credential);break}return o.tokenBodyParameters&&n.addExtraQueryParameters(o.tokenBodyParameters),o.enableSpaAuthorizationCode&&(!o.tokenBodyParameters||!o.tokenBodyParameters[Ce.RETURN_SPA_CODE])&&n.addExtraQueryParameters((u={},u[Ce.RETURN_SPA_CODE]="1",u)),[2,n.createQueryString()]}})})},t.prototype.createAuthCodeUrlQueryString=function(o){return pe(this,void 0,void 0,function(){var n,r,i,a,s,s,c,l;return me(this,function(u){switch(u.label){case 0:if(n=new Na,n.addClientId(this.config.authOptions.clientId),r=Ca(o.scopes||[],o.extraScopesToConsent||[]),n.addScopes(r),n.addRedirectUri(o.redirectUri),i=o.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(i),n.addResponseMode(o.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),o.codeChallenge&&o.codeChallengeMethod&&n.addCodeChallengeParams(o.codeChallenge,o.codeChallengeMethod),o.prompt&&n.addPrompt(o.prompt),o.domainHint&&n.addDomainHint(o.domainHint),o.prompt!==Lt.SELECT_ACCOUNT)if(o.sid&&o.prompt===Lt.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(o.sid);else if(o.account){if(a=this.extractAccountSid(o.account),a&&o.prompt===Lt.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(a);try{s=Pa(o.account.homeAccountId),n.addCcsOid(s)}catch(p){this.logger.verbose("Could not parse home account ID for CCS Header: "+p)}}else if(o.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(o.loginHint),n.addCcsUpn(o.loginHint);else if(o.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(o.account.username);try{s=Pa(o.account.homeAccountId),n.addCcsOid(s)}catch(p){this.logger.verbose("Could not parse home account ID for CCS Header: "+p)}}}else o.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(o.loginHint),n.addCcsUpn(o.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return o.nonce&&n.addNonce(o.nonce),o.state&&n.addState(o.state),(!z.isEmpty(o.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(o.claims,this.config.authOptions.clientCapabilities),o.extraQueryParameters&&n.addExtraQueryParameters(o.extraQueryParameters),o.nativeBroker?(n.addNativeBroker(),o.authenticationScheme!==Fe.POP?[3,2]:(c=new Ir(this.cryptoUtils),[4,c.generateCnf(o)])):[3,2];case 1:l=u.sent(),n.addPopToken(l.reqCnfHash),u.label=2;case 2:return[2,n.createQueryString()]}})})},t.prototype.createLogoutUrlQueryString=function(o){var n=new Na;return o.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(o.postLogoutRedirectUri),o.correlationId&&n.addCorrelationId(o.correlationId),o.idTokenHint&&n.addIdTokenHint(o.idTokenHint),o.state&&n.addState(o.state),o.logoutHint&&n.addLogoutHint(o.logoutHint),o.extraQueryParameters&&n.addExtraQueryParameters(o.extraQueryParameters),n.createQueryString()},t.prototype.extractAccountSid=function(o){if(o.idTokenClaims){var n=o.idTokenClaims;return n.sid||null}return null},t}(ru);var Yp=function(e){mt(t,e);function t(o){return e.call(this,o)||this}return t.prototype.acquireToken=function(o){return pe(this,void 0,void 0,function(){var n,r,i;return me(this,function(a){switch(a.label){case 0:return n=Yt.nowSeconds(),[4,this.executeTokenRequest(o,this.authority)];case 1:return r=a.sent(),i=new hc(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin),i.validateTokenResponse(r.body),[2,i.handleServerTokenResponse(r.body,this.authority,n,o,void 0,void 0,!0)]}})})},t.prototype.acquireTokenByRefreshToken=function(o){return pe(this,void 0,void 0,function(){var n,r,i;return me(this,function(a){if(!o)throw Ke.createEmptyTokenRequestError();if(!o.account)throw W.createNoAccountInSilentRequestError();if(n=this.cacheManager.isAppMetadataFOCI(o.account.environment,this.config.authOptions.clientId),n)try{return[2,this.acquireTokenWithCachedRefreshToken(o,!0)]}catch(s){if(r=s instanceof Gt&&s.errorCode===Ma.noTokensFoundError.code,i=s instanceof Ko&&s.errorCode===gT.INVALID_GRANT_ERROR&&s.subError===gT.CLIENT_MISMATCH_ERROR,r||i)return[2,this.acquireTokenWithCachedRefreshToken(o,!1)];throw s}return[2,this.acquireTokenWithCachedRefreshToken(o,!1)]})})},t.prototype.acquireTokenWithCachedRefreshToken=function(o,n){return pe(this,void 0,void 0,function(){var r,i;return me(this,function(a){if(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,o.account,n),!r)throw Gt.createNoTokensFoundError();return i=pt(pt({},o),{refreshToken:r.secret,authenticationScheme:o.authenticationScheme||Fe.BEARER,ccsCredential:{credential:o.account.homeAccountId,type:_o.HOME_ACCOUNT_ID}}),[2,this.acquireToken(i)]})})},t.prototype.executeTokenRequest=function(o,n){return pe(this,void 0,void 0,function(){var r,i,a,s,c;return me(this,function(l){switch(l.label){case 0:return[4,this.createTokenRequestBody(o)];case 1:return r=l.sent(),i=this.createTokenQueryParameters(o),a=this.createTokenRequestHeaders(o.ccsCredential),s={clientId:this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:o.scopes,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},c=Ee.appendQueryString(n.tokenEndpoint,i),[2,this.executePostToTokenEndpoint(c,r,a,s)]}})})},t.prototype.createTokenQueryParameters=function(o){var n=new Na;return o.tokenQueryParameters&&n.addExtraQueryParameters(o.tokenQueryParameters),n.createQueryString()},t.prototype.createTokenRequestBody=function(o){return pe(this,void 0,void 0,function(){var n,r,i,a,s,c;return me(this,function(l){switch(l.label){case 0:return n=new Na,n.addClientId(this.config.authOptions.clientId),n.addScopes(o.scopes),n.addGrantType(tu.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&n.addServerTelemetry(this.serverTelemetryManager),r=o.correlationId||this.config.cryptoInterface.createNewGuid(),n.addCorrelationId(r),n.addRefreshToken(o.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(i=this.config.clientCredentials.clientAssertion,n.addClientAssertion(i.assertion),n.addClientAssertionType(i.assertionType)),o.authenticationScheme!==Fe.POP?[3,2]:(a=new Ir(this.cryptoUtils),[4,a.generateCnf(o)]);case 1:return s=l.sent(),n.addPopToken(s.reqCnfString),[3,3];case 2:if(o.authenticationScheme===Fe.SSH)if(o.sshJwk)n.addSshJwk(o.sshJwk);else throw Ke.createMissingSshJwkError();l.label=3;case 3:if((!z.isEmptyObj(o.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(o.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&o.ccsCredential)switch(o.ccsCredential.type){case _o.HOME_ACCOUNT_ID:try{c=Pa(o.ccsCredential.credential),n.addCcsOid(c)}catch(u){this.logger.verbose("Could not parse home account ID for CCS Header: "+u)}break;case _o.UPN:n.addCcsUpn(o.ccsCredential.credential);break}return[2,n.createQueryString()]}})})},t}(ru);var vT=function(e){mt(t,e);function t(o){return e.call(this,o)||this}return t.prototype.acquireToken=function(o){return pe(this,void 0,void 0,function(){var n,r;return me(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.acquireCachedToken(o)];case 1:return[2,i.sent()];case 2:if(n=i.sent(),n instanceof W&&n.errorCode===j.tokenRefreshRequired.code)return r=new Yp(this.config),[2,r.acquireTokenByRefreshToken(o)];throw n;case 3:return[2]}})})},t.prototype.acquireCachedToken=function(o){var n,r,i,a;return pe(this,void 0,void 0,function(){var s,c;return me(this,function(l){switch(l.label){case 0:if(!o)throw Ke.createEmptyTokenRequestError();if(o.forceRefresh)throw(n=this.serverTelemetryManager)===null||n===void 0||n.setCacheOutcome($i.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),W.createRefreshRequiredError();if(!o.account)throw W.createNoAccountInSilentRequestError();if(s=o.authority||this.authority.getPreferredCache(),c=this.cacheManager.readCacheRecord(o.account,this.config.authOptions.clientId,o,s),c.accessToken){if(Yt.wasClockTurnedBack(c.accessToken.cachedAt)||Yt.isTokenExpired(c.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw(i=this.serverTelemetryManager)===null||i===void 0||i.setCacheOutcome($i.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),W.createRefreshRequiredError();if(c.accessToken.refreshOn&&Yt.isTokenExpired(c.accessToken.refreshOn,0))throw(a=this.serverTelemetryManager)===null||a===void 0||a.setCacheOutcome($i.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),W.createRefreshRequiredError()}else throw(r=this.serverTelemetryManager)===null||r===void 0||r.setCacheOutcome($i.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),W.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(c,o)];case 1:return[2,l.sent()]}})})},t.prototype.generateResultFromCacheRecord=function(o,n){return pe(this,void 0,void 0,function(){var r;return me(this,function(i){switch(i.label){case 0:return o.idToken&&(r=new Ro(o.idToken.secret,this.config.cryptoInterface)),[4,hc.generateAuthenticationResult(this.cryptoUtils,this.authority,o,!0,n,r)];case 1:return[2,i.sent()]}})})},t}(ru);function zU(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}var FU={endpointMetadata:{"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},instanceDiscoveryMetadata:{"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}}},bT=FU.endpointMetadata,xT=FU.instanceDiscoveryMetadata;var Oa;(function(e){e.AAD="AAD",e.OIDC="OIDC"})(Oa||(Oa={}));var su=function(){function e(){this.expiresAt=Yt.nowSeconds()+fc.REFRESH_TIME_SECONDS}return e.prototype.updateCloudDiscoveryMetadata=function(t,o){this.aliases=t.aliases,this.preferred_cache=t.preferred_cache,this.preferred_network=t.preferred_network,this.aliasesFromNetwork=o},e.prototype.updateEndpointMetadata=function(t,o){this.authorization_endpoint=t.authorization_endpoint,this.token_endpoint=t.token_endpoint,this.end_session_endpoint=t.end_session_endpoint,this.issuer=t.issuer,this.endpointsFromNetwork=o,this.jwks_uri=t.jwks_uri},e.prototype.updateCanonicalAuthority=function(t){this.canonical_authority=t},e.prototype.resetExpiresAt=function(){this.expiresAt=Yt.nowSeconds()+fc.REFRESH_TIME_SECONDS},e.prototype.isExpired=function(){return this.expiresAt<=Yt.nowSeconds()},e.isAuthorityMetadataEntity=function(t,o){return o?t.indexOf(fc.CACHE_KEY)===0&&o.hasOwnProperty("aliases")&&o.hasOwnProperty("preferred_cache")&&o.hasOwnProperty("preferred_network")&&o.hasOwnProperty("canonical_authority")&&o.hasOwnProperty("authorization_endpoint")&&o.hasOwnProperty("token_endpoint")&&o.hasOwnProperty("issuer")&&o.hasOwnProperty("aliasesFromNetwork")&&o.hasOwnProperty("endpointsFromNetwork")&&o.hasOwnProperty("expiresAt")&&o.hasOwnProperty("jwks_uri"):!1},e}();function HU(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}var qU=function(){function e(t){this.networkInterface=t}return e.prototype.detectRegion=function(t,o,n){return pe(this,void 0,void 0,function(){var r,i,a,s,c;return me(this,function(l){switch(l.label){case 0:if(r=t,r)return[3,8];i=e.IMDS_OPTIONS,n&&(i.proxyUrl=n),l.label=1;case 1:return l.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(T.IMDS_VERSION,i)];case 2:return a=l.sent(),a.status===mc.httpSuccess&&(r=a.body,o.region_source=Ui.IMDS),a.status!==mc.httpBadRequest?[3,5]:[4,this.getCurrentVersion(i)];case 3:return s=l.sent(),s?[4,this.getRegionFromIMDS(s,i)]:(o.region_source=Ui.FAILED_AUTO_DETECTION,[2,null]);case 4:c=l.sent(),c.status===mc.httpSuccess&&(r=c.body,o.region_source=Ui.IMDS),l.label=5;case 5:return[3,7];case 6:return l.sent(),o.region_source=Ui.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:o.region_source=Ui.ENVIRONMENT_VARIABLE,l.label=9;case 9:return r||(o.region_source=Ui.FAILED_AUTO_DETECTION),[2,r||null]}})})},e.prototype.getRegionFromIMDS=function(t,o){return pe(this,void 0,void 0,function(){return me(this,function(n){return[2,this.networkInterface.sendGetRequestAsync(T.IMDS_ENDPOINT+"?api-version="+t+"&format=text",o,T.IMDS_TIMEOUT)]})})},e.prototype.getCurrentVersion=function(t){return pe(this,void 0,void 0,function(){var o;return me(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(T.IMDS_ENDPOINT+"?format=json",t)];case 1:return o=n.sent(),o.status===mc.httpBadRequest&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?[2,o.body["newest-versions"][0]]:[2,null];case 2:return n.sent(),[2,null];case 3:return[2]}})})},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}();var Ua=function(){function e(t,o,n,r,i){this.canonicalAuthority=t,this._canonicalAuthority.validateAsUri(),this.networkInterface=o,this.cacheManager=n,this.authorityOptions=r,this.regionDiscovery=new qU(o),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=i||T.EMPTY_STRING}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var t=this.canonicalAuthorityUrlComponents.PathSegments;return t.length&&t[0].toLowerCase()===T.ADFS?sn.Adfs:sn.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(t){this._canonicalAuthority=new Ee(t),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw W.createLogoutNotSupportedError();var t=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.issuer);return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"jwksUri",{get:function(){if(this.discoveryComplete()){var t=this.replacePath(this.metadata.jwks_uri);return this.replaceTenant(t)}else throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(t){return t.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(t){var o=t,n=new Ee(this.metadata.canonical_authority),r=n.getUrlComponents().PathSegments,i=this.canonicalAuthorityUrlComponents.PathSegments;return i.forEach(function(a,s){var c=r[s];a!==c&&(o=o.replace("/"+c+"/","/"+a+"/"))}),o},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===sn.Adfs||this.protocolMode===Oa.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return pe(this,void 0,void 0,function(){var t,o,n,r;return me(this,function(i){switch(i.label){case 0:return t=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort),t||(t=new su,t.updateCanonicalAuthority(this.canonicalAuthority)),[4,this.updateCloudDiscoveryMetadata(t)];case 1:return o=i.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,t.preferred_network),[4,this.updateEndpointMetadata(t)];case 2:return n=i.sent(),o!==In.CACHE&&n!==In.CACHE&&(t.resetExpiresAt(),t.updateCanonicalAuthority(this.canonicalAuthority)),r=this.cacheManager.generateAuthorityMetadataCacheKey(t.preferred_cache),this.cacheManager.setAuthorityMetadata(r,t),this.metadata=t,[2]}})})},e.prototype.updateEndpointMetadata=function(t){var o,n;return pe(this,void 0,void 0,function(){var r,i;return me(this,function(a){switch(a.label){case 0:return r=this.getEndpointMetadataFromConfig(),r?(t.updateEndpointMetadata(r,!1),[2,In.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,In.CACHE]:(i=this.getEndpointMetadataFromHardcodedValues(),[4,this.getEndpointMetadataFromNetwork()]);case 1:return r=a.sent(),r?!((o=this.authorityOptions.azureRegionConfiguration)===null||o===void 0)&&o.azureRegion?[4,this.updateMetadataWithRegionalInformation(r)]:[3,3]:[3,4];case 2:r=a.sent(),a.label=3;case 3:return t.updateEndpointMetadata(r,!0),[2,In.NETWORK];case 4:return i&&!this.authorityOptions.skipAuthorityMetadataCache?!((n=this.authorityOptions.azureRegionConfiguration)===null||n===void 0)&&n.azureRegion?[4,this.updateMetadataWithRegionalInformation(i)]:[3,6]:[3,7];case 5:i=a.sent(),a.label=6;case 6:return t.updateEndpointMetadata(i,!1),[2,In.HARDCODED_VALUES];case 7:throw W.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},e.prototype.isAuthoritySameType=function(t){var o=new Ee(t.canonical_authority),n=o.getUrlComponents().PathSegments;return n.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ke.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return pe(this,void 0,void 0,function(){var t,o;return me(this,function(n){switch(n.label){case 0:t={},this.proxyUrl&&(t.proxyUrl=this.proxyUrl),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,t)];case 2:return o=n.sent(),[2,zU(o.body)?o.body:null];case 3:return n.sent(),[2,null];case 4:return[2]}})})},e.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in bT?bT[this.canonicalAuthority]:null},e.prototype.updateMetadataWithRegionalInformation=function(t){var o,n,r,i,a;return pe(this,void 0,void 0,function(){var s,c;return me(this,function(l){switch(l.label){case 0:return[4,this.regionDiscovery.detectRegion((o=this.authorityOptions.azureRegionConfiguration)===null||o===void 0?void 0:o.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)];case 1:return s=l.sent(),c=((n=this.authorityOptions.azureRegionConfiguration)===null||n===void 0?void 0:n.azureRegion)===T.AZURE_REGION_AUTO_DISCOVER_FLAG?s:(r=this.authorityOptions.azureRegionConfiguration)===null||r===void 0?void 0:r.azureRegion,((i=this.authorityOptions.azureRegionConfiguration)===null||i===void 0?void 0:i.azureRegion)===T.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=s?ka.AUTO_DETECTION_REQUESTED_SUCCESSFUL:ka.AUTO_DETECTION_REQUESTED_FAILED:s?this.regionDiscoveryMetadata.region_outcome=((a=this.authorityOptions.azureRegionConfiguration)===null||a===void 0?void 0:a.azureRegion)===s?ka.CONFIGURED_MATCHES_DETECTED:ka.CONFIGURED_NOT_DETECTED:this.regionDiscoveryMetadata.region_outcome=ka.CONFIGURED_NO_AUTO_DETECTION,c?(this.regionDiscoveryMetadata.region_used=c,[2,e.replaceWithRegionalInformation(t,c)]):[2,t]}})})},e.prototype.updateCloudDiscoveryMetadata=function(t){return pe(this,void 0,void 0,function(){var o,n;return me(this,function(r){switch(r.label){case 0:return o=this.getCloudDiscoveryMetadataFromConfig(),o?(t.updateCloudDiscoveryMetadata(o,!1),[2,In.CONFIG]):this.isAuthoritySameType(t)&&t.aliasesFromNetwork&&!t.isExpired()?[2,In.CACHE]:(n=this.getCloudDiscoveryMetadataFromHarcodedValues(),[4,this.getCloudDiscoveryMetadataFromNetwork()]);case 1:if(o=r.sent(),o)return t.updateCloudDiscoveryMetadata(o,!0),[2,In.NETWORK];if(n&&!this.options.skipAuthorityMetadataCache)return t.updateCloudDiscoveryMetadata(n,!1),[2,In.HARDCODED_VALUES];throw Ke.createUntrustedAuthorityError()}})})},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),o=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(o)return o}catch{throw Ke.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return pe(this,void 0,void 0,function(){var t,o,n,r,i;return me(this,function(a){switch(a.label){case 0:t=""+T.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",o={},this.proxyUrl&&(o.proxyUrl=this.proxyUrl),n=null,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t,o)];case 2:return r=a.sent(),i=HU(r.body)?r.body.metadata:[],i.length===0?[2,null]:(n=e.getCloudDiscoveryMetadataFromNetworkResponse(i,this.hostnameAndPort),[3,4]);case 3:return a.sent(),[2,null];case 4:return n||(n=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,n]}})})},e.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in xT?xT[this.canonicalAuthority]:null},e.prototype.isInKnownAuthorities=function(){var t=this,o=this.authorityOptions.knownAuthorities.filter(function(n){return Ee.getDomainFromUrl(n).toLowerCase()===t.hostnameAndPort});return o.length>0},e.generateAuthority=function(t,o){var n;if(o&&o.azureCloudInstance!==ri.None){var r=o.tenant?o.tenant:T.DEFAULT_COMMON_TENANT;n=o.azureCloudInstance+"/"+r+"/"}return n||t},e.createCloudDiscoveryMetadataFromHost=function(t){return{preferred_network:t,preferred_cache:t,aliases:[t]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(t,o){for(var n=0;n<t.length;n++){var r=t[n];if(r.aliases.indexOf(o)>-1)return r}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw W.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(t){return this.metadata.aliases.indexOf(t)>-1},e.isPublicCloudAuthority=function(t){return T.KNOWN_PUBLIC_CLOUDS.indexOf(t)>=0},e.buildRegionalAuthorityString=function(t,o,n){var r=new Ee(t);r.validateAsUri();var i=r.getUrlComponents(),a=o+"."+i.HostNameAndPort;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=o+"."+T.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var s=Ee.constructAuthorityUriFromObject(pt(pt({},r.getUrlComponents()),{HostNameAndPort:a})).urlString;return n?s+"?"+n:s},e.replaceWithRegionalInformation=function(t,o){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,o),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,o,"allowestsrnonmsi=true"),t.end_session_endpoint&&(t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,o)),t},e}();var $a=function(){function e(){}return e.createDiscoveredInstance=function(t,o,n,r,i){return pe(this,void 0,void 0,function(){var a,s;return me(this,function(c){switch(c.label){case 0:a=e.createInstance(t,o,n,r,i),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,a.resolveEndpointsAsync()];case 2:return c.sent(),[2,a];case 3:throw s=c.sent(),W.createEndpointDiscoveryIncompleteError(s);case 4:return[2]}})})},e.createInstance=function(t,o,n,r,i){if(z.isEmpty(t))throw Ke.createUrlEmptyError();return new Ua(t,o,n,r,i)},e}();var _c=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(t,o){var n=t.indexOf(oo.CACHE_KEY)===0,r=!0;return o&&(r=o.hasOwnProperty("failedRequests")&&o.hasOwnProperty("errors")&&o.hasOwnProperty("cacheHits")),n&&r},e}();var qh=function(){function e(){}return e.isThrottlingEntity=function(t,o){var n=!1;t&&(n=t.indexOf(Aa.THROTTLING_PREFIX)===0);var r=!0;return o&&(r=o.hasOwnProperty("throttleTime")),n&&r},e}();var yT={sendGetRequestAsync:function(){var e="Network interface - sendGetRequestAsync() has not been implemented for the Network interface.";return Promise.reject(Z.createUnexpectedError(e))},sendPostRequestAsync:function(){var e="Network interface - sendPostRequestAsync() has not been implemented for the Network interface.";return Promise.reject(Z.createUnexpectedError(e))}};var Bh={missingKidError:{code:"missing_kid_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided."},missingAlgError:{code:"missing_alg_error",desc:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."}},TT=function(e){mt(t,e);function t(o,n){var r=e.call(this,o,n)||this;return r.name="JoseHeaderError",Object.setPrototypeOf(r,t.prototype),r}return t.createMissingKidError=function(){return new t(Bh.missingKidError.code,Bh.missingKidError.desc)},t.createMissingAlgError=function(){return new t(Bh.missingAlgError.code,Bh.missingAlgError.desc)},t}(Z);var ST=function(){function e(t){this.typ=t.typ,this.alg=t.alg,this.kid=t.kid}return e.getShrHeaderString=function(t){if(!t.kid)throw TT.createMissingKidError();if(!t.alg)throw TT.createMissingAlgError();var o=new e({typ:t.typ||$h.Jwt,kid:t.kid,alg:t.alg});return JSON.stringify(o)},e}();var ET=function(){function e(t,o){this.cacheOutcome=$i.NO_CACHE_HIT,this.cacheManager=o,this.apiId=t.apiId,this.correlationId=t.correlationId,this.wrapperSKU=t.wrapperSKU||T.EMPTY_STRING,this.wrapperVer=t.wrapperVer||T.EMPTY_STRING,this.telemetryCacheKey=oo.CACHE_KEY+to.CACHE_KEY_SEPARATOR+t.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var t=""+this.apiId+oo.VALUE_SEPARATOR+this.cacheOutcome,o=[this.wrapperSKU,this.wrapperVer].join(oo.VALUE_SEPARATOR),n=this.getRegionDiscoveryFields(),r=[t,n].join(oo.VALUE_SEPARATOR);return[oo.SCHEMA_VERSION,r,o].join(oo.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),o=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*o).join(oo.VALUE_SEPARATOR),r=t.errors.slice(0,o).join(oo.VALUE_SEPARATOR),i=t.errors.length,a=o<i?oo.OVERFLOW_TRUE:oo.OVERFLOW_FALSE,s=[i,a].join(oo.VALUE_SEPARATOR);return[oo.SCHEMA_VERSION,t.cacheHits,n,r,s].join(oo.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(t){var o=this.getLastRequests();o.errors.length>=oo.MAX_CACHED_ERRORS&&(o.failedRequests.shift(),o.failedRequests.shift(),o.errors.shift()),o.failedRequests.push(this.apiId,this.correlationId),z.isEmpty(t.subError)?z.isEmpty(t.errorCode)?!!t&&t.toString()?o.errors.push(t.toString()):o.errors.push(oo.UNKNOWN_ERROR):o.errors.push(t.errorCode):o.errors.push(t.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)},e.prototype.incrementCacheHits=function(){var t=this.getLastRequests();return t.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t),t.cacheHits},e.prototype.getLastRequests=function(){var t=new _c,o=this.cacheManager.getServerTelemetry(this.telemetryCacheKey);return o||t},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),o=e.maxErrorsToSend(t),n=t.errors.length;if(o===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{var r=new _c;r.failedRequests=t.failedRequests.slice(o*2),r.errors=t.errors.slice(o),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r)}},e.maxErrorsToSend=function(t){var o,n=0,r=0,i=t.errors.length;for(o=0;o<i;o++){var a=t.failedRequests[2*o]||T.EMPTY_STRING,s=t.failedRequests[2*o+1]||T.EMPTY_STRING,c=t.errors[o]||T.EMPTY_STRING;if(r+=a.toString().length+s.toString().length+c.length+3,r<oo.MAX_LAST_HEADER_BYTES)n+=1;else break}return n},e.prototype.getRegionDiscoveryFields=function(){var t=[];return t.push(this.regionUsed||T.EMPTY_STRING),t.push(this.regionSource||T.EMPTY_STRING),t.push(this.regionOutcome||T.EMPTY_STRING),t.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(t){this.regionUsed=t.region_used,this.regionSource=t.region_source,this.regionOutcome=t.region_outcome},e.prototype.setCacheOutcome=function(t){this.cacheOutcome=t},e}();var gt;(function(e){e.AcquireTokenByCode="acquireTokenByCode",e.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",e.AcquireTokenSilent="acquireTokenSilent",e.AcquireTokenSilentAsync="acquireTokenSilentAsync",e.AcquireTokenPopup="acquireTokenPopup",e.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",e.CryptoOptsSignJwt="cryptoOptsSignJwt",e.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",e.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",e.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",e.SsoSilent="ssoSilent",e.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",e.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",e.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken"})(gt||(gt={}));var za;(function(e){e[e.NotStarted=0]="NotStarted",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"})(za||(za={}));var Gp=function(){function e(t,o,n,r,i,a){this.authority=o,this.libraryName=r,this.libraryVersion=i,this.applicationTelemetry=a,this.clientId=t,this.logger=n,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.measurementsById=new Map}return e.prototype.startMeasurement=function(t,o){var n=this,r,i,a=o||this.generateId();o||this.logger.info("PerformanceClient: No correlation id provided for "+t+", generating",a),this.logger.trace("PerformanceClient: Performance measurement started for "+t,a);var s=this.startPerformanceMeasuremeant(t,a);s.startMeasurement();var c={eventId:this.generateId(),status:za.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,appName:(r=this.applicationTelemetry)===null||r===void 0?void 0:r.appName,appVersion:(i=this.applicationTelemetry)===null||i===void 0?void 0:i.appVersion,clientId:this.clientId,name:t,startTimeMs:Date.now(),correlationId:a};return this.cacheEventByCorrelationId(c),this.cacheMeasurement(c,s),{endMeasurement:function(l){var u=n.endMeasurement(pt(pt({},c),l));return u&&n.cacheEventByCorrelationId(u),u},flushMeasurement:function(){return n.flushMeasurements(c.name,c.correlationId)},discardMeasurement:function(){return n.discardMeasurements(c.correlationId)},measurement:s,event:c}},e.prototype.endMeasurement=function(t){var o=this.measurementsById.get(t.eventId);if(o){this.measurementsById.delete(t.eventId),o.endMeasurement();var n=o.flushMeasurement();if(n!==null){this.logger.trace("PerformanceClient: Performance measurement ended for "+t.name+": "+n+" ms",t.correlationId);var r=pt(pt({durationMs:Math.round(n)},t),{status:za.Completed});return r}else this.logger.trace("PerformanceClient: Performance measurement not taken",t.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+t.eventId,t.correlationId);return null},e.prototype.cacheEventByCorrelationId=function(t){var o=this.eventsByCorrelationId.get(t.correlationId);o?(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" added/updated",t.correlationId),o.set(t.eventId,t)):(this.logger.trace("PerformanceClient: Performance measurement for "+t.name+" started",t.correlationId),this.eventsByCorrelationId.set(t.correlationId,new Map().set(t.eventId,t)))},e.prototype.cacheMeasurement=function(t,o){this.measurementsById.set(t.eventId,o)},e.prototype.flushMeasurements=function(t,o){var n=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+t,o);var r=this.eventsByCorrelationId.get(o);if(r){this.discardMeasurements(o);var i=[];r.forEach(function(u){if(u.name!==t&&u.status!==za.Completed){n.logger.trace("PerformanceClient: Incomplete submeasurement "+u.name+" found for "+t,o);var p=n.endMeasurement(u);p&&i.push(p)}i.push(u)});var a=i.sort(function(u,p){return u.startTimeMs-p.startTimeMs}),s=a.filter(function(u){return u.name===t&&u.status===za.Completed});if(s.length>0){s.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",o);var c=s[0];this.logger.verbose("PerformanceClient: Measurement found for "+t,o);var l=a.reduce(function(u,p){if(p.name!==t){n.logger.trace("PerformanceClient: Complete submeasurement found for "+p.name,o);var m=p.name+"DurationMs";u[m]?n.logger.verbose("PerformanceClient: Submeasurement for "+t+" already exists for "+p.name+", ignoring",o):u[m]=p.durationMs}return u},c);this.emitEvents([l],l.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+t,o)}else this.logger.verbose("PerformanceClient: No measurements found",o)},e.prototype.discardMeasurements=function(t){this.logger.trace("PerformanceClient: Performance measurements discarded",t),this.eventsByCorrelationId.delete(t)},e.prototype.addPerformanceCallback=function(t){var o=this.generateId();return this.callbacks.set(o,t),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+o),o},e.prototype.removePerformanceCallback=function(t){var o=this.callbacks.delete(t);return o?this.logger.verbose("PerformanceClient: Performance callback "+t+" removed."):this.logger.verbose("PerformanceClient: Performance callback "+t+" not removed."),o},e.prototype.emitEvents=function(t,o){var n=this;this.logger.verbose("PerformanceClient: Emitting performance events",o),this.callbacks.forEach(function(r,i){n.logger.trace("PerformanceClient: Emitting event to callback "+i,o),r.apply(null,[t])})},e}();var P6=function(){function e(){}return e.prototype.startMeasurement=function(){},e.prototype.endMeasurement=function(){},e.prototype.flushMeasurement=function(){return null},e}(),wT=function(e){mt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.generateId=function(){return"callback-id"},t.prototype.startPerformanceMeasuremeant=function(){return new P6},t}(Gp);var B={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},hashDoesNotContainKnownPropertiesError:{code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},popupWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},blockAcquireTokenInPopupsError:{code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentLogoutUnsupportedError:{code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"},noNetworkConnectivity:{code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},postRequestFailed:{code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},getRequestFailed:{code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},failedToParseNetworkResponse:{code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},unableToLoadTokenError:{code:"unable_to_load_token",desc:"Error loading token to cache."},signingKeyNotFoundInStorage:{code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},authCodeRequired:{code:"auth_code_required",desc:"An authorization code must be provided (as the `code` property on the request) to this flow."},authCodeOrNativeAccountRequired:{code:"auth_code_or_nativeAccountId_required",desc:"An authorization code or nativeAccountId must be provided to this flow."},databaseUnavailable:{code:"database_unavailable",desc:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts."},unableToAcquireTokenFromNativePlatform:{code:"unable_to_acquire_token_from_native_platform",desc:"Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors."},nativeHandshakeTimeout:{code:"native_handshake_timeout",desc:"Timed out while attempting to establish connection to browser extension"},nativeExtensionNotInstalled:{code:"native_extension_not_installed",desc:"Native extension is not installed. If you think this is a mistake call the initialize function."},nativeConnectionNotEstablished:{code:"native_connection_not_established",desc:"Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors."},nativeBrokerCalledBeforeInitialize:{code:"native_broker_called_before_initialize",desc:"You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors."},nativePromptNotSupported:{code:"native_prompt_not_supported",desc:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow."}},F=function(e){et(t,e);function t(o,n){var r=e.call(this,o,n)||this;return Object.setPrototypeOf(r,t.prototype),r.name="BrowserAuthError",r}return t.createPkceNotGeneratedError=function(o){return new t(B.pkceNotGenerated.code,B.pkceNotGenerated.desc+" Detail:"+o)},t.createCryptoNotAvailableError=function(o){return new t(B.cryptoDoesNotExist.code,B.cryptoDoesNotExist.desc+" Detail:"+o)},t.createHttpMethodNotImplementedError=function(o){return new t(B.httpMethodNotImplementedError.code,B.httpMethodNotImplementedError.desc+" Given Method: "+o)},t.createEmptyNavigationUriError=function(){return new t(B.emptyNavigateUriError.code,B.emptyNavigateUriError.desc)},t.createEmptyHashError=function(o){return new t(B.hashEmptyError.code,B.hashEmptyError.desc+" Given Url: "+o)},t.createHashDoesNotContainStateError=function(){return new t(B.hashDoesNotContainStateError.code,B.hashDoesNotContainStateError.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(B.hashDoesNotContainKnownPropertiesError.code,B.hashDoesNotContainKnownPropertiesError.desc)},t.createUnableToParseStateError=function(){return new t(B.unableToParseStateError.code,B.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(B.stateInteractionTypeMismatchError.code,B.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(B.interactionInProgress.code,B.interactionInProgress.desc)},t.createPopupWindowError=function(o){var n=B.popupWindowError.desc;return n=z.isEmpty(o)?n:n+" Details: "+o,new t(B.popupWindowError.code,n)},t.createEmptyWindowCreatedError=function(){return new t(B.emptyWindowError.code,B.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(B.userCancelledError.code,B.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(B.monitorPopupTimeoutError.code,B.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(B.monitorIframeTimeoutError.code,B.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(o){return new t(B.redirectInIframeError.code,B.redirectInIframeError.desc+" (window.parent !== window) => "+o)},t.createBlockReloadInHiddenIframeError=function(){return new t(B.blockTokenRequestsInHiddenIframeError.code,B.blockTokenRequestsInHiddenIframeError.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(B.blockAcquireTokenInPopupsError.code,B.blockAcquireTokenInPopupsError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(B.iframeClosedPrematurelyError.code,B.iframeClosedPrematurelyError.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(B.silentLogoutUnsupportedError.code,B.silentLogoutUnsupportedError.desc)},t.createNoAccountError=function(){return new t(B.noAccountError.code,B.noAccountError.desc)},t.createSilentPromptValueError=function(o){return new t(B.silentPromptValueError.code,B.silentPromptValueError.desc+" Given value: "+o)},t.createUnableToParseTokenRequestCacheError=function(){return new t(B.unableToParseTokenRequestCacheError.code,B.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(B.noTokenRequestCacheError.code,B.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(B.authRequestNotSet.code,B.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(B.noCachedAuthorityError.code,B.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(B.invalidCacheType.code,""+B.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(B.notInBrowserEnvironment.code,B.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(B.databaseNotOpen.code,B.databaseNotOpen.desc)},t.createNoNetworkConnectivityError=function(){return new t(B.noNetworkConnectivity.code,B.noNetworkConnectivity.desc)},t.createPostRequestFailedError=function(o,n){return new t(B.postRequestFailed.code,B.postRequestFailed.desc+" | Network client threw: "+o+" | Attempted to reach: "+n.split("?")[0])},t.createGetRequestFailedError=function(o,n){return new t(B.getRequestFailed.code,B.getRequestFailed.desc+" | Network client threw: "+o+" | Attempted to reach: "+n.split("?")[0])},t.createFailedToParseNetworkResponseError=function(o){return new t(B.failedToParseNetworkResponse.code,B.failedToParseNetworkResponse.desc+" | Attempted to reach: "+o.split("?")[0])},t.createUnableToLoadTokenError=function(o){return new t(B.unableToLoadTokenError.code,B.unableToLoadTokenError.desc+" | "+o)},t.createSigningKeyNotFoundInStorageError=function(o){return new t(B.signingKeyNotFoundInStorage.code,B.signingKeyNotFoundInStorage.desc+" | No match found for KeyId: "+o)},t.createAuthCodeRequiredError=function(){return new t(B.authCodeRequired.code,B.authCodeRequired.desc)},t.createAuthCodeOrNativeAccountIdRequiredError=function(){return new t(B.authCodeOrNativeAccountRequired.code,B.authCodeOrNativeAccountRequired.desc)},t.createDatabaseUnavailableError=function(){return new t(B.databaseUnavailable.code,B.databaseUnavailable.desc)},t.createUnableToAcquireTokenFromNativePlatformError=function(){return new t(B.unableToAcquireTokenFromNativePlatform.code,B.unableToAcquireTokenFromNativePlatform.desc)},t.createNativeHandshakeTimeoutError=function(){return new t(B.nativeHandshakeTimeout.code,B.nativeHandshakeTimeout.desc)},t.createNativeExtensionNotInstalledError=function(){return new t(B.nativeExtensionNotInstalled.code,B.nativeExtensionNotInstalled.desc)},t.createNativeConnectionNotEstablishedError=function(){return new t(B.nativeConnectionNotEstablished.code,B.nativeConnectionNotEstablished.desc)},t.createNativeBrokerCalledBeforeInitialize=function(){return new t(B.nativeBrokerCalledBeforeInitialize.code,B.nativeBrokerCalledBeforeInitialize.desc)},t.createNativePromptParameterNotSupportedError=function(){return new t(B.nativePromptNotSupported.code,B.nativePromptNotSupported.desc)},t}(Z);var Vt={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",POLL_INTERVAL_MS:50,MSAL_SKU:"msal.js.browser"},bc={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Pr;(function(e){e.HandshakeRequest="Handshake",e.HandshakeResponse="HandshakeResponse",e.GetToken="GetToken",e.Response="Response"})(Pr||(Pr={}));var ro;(function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"})(ro||(ro={}));var Xn;(function(e){e.GET="GET",e.POST="POST"})(Xn||(Xn={}));var Qe;(function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId",e.NATIVE_REQUEST="request.native"})(Qe||(Qe={}));var vc;(function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"})(vc||(vc={}));var tt;(function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenByCode=866]="acquireTokenByCode",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"})(tt||(tt={}));var ne;(function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"})(ne||(ne={}));var BU;(function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"})(BU||(BU={}));var CT={scopes:Ar},Vp="jwk",YU;(function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"})(YU||(YU={}));var jp="msal.db",GU=1,VU=jp+".keys";var Jn={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},Wp=function(e){et(t,e);function t(o,n){var r=e.call(this,o,n)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,t.prototype),r}return t.createRedirectUriEmptyError=function(){return new t(Jn.redirectUriNotSet.code,Jn.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Jn.postLogoutUriNotSet.code,Jn.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(o){return new t(Jn.storageNotSupportedError.code,Jn.storageNotSupportedError.desc+" Given Location: "+o)},t.createRedirectCallbacksNotSetError=function(){return new t(Jn.noRedirectCallbacksSet.code,Jn.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(Jn.stubPcaInstanceCalled.code,Jn.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(Jn.inMemRedirectUnavailable.code,Jn.inMemRedirectUnavailable.desc)},t}(Z);var kT=function(){function e(t){this.validateWindowStorage(t),this.windowStorage=window[t]}return e.prototype.validateWindowStorage=function(t){if(t!==ro.LocalStorage&&t!==ro.SessionStorage)throw Wp.createStorageNotSupportedError(t);var o=!!window[t];if(!o)throw Wp.createStorageNotSupportedError(t)},e.prototype.getItem=function(t){return this.windowStorage.getItem(t)},e.prototype.setItem=function(t,o){this.windowStorage.setItem(t,o)},e.prototype.removeItem=function(t){this.windowStorage.removeItem(t)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(t){return this.windowStorage.hasOwnProperty(t)},e}();var Kp=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(t){return this.cache.get(t)||null},e.prototype.setItem=function(t,o){this.cache.set(t,o)},e.prototype.removeItem=function(t){this.cache.delete(t)},e.prototype.getKeys=function(){var t=[];return this.cache.forEach(function(o,n){t.push(n)}),t},e.prototype.containsKey=function(t){return this.cache.has(t)},e.prototype.clear=function(){this.cache.clear()},e}();var Yh=function(){function e(){}return e.extractBrowserRequestState=function(t,o){if(z.isEmpty(o))return null;try{var n=No.parseRequestState(t,o);return n.libraryState.meta}catch(r){throw W.createInvalidStateError(o,r)}},e.parseServerResponseFromHash=function(t){if(!t)return{};var o=new Ee(t);return Ee.getDeserializedHash(o.getHash())},e}();var AT=function(e){et(t,e);function t(o,n,r,i){var a=e.call(this,o,r)||this;return a.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,a.cacheConfig=n,a.logger=i,a.internalStorage=new Kp,a.browserStorage=a.setupBrowserStorage(a.cacheConfig.cacheLocation),a.temporaryCacheStorage=a.setupTemporaryCacheStorage(a.cacheConfig.cacheLocation),a.migrateCacheEntries(),a}return t.prototype.setupBrowserStorage=function(o){switch(o){case ro.LocalStorage:case ro.SessionStorage:try{return new kT(o)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=ro.MemoryStorage,new Kp},t.prototype.setupTemporaryCacheStorage=function(o){switch(o){case ro.LocalStorage:case ro.SessionStorage:try{return new kT(ro.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}case ro.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var o=this,n=T.CACHE_PREFIX+"."+eo.ID_TOKEN,r=T.CACHE_PREFIX+"."+eo.CLIENT_INFO,i=T.CACHE_PREFIX+"."+eo.ERROR,a=T.CACHE_PREFIX+"."+eo.ERROR_DESC,s=this.browserStorage.getItem(n),c=this.browserStorage.getItem(r),l=this.browserStorage.getItem(i),u=this.browserStorage.getItem(a),p=[s,c,l,u],m=[eo.ID_TOKEN,eo.CLIENT_INFO,eo.ERROR,eo.ERROR_DESC];m.forEach(function(f,h){return o.migrateCacheEntry(f,p[h])})},t.prototype.migrateCacheEntry=function(o,n){n&&this.setTemporaryCache(o,n,!0)},t.prototype.validateAndParseJson=function(o){try{var n=JSON.parse(o);return n&&typeof n=="object"?n:null}catch{return null}},t.prototype.getItem=function(o){return this.browserStorage.getItem(o)},t.prototype.setItem=function(o,n){this.browserStorage.setItem(o,n)},t.prototype.getAccount=function(o){var n=this.getItem(o);if(!n)return null;var r=this.validateAndParseJson(n);return!r||!Tt.isAccountEntity(r)?null:cn.toObject(new Tt,r)},t.prototype.setAccount=function(o){this.logger.trace("BrowserCacheManager.setAccount called");var n=o.generateAccountKey();this.setItem(n,JSON.stringify(o))},t.prototype.getIdTokenCredential=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!Da.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),cn.toObject(new Da,r))},t.prototype.setIdTokenCredential=function(o){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var n=o.generateCredentialKey();this.setItem(n,JSON.stringify(o))},t.prototype.getAccessTokenCredential=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!La.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),cn.toObject(new La,r))},t.prototype.setAccessTokenCredential=function(o){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var n=o.generateCredentialKey();this.setItem(n,JSON.stringify(o))},t.prototype.getRefreshTokenCredential=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!iu.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),cn.toObject(new iu,r))},t.prototype.setRefreshTokenCredential=function(o){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var n=o.generateCredentialKey();this.setItem(n,JSON.stringify(o))},t.prototype.getAppMetadata=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!au.isAppMetadataEntity(o,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),cn.toObject(new au,r))},t.prototype.setAppMetadata=function(o){this.logger.trace("BrowserCacheManager.setAppMetadata called");var n=o.generateAppMetadataKey();this.setItem(n,JSON.stringify(o))},t.prototype.getServerTelemetry=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!_c.isServerTelemetryEntity(o,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),cn.toObject(new _c,r))},t.prototype.setServerTelemetry=function(o,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(o,JSON.stringify(n))},t.prototype.getAuthorityMetadata=function(o){var n=this.internalStorage.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(n);return r&&su.isAuthorityMetadataEntity(o,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),cn.toObject(new su,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var o=this,n=this.internalStorage.getKeys();return n.filter(function(r){return o.isAuthorityMetadata(r)})},t.prototype.setWrapperMetadata=function(o,n){this.internalStorage.setItem(vc.WRAPPER_SKU,o),this.internalStorage.setItem(vc.WRAPPER_VER,n)},t.prototype.getWrapperMetadata=function(){var o=this.internalStorage.getItem(vc.WRAPPER_SKU)||T.EMPTY_STRING,n=this.internalStorage.getItem(vc.WRAPPER_VER)||T.EMPTY_STRING;return[o,n]},t.prototype.setAuthorityMetadata=function(o,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(o,JSON.stringify(n))},t.prototype.getActiveAccount=function(){var o=this.generateCacheKey(eo.ACTIVE_ACCOUNT),n=this.browserStorage.getItem(o);return n&&this.getAccountInfoByFilter({localAccountId:n})[0]||null},t.prototype.setActiveAccount=function(o){var n=this.generateCacheKey(eo.ACTIVE_ACCOUNT);o?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(n,o.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n))},t.prototype.getAccountInfoByFilter=function(o){var n=this.getAllAccounts();return n.filter(function(r){return!(o.username&&o.username.toLowerCase()!==r.username.toLowerCase()||o.homeAccountId&&o.homeAccountId!==r.homeAccountId||o.localAccountId&&o.localAccountId!==r.localAccountId||o.tenantId&&o.tenantId!==r.tenantId||o.environment&&o.environment!==r.environment)})},t.prototype.getAccountInfoByHints=function(o,n){var r=this.getAllAccounts().filter(function(i){if(n){var a=i.idTokenClaims&&i.idTokenClaims.sid;return n===a}return o?o===i.username:!1});if(r.length===1)return r[0];if(r.length>1)throw W.createMultipleMatchingAccountsInCacheError();return null},t.prototype.getThrottlingCache=function(o){var n=this.getItem(o);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(n);return!r||!qh.isThrottlingEntity(o,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),cn.toObject(new qh,r))},t.prototype.setThrottlingCache=function(o,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(o,JSON.stringify(n))},t.prototype.getTemporaryCache=function(o,n){var r=n?this.generateCacheKey(o):o;if(this.cacheConfig.storeAuthStateInCookie){var i=this.getItemCookie(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}var a=this.temporaryCacheStorage.getItem(r);if(!a){if(this.cacheConfig.cacheLocation===ro.LocalStorage){var s=this.browserStorage.getItem(r);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),s}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),a},t.prototype.setTemporaryCache=function(o,n,r){var i=r?this.generateCacheKey(o):o;this.temporaryCacheStorage.setItem(i,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,n))},t.prototype.removeItem=function(o){return this.browserStorage.removeItem(o),this.temporaryCacheStorage.removeItem(o),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(o)),!0},t.prototype.containsKey=function(o){return this.browserStorage.containsKey(o)||this.temporaryCacheStorage.containsKey(o)},t.prototype.getKeys=function(){return Uh(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return D(this,void 0,void 0,function(){var o=this;return L(this,function(n){switch(n.label){case 0:return[4,this.removeAllAccounts()];case 1:return n.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(r){(o.browserStorage.containsKey(r)||o.temporaryCacheStorage.containsKey(r))&&(r.indexOf(T.CACHE_PREFIX)!==-1||r.indexOf(o.clientId)!==-1)&&o.removeItem(r)}),this.internalStorage.clear(),[2]}})})},t.prototype.setItemCookie=function(o,n,r){var i=encodeURIComponent(o)+"="+encodeURIComponent(n)+";path=/;SameSite=Lax;";if(r){var a=this.getCookieExpirationTime(r);i+="expires="+a+";"}this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i},t.prototype.getItemCookie=function(o){for(var n=encodeURIComponent(o)+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var a=r[i];a.charAt(0)===" ";)a=a.substring(1);if(a.indexOf(n)===0)return decodeURIComponent(a.substring(n.length,a.length))}return T.EMPTY_STRING},t.prototype.clearMsalCookies=function(){var o=this,n=T.CACHE_PREFIX+"."+this.clientId,r=document.cookie.split(";");r.forEach(function(i){for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(n)===0){var a=i.split("=")[0];o.clearItemCookie(a)}})},t.prototype.clearItemCookie=function(o){this.setItemCookie(o,T.EMPTY_STRING,-1)},t.prototype.getCookieExpirationTime=function(o){var n=new Date,r=new Date(n.getTime()+o*this.COOKIE_LIFE_MULTIPLIER);return r.toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(o){var n=this.validateAndParseJson(o);return n?JSON.stringify(o):z.startsWith(o,T.CACHE_PREFIX)||z.startsWith(o,eo.ADAL_ID_TOKEN)?o:T.CACHE_PREFIX+"."+this.clientId+"."+o},t.prototype.generateAuthorityKey=function(o){var n=No.parseRequestState(this.cryptoImpl,o).libraryState.id;return this.generateCacheKey(Qe.AUTHORITY+"."+n)},t.prototype.generateNonceKey=function(o){var n=No.parseRequestState(this.cryptoImpl,o).libraryState.id;return this.generateCacheKey(Qe.NONCE_IDTOKEN+"."+n)},t.prototype.generateStateKey=function(o){var n=No.parseRequestState(this.cryptoImpl,o).libraryState.id;return this.generateCacheKey(Qe.REQUEST_STATE+"."+n)},t.prototype.getCachedAuthority=function(o){var n=this.generateStateKey(o),r=this.getTemporaryCache(n);if(!r)return null;var i=this.generateAuthorityKey(r);return this.getTemporaryCache(i)},t.prototype.updateCacheEntries=function(o,n,r,i,a){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var s=this.generateStateKey(o);this.setTemporaryCache(s,o,!1);var c=this.generateNonceKey(o);this.setTemporaryCache(c,n,!1);var l=this.generateAuthorityKey(o);if(this.setTemporaryCache(l,r,!1),a){var u={credential:a.homeAccountId,type:_o.HOME_ACCOUNT_ID};this.setTemporaryCache(Qe.CCS_CREDENTIAL,JSON.stringify(u),!0)}else if(!z.isEmpty(i)){var u={credential:i,type:_o.UPN};this.setTemporaryCache(Qe.CCS_CREDENTIAL,JSON.stringify(u),!0)}},t.prototype.resetRequestCache=function(o){var n=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),z.isEmpty(o)||this.getKeys().forEach(function(r){r.indexOf(o)!==-1&&n.removeItem(r)}),o&&(this.removeItem(this.generateStateKey(o)),this.removeItem(this.generateNonceKey(o)),this.removeItem(this.generateAuthorityKey(o))),this.removeItem(this.generateCacheKey(Qe.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Qe.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Qe.URL_HASH)),this.removeItem(this.generateCacheKey(Qe.CORRELATION_ID)),this.removeItem(this.generateCacheKey(Qe.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(Qe.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(o){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),o){var n=this.generateStateKey(o),r=this.temporaryCacheStorage.getItem(n);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||T.EMPTY_STRING)}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(o){var n=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(r){if(r.indexOf(Qe.REQUEST_STATE)!==-1){var i=n.temporaryCacheStorage.getItem(r);if(!!i){var a=Yh.extractBrowserRequestState(n.cryptoImpl,i);a&&a.interactionType===o&&(n.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+i),n.resetRequestCache(i))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},t.prototype.cacheCodeRequest=function(o,n){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=n.base64Encode(JSON.stringify(o));this.setTemporaryCache(Qe.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(o,n){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(Qe.REQUEST_PARAMS,!0);if(!r)throw F.createNoTokenRequestCacheError();var i=this.validateAndParseJson(n.base64Decode(r));if(!i)throw F.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(Qe.REQUEST_PARAMS)),z.isEmpty(i.authority)){var a=this.generateAuthorityKey(o),s=this.getTemporaryCache(a);if(!s)throw F.createNoCachedAuthorityError();i.authority=s}return i},t.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var o=this.getTemporaryCache(Qe.NATIVE_REQUEST,!0);if(!o)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;var n=this.validateAndParseJson(o);return n||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)},t.prototype.isInteractionInProgress=function(o){var n=this.getInteractionInProgress();return o?n===this.clientId:!!n},t.prototype.getInteractionInProgress=function(){var o=T.CACHE_PREFIX+"."+Qe.INTERACTION_STATUS_KEY;return this.getTemporaryCache(o,!1)},t.prototype.setInteractionInProgress=function(o){var n=T.CACHE_PREFIX+"."+Qe.INTERACTION_STATUS_KEY;if(o){if(this.getInteractionInProgress())throw F.createInteractionInProgressError();this.setTemporaryCache(n,this.clientId,!1)}else!o&&this.getInteractionInProgress()===this.clientId&&this.removeItem(n)},t.prototype.getLegacyLoginHint=function(){var o=this.getTemporaryCache(eo.ADAL_ID_TOKEN);o&&(this.browserStorage.removeItem(eo.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var n=this.getTemporaryCache(eo.ID_TOKEN,!0);n&&(this.removeItem(this.generateCacheKey(eo.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=n||o;if(r){var i=new Ro(r,this.cryptoImpl);if(i.claims&&i.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.claims.preferred_username;if(i.claims&&i.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t.prototype.updateCredentialCacheKey=function(o,n){var r=n.generateCredentialKey();if(o!==r){var i=this.getItem(o);if(i)return this.removeItem(o),this.setItem(r,i),this.logger.verbose("Updated an outdated "+n.credentialType+" cache key"),r;this.logger.error("Attempted to update an outdated "+n.credentialType+" cache key but no item matching the outdated key was found in storage")}return o},t}(cn),jU=function(e,t){var o={cacheLocation:ro.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1};return new AT(e,o,Ia,t)};var Gh="@azure/msal-browser",Fa="2.27.0";var WU=function(){function e(){}return e.prototype.sendGetRequestAsync=function(t,o){return D(this,void 0,void 0,function(){var n,r,i;return L(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,fetch(t,{method:Xn.GET,headers:this.getFetchHeaders(o)})];case 1:return n=a.sent(),[3,3];case 2:throw r=a.sent(),window.navigator.onLine?F.createGetRequestFailedError(r,t):F.createNoNetworkConnectivityError();case 3:return a.trys.push([3,5,,6]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 4:return[2,(i.body=a.sent(),i.status=n.status,i)];case 5:throw a.sent(),F.createFailedToParseNetworkResponseError(t);case 6:return[2]}})})},e.prototype.sendPostRequestAsync=function(t,o){return D(this,void 0,void 0,function(){var n,r,i,a;return L(this,function(s){switch(s.label){case 0:n=o&&o.body||T.EMPTY_STRING,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(t,{method:Xn.POST,headers:this.getFetchHeaders(o),body:n})];case 2:return r=s.sent(),[3,4];case 3:throw i=s.sent(),window.navigator.onLine?F.createPostRequestFailedError(i,t):F.createNoNetworkConnectivityError();case 4:return s.trys.push([4,6,,7]),a={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 5:return[2,(a.body=s.sent(),a.status=r.status,a)];case 6:throw s.sent(),F.createFailedToParseNetworkResponseError(t);case 7:return[2]}})})},e.prototype.getFetchHeaders=function(t){var o=new Headers;if(!(t&&t.headers))return o;var n=t.headers;return Object.keys(n).forEach(function(r){o.append(r,n[r])}),o},e.prototype.getHeaderDict=function(t){var o={};return t.forEach(function(n,r){o[r]=n}),o},e}();var KU=function(){function e(){}return e.prototype.sendGetRequestAsync=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,this.sendRequestAsync(t,Xn.GET,o)]})})},e.prototype.sendPostRequestAsync=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,this.sendRequestAsync(t,Xn.POST,o)]})})},e.prototype.sendRequestAsync=function(t,o,n){var r=this;return new Promise(function(i,a){var s=new XMLHttpRequest;if(s.open(o,t,!0),r.setXhrHeaders(s,n),s.onload=function(){(s.status<200||s.status>=300)&&(o===Xn.POST?a(F.createPostRequestFailedError("Failed with status "+s.status,t)):a(F.createGetRequestFailedError("Failed with status "+s.status,t)));try{var c=JSON.parse(s.responseText),l={headers:r.getHeaderDict(s),body:c,status:s.status};i(l)}catch{a(F.createFailedToParseNetworkResponseError(t))}},s.onerror=function(){window.navigator.onLine?o===Xn.POST?a(F.createPostRequestFailedError("Failed with status "+s.status,t)):a(F.createGetRequestFailedError("Failed with status "+s.status,t)):a(F.createNoNetworkConnectivityError())},o===Xn.POST&&n&&n.body)s.send(n.body);else if(o===Xn.GET)s.send();else throw F.createHttpMethodNotImplementedError(o)})},e.prototype.setXhrHeaders=function(t,o){if(o&&o.headers){var n=o.headers;Object.keys(n).forEach(function(r){t.setRequestHeader(r,n[r])})}},e.prototype.getHeaderDict=function(t){var o=t.getAllResponseHeaders(),n=o.trim().split(/[\r\n]+/),r={};return n.forEach(function(i){var a=i.split(": "),s=a.shift(),c=a.join(": ");s&&c&&(r[s]=c)}),r},e}();var ft=function(){function e(){}return e.clearHash=function(t){t.location.hash=T.EMPTY_STRING,typeof t.history.replaceState=="function"&&t.history.replaceState(null,T.EMPTY_STRING,""+t.location.origin+t.location.pathname+t.location.search)},e.replaceHash=function(t){var o=t.split("#");o.shift(),window.location.hash=o.length>0?o.join("#"):T.EMPTY_STRING},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(Vt.POPUP_NAME_PREFIX+".")===0},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var t=new Ee(window.location.href),o=t.getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new WU:new KU},e.blockReloadInHiddenIframes=function(){var t=Ee.hashContainsKnownProperties(window.location.hash);if(t&&e.isInIframe())throw F.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,o){var n=e.isInIframe();if(t===ne.Redirect&&n&&!o)throw F.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw F.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(t){if(!t)throw F.createNonBrowserEnvironmentError()},e.blockNativeBrokerCalledBeforeInitialized=function(t,o){if(t&&!o)throw F.createNativeBrokerCalledBeforeInitialize()},e.detectIEOrEdge=function(){var t=window.navigator.userAgent,o=t.indexOf("MSIE "),n=t.indexOf("Trident/"),r=t.indexOf("Edge/"),i=o>0||n>0,a=r>0;return i||a},e}();var Vh=function(){function e(t,o,n,r,i,a,s,c,l){this.config=t,this.browserStorage=o,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=a,this.nativeMessageHandler=c,this.correlationId=l||this.browserCrypto.createNewGuid(),this.logger=r.clone(Vt.MSAL_SKU,Fa,this.correlationId),this.performanceClient=s}return e.prototype.clearCacheOnLogout=function(t){return D(this,void 0,void 0,function(){return L(this,function(o){switch(o.label){case 0:if(!t)return[3,5];Tt.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Tt.generateAccountCacheKey(t))];case 2:return o.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return o.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return o.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return o.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return o.sent(),[3,9];case 8:return o.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},e.prototype.initializeBaseRequest=function(t){return D(this,void 0,void 0,function(){var o,n,r,i;return L(this,function(a){switch(a.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),o=t.authority||this.config.auth.authority,n=Uh(t&&t.scopes||[]),r=oe(oe({},t),{correlationId:this.correlationId,authority:o,scopes:n}),!r.authenticationScheme)r.authenticationScheme=Fe.BEARER,this.logger.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(r.authenticationScheme===Fe.SSH){if(!t.sshJwk)throw Ke.createMissingSshJwkError();if(!t.sshKid)throw Ke.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+r.authenticationScheme+'" as configured in Auth request')}return t.claims&&!z.isEmpty(t.claims)?(i=r,[4,this.browserCrypto.hashString(t.claims)]):[3,2];case 1:i.requestedClaimsHash=a.sent(),a.label=2;case 2:return[2,r]}})})},e.prototype.getRedirectUri=function(t){this.logger.verbose("getRedirectUri called");var o=t||this.config.auth.redirectUri||ft.getCurrentUri();return Ee.getAbsoluteUrl(o,ft.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(t,o){this.logger.verbose("initializeServerTelemetryManager called");var n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:t,forceRefresh:o||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new ET(n,this.browserStorage)},e.prototype.getDiscoveredAuthority=function(t){return D(this,void 0,void 0,function(){var o;return L(this,function(n){switch(n.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},t?(this.logger.verbose("Creating discovered authority with request authority"),[4,$a.createDiscoveredInstance(t,this.config.system.networkClient,this.browserStorage,o)]):[3,2];case 1:return[2,n.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,$a.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,o)];case 3:return[2,n.sent()]}})})},e}();var Zn=function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initializeAuthorizationCodeRequest=function(o){return D(this,void 0,void 0,function(){var n,r;return L(this,function(i){switch(i.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",o.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return n=i.sent(),r=oe(oe({},o),{redirectUri:o.redirectUri,code:T.EMPTY_STRING,codeVerifier:n.verifier}),o.codeChallenge=n.challenge,o.codeChallengeMethod=T.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},t.prototype.initializeLogoutRequest=function(o){this.logger.verbose("initializeLogoutRequest called",o?.correlationId);var n=oe({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},o);if(o)if(o.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(o.account){var r=this.getLogoutHintFromIdTokenClaims(o.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!o||o.postLogoutRedirectUri!==null?o&&o.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=Ee.getAbsoluteUrl(o.postLogoutRedirectUri,ft.getCurrentUri())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=Ee.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ft.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=Ee.getAbsoluteUrl(ft.getCurrentUri(),ft.getCurrentUri())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n},t.prototype.getLogoutHintFromIdTokenClaims=function(o){var n=o.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},t.prototype.createAuthCodeClient=function(o,n,r){return D(this,void 0,void 0,function(){var i;return L(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(o,n,r)];case 1:return i=a.sent(),[2,new Bp(i)]}})})},t.prototype.getClientConfiguration=function(o,n,r){return D(this,void 0,void 0,function(){var i;return L(this,function(a){switch(a.label){case 0:return this.logger.verbose("getClientConfiguration called",this.correlationId),[4,this.getDiscoveredAuthority(n,r)];case 1:return i=a.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:i,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:o,libraryInfo:{sku:Vt.MSAL_SKU,version:Fa,cpu:T.EMPTY_STRING,os:T.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},t.prototype.validateAndExtractStateFromHash=function(o,n,r){if(this.logger.verbose("validateAndExtractStateFromHash called",r),!o.state)throw F.createHashDoesNotContainStateError();var i=Yh.extractBrowserRequestState(this.browserCrypto,o.state);if(!i)throw F.createUnableToParseStateError();if(i.interactionType!==n)throw F.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),o.state},t.prototype.getDiscoveredAuthority=function(o,n){return D(this,void 0,void 0,function(){var r,i,a,s;return L(this,function(c){switch(c.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",this.correlationId),r=this.performanceClient.startMeasurement(gt.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=o||this.config.auth.authority,s=Ua.generateAuthority(a,n||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),[4,$a.createDiscoveredInstance(s,this.config.system.networkClient,this.browserStorage,i).then(function(l){return r.endMeasurement({success:!0}),l}).catch(function(l){throw r.endMeasurement({errorCode:l.errorCode,subErrorCode:l.subError,success:!1}),l})];case 1:return[2,c.sent()]}})})},t.prototype.initializeAuthorizationRequest=function(o,n){return D(this,void 0,void 0,function(){var r,i,a,s,c,l,u;return L(this,function(p){switch(p.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),r=this.getRedirectUri(o.redirectUri),i={interactionType:n},a=No.setRequestState(this.browserCrypto,o&&o.state||T.EMPTY_STRING,i),c=[{}],[4,this.initializeBaseRequest(o)];case 1:return s=oe.apply(void 0,[oe.apply(void 0,c.concat([p.sent()])),{redirectUri:r,state:a,nonce:o.nonce||this.browserCrypto.createNewGuid(),responseMode:pc.FRAGMENT}]),l=o.account||this.browserStorage.getActiveAccount(),l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+l.homeAccountId,this.correlationId),s.account=l),z.isEmpty(s.loginHint)&&!l&&(u=this.browserStorage.getLegacyLoginHint(),u&&(s.loginHint=u)),[2,s]}})})},t}(Vh);var cu=function(){function e(t,o,n,r){this.authModule=t,this.browserStorage=o,this.authCodeRequest=n,this.logger=r}return e.prototype.handleCodeResponseFromHash=function(t,o,n,r){return D(this,void 0,void 0,function(){var i,a,s;return L(this,function(c){if(this.logger.verbose("InteractionHandler.handleCodeResponse called"),z.isEmpty(t))throw F.createEmptyHashError(t);if(i=this.browserStorage.generateStateKey(o),a=this.browserStorage.getTemporaryCache(i),!a)throw W.createStateNotFoundError("Cached State");try{s=this.authModule.handleFragmentResponse(t,a)}catch(l){throw l instanceof Ko&&l.subError===B.userCancelledError.code?F.createUserCancelledError():l}return[2,this.handleCodeResponseFromServer(s,o,n,r)]})})},e.prototype.handleCodeResponseFromServer=function(t,o,n,r,i){return i===void 0&&(i=!0),D(this,void 0,void 0,function(){var a,s,c,l,u,p;return L(this,function(m){switch(m.label){case 0:if(this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),a=this.browserStorage.generateStateKey(o),s=this.browserStorage.getTemporaryCache(a),!s)throw W.createStateNotFoundError("Cached State");return c=this.browserStorage.generateNonceKey(s),l=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=t.code,t.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(t.cloud_instance_host_name,n,r)]:[3,2];case 1:m.sent(),m.label=2;case 2:return i&&(t.nonce=l||void 0),t.state=s,t.client_info?this.authCodeRequest.clientInfo=t.client_info:(u=this.checkCcsCredentials(),u&&(this.authCodeRequest.ccsCredential=u)),[4,this.authModule.acquireToken(this.authCodeRequest,t)];case 3:return p=m.sent(),this.browserStorage.cleanRequestByState(o),[2,p]}})})},e.prototype.updateTokenEndpointAuthority=function(t,o,n){return D(this,void 0,void 0,function(){var r,i;return L(this,function(a){switch(a.label){case 0:return r="https://"+t+"/"+o.tenant+"/",[4,$a.createDiscoveredInstance(r,n,this.browserStorage,o.options)];case 1:return i=a.sent(),this.authModule.updateAuthority(i),[2]}})})},e.prototype.checkCcsCredentials=function(){var t=this.browserStorage.getTemporaryCache(Qe.CCS_CREDENTIAL,!0);if(t)try{return JSON.parse(t)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+t)}return null},e}();var IT=function(e){et(t,e);function t(o,n,r,i,a){var s=e.call(this,o,n,r,i)||this;return s.browserCrypto=a,s}return t.prototype.initiateAuthRequest=function(o,n){return D(this,void 0,void 0,function(){var r,i;return L(this,function(a){switch(a.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),z.isEmpty(o)?[3,7]:(n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Qe.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Qe.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+o),r={apiId:tt.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1},typeof n.onRedirectNavigate!="function"?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),i=n.onRedirectNavigate(o),i===!1?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,n.navigationClient.navigateExternal(o,r)])));case 1:return a.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,n.navigationClient.navigateExternal(o,r)];case 5:return a.sent(),[2];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),F.createEmptyNavigationUriError();case 8:return[2]}})})},t.prototype.handleCodeResponseFromHash=function(o,n,r,i){return D(this,void 0,void 0,function(){var a,s,c,l,u,p,m;return L(this,function(f){switch(f.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),z.isEmpty(o))throw F.createEmptyHashError(o);if(this.browserStorage.setInteractionInProgress(!1),a=this.browserStorage.generateStateKey(n),s=this.browserStorage.getTemporaryCache(a),!s)throw W.createStateNotFoundError("Cached State");try{c=this.authModule.handleFragmentResponse(o,s)}catch(h){throw h instanceof Ko&&h.subError===B.userCancelledError.code?F.createUserCancelledError():h}return l=this.browserStorage.generateNonceKey(s),u=this.browserStorage.getTemporaryCache(l),this.authCodeRequest.code=c.code,c.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(c.cloud_instance_host_name,r,i)]:[3,2];case 1:f.sent(),f.label=2;case 2:return c.nonce=u||void 0,c.state=s,c.client_info?this.authCodeRequest.clientInfo=c.client_info:(p=this.checkCcsCredentials(),p&&(this.authCodeRequest.ccsCredential=p)),[4,this.authModule.acquireToken(this.authCodeRequest,c)];case 3:return m=f.sent(),this.browserStorage.cleanRequestByState(n),[2,m]}})})},t}(cu);var xe;(function(e){e.INITIALIZE_START="msal:initializeStart",e.INITIALIZE_END="msal:initializeEnd",e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",e.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",e.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"})(xe||(xe={}));var Ha;(function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"})(Ha||(Ha={}));var PT={extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."}},ln=function(e){et(t,e);function t(o,n,r){var i=e.call(this,o,n)||this;return Object.setPrototypeOf(i,t.prototype),i.name="NativeAuthError",i.ext=r,i}return t.prototype.isFatal=function(){if(this.ext&&this.ext.status&&(this.ext.status===Ha.PERSISTENT_ERROR||this.ext.status===Ha.DISABLED))return!0;switch(this.errorCode){case PT.extensionError.code:return!0;default:return!1}},t.createError=function(o,n,r){if(r&&r.status)switch(r.status){case Ha.ACCOUNT_UNAVAILABLE:return Gt.createNativeAccountUnavailableError();case Ha.USER_INTERACTION_REQUIRED:return new Gt(o,n);case Ha.USER_CANCEL:return F.createUserCancelledError();case Ha.NO_NETWORK:return F.createNoNetworkConnectivityError()}return new t(o,n,r)},t.createUserSwitchError=function(){return new t(PT.userSwitch.code,PT.userSwitch.desc)},t}(Z);var ii=function(e){et(t,e);function t(o,n,r,i,a,s,c,l,u,p,m){var f=e.call(this,o,n,r,i,a,s,l,u,m)||this;return f.apiId=c,f.accountId=p,f.nativeMessageHandler=u,f}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c;return L(this,function(l){switch(l.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),n=this.performanceClient.startMeasurement(gt.NativeInteractionClientAcquireToken,o.correlationId),[4,this.initializeNativeRequest(o)];case 1:return r=l.sent(),i={method:Pr.GetToken,request:r},a=Yt.nowSeconds(),[4,this.nativeMessageHandler.sendMessage(i)];case 2:return s=l.sent(),c=this.validateNativeResponse(s),[2,this.handleNativeResponse(c,r,a).then(function(u){return n.endMeasurement({success:!0,isNativeBroker:!0}),u}).catch(function(u){throw n.endMeasurement({success:!1,errorCode:u.errorCode,subErrorCode:u.subError,isNativeBroker:!0}),u})]}})})},t.prototype.acquireTokenRedirect=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c;return L(this,function(l){switch(l.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(o)];case 1:n=l.sent(),r={method:Pr.GetToken,request:n},l.label=2;case 2:return l.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(r)];case 3:return i=l.sent(),this.validateNativeResponse(i),[3,5];case 4:if(a=l.sent(),a instanceof ln&&a.isFatal())throw a;return[3,5];case 5:return this.browserStorage.setTemporaryCache(Qe.NATIVE_REQUEST,JSON.stringify(n),!0),s={apiId:tt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},c=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(o.redirectUri),[4,this.navigationClient.navigateExternal(c,s)];case 6:return l.sent(),[2]}})})},t.prototype.handleRedirectPromise=function(){return D(this,void 0,void 0,function(){var o,n,r,i,a,s;return L(this,function(c){switch(c.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(o=this.browserStorage.getCachedNativeRequest(),!o)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qe.NATIVE_REQUEST)),n={method:Pr.GetToken,request:o},r=Yt.nowSeconds(),c.label=1;case 1:return c.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(n)];case 2:return i=c.sent(),this.validateNativeResponse(i),a=this.handleNativeResponse(i,o,r),this.browserStorage.setInteractionInProgress(!1),[2,a];case 3:throw s=c.sent(),this.browserStorage.setInteractionInProgress(!1),s;case 4:return[2]}})})},t.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},t.prototype.handleNativeResponse=function(o,n,r){return D(this,void 0,void 0,function(){var i,a,s,c,l,u,p,m,f,h,_,g,v,x,E,O,k=this;return L(this,function(P){switch(P.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),o.account.id!==n.accountId)throw ln.createUserSwitchError();return i=new Ro(o.id_token||T.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(n.authority)];case 1:switch(a=P.sent(),s=a.getPreferredCache(),c=Tt.generateHomeAccountId(o.client_info||T.EMPTY_STRING,sn.Default,this.logger,this.browserCrypto,i),l=Tt.createAccount(o.client_info,c,i,void 0,void 0,void 0,s,o.account.id),this.browserStorage.setAccount(l),u=o.scopes?no.fromString(o.scopes):no.fromString(n.scopes),p=o.account.properties||{},m=p.UID||i.claims.oid||i.claims.sub||T.EMPTY_STRING,f=p.TenantId||i.claims.tid||T.EMPTY_STRING,_=Fe.BEARER,g=n.tokenType,g){case Fe.POP:return[3,2]}return[3,4];case 2:if(_=Fe.POP,o.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),h=o.shr,[3,5];if(v=new Ir(this.browserCrypto),x={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce},!n.keyId)throw W.createKeyIdMissingError();return[4,v.signPopToken(o.access_token,n.keyId,x)];case 3:return h=P.sent(),[3,5];case 4:h=o.access_token,P.label=5;case 5:return E=this.getMATSFromResponse(o),O={authority:a.canonicalAuthority,uniqueId:m,tenantId:f,scopes:u.asArray(),account:l.getAccountInfo(),idToken:o.id_token,idTokenClaims:i.claims,accessToken:h,fromCache:E?this.isResponseFromCache(E):!1,expiresOn:new Date(Number(r+o.expires_in)*1e3),tokenType:_,correlationId:this.correlationId,state:o.state,fromNativeBroker:!0},this.browserStorage.removeAccountContext(l).catch(function(Te){k.logger.error("Error occurred while removing account context from browser storage. "+Te)}),[2,O]}})})},t.prototype.validateNativeResponse=function(o){if(o.hasOwnProperty("access_token")&&o.hasOwnProperty("id_token")&&o.hasOwnProperty("client_info")&&o.hasOwnProperty("account")&&o.hasOwnProperty("scopes")&&o.hasOwnProperty("expires_in"))return o;throw ln.createUnexpectedError("Response missing expected properties.")},t.prototype.getMATSFromResponse=function(o){if(o.properties.MATS)try{return JSON.parse(o.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},t.prototype.isResponseFromCache=function(o){return typeof o.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!o.is_cached},t.prototype.initializeNativeRequest=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l,u,p,m=this;return L(this,function(f){switch(f.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),n=o.authority||this.config.auth.authority,r=new Ee(n),r.validateAsUri(),i=o&&o.scopes||[],a=new no(i),a.appendScopes(Ar),s=function(){switch(m.apiId){case tt.ssoSilent:case tt.acquireTokenSilent_silentFlow:return m.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Lt.NONE}if(!o.prompt){m.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(o.prompt){case Lt.NONE:case Lt.CONSENT:case Lt.LOGIN:return m.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),o.prompt;default:throw m.logger.trace("initializeNativeRequest: prompt = "+o.prompt+" is not compatible with native flow"),F.createNativePromptParameterNotSupportedError()}},c=oe(oe({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scopes:a.printScopes(),redirectUri:this.getRedirectUri(o.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:o.authenticationScheme,windowTitleSubstring:document.title,extraParameters:oe(oe(oe({},o.extraQueryParameters),o.tokenQueryParameters),{telemetry:bc.MATS_TELEMETRY}),extendedExpiryToken:!1}),o.authenticationScheme!==Fe.POP?[3,2]:(l={resourceRequestUri:o.resourceRequestUri,resourceRequestMethod:o.resourceRequestMethod,shrClaims:o.shrClaims,shrNonce:o.shrNonce},u=new Ir(this.browserCrypto),[4,u.generateCnf(l)]);case 1:p=f.sent(),c.reqCnf=p.reqCnfHash,c.keyId=p.kid,f.label=2;case 2:return[2,c]}})})},t}(Vh);var er=function(){function e(t,o,n){this.logger=t,this.handshakeTimeoutMs=o,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return e.prototype.sendMessage=function(t){return D(this,void 0,void 0,function(){var o,n=this;return L(this,function(r){return this.logger.trace("NativeMessageHandler - sendMessage called."),o={channel:bc.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:t},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(o)),this.messageChannel.port1.postMessage(o),[2,new Promise(function(i,a){n.resolvers.set(o.responseId,{resolve:i,reject:a})})]})})},e.createProvider=function(t,o){return D(this,void 0,void 0,function(){var n,r;return L(this,function(i){switch(i.label){case 0:t.trace("NativeMessageHandler - createProvider called."),i.label=1;case 1:return i.trys.push([1,3,,5]),n=new e(t,o,bc.PREFERRED_EXTENSION_ID),[4,n.sendHandshakeRequest()];case 2:return i.sent(),[2,n];case 3:return i.sent(),r=new e(t,o),[4,r.sendHandshakeRequest()];case 4:return i.sent(),[2,r];case 5:return[2]}})})},e.prototype.sendHandshakeRequest=function(){return D(this,void 0,void 0,function(){var t,o=this;return L(this,function(n){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),t={channel:bc.CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:Pr.HandshakeRequest}},this.messageChannel.port1.onmessage=function(r){o.onChannelMessage(r)},window.postMessage(t,window.origin,[this.messageChannel.port2]),[2,new Promise(function(r,i){o.handshakeResolvers.set(t.responseId,{resolve:r,reject:i}),o.timeoutId=window.setTimeout(function(){window.removeEventListener("message",o.windowListener,!1),o.messageChannel.port1.close(),o.messageChannel.port2.close(),i(F.createNativeHandshakeTimeoutError()),o.handshakeResolvers.delete(t.responseId)},o.handshakeTimeoutMs)})]})})},e.prototype.onWindowMessage=function(t){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),t.source===window){var o=t.data;if(!(!o.channel||o.channel!==bc.CHANNEL_ID)&&!(o.extensionId&&o.extensionId!==this.extensionId)&&o.body.method===Pr.HandshakeRequest){this.logger.verbose(o.extensionId?"Extension with id: "+o.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var n=this.handshakeResolvers.get(o.responseId);n&&n.reject(F.createNativeExtensionNotInstalledError())}}},e.prototype.onChannelMessage=function(t){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var o=t.data,n=this.resolvers.get(o.responseId),r=this.handshakeResolvers.get(o.responseId);try{var i=o.body.method;if(i===Pr.Response){if(!n)return;var a=o.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(a)),a.status!=="Success")n.reject(ln.createError(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?n.reject(ln.createError(a.result.code,a.result.description,a.result.ext)):n.resolve(a.result);else throw Z.createUnexpectedError("Event does not contain result.");this.resolvers.delete(o.responseId)}else if(i===Pr.HandshakeResponse){if(!r)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=o.extensionId,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),r.resolve(),this.handshakeResolvers.delete(o.responseId)}}catch(s){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+s.toString()),this.logger.errorPii("Unable to parse "+t),n?n.reject(s):r&&r.reject(s)}},e.isNativeAvailable=function(t,o,n,r){if(o.trace("isNativeAvailable called"),!t.system.allowNativeBroker)return o.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return o.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case Fe.BEARER:case Fe.POP:return o.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return o.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},e}();var QU=function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l,u,p,m=this;return L(this,function(f){switch(f.label){case 0:return[4,this.initializeAuthorizationRequest(o,ne.Redirect)];case 1:n=f.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||T.EMPTY_STRING,n.account||null),r=this.initializeServerTelemetryManager(tt.acquireTokenRedirect),i=function(h){h.persisted&&(m.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),m.browserStorage.cleanRequestByState(n.state))},f.label=2;case 2:return f.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(n)];case 3:return a=f.sent(),[4,this.createAuthCodeClient(r,n.authority,n.azureCloudOptions)];case 4:return s=f.sent(),this.logger.verbose("Auth code client created"),c=new IT(s,this.browserStorage,a,this.logger,this.browserCrypto),[4,s.getAuthCodeUrl(oe(oe({},n),{nativeBroker:er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme)}))];case 5:return l=f.sent(),u=this.getRedirectStartPage(o.redirectStartPage),this.logger.verbosePii("Redirect start page: "+u),window.addEventListener("pageshow",i),[4,c.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:o.onRedirectNavigate})];case 6:return[2,f.sent()];case 7:throw p=f.sent(),p instanceof Z&&p.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",i),r.cacheFailedRequest(p),this.browserStorage.cleanRequestByState(n.state),p;case 8:return[2]}})})},t.prototype.handleRedirectPromise=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l,u,p,m,f,h;return L(this,function(_){switch(_.label){case 0:n=this.initializeServerTelemetryManager(tt.handleRedirectPromise),_.label=1;case 1:if(_.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(r=this.getRedirectResponseHash(o||window.location.hash),!r)return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),[2,null];i=void 0;try{a=Ee.getDeserializedHash(r),i=this.validateAndExtractStateFromHash(a,ne.Redirect),this.logger.verbose("State extracted from hash")}catch(g){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+g),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),[2,null]}return s=this.browserStorage.getTemporaryCache(Qe.ORIGIN_URI,!0)||T.EMPTY_STRING,c=Ee.removeHashFromUrl(s),l=Ee.removeHashFromUrl(window.location.href),c===l&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,i,n)]):[3,3];case 2:return u=_.sent(),s.indexOf("#")>-1&&ft.replaceHash(s),[2,u];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,i,n)]);case 4:return!ft.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(Qe.URL_HASH,r,!0),p={apiId:tt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},m=!0,!s||s==="null"?(f=ft.getHomepage(),this.browserStorage.setTemporaryCache(Qe.ORIGIN_URI,f,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(f,p)]):[3,6]):[3,9];case 5:return m=_.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+s),[4,this.navigationClient.navigateInternal(s,p)];case 7:m=_.sent(),_.label=8;case 8:if(!m)return[2,this.handleHash(r,i,n)];_.label=9;case 9:return[2,null];case 10:throw h=_.sent(),h instanceof Z&&h.setCorrelationId(this.correlationId),n.cacheFailedRequest(h),this.browserStorage.cleanRequestByInteractionType(ne.Redirect),h;case 11:return[2]}})})},t.prototype.getRedirectResponseHash=function(o){this.logger.verbose("getRedirectResponseHash called");var n=Ee.hashContainsKnownProperties(o);if(n)return ft.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),o;var r=this.browserStorage.getTemporaryCache(Qe.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Qe.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),r},t.prototype.handleHash=function(o,n,r){return D(this,void 0,void 0,function(){var i,a,s,c,l,u,p,m=this;return L(this,function(f){switch(f.label){case 0:if(i=this.browserStorage.getCachedRequest(n,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),a=Ee.getDeserializedHash(o),a.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F.createNativeConnectionNotEstablishedError();return s=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,a.accountId,i.correlationId),c=No.parseRequestState(this.browserCrypto,n).userRequestState,[2,s.acquireToken(oe(oe({},i),{state:c,prompt:void 0})).finally(function(){m.browserStorage.cleanRequestByState(n)})]}if(l=this.browserStorage.getCachedAuthority(n),!l)throw F.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,l)];case 1:return u=f.sent(),this.logger.verbose("Auth code client created"),Ra.removeThrottle(this.browserStorage,this.config.auth.clientId,i),p=new IT(u,this.browserStorage,i,this.logger,this.browserCrypto),[4,p.handleCodeResponseFromHash(o,n,u.authority,this.networkClient)];case 2:return[2,f.sent()]}})})},t.prototype.logout=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l;return L(this,function(u){switch(u.label){case 0:this.logger.verbose("logoutRedirect called"),n=this.initializeLogoutRequest(o),r=this.initializeServerTelemetryManager(tt.logout),u.label=1;case 1:return u.trys.push([1,10,,11]),this.eventHandler.emitEvent(xe.LOGOUT_START,ne.Redirect,o),[4,this.clearCacheOnLogout(n.account)];case 2:return u.sent(),i={apiId:tt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,o&&o.authority)];case 3:return a=u.sent(),this.logger.verbose("Auth code client created"),s=a.getLogoutUri(n),this.eventHandler.emitEvent(xe.LOGOUT_SUCCESS,ne.Redirect,n),o&&typeof o.onRedirectNavigate=="function"?(c=o.onRedirectNavigate(s),c===!1?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(s,i)])):[3,7];case 4:return u.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),u.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(s,i)];case 8:return u.sent(),[2];case 9:return[3,11];case 10:throw l=u.sent(),l instanceof Z&&l.setCorrelationId(this.correlationId),r.cacheFailedRequest(l),this.eventHandler.emitEvent(xe.LOGOUT_FAILURE,ne.Redirect,null,l),this.eventHandler.emitEvent(xe.LOGOUT_END,ne.Redirect),l;case 11:return this.eventHandler.emitEvent(xe.LOGOUT_END,ne.Redirect),[2]}})})},t.prototype.getRedirectStartPage=function(o){var n=o||window.location.href;return Ee.getAbsoluteUrl(n,ft.getCurrentUri())},t}(Zn);var XU=function(e){et(t,e);function t(o,n,r,i,a,s,c,l,u){var p=e.call(this,o,n,r,i,a,s,c,l,u)||this;return p.unloadWindow=p.unloadWindow.bind(p),p}return t.prototype.acquireToken=function(o){try{var n=this.generatePopupName(o.scopes||Ar,o.authority||this.config.auth.authority),r=o.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(o,n,r);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var i=this.openSizedPopup("about:blank",n,r);return this.acquireTokenPopupAsync(o,n,r,i)}catch(a){return Promise.reject(a)}},t.prototype.logout=function(o){try{this.logger.verbose("logoutPopup called");var n=this.initializeLogoutRequest(o),r=this.generateLogoutPopupName(n),i=o&&o.authority,a=o&&o.mainWindowRedirectUri,s=o?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,s,i,void 0,a);this.logger.verbose("asyncPopup set to false, opening popup");var c=this.openSizedPopup("about:blank",r,s);return this.logoutPopupAsync(n,r,s,i,c,a)}catch(l){return Promise.reject(l)}},t.prototype.acquireTokenPopupAsync=function(o,n,r,i){return D(this,void 0,void 0,function(){var a,s,c,l,u,p,m,f,h,_,g,v,x,E,O,k,P,Te=this;return L(this,function(Se){switch(Se.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),a=this.initializeServerTelemetryManager(tt.acquireTokenPopup),[4,this.initializeAuthorizationRequest(o,ne.Popup)];case 1:s=Se.sent(),this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority,s.loginHint||T.EMPTY_STRING,s.account||null),Se.label=2;case 2:return Se.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(s)];case 3:return c=Se.sent(),[4,this.createAuthCodeClient(a,s.authority,s.azureCloudOptions)];case 4:return l=Se.sent(),this.logger.verbose("Auth code client created"),u=er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,o.authenticationScheme),p=void 0,u&&(p=this.performanceClient.startMeasurement(gt.FetchAccountIdWithNativeBroker,o.correlationId)),[4,l.getAuthCodeUrl(oe(oe({},s),{nativeBroker:u}))];case 5:return m=Se.sent(),f=new cu(l,this.browserStorage,c,this.logger),h={popup:i,popupName:n,popupWindowAttributes:r},_=this.initiateAuthRequest(m,h),this.eventHandler.emitEvent(xe.POPUP_OPENED,ne.Popup,{popupWindow:_},null),[4,this.monitorPopupForHash(_)];case 6:if(g=Se.sent(),v=Ee.getDeserializedHash(g),x=this.validateAndExtractStateFromHash(v,ne.Popup,s.correlationId),Ra.removeThrottle(this.browserStorage,this.config.auth.clientId,c),v.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),p&&p.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw F.createNativeConnectionNotEstablishedError();return E=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,v.accountId,s.correlationId),O=No.parseRequestState(this.browserCrypto,x).userRequestState,[2,E.acquireToken(oe(oe({},s),{state:O,prompt:void 0})).finally(function(){Te.browserStorage.cleanRequestByState(x)})]}return[4,f.handleCodeResponseFromHash(g,x,l.authority,this.networkClient)];case 7:return k=Se.sent(),[2,k];case 8:throw P=Se.sent(),i&&i.close(),P instanceof Z&&P.setCorrelationId(this.correlationId),a.cacheFailedRequest(P),this.browserStorage.cleanRequestByState(s.state),P;case 9:return[2]}})})},t.prototype.logoutPopupAsync=function(o,n,r,i,a,s){return D(this,void 0,void 0,function(){var c,l,u,p,m,f,h;return L(this,function(_){switch(_.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(xe.LOGOUT_START,ne.Popup,o),c=this.initializeServerTelemetryManager(tt.logoutPopup),_.label=1;case 1:return _.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(o.account)];case 2:return _.sent(),[4,this.createAuthCodeClient(c,i)];case 3:return l=_.sent(),this.logger.verbose("Auth code client created"),u=l.getLogoutUri(o),this.eventHandler.emitEvent(xe.LOGOUT_SUCCESS,ne.Popup,o),p=this.openPopup(u,{popupName:n,popupWindowAttributes:r,popup:a}),this.eventHandler.emitEvent(xe.POPUP_OPENED,ne.Popup,{popupWindow:p},null),[4,this.waitForLogoutPopup(p)];case 4:return _.sent(),s?(m={apiId:tt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},f=Ee.getAbsoluteUrl(s,ft.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+f),this.navigationClient.navigateInternal(f,m)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw h=_.sent(),a&&a.close(),h instanceof Z&&h.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(xe.LOGOUT_FAILURE,ne.Popup,null,h),this.eventHandler.emitEvent(xe.LOGOUT_END,ne.Popup),c.cacheFailedRequest(h),h;case 6:return this.eventHandler.emitEvent(xe.LOGOUT_END,ne.Popup),[2]}})})},t.prototype.initiateAuthRequest=function(o,n){if(z.isEmpty(o))throw this.logger.error("Navigate url is empty"),F.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+o),this.openPopup(o,n)},t.prototype.monitorPopupForHash=function(o){var n=this;return new Promise(function(r,i){var a=n.config.system.windowHashTimeout/Vt.POLL_INTERVAL_MS,s=0;n.logger.verbose("PopupHandler.monitorPopupForHash - polling started");var c=setInterval(function(){if(o.closed){n.logger.error("PopupHandler.monitorPopupForHash - window closed"),n.cleanPopup(),clearInterval(c),i(F.createUserCancelledError());return}var l=T.EMPTY_STRING,u=T.EMPTY_STRING;try{l=o.location.href,u=o.location.hash}catch{}z.isEmpty(l)||l==="about:blank"||(n.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),s++,u?(n.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(c),n.cleanPopup(o),Ee.hashContainsKnownProperties(u)?(n.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),r(u)):(n.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),n.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+u),i(F.createHashDoesNotContainKnownPropertiesError()))):s>a&&(n.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(c),i(F.createMonitorPopupTimeoutError())))},Vt.POLL_INTERVAL_MS)})},t.prototype.waitForLogoutPopup=function(o){var n=this;return new Promise(function(r){n.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var i=setInterval(function(){o.closed&&(n.logger.error("PopupHandler.waitForLogoutPopup - window closed"),n.cleanPopup(),clearInterval(i),r());var a=T.EMPTY_STRING;try{a=o.location.href}catch{}z.isEmpty(a)||a==="about:blank"||(n.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(i),n.cleanPopup(o),r())},Vt.POLL_INTERVAL_MS)})},t.prototype.openPopup=function(o,n){try{var r=void 0;if(n.popup?(r=n.popup,this.logger.verbosePii("Navigating popup window to: "+o),r.location.assign(o)):typeof n.popup>"u"&&(this.logger.verbosePii("Opening popup window to: "+o),r=this.openSizedPopup(o,n.popupName,n.popupWindowAttributes)),!r)throw F.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),F.createPopupWindowError(i.toString())}},t.prototype.openSizedPopup=function(o,n,r){var i,a,s,c,l=window.screenLeft?window.screenLeft:window.screenX,u=window.screenTop?window.screenTop:window.screenY,p=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,m=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,f=(i=r.popupSize)===null||i===void 0?void 0:i.width,h=(a=r.popupSize)===null||a===void 0?void 0:a.height,_=(s=r.popupPosition)===null||s===void 0?void 0:s.top,g=(c=r.popupPosition)===null||c===void 0?void 0:c.left;return(!f||f<0||f>p)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),f=Vt.POPUP_WIDTH),(!h||h<0||h>m)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),h=Vt.POPUP_HEIGHT),(!_||_<0||_>m)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),_=Math.max(0,m/2-Vt.POPUP_HEIGHT/2+u)),(!g||g<0||g>p)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,p/2-Vt.POPUP_WIDTH/2+l)),window.open(o,n,"width="+f+", height="+h+", top="+_+", left="+g+", scrollbars=yes")},t.prototype.unloadWindow=function(o){this.browserStorage.cleanRequestByInteractionType(ne.Popup),this.currentWindow&&this.currentWindow.close(),o.preventDefault()},t.prototype.cleanPopup=function(o){o&&o.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},t.prototype.generatePopupName=function(o,n){return Vt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+o.join("-")+"."+n+"."+this.correlationId},t.prototype.generateLogoutPopupName=function(o){var n=o.account&&o.account.homeAccountId;return Vt.POPUP_NAME_PREFIX+"."+this.config.auth.clientId+"."+n+"."+this.correlationId},t}(Zn);var JU=function(){function e(){}return e.prototype.navigateInternal=function(t,o){return e.defaultNavigateWindow(t,o)},e.prototype.navigateExternal=function(t,o){return e.defaultNavigateWindow(t,o)},e.defaultNavigateWindow=function(t,o){return o.noHistory?window.location.replace(t):window.location.assign(t),new Promise(function(n){setTimeout(function(){n(!0)},o.timeout)})},e}();var R6=6e4,jh=6e3,N6=3e4,D6=2e3;function ZU(e,t){var o=e.auth,n=e.cache,r=e.system,i=e.telemetry,a={clientId:T.EMPTY_STRING,authority:""+T.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:T.EMPTY_STRING,authorityMetadata:T.EMPTY_STRING,redirectUri:T.EMPTY_STRING,postLogoutRedirectUri:T.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Oa.AAD,azureCloudOptions:{azureCloudInstance:ri.None,tenant:T.EMPTY_STRING},skipAuthorityMetadataCache:!1},s={cacheLocation:ro.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},c={loggerCallback:function(){},logLevel:vt.Info,piiLoggingEnabled:!1},l=oe(oe({},Hh),{loggerOptions:c,networkClient:t?ft.getBrowserNetworkClient():yT,navigationClient:new JU,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||R6,iframeHashTimeout:r?.loadFrameTimeout||jh,navigateFrameWait:t&&ft.detectIEOrEdge()?500:0,redirectNavigationTimeout:N6,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||D6}),u={application:{appName:T.EMPTY_STRING,appVersion:T.EMPTY_STRING}},p={auth:oe(oe({},a),o),cache:oe(oe({},s),n),system:oe(oe({},l),r),telemetry:oe(oe({},u),i)};return p}var Wh=function(e){et(t,e);function t(o,n,r,i,a){var s=e.call(this,o,n,r,i)||this;return s.navigateFrameWait=a,s}return t.prototype.initiateAuthRequest=function(o){return D(this,void 0,void 0,function(){var n;return L(this,function(r){switch(r.label){case 0:if(z.isEmpty(o))throw this.logger.info("Navigate url is empty"),F.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(o)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=this.loadFrameSync(o),r.label=3;case 3:return[2,n]}})})},t.prototype.monitorIframeForHash=function(o,n){var r=this;return new Promise(function(i,a){n<jh&&r.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+n+"ms) than the default ("+jh+"ms). This may result in timeouts.");var s=window.performance.now(),c=s+n,l=setInterval(function(){if(window.performance.now()>c){r.removeHiddenIframe(o),clearInterval(l),a(F.createMonitorIframeTimeoutError());return}var u=T.EMPTY_STRING,p=o.contentWindow;try{u=p?p.location.href:T.EMPTY_STRING}catch{}if(!z.isEmpty(u)){var m=p?p.location.hash:T.EMPTY_STRING;if(Ee.hashContainsKnownProperties(m)){r.removeHiddenIframe(o),clearInterval(l),i(m);return}}},Vt.POLL_INTERVAL_MS)})},t.prototype.loadFrame=function(o){var n=this;return new Promise(function(r,i){var a=n.createHiddenIframe();setTimeout(function(){if(!a){i("Unable to load iframe");return}a.src=o,r(a)},n.navigateFrameWait)})},t.prototype.loadFrameSync=function(o){var n=this.createHiddenIframe();return n.src=o,n},t.prototype.createHiddenIframe=function(){var o=document.createElement("iframe");return o.style.visibility="hidden",o.style.position="absolute",o.style.width=o.style.height="0",o.style.border="0",o.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(o),o},t.prototype.removeHiddenIframe=function(o){document.body===o.parentNode&&document.body.removeChild(o)},t}(cu);var e$=function(e){et(t,e);function t(o,n,r,i,a,s,c,l,u,p){var m=e.call(this,o,n,r,i,a,s,l,u,p)||this;return m.apiId=c,m}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s;return L(this,function(c){switch(c.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),n=this.performanceClient.startMeasurement(gt.SilentIframeClientAcquireToken,o.correlationId),z.isEmpty(o.loginHint)&&z.isEmpty(o.sid)&&(!o.account||z.isEmpty(o.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),o.prompt&&o.prompt!==Lt.NONE)throw n.endMeasurement({success:!1}),F.createSilentPromptValueError(o.prompt);return[4,this.initializeAuthorizationRequest(oe(oe({},o),{prompt:Lt.NONE}),ne.Silent)];case 1:r=c.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||T.EMPTY_STRING,r.account||null),i=this.initializeServerTelemetryManager(this.apiId),c.label=2;case 2:return c.trys.push([2,5,,6]),[4,this.createAuthCodeClient(i,r.authority,r.azureCloudOptions)];case 3:return a=c.sent(),this.logger.verbose("Auth code client created"),[4,this.silentTokenHelper(a,r).then(function(l){return n.endMeasurement({success:!0,fromCache:!1}),l})];case 4:return[2,c.sent()];case 5:throw s=c.sent(),s instanceof Z&&s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s),this.browserStorage.cleanRequestByState(r.state),n.endMeasurement({errorCode:s instanceof Z&&s.errorCode||void 0,subErrorCode:s instanceof Z&&s.subError||void 0,success:!1}),s;case 6:return[2]}})})},t.prototype.logout=function(){return Promise.reject(F.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(o,n){return D(this,void 0,void 0,function(){var r,i,a,s,c,l,u,p,m,f=this;return L(this,function(h){switch(h.label){case 0:return[4,this.initializeAuthorizationCodeRequest(n)];case 1:return r=h.sent(),[4,o.getAuthCodeUrl(oe(oe({},n),{nativeBroker:er.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)}))];case 2:return i=h.sent(),a=new Wh(o,this.browserStorage,r,this.logger,this.config.system.navigateFrameWait),[4,a.initiateAuthRequest(i)];case 3:return s=h.sent(),[4,a.monitorIframeForHash(s,this.config.system.iframeHashTimeout)];case 4:if(c=h.sent(),l=Ee.getDeserializedHash(c),u=this.validateAndExtractStateFromHash(l,ne.Silent,r.correlationId),l.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F.createNativeConnectionNotEstablishedError();return p=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,l.accountId,this.correlationId),m=No.parseRequestState(this.browserCrypto,u).userRequestState,[2,p.acquireToken(oe(oe({},n),{state:m,prompt:Lt.NONE})).finally(function(){f.browserStorage.cleanRequestByState(u)})]}return[2,a.handleCodeResponseFromHash(c,u,o.authority,this.networkClient)]}})})},t}(Zn);var t$=function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s;return L(this,function(c){switch(c.label){case 0:return n=this.performanceClient.startMeasurement(gt.SilentCacheClientAcquireToken,o.correlationId),r=this.initializeServerTelemetryManager(tt.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(r,o.authority,o.azureCloudOptions)];case 1:i=c.sent(),this.logger.verbose("Silent auth client created"),c.label=2;case 2:return c.trys.push([2,4,,5]),[4,i.acquireCachedToken(o)];case 3:return a=c.sent(),n.endMeasurement({success:!0,fromCache:!0}),[2,a];case 4:throw s=c.sent(),s instanceof F&&s.errorCode===B.signingKeyNotFoundInStorage.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),n.endMeasurement({errorCode:s instanceof Z&&s.errorCode||void 0,subErrorCode:s instanceof Z&&s.subError||void 0,success:!1}),s;case 5:return[2]}})})},t.prototype.logout=function(){return Promise.reject(F.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(o,n,r){return D(this,void 0,void 0,function(){var i;return L(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(o,n,r)];case 1:return i=a.sent(),[2,new vT(i)]}})})},t.prototype.initializeSilentRequest=function(o,n){return D(this,void 0,void 0,function(){var r;return L(this,function(i){switch(i.label){case 0:return r=[oe({},o)],[4,this.initializeBaseRequest(o)];case 1:return[2,oe.apply(void 0,[oe.apply(void 0,r.concat([i.sent()])),{account:n,forceRefresh:o.forceRefresh||!1}])]}})})},t}(Zn);var o$=function(e){et(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c=this;return L(this,function(l){switch(l.label){case 0:return r=[oe({},o)],[4,this.initializeBaseRequest(o)];case 1:return n=oe.apply(void 0,r.concat([l.sent()])),i=this.performanceClient.startMeasurement(gt.SilentRefreshClientAcquireToken,n.correlationId),a=this.initializeServerTelemetryManager(tt.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(a,n.authority,n.azureCloudOptions)];case 2:return s=l.sent(),this.logger.verbose("Refresh token client created"),[2,s.acquireTokenByRefreshToken(n).then(function(u){return i.endMeasurement({success:!0,fromCache:u.fromCache}),u}).catch(function(u){throw u instanceof Z&&u.setCorrelationId(c.correlationId),a.cacheFailedRequest(u),i.endMeasurement({errorCode:u.errorCode,subErrorCode:u.subError,success:!1}),u})]}})})},t.prototype.logout=function(){return Promise.reject(F.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(o,n,r){return D(this,void 0,void 0,function(){var i;return L(this,function(a){switch(a.label){case 0:return[4,this.getClientConfiguration(o,n,r)];case 1:return i=a.sent(),[2,new Yp(i)]}})})},t}(Zn);var n$=function(){function e(t,o){this.eventCallbacks=new Map,this.logger=t,this.browserCrypto=o,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(t){if(typeof window<"u"){var o=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(o,t),this.logger.verbose("Event callback registered with id: "+o),o}return null},e.prototype.removeEventCallback=function(t){this.eventCallbacks.delete(t),this.logger.verbose("Event callback "+t+" removed.")},e.prototype.enableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(t,o,n,r){var i=this;if(typeof window<"u"){var a={eventType:t,interactionType:o||null,payload:n||null,error:r||null,timestamp:Date.now()};this.logger.info("Emitting event: "+t),this.eventCallbacks.forEach(function(s,c){i.logger.verbose("Emitting event to callback "+c+": "+t),s.apply(null,[a])})}},e.prototype.handleAccountCacheChange=function(t){try{var o=t.newValue||t.oldValue;if(!o)return;var n=JSON.parse(o);if(typeof n!="object"||!Tt.isAccountEntity(n))return;var r=cn.toObject(new Tt,n),i=r.getAccountInfo();!t.oldValue&&t.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(xe.ACCOUNT_ADDED,void 0,i)):!t.newValue&&t.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(xe.ACCOUNT_REMOVED,void 0,i))}catch{return}},e}();var Do=function(){function e(){}return e.decimalToHex=function(t){for(var o=t.toString(16);o.length<2;)o="0"+o;return o},e}();var Kh=function(){function e(t){this.cryptoObj=t}return e.prototype.generateGuid=function(){try{var t=new Uint8Array(16);return this.cryptoObj.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,Do.decimalToHex(t[0])+Do.decimalToHex(t[1])+Do.decimalToHex(t[2])+Do.decimalToHex(t[3])+"-"+Do.decimalToHex(t[4])+Do.decimalToHex(t[5])+"-"+Do.decimalToHex(t[6])+Do.decimalToHex(t[7])+"-"+Do.decimalToHex(t[8])+Do.decimalToHex(t[9])+"-"+Do.decimalToHex(t[10])+Do.decimalToHex(t[11])+Do.decimalToHex(t[12])+Do.decimalToHex(t[13])+Do.decimalToHex(t[14])+Do.decimalToHex(t[15])}catch{for(var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",r=0,i=T.EMPTY_STRING,a=0;a<36;a++)o[a]!=="-"&&o[a]!=="4"&&(r=Math.random()*16|0),o[a]==="x"?i+=n[r]:o[a]==="y"?(r&=3,r|=8,i+=n[r]):i+=o[a];return i}},e.prototype.isGuid=function(t){var o=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return o.test(t)},e}();var ai=function(){function e(){}return e.stringToUtf8Arr=function(t){for(var o,n=0,r=t.length,i=0;i<r;i++)o=t.charCodeAt(i),n+=o<128?1:o<2048?2:o<65536?3:o<2097152?4:o<67108864?5:6;for(var a=new Uint8Array(n),s=0,c=0;s<n;c++)o=t.charCodeAt(c),o<128?a[s++]=o:o<2048?(a[s++]=192+(o>>>6),a[s++]=128+(o&63)):o<65536?(a[s++]=224+(o>>>12),a[s++]=128+(o>>>6&63),a[s++]=128+(o&63)):o<2097152?(a[s++]=240+(o>>>18),a[s++]=128+(o>>>12&63),a[s++]=128+(o>>>6&63),a[s++]=128+(o&63)):o<67108864?(a[s++]=248+(o>>>24),a[s++]=128+(o>>>18&63),a[s++]=128+(o>>>12&63),a[s++]=128+(o>>>6&63),a[s++]=128+(o&63)):(a[s++]=252+(o>>>30),a[s++]=128+(o>>>24&63),a[s++]=128+(o>>>18&63),a[s++]=128+(o>>>12&63),a[s++]=128+(o>>>6&63),a[s++]=128+(o&63));return a},e.stringToArrayBuffer=function(t){for(var o=new ArrayBuffer(t.length),n=new Uint8Array(o),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return o},e.utf8ArrToString=function(t){for(var o=T.EMPTY_STRING,n=void 0,r=t.length,i=0;i<r;i++)n=t[i],o+=String.fromCharCode(n>251&&n<254&&i+5<r?(n-252)*1073741824+(t[++i]-128<<24)+(t[++i]-128<<18)+(t[++i]-128<<12)+(t[++i]-128<<6)+t[++i]-128:n>247&&n<252&&i+4<r?(n-248<<24)+(t[++i]-128<<18)+(t[++i]-128<<12)+(t[++i]-128<<6)+t[++i]-128:n>239&&n<248&&i+3<r?(n-240<<18)+(t[++i]-128<<12)+(t[++i]-128<<6)+t[++i]-128:n>223&&n<240&&i+2<r?(n-224<<12)+(t[++i]-128<<6)+t[++i]-128:n>191&&n<224&&i+1<r?(n-192<<6)+t[++i]-128:n);return o},e}();var Qh=function(){function e(){}return e.prototype.urlEncode=function(t){return encodeURIComponent(this.encode(t).replace(/=/g,T.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(t){return this.base64EncArr(t).replace(/=/g,T.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(t){var o=ai.stringToUtf8Arr(t);return this.base64EncArr(o)},e.prototype.base64EncArr=function(t){for(var o=(3-t.length%3)%3,n=T.EMPTY_STRING,r=void 0,i=t.length,a=0,s=0;s<i;s++)r=s%3,a|=t[s]<<(16>>>r&24),(r===2||t.length-s===1)&&(n+=String.fromCharCode(this.uint6ToB64(a>>>18&63),this.uint6ToB64(a>>>12&63),this.uint6ToB64(a>>>6&63),this.uint6ToB64(a&63)),a=0);return o===0?n:n.substring(0,n.length-o)+(o===1?"=":"==")},e.prototype.uint6ToB64=function(t){return t<26?t+65:t<52?t+71:t<62?t-4:t===62?43:t===63?47:65},e}();var r$=function(){function e(){}return e.prototype.decode=function(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("Invalid base64 string")}var n=this.base64DecToArr(o);return ai.utf8ArrToString(n)},e.prototype.base64DecToArr=function(t,o){for(var n=t.replace(/[^A-Za-z0-9\+\/]/g,T.EMPTY_STRING),r=n.length,i=o?Math.ceil((r*3+1>>>2)/o)*o:r*3+1>>>2,a=new Uint8Array(i),s=void 0,c=void 0,l=0,u=0,p=0;p<r;p++)if(c=p&3,l|=this.b64ToUint6(n.charCodeAt(p))<<18-6*c,c===3||r-p===1){for(s=0;s<3&&u<i;s++,u++)a[u]=l>>>(16>>>s&24)&255;l=0}return a},e.prototype.b64ToUint6=function(t){return t>64&&t<91?t-65:t>96&&t<123?t-71:t>47&&t<58?t+4:t===43?62:t===47?63:0},e}();var L6=32,i$=function(){function e(t){this.base64Encode=new Qh,this.cryptoObj=t}return e.prototype.generateCodes=function(){return D(this,void 0,void 0,function(){var t,o;return L(this,function(n){switch(n.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return o=n.sent(),[2,{verifier:t,challenge:o}]}})})},e.prototype.generateCodeVerifier=function(){try{var t=new Uint8Array(L6);this.cryptoObj.getRandomValues(t);var o=this.base64Encode.urlEncodeArr(t);return o}catch(n){throw F.createPkceNotGeneratedError(n)}},e.prototype.generateCodeChallengeFromVerifier=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(t)];case 1:return o=r.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(o))];case 2:throw n=r.sent(),F.createPkceNotGeneratedError(n);case 3:return[2]}})})},e}();var M6="RSASSA-PKCS1-v1_5",RT="SHA-256",O6=2048,U6=new Uint8Array([1,0,1]),lu=function(){function e(t){if(this.logger=t,!this.hasCryptoAPI())throw F.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:M6,hash:RT,modulusLength:O6,publicExponent:U6}}return e.prototype.sha256Digest=function(t){return D(this,void 0,void 0,function(){var o;return L(this,function(n){return o=ai.stringToUtf8Arr(t),[2,this.hasIECrypto()?this.getMSCryptoDigest(RT,o):this.getSubtleCryptoDigest(RT,o)]})})},e.prototype.getRandomValues=function(t){var o=window.msCrypto||window.crypto;if(!o.getRandomValues)throw F.createCryptoNotAvailableError("getRandomValues does not exist.");o.getRandomValues(t)},e.prototype.generateKeyPair=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(t,o):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,t,o)]})})},e.prototype.exportJwk=function(t){return D(this,void 0,void 0,function(){return L(this,function(o){return[2,this.hasIECrypto()?this.msCryptoExportJwk(t):window.crypto.subtle.exportKey(Vp,t)]})})},e.prototype.importJwk=function(t,o,n){return D(this,void 0,void 0,function(){var r,i;return L(this,function(a){return r=e.getJwkString(t),i=ai.stringToArrayBuffer(r),[2,this.hasIECrypto()?this.msCryptoImportKey(i,o,n):window.crypto.subtle.importKey(Vp,t,this._keygenAlgorithmOptions,o,n)]})})},e.prototype.sign=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,this.hasIECrypto()?this.msCryptoSign(t,o):window.crypto.subtle.sign(this._keygenAlgorithmOptions,t,o)]})})},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,window.crypto.subtle.digest(t,o)]})})},e.prototype.getMSCryptoDigest=function(t,o){return D(this,void 0,void 0,function(){return L(this,function(n){return[2,new Promise(function(r,i){var a=window.msCrypto.subtle.digest(t,o.buffer);a.addEventListener("complete",function(s){r(s.target.result)}),a.addEventListener("error",function(s){i(s)})})]})})},e.prototype.msCryptoGenerateKey=function(t,o){return D(this,void 0,void 0,function(){var n=this;return L(this,function(r){return[2,new Promise(function(i,a){var s=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,t,o);s.addEventListener("complete",function(c){i(c.target.result)}),s.addEventListener("error",function(c){a(c)})})]})})},e.prototype.msCryptoExportJwk=function(t){return D(this,void 0,void 0,function(){return L(this,function(o){return[2,new Promise(function(n,r){var i=window.msCrypto.subtle.exportKey(Vp,t);i.addEventListener("complete",function(a){var s=a.target.result,c=ai.utf8ArrToString(new Uint8Array(s)).replace(/\r/g,T.EMPTY_STRING).replace(/\n/g,T.EMPTY_STRING).replace(/\t/g,T.EMPTY_STRING).split(" ").join(T.EMPTY_STRING).replace("\0",T.EMPTY_STRING);try{n(JSON.parse(c))}catch(l){r(l)}}),i.addEventListener("error",function(a){r(a)})})]})})},e.prototype.msCryptoImportKey=function(t,o,n){return D(this,void 0,void 0,function(){var r=this;return L(this,function(i){return[2,new Promise(function(a,s){var c=window.msCrypto.subtle.importKey(Vp,t,r._keygenAlgorithmOptions,o,n);c.addEventListener("complete",function(l){a(l.target.result)}),c.addEventListener("error",function(l){s(l)})})]})})},e.prototype.msCryptoSign=function(t,o){return D(this,void 0,void 0,function(){var n=this;return L(this,function(r){return[2,new Promise(function(i,a){var s=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,t,o);s.addEventListener("complete",function(c){i(c.target.result)}),s.addEventListener("error",function(c){a(c)})})]})})},e.getJwkString=function(t){return JSON.stringify(t,Object.keys(t).sort())},e}();var a$=function(){function e(){this.dbName=jp,this.version=GU,this.tableName=VU,this.dbOpen=!1}return e.prototype.open=function(){return D(this,void 0,void 0,function(){var t=this;return L(this,function(o){return[2,new Promise(function(n,r){var i=window.indexedDB.open(t.dbName,t.version);i.addEventListener("upgradeneeded",function(a){var s=a;s.target.result.createObjectStore(t.tableName)}),i.addEventListener("success",function(a){var s=a;t.db=s.target.result,t.dbOpen=!0,n()}),i.addEventListener("error",function(){return r(F.createDatabaseUnavailableError())})})]})})},e.prototype.closeConnection=function(){var t=this.db;t&&this.dbOpen&&(t.close(),this.dbOpen=!1)},e.prototype.validateDbIsOpen=function(){return D(this,void 0,void 0,function(){return L(this,function(t){switch(t.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,t.sent()];case 2:return[2]}})})},e.prototype.getItem=function(t){return D(this,void 0,void 0,function(){var o=this;return L(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,i){if(!o.db)return i(F.createDatabaseNotOpenError());var a=o.db.transaction([o.tableName],"readonly"),s=a.objectStore(o.tableName),c=s.get(t);c.addEventListener("success",function(l){var u=l;o.closeConnection(),r(u.target.result)}),c.addEventListener("error",function(l){o.closeConnection(),i(l)})})]}})})},e.prototype.setItem=function(t,o){return D(this,void 0,void 0,function(){var n=this;return L(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(i,a){if(!n.db)return a(F.createDatabaseNotOpenError());var s=n.db.transaction([n.tableName],"readwrite"),c=s.objectStore(n.tableName),l=c.put(o,t);l.addEventListener("success",function(){n.closeConnection(),i()}),l.addEventListener("error",function(u){n.closeConnection(),a(u)})})]}})})},e.prototype.removeItem=function(t){return D(this,void 0,void 0,function(){var o=this;return L(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,i){if(!o.db)return i(F.createDatabaseNotOpenError());var a=o.db.transaction([o.tableName],"readwrite"),s=a.objectStore(o.tableName),c=s.delete(t);c.addEventListener("success",function(){o.closeConnection(),r()}),c.addEventListener("error",function(l){o.closeConnection(),i(l)})})]}})})},e.prototype.getKeys=function(){return D(this,void 0,void 0,function(){var t=this;return L(this,function(o){switch(o.label){case 0:return[4,this.validateDbIsOpen()];case 1:return o.sent(),[2,new Promise(function(n,r){if(!t.db)return r(F.createDatabaseNotOpenError());var i=t.db.transaction([t.tableName],"readonly"),a=i.objectStore(t.tableName),s=a.getAllKeys();s.addEventListener("success",function(c){var l=c;t.closeConnection(),n(l.target.result)}),s.addEventListener("error",function(c){t.closeConnection(),r(c)})})]}})})},e.prototype.containsKey=function(t){return D(this,void 0,void 0,function(){var o=this;return L(this,function(n){switch(n.label){case 0:return[4,this.validateDbIsOpen()];case 1:return n.sent(),[2,new Promise(function(r,i){if(!o.db)return i(F.createDatabaseNotOpenError());var a=o.db.transaction([o.tableName],"readonly"),s=a.objectStore(o.tableName),c=s.count(t);c.addEventListener("success",function(l){var u=l;o.closeConnection(),r(u.target.result===1)}),c.addEventListener("error",function(l){o.closeConnection(),i(l)})})]}})})},e.prototype.deleteDatabase=function(){return D(this,void 0,void 0,function(){var t,o;return L(this,function(n){switch(n.label){case 0:return this.db&&this.dbOpen&&this.closeConnection(),[4,window.indexedDB.databases()];case 1:return t=n.sent(),o=t.find(function(r){return r.name===jp}),o?[2,new Promise(function(r,i){var a=window.indexedDB.deleteDatabase(jp);a.addEventListener("success",function(){return r(!0)}),a.addEventListener("error",function(){return i(!1)})})]:[2,!0]}})})},e}();var NT=function(){function e(t,o){this.inMemoryCache=new Kp,this.indexedDBCache=new a$,this.logger=t,this.storeName=o}return e.prototype.handleDatabaseAccessError=function(t){if(t instanceof F&&t.errorCode===B.databaseUnavailable.code)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw t},e.prototype.getItem=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){switch(r.label){case 0:if(o=this.inMemoryCache.getItem(t),o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(t)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,o]}})})},e.prototype.setItem=function(t,o){return D(this,void 0,void 0,function(){var n;return L(this,function(r){switch(r.label){case 0:this.inMemoryCache.setItem(t,o),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(t,o)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2]}})})},e.prototype.removeItem=function(t){return D(this,void 0,void 0,function(){var o;return L(this,function(n){switch(n.label){case 0:this.inMemoryCache.removeItem(t),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(t)];case 2:return n.sent(),[3,4];case 3:return o=n.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2]}})})},e.prototype.getKeys=function(){return D(this,void 0,void 0,function(){var t,o;return L(this,function(n){switch(n.label){case 0:if(t=this.inMemoryCache.getKeys(),t.length!==0)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,n.sent()];case 3:return o=n.sent(),this.handleDatabaseAccessError(o),[3,4];case 4:return[2,t]}})})},e.prototype.containsKey=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){switch(r.label){case 0:if(o=this.inMemoryCache.containsKey(t),o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(t)];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handleDatabaseAccessError(n),[3,4];case 4:return[2,o]}})})},e.prototype.clear=function(){return D(this,void 0,void 0,function(){var t,o;return L(this,function(n){switch(n.label){case 0:this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted"),this.logger.verbose("Deleting persistent keystore "+this.storeName),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return t=n.sent(),t&&this.logger.verbose("Persistent keystore "+this.storeName+" deleted"),[2,t];case 3:return o=n.sent(),this.handleDatabaseAccessError(o),[2,!1];case 4:return[2]}})})},e}();var Xh;(function(e){e.asymmetricKeys="asymmetricKeys",e.symmetricKeys="symmetricKeys"})(Xh||(Xh={}));var s$=function(){function e(t,o){this.logger=t,this.browserCrypto=new lu(this.logger),this.b64Encode=new Qh,this.b64Decode=new r$,this.guidGenerator=new Kh(this.browserCrypto),this.pkceGenerator=new i$(this.browserCrypto),this.cache={asymmetricKeys:new NT(this.logger,Xh.asymmetricKeys),symmetricKeys:new NT(this.logger,Xh.symmetricKeys)},this.performanceClient=o}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(t){return this.b64Encode.encode(t)},e.prototype.base64Decode=function(t){return this.b64Decode.decode(t)},e.prototype.generatePkceCodes=function(){return D(this,void 0,void 0,function(){return L(this,function(t){return[2,this.pkceGenerator.generateCodes()]})})},e.prototype.getPublicKeyThumbprint=function(t){var o;return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l,u;return L(this,function(p){switch(p.label){case 0:return n=(o=this.performanceClient)===null||o===void 0?void 0:o.startMeasurement(gt.CryptoOptsGetPublicKeyThumbprint,t.correlationId),[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=p.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return i=p.sent(),a={e:i.e,kty:i.kty,n:i.n},s=lu.getJwkString(a),[4,this.hashString(s)];case 3:return c=p.sent(),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return l=p.sent(),[4,this.browserCrypto.importJwk(l,!1,["sign"])];case 5:return u=p.sent(),[4,this.cache.asymmetricKeys.setItem(c,{privateKey:u,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return p.sent(),n&&n.endMeasurement({success:!0}),[2,c]}})})},e.prototype.removeTokenBindingKey=function(t){return D(this,void 0,void 0,function(){var o;return L(this,function(n){switch(n.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(t)];case 1:return n.sent(),[4,this.cache.asymmetricKeys.containsKey(t)];case 2:return o=n.sent(),[2,!o]}})})},e.prototype.clearKeystore=function(){return D(this,void 0,void 0,function(){var t;return L(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),this.logger.verbose("Deleting in-memory and persistent asymmetric key stores"),[4,this.cache.asymmetricKeys.clear()];case 1:return o.sent(),this.logger.verbose("Successfully deleted asymmetric key stores"),this.logger.verbose("Deleting in-memory and persistent symmetric key stores"),[4,this.cache.symmetricKeys.clear()];case 2:return o.sent(),this.logger.verbose("Successfully deleted symmetric key stores"),[2,!0];case 3:return t=o.sent(),t instanceof Error?this.logger.error("Clearing keystore failed with error: "+t.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},e.prototype.signJwt=function(t,o,n){var r;return D(this,void 0,void 0,function(){var i,a,s,c,l,u,p,m,f,h,_,g,v;return L(this,function(x){switch(x.label){case 0:return i=(r=this.performanceClient)===null||r===void 0?void 0:r.startMeasurement(gt.CryptoOptsSignJwt,n),[4,this.cache.asymmetricKeys.getItem(o)];case 1:if(a=x.sent(),!a)throw F.createSigningKeyNotFoundInStorageError(o);return[4,this.browserCrypto.exportJwk(a.publicKey)];case 2:return s=x.sent(),c=lu.getJwkString(s),l=this.b64Encode.urlEncode(JSON.stringify({kid:o})),u=ST.getShrHeaderString({kid:l,alg:s.alg}),p=this.b64Encode.urlEncode(u),t.cnf={jwk:JSON.parse(c)},m=this.b64Encode.urlEncode(JSON.stringify(t)),f=p+"."+m,h=ai.stringToArrayBuffer(f),[4,this.browserCrypto.sign(a.privateKey,h)];case 3:return _=x.sent(),g=this.b64Encode.urlEncodeArr(new Uint8Array(_)),v=f+"."+g,i&&i.endMeasurement({success:!0}),[2,v]}})})},e.prototype.hashString=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){switch(r.label){case 0:return[4,this.browserCrypto.sha256Digest(t)];case 1:return o=r.sent(),n=new Uint8Array(o),[2,this.b64Encode.urlEncodeArr(n)]}})})},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e}();var c$=function(){function e(t,o,n,r){this.isBrowserEnvironment=typeof window<"u",this.config=t,this.storage=o,this.logger=n,this.cryptoObj=r}return e.prototype.loadExternalTokens=function(t,o,n){if(this.logger.info("TokenCache - loadExternalTokens called"),!o.id_token)throw F.createUnableToLoadTokenError("Please ensure server response includes id token.");if(t.account)this.loadIdToken(o.id_token,t.account.homeAccountId,t.account.environment,t.account.tenantId,n),this.loadAccessToken(t,o,t.account.homeAccountId,t.account.environment,t.account.tenantId,n);else if(t.authority){var r=Ua.generateAuthority(t.authority,t.azureCloudOptions),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=new Ua(r,this.config.system.networkClient,this.storage,i);if(n.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(o.id_token,n.clientInfo,a.hostnameAndPort,a.tenant,n),this.loadAccessToken(t,o,n.clientInfo,a.hostnameAndPort,a.tenant,n);else if(o.client_info)this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(o.id_token,o.client_info,a.hostnameAndPort,a.tenant,n),this.loadAccessToken(t,o,o.client_info,a.hostnameAndPort,a.tenant,n);else throw F.createUnableToLoadTokenError("Please provide clientInfo in the response or options.")}else throw F.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.")},e.prototype.loadIdToken=function(t,o,n,r,i){var a=Da.createIdTokenEntity(o,n,t,this.config.auth.clientId,r),s=new Ro(t,this.cryptoObj),c=i.clientInfo?Tt.createAccount(i.clientInfo,o,s,void 0,void 0,void 0,n):Tt.createGenericAccount(o,s,void 0,void 0,void 0,n);if(this.isBrowserEnvironment)this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(c),this.storage.setIdTokenCredential(a);else throw F.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e.prototype.loadAccessToken=function(t,o,n,r,i,a){if(!o.access_token){this.logger.verbose("TokenCache - No access token provided for caching");return}if(!o.expires_in)throw F.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!a.extendedExpiresOn)throw F.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var s=new no(t.scopes).printScopes(),c=a.expiresOn||o.expires_in+new Date().getTime()/1e3,l=a.extendedExpiresOn,u=La.createAccessTokenEntity(n,r,o.access_token,this.config.auth.clientId,i,s,c,l,this.cryptoObj);if(this.isBrowserEnvironment)this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u);else throw F.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},e}();var l$=function(e){et(t,e);function t(o){var n=e.call(this,o)||this;return n.includeRedirectUri=!1,n}return t}(Bp);var u$=function(e){et(t,e);function t(o,n,r,i,a,s,c,l,u,p){var m=e.call(this,o,n,r,i,a,s,l,u,p)||this;return m.apiId=c,m}return t.prototype.acquireToken=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l;return L(this,function(u){switch(u.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!o.code)throw F.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(o,ne.Silent)];case 1:n=u.sent(),this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||T.EMPTY_STRING,n.account||null),r=this.initializeServerTelemetryManager(this.apiId),u.label=2;case 2:return u.trys.push([2,4,,5]),i=oe(oe({},n),{code:o.code}),[4,this.getClientConfiguration(r,n.authority)];case 3:return a=u.sent(),s=new l$(a),this.logger.verbose("Auth code client created"),c=new Wh(s,this.browserStorage,i,this.logger,this.config.system.navigateFrameWait),[2,c.handleCodeResponseFromServer({code:o.code,msgraph_host:o.msGraphHost,cloud_graph_host_name:o.cloudGraphHostName,cloud_instance_host_name:o.cloudInstanceHostName},n.state,s.authority,this.networkClient,!1)];case 4:throw l=u.sent(),l instanceof Z&&l.setCorrelationId(this.correlationId),r.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(n.state),l;case 5:return[2]}})})},t.prototype.logout=function(){return Promise.reject(F.createSilentLogoutUnsupportedError())},t}(Zn);var d$=function(){function e(t,o){this.correlationId=o,this.measureName="msal.measure."+t+"."+this.correlationId,this.startMark="msal.start."+t+"."+this.correlationId,this.endMark="msal.end."+t+"."+this.correlationId}return e.supportsBrowserPerformance=function(){return typeof window<"u"&&typeof window.performance<"u"&&typeof window.performance.mark=="function"&&typeof window.performance.measure=="function"&&typeof window.performance.clearMarks=="function"&&typeof window.performance.clearMeasures=="function"&&typeof window.performance.getEntriesByName=="function"},e.prototype.startMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},e.prototype.endMeasurement=function(){if(e.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},e.prototype.flushMeasurement=function(){if(e.supportsBrowserPerformance())try{var t=window.performance.getEntriesByName(this.measureName,"measure");if(t.length>0){var o=t[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),o}}catch{}return null},e}();var p$=function(e){et(t,e);function t(o,n,r,i,a,s){var c=e.call(this,o,n,r,i,a,s)||this;return c.browserCrypto=new lu(c.logger),c.guidGenerator=new Kh(c.browserCrypto),c}return t.prototype.startPerformanceMeasuremeant=function(o,n){return new d$(o,n)},t.prototype.generateId=function(){return this.guidGenerator.generateGuid()},t.prototype.getPageVisibility=function(){var o;return((o=document.visibilityState)===null||o===void 0?void 0:o.toString())||null},t.prototype.startMeasurement=function(o,n){var r=this,i=this.getPageVisibility(),a=e.prototype.startMeasurement.call(this,o,n);return oe(oe({},a),{endMeasurement:function(s){return a.endMeasurement(oe({startPageVisibility:i,endPageVisibility:r.getPageVisibility()},s))}})},t}(Gp);var m$=function(){function e(t){this.isBrowserEnvironment=typeof window<"u",this.config=ZU(t,this.isBrowserEnvironment),this.initialized=!1,this.logger=new nu(this.config.system.loggerOptions,Gh,Fa),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new p$(this.config.auth.clientId,this.config.auth.authority,this.logger,Gh,Fa,this.config.telemetry.application):new wT(this.config.auth.clientId,this.config.auth.authority,this.logger,Gh,Fa,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new s$(this.logger,this.performanceClient):Ia,this.eventHandler=new n$(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new AT(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):jU(this.config.auth.clientId,this.logger),this.tokenCache=new c$(this.config,this.browserStorage,this.logger,this.browserCrypto)}return e.prototype.initialize=function(){return D(this,void 0,void 0,function(){var t,o;return L(this,function(n){switch(n.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(this.eventHandler.emitEvent(xe.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),t=this,[4,er.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return t.nativeExtensionProvider=n.sent(),[3,4];case 3:return o=n.sent(),this.logger.verbose(o),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(xe.INITIALIZE_END),[2]}})})},e.prototype.handleRedirectPromise=function(t){return D(this,void 0,void 0,function(){var o,n,r,i,a,s,c,l,u=this;return L(this,function(p){return this.logger.verbose("handleRedirectPromise called"),ft.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),o=this.getAllAccounts(),this.isBrowserEnvironment?(n=t||T.EMPTY_STRING,r=this.redirectResponse.get(n),typeof r>"u"?(this.eventHandler.emitEvent(xe.HANDLE_REDIRECT_START,ne.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),i=this.browserStorage.getCachedNativeRequest(),a=void 0,i&&er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!t?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),s=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,i.accountId,i.correlationId),a=s.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),c=this.browserStorage.getTemporaryCache(Qe.CORRELATION_ID,!0)||T.EMPTY_STRING,l=this.createRedirectClient(c),a=l.handleRedirectPromise(t)),r=a.then(function(m){if(m){var f=o.length<u.getAllAccounts().length;f?(u.eventHandler.emitEvent(xe.LOGIN_SUCCESS,ne.Redirect,m),u.logger.verbose("handleRedirectResponse returned result, login success")):(u.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_SUCCESS,ne.Redirect,m),u.logger.verbose("handleRedirectResponse returned result, acquire token success"))}return u.eventHandler.emitEvent(xe.HANDLE_REDIRECT_END,ne.Redirect),m}).catch(function(m){throw o.length>0?u.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_FAILURE,ne.Redirect,null,m):u.eventHandler.emitEvent(xe.LOGIN_FAILURE,ne.Redirect,null,m),u.eventHandler.emitEvent(xe.HANDLE_REDIRECT_END,ne.Redirect),m}),this.redirectResponse.set(n,r)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,r]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},e.prototype.acquireTokenRedirect=function(t){return D(this,void 0,void 0,function(){var o,n,r,i,a,s=this;return L(this,function(c){return o=this.getRequestCorrelationId(t),this.logger.verbose("acquireTokenRedirect called",o),this.preflightBrowserEnvironmentCheck(ne.Redirect),n=this.getAllAccounts().length>0,n?this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_START,ne.Redirect,t):this.eventHandler.emitEvent(xe.LOGIN_START,ne.Redirect,t),this.nativeExtensionProvider&&this.canUseNative(t)?(i=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(t),t.correlationId),r=i.acquireTokenRedirect(t).catch(function(l){if(l instanceof ln&&l.isFatal()){s.nativeExtensionProvider=void 0;var u=s.createRedirectClient(t.correlationId);return u.acquireToken(t)}else if(l instanceof Gt){s.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");var u=s.createRedirectClient(t.correlationId);return u.acquireToken(t)}throw s.browserStorage.setInteractionInProgress(!1),l})):(a=this.createRedirectClient(t.correlationId),r=a.acquireToken(t)),[2,r.catch(function(l){throw n?s.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_FAILURE,ne.Redirect,null,l):s.eventHandler.emitEvent(xe.LOGIN_FAILURE,ne.Redirect,null,l),l})]})})},e.prototype.acquireTokenPopup=function(t){var o=this,n=this.getRequestCorrelationId(t),r=this.performanceClient.startMeasurement(gt.AcquireTokenPopup,n);try{this.logger.verbose("acquireTokenPopup called",n),this.preflightBrowserEnvironmentCheck(ne.Popup)}catch(c){return Promise.reject(c)}var i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_START,ne.Popup,t):this.eventHandler.emitEvent(xe.LOGIN_START,ne.Popup,t);var a;if(this.canUseNative(t))a=this.acquireTokenNative(t,tt.acquireTokenPopup).then(function(c){return o.browserStorage.setInteractionInProgress(!1),r.endMeasurement({success:!0,isNativeBroker:!0}),r.flushMeasurement(),c}).catch(function(c){if(c instanceof ln&&c.isFatal()){o.nativeExtensionProvider=void 0;var l=o.createPopupClient(t.correlationId);return l.acquireToken(t)}else if(c instanceof Gt){o.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");var l=o.createPopupClient(t.correlationId);return l.acquireToken(t)}throw o.browserStorage.setInteractionInProgress(!1),c});else{var s=this.createPopupClient(t.correlationId);a=s.acquireToken(t)}return a.then(function(c){var l=i.length<o.getAllAccounts().length;return l?o.eventHandler.emitEvent(xe.LOGIN_SUCCESS,ne.Popup,c):o.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_SUCCESS,ne.Popup,c),r.endMeasurement({success:!0}),r.flushMeasurement(),c}).catch(function(c){return i.length>0?o.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_FAILURE,ne.Popup,null,c):o.eventHandler.emitEvent(xe.LOGIN_FAILURE,ne.Popup,null,c),r.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),r.flushMeasurement(),Promise.reject(c)})},e.prototype.ssoSilent=function(t){return D(this,void 0,void 0,function(){var o,n,r,i,a,s=this;return L(this,function(c){return o=this.getRequestCorrelationId(t),n=oe(oe({},t),{prompt:Lt.NONE,correlationId:o}),this.preflightBrowserEnvironmentCheck(ne.Silent),r=this.performanceClient.startMeasurement(gt.SsoSilent,o),this.logger.verbose("ssoSilent called",o),this.eventHandler.emitEvent(xe.SSO_SILENT_START,ne.Silent,n),this.canUseNative(n)?i=this.acquireTokenNative(n,tt.ssoSilent).catch(function(l){if(l instanceof ln&&l.isFatal()){s.nativeExtensionProvider=void 0;var u=s.createSilentIframeClient(n.correlationId);return u.acquireToken(n)}throw l}):(a=this.createSilentIframeClient(n.correlationId),i=a.acquireToken(n)),[2,i.then(function(l){return s.eventHandler.emitEvent(xe.SSO_SILENT_SUCCESS,ne.Silent,l),r.endMeasurement({success:!0,isNativeBroker:l.fromNativeBroker}),r.flushMeasurement(),l}).catch(function(l){throw s.eventHandler.emitEvent(xe.SSO_SILENT_FAILURE,ne.Silent,null,l),r.endMeasurement({errorCode:l.errorCode,subErrorCode:l.subError,success:!1}),r.flushMeasurement(),l})]})})},e.prototype.acquireTokenByCode=function(t){return D(this,void 0,void 0,function(){var o,n,r,i,a=this;return L(this,function(s){o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(ne.Silent),this.logger.trace("acquireTokenByCode called",o),this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_BY_CODE_START,ne.Silent,t),n=this.performanceClient.startMeasurement(gt.AcquireTokenByCode,t.correlationId);try{if(t.code)return r=t.code,i=this.hybridAuthCodeResponses.get(r),i?(this.logger.verbose("Existing acquireTokenByCode request found",t.correlationId),n.endMeasurement({success:!0}),n.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",o),i=this.acquireTokenByCodeAsync(oe(oe({},t),{correlationId:o})).then(function(c){return a.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_BY_CODE_SUCCESS,ne.Silent,c),a.hybridAuthCodeResponses.delete(r),n.endMeasurement({success:!0,isNativeBroker:c.fromNativeBroker}),n.flushMeasurement(),c}).catch(function(c){throw a.hybridAuthCodeResponses.delete(r),a.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_BY_CODE_FAILURE,ne.Silent,null,c),n.endMeasurement({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),n.flushMeasurement(),c}),this.hybridAuthCodeResponses.set(r,i)),[2,i];if(t.nativeAccountId){if(this.canUseNative(t,t.nativeAccountId))return[2,this.acquireTokenNative(t,tt.acquireTokenByCode,t.nativeAccountId).catch(function(c){throw c instanceof ln&&c.isFatal()&&(a.nativeExtensionProvider=void 0),c})];throw F.createUnableToAcquireTokenFromNativePlatformError()}else throw F.createAuthCodeOrNativeAccountIdRequiredError()}catch(c){throw this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_BY_CODE_FAILURE,ne.Silent,null,c),n.endMeasurement({errorCode:c instanceof Z&&c.errorCode||void 0,subErrorCode:c instanceof Z&&c.subError||void 0,success:!1}),c}return[2]})})},e.prototype.acquireTokenByCodeAsync=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){switch(r.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",t.correlationId),o=this.createSilentAuthCodeClient(t.correlationId),[4,o.acquireToken(t)];case 1:return n=r.sent(),[2,n]}})})},e.prototype.acquireTokenByRefreshToken=function(t){return D(this,void 0,void 0,function(){var o,n,r=this;return L(this,function(i){return ft.blockReloadInHiddenIframes(),o=this.performanceClient.startMeasurement(gt.AcquireTokenByRefreshToken,t.correlationId),this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_NETWORK_START,ne.Silent,t),n=this.createSilentRefreshClient(t.correlationId),[2,n.acquireToken(t).then(function(a){return o.endMeasurement({success:!0,fromCache:a.fromCache}),a}).catch(function(a){var s=a instanceof Ko,c=a instanceof Gt,l=a.errorCode===Vt.INVALID_GRANT_ERROR;if(s&&l&&!c){r.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",t.correlationId);var u=r.createSilentIframeClient(t.correlationId);return u.acquireToken(t).then(function(p){return o.endMeasurement({success:!0,fromCache:p.fromCache}),p}).catch(function(p){throw o.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})}throw o.endMeasurement({success:!1}),a})]})})},e.prototype.logout=function(t){return D(this,void 0,void 0,function(){var o;return L(this,function(n){return o=this.getRequestCorrelationId(t),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",o),[2,this.logoutRedirect(oe({correlationId:o},t))]})})},e.prototype.logoutRedirect=function(t){return D(this,void 0,void 0,function(){var o,n;return L(this,function(r){return o=this.getRequestCorrelationId(t),this.preflightBrowserEnvironmentCheck(ne.Redirect),n=this.createRedirectClient(o),[2,n.logout(t)]})})},e.prototype.logoutPopup=function(t){try{var o=this.getRequestCorrelationId(t);this.preflightBrowserEnvironmentCheck(ne.Popup);var n=this.createPopupClient(o);return n.logout(t)}catch(r){return Promise.reject(r)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(t){var o=this.getAllAccounts();return!z.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+t),o.filter(function(n){return n.username.toLowerCase()===t.toLowerCase()})[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(t){var o=this.getAllAccounts();return!z.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+t),o.filter(function(n){return n.homeAccountId===t})[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(t){var o=this.getAllAccounts();return!z.isEmpty(t)&&o&&o.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+t),o.filter(function(n){return n.localAccountId===t})[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(t){this.browserStorage.setActiveAccount(t)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(t,o){if(o===void 0&&(o=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),ft.blockNonBrowserEnvironment(this.isBrowserEnvironment),ft.blockRedirectInIframe(t,this.config.system.allowRedirectInIframe),ft.blockReloadInHiddenIframes(),ft.blockAcquireTokenInPopups(),ft.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t===ne.Redirect&&this.config.cache.cacheLocation===ro.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Wp.createInMemoryRedirectUnavailableError();(t===ne.Redirect||t===ne.Popup)&&this.preflightInteractiveRequest(o)},e.prototype.preflightInteractiveRequest=function(t){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ft.blockReloadInHiddenIframes(),t&&this.browserStorage.setInteractionInProgress(!0)},e.prototype.acquireTokenNative=function(t,o,n){return D(this,void 0,void 0,function(){var r;return L(this,function(i){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw F.createNativeConnectionNotEstablishedError();return r=new ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(t),t.correlationId),[2,r.acquireToken(t)]})})},e.prototype.canUseNative=function(t,o){if(this.logger.trace("canUseNative called"),!er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(t.prompt)switch(t.prompt){case Lt.NONE:case Lt.CONSENT:case Lt.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+t.prompt+" is not compatible with native flow, returning false"),!1}return!o&&!this.getNativeAccountId(t)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0},e.prototype.getNativeAccountId=function(t){var o=t.account||this.browserStorage.getAccountInfoByHints(t.loginHint,t.sid)||this.getActiveAccount();return o&&o.nativeAccountId||""},e.prototype.createPopupClient=function(t){return new XU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.createRedirectClient=function(t){return new QU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.createSilentIframeClient=function(t){return new e$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.ssoSilent,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.createSilentCacheClient=function(t){return new t$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.createSilentRefreshClient=function(t){return new o$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.createSilentAuthCodeClient=function(t){return new u$(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,tt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,t)},e.prototype.addEventCallback=function(t){return this.eventHandler.addEventCallback(t)},e.prototype.removeEventCallback=function(t){this.eventHandler.removeEventCallback(t)},e.prototype.addPerformanceCallback=function(t){return this.performanceClient.addPerformanceCallback(t)},e.prototype.removePerformanceCallback=function(t){return this.performanceClient.removePerformanceCallback(t)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(t){this.logger=t},e.prototype.initializeWrapperLibrary=function(t,o){this.browserStorage.setWrapperMetadata(t,o)},e.prototype.setNavigationClient=function(t){this.navigationClient=t},e.prototype.getConfiguration=function(){return this.config},e.prototype.getRequestCorrelationId=function(t){return t?.correlationId?t.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():T.EMPTY_STRING},e}();var DT=function(e){et(t,e);function t(o){var n=e.call(this,o)||this;return n.activeSilentTokenRequests=new Map,n}return t.prototype.loginRedirect=function(o){return D(this,void 0,void 0,function(){var n;return L(this,function(r){return n=this.getRequestCorrelationId(o),this.logger.verbose("loginRedirect called",n),[2,this.acquireTokenRedirect(oe({correlationId:n},o||CT))]})})},t.prototype.loginPopup=function(o){var n=this.getRequestCorrelationId(o);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup(oe({correlationId:n},o||CT))},t.prototype.acquireTokenSilent=function(o){return D(this,void 0,void 0,function(){var n,r,i,a,s,c,l,u=this;return L(this,function(p){if(n=this.getRequestCorrelationId(o),r=this.performanceClient.startMeasurement(gt.AcquireTokenSilent,n),this.preflightBrowserEnvironmentCheck(ne.Silent),this.logger.verbose("acquireTokenSilent called",n),i=o.account||this.getActiveAccount(),!i)throw F.createNoAccountError();return a={clientId:this.config.auth.clientId,authority:o.authority||T.EMPTY_STRING,scopes:o.scopes,homeAccountIdentifier:i.homeAccountId,claims:o.claims,authenticationScheme:o.authenticationScheme,resourceRequestMethod:o.resourceRequestMethod,resourceRequestUri:o.resourceRequestUri,shrClaims:o.shrClaims,sshKid:o.sshKid},s=JSON.stringify(a),c=this.activeSilentTokenRequests.get(s),typeof c>"u"?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),l=this.acquireTokenSilentAsync(oe(oe({},o),{correlationId:n}),i).then(function(m){return u.activeSilentTokenRequests.delete(s),r.endMeasurement({success:!0,fromCache:m.fromCache,isNativeBroker:m.fromNativeBroker}),r.flushMeasurement(),m}).catch(function(m){throw u.activeSilentTokenRequests.delete(s),r.endMeasurement({errorCode:m.errorCode,subErrorCode:m.subError,success:!1}),r.flushMeasurement(),m}),this.activeSilentTokenRequests.set(s,l),[2,l]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),r.endMeasurement({success:!0}),r.discardMeasurement(),[2,c])})})},t.prototype.acquireTokenSilentAsync=function(o,n){return D(this,void 0,void 0,function(){var r,i,a,s,c,l=this;return L(this,function(u){switch(u.label){case 0:return this.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_START,ne.Silent,o),r=this.performanceClient.startMeasurement(gt.AcquireTokenSilentAsync,o.correlationId),er.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,o.authenticationScheme)&&n.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),a=oe(oe({},o),{account:n}),i=this.acquireTokenNative(a,tt.acquireTokenSilent_silentFlow).catch(function(p){return D(l,void 0,void 0,function(){var m;return L(this,function(f){if(p instanceof ln&&p.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,m=this.createSilentIframeClient(o.correlationId),[2,m.acquireToken(o)];throw p})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),s=this.createSilentCacheClient(o.correlationId),[4,s.initializeSilentRequest(o,n)];case 2:c=u.sent(),i=s.acquireToken(c).catch(function(){return D(l,void 0,void 0,function(){return L(this,function(p){return[2,this.acquireTokenByRefreshToken(c)]})})}),u.label=3;case 3:return[2,i.then(function(p){return l.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_SUCCESS,ne.Silent,p),r.endMeasurement({success:!0,fromCache:p.fromCache,isNativeBroker:p.fromNativeBroker}),p}).catch(function(p){throw l.eventHandler.emitEvent(xe.ACQUIRE_TOKEN_FAILURE,ne.Silent,null,p),r.endMeasurement({errorCode:p.errorCode,subErrorCode:p.subError,success:!1}),p})]}})})},t}(m$);var f$=new WeakMap,un=e=>(...t)=>{let o=e(...t);return f$.set(o,!0),o},xc=e=>typeof e=="function"&&f$.has(e);var LT=typeof window<"u"&&window.customElements!=null&&window.customElements.polyfillWrapFlushCallback!==void 0,Jh=(e,t,o=null,n=null)=>{for(;t!==o;){let r=t.nextSibling;e.insertBefore(t,n),t=r}},yc=(e,t,o=null)=>{for(;t!==o;){let n=t.nextSibling;e.removeChild(t),t=n}};var Pn={},Zh={};var si=`{{lit-${String(Math.random()).slice(2)}}}`,MT=`<!--${si}-->`,g$=new RegExp(`${si}|${MT}`),uu="$lit$",Qp=class{constructor(t,o){this.parts=[],this.element=o;let n=[],r=[],i=document.createTreeWalker(o.content,133,null,!1),a=0,s=-1,c=0,{strings:l,values:{length:u}}=t;for(;c<u;){let p=i.nextNode();if(p===null){i.currentNode=r.pop();continue}if(s++,p.nodeType===1){if(p.hasAttributes()){let m=p.attributes,{length:f}=m,h=0;for(let _=0;_<f;_++)h$(m[_].name,uu)&&h++;for(;h-- >0;){let _=l[c],g=e_.exec(_)[2],v=g.toLowerCase()+uu,x=p.getAttribute(v);p.removeAttribute(v);let E=x.split(g$);this.parts.push({type:"attribute",index:s,name:g,strings:E}),c+=E.length-1}}p.tagName==="TEMPLATE"&&(r.push(p),i.currentNode=p.content)}else if(p.nodeType===3){let m=p.data;if(m.indexOf(si)>=0){let f=p.parentNode,h=m.split(g$),_=h.length-1;for(let g=0;g<_;g++){let v,x=h[g];if(x==="")v=Rn();else{let E=e_.exec(x);E!==null&&h$(E[2],uu)&&(x=x.slice(0,E.index)+E[1]+E[2].slice(0,-uu.length)+E[3]),v=document.createTextNode(x)}f.insertBefore(v,p),this.parts.push({type:"node",index:++s})}h[_]===""?(f.insertBefore(Rn(),p),n.push(p)):p.data=h[_],c+=_}}else if(p.nodeType===8)if(p.data===si){let m=p.parentNode;(p.previousSibling===null||s===a)&&(s++,m.insertBefore(Rn(),p)),a=s,this.parts.push({type:"node",index:s}),p.nextSibling===null?p.data="":(n.push(p),s--),c++}else{let m=-1;for(;(m=p.data.indexOf(si,m+1))!==-1;)this.parts.push({type:"node",index:-1}),c++}}for(let p of n)p.parentNode.removeChild(p)}},h$=(e,t)=>{let o=e.length-t.length;return o>=0&&e.slice(o)===t},OT=e=>e.index!==-1,Rn=()=>document.createComment(""),e_=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;var du=class{constructor(t,o,n){this.__parts=[],this.template=t,this.processor=o,this.options=n}update(t){let o=0;for(let n of this.__parts)n!==void 0&&n.setValue(t[o]),o++;for(let n of this.__parts)n!==void 0&&n.commit()}_clone(){let t=LT?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),o=[],n=this.template.parts,r=document.createTreeWalker(t,133,null,!1),i=0,a=0,s,c=r.nextNode();for(;i<n.length;){if(s=n[i],!OT(s)){this.__parts.push(void 0),i++;continue}for(;a<s.index;)a++,c.nodeName==="TEMPLATE"&&(o.push(c),r.currentNode=c.content),(c=r.nextNode())===null&&(r.currentNode=o.pop(),c=r.nextNode());if(s.type==="node"){let l=this.processor.handleTextExpression(this.options);l.insertAfterNode(c.previousSibling),this.__parts.push(l)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,s.name,s.strings,this.options));i++}return LT&&(document.adoptNode(t),customElements.upgrade(t)),t}};var _$=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:e=>e}),$6=` ${si} `,Rr=class{constructor(t,o,n,r){this.strings=t,this.values=o,this.type=n,this.processor=r}getHTML(){let t=this.strings.length-1,o="",n=!1;for(let r=0;r<t;r++){let i=this.strings[r],a=i.lastIndexOf("<!--");n=(a>-1||n)&&i.indexOf("-->",a+1)===-1;let s=e_.exec(i);s===null?o+=i+(n?$6:MT):o+=i.substr(0,s.index)+s[1]+s[2]+uu+s[3]+si}return o+=this.strings[t],o}getTemplateElement(){let t=document.createElement("template"),o=this.getHTML();return _$!==void 0&&(o=_$.createHTML(o)),t.innerHTML=o,t}};var qa=e=>e===null||!(typeof e=="object"||typeof e=="function"),t_=e=>Array.isArray(e)||!!(e&&e[Symbol.iterator]),pu=class{constructor(t,o,n){this.dirty=!0,this.element=t,this.name=o,this.strings=n,this.parts=[];for(let r=0;r<n.length-1;r++)this.parts[r]=this._createPart()}_createPart(){return new Hi(this)}_getValue(){let t=this.strings,o=t.length-1,n=this.parts;if(o===1&&t[0]===""&&t[1]===""){let i=n[0].value;if(typeof i=="symbol")return String(i);if(typeof i=="string"||!t_(i))return i}let r="";for(let i=0;i<o;i++){r+=t[i];let a=n[i];if(a!==void 0){let s=a.value;if(qa(s)||!t_(s))r+=typeof s=="string"?s:String(s);else for(let c of s)r+=typeof c=="string"?c:String(c)}}return r+=t[o],r}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}},Hi=class{constructor(t){this.value=void 0,this.committer=t}setValue(t){t!==Pn&&(!qa(t)||t!==this.value)&&(this.value=t,xc(t)||(this.committer.dirty=!0))}commit(){for(;xc(this.value);){let t=this.value;this.value=Pn,t(this)}this.value!==Pn&&this.committer.commit()}},dn=class{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(Rn()),this.endNode=t.appendChild(Rn())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=Rn()),t.__insert(this.endNode=Rn())}insertAfterPart(t){t.__insert(this.startNode=Rn()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(this.startNode.parentNode===null)return;for(;xc(this.__pendingValue);){let o=this.__pendingValue;this.__pendingValue=Pn,o(this)}let t=this.__pendingValue;t!==Pn&&(qa(t)?t!==this.value&&this.__commitText(t):t instanceof Rr?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):t_(t)?this.__commitIterable(t):t===Zh?(this.value=Zh,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){let o=this.startNode.nextSibling;t=t??"";let n=typeof t=="string"?t:String(t);o===this.endNode.previousSibling&&o.nodeType===3?o.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){let o=this.options.templateFactory(t);if(this.value instanceof du&&this.value.template===o)this.value.update(t.values);else{let n=new du(o,t.processor,this.options),r=n._clone();n.update(t.values),this.__commitNode(r),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());let o=this.value,n=0,r;for(let i of t)r=o[n],r===void 0&&(r=new dn(this.options),o.push(r),n===0?r.appendIntoPart(this):r.insertAfterPart(o[n-1])),r.setValue(i),r.commit(),n++;n<o.length&&(o.length=n,this.clear(r&&r.endNode))}clear(t=this.startNode){yc(this.startNode.parentNode,t.nextSibling,this.endNode)}},Xp=class{constructor(t,o,n){if(this.value=void 0,this.__pendingValue=void 0,n.length!==2||n[0]!==""||n[1]!=="")throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=o,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;xc(this.__pendingValue);){let o=this.__pendingValue;this.__pendingValue=Pn,o(this)}if(this.__pendingValue===Pn)return;let t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=Pn}},Jp=class extends pu{constructor(t,o,n){super(t,o,n),this.single=n.length===2&&n[0]===""&&n[1]===""}_createPart(){return new mu(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}},mu=class extends Hi{},v$=!1;(()=>{try{let e={get capture(){return v$=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch{}})();var Zp=class{constructor(t,o,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=o,this.eventContext=n,this.__boundHandleEvent=r=>this.handleEvent(r)}setValue(t){this.__pendingValue=t}commit(){for(;xc(this.__pendingValue);){let i=this.__pendingValue;this.__pendingValue=Pn,i(this)}if(this.__pendingValue===Pn)return;let t=this.__pendingValue,o=this.value,n=t==null||o!=null&&(t.capture!==o.capture||t.once!==o.once||t.passive!==o.passive),r=t!=null&&(o==null||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),r&&(this.__options=z6(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=Pn}handleEvent(t){typeof this.value=="function"?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}},z6=e=>e&&(v$?{capture:e.capture,passive:e.passive,once:e.once}:e.capture);var o_=class{handleAttributeExpressions(t,o,n,r){let i=o[0];return i==="."?new Jp(t,o.slice(1),n).parts:i==="@"?[new Zp(t,o.slice(1),r.eventContext)]:i==="?"?[new Xp(t,o.slice(1),n)]:new pu(t,o,n).parts}handleTextExpression(t){return new dn(t)}},n_=new o_;function $T(e){let t=UT.get(e.type);t===void 0&&(t={stringsArray:new WeakMap,keyString:new Map},UT.set(e.type,t));let o=t.stringsArray.get(e.strings);if(o!==void 0)return o;let n=e.strings.join(si);return o=t.keyString.get(n),o===void 0&&(o=new Qp(e,e.getTemplateElement()),t.keyString.set(n,o)),t.stringsArray.set(e.strings,o),o}var UT=new Map;var zT=new WeakMap,I=(e,t,o)=>{let n=zT.get(t);n===void 0&&(yc(t,t.firstChild),zT.set(t,n=new dn(Object.assign({templateFactory:$T},o))),n.appendInto(t)),n.setValue(e),n.commit()};typeof window<"u"&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.4.1");var d=(e,...t)=>new Rr(e,t,"html",n_);var H6=0;function Qo(){return`ax-${H6++}`}function FT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".split("").map(e=>{if(e==="-"||e==="4")return e;let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}).join("")}var ese=d` <div
	id="spinner"
	class="c-progress f-indeterminate-local f-progress-large"
	role="progressbar"
	tabindex="0"
	aria-valuetext="${Ni}"
	aria-label="${Ni}"
>
	<span></span>
	<span></span>
	<span></span>
	<span></span>
	<span></span>
</div>`;function Ba(e=!0){let t=e?"color-text-subtle":"white-static-text";return e?d` <div
				class="nav-bar-logo"
				role="presentation"
				aria-hidden="true"
				itemprop="logo"
				itemscope="itemscope"
		  >
				${b$(t)}
		  </div>`:d`
				<span class="margin-top-xxs aria-hidden="true"> ${b$(t)} </span>
		  `}function b$(e){return d`
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="108"
			height="23"
			viewBox="72 72 337 74"
			preserveAspectRatio="xMidYMin slice"
		>
			<g data-name="MS-symbol">
				<clipPath>
					<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z" />
				</clipPath>
				<g clip-path="url(#a)">
					<path
						class="fill-current-color ${e}"
						d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z"
					/>
					<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022" />
					<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00" />
					<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef" />
					<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900" />
				</g>
			</g>
		</svg>
	`}var ci=class{constructor(t){this.url=wa(t),this.source=this.url.searchParams.get("source"),this.source||(this.source=te("page_type")==="learn"||te("page_kind")==="learn"?"learn":"docs",te("uhfHeaderId")!=="answers"&&this.url.searchParams.set("source",this.source))}static getProfileContext(t){try{let o=t||location.href,n=new ci(o),r=wa(o);return r.searchParams.delete("source"),{redirectUrl:r.href,source:n.source,microsoftUser:void 0}}catch{return{redirectUrl:void 0,source:void 0,microsoftUser:void 0}}}toString(){return this.url.href}};function x$(e){let t=null;try{t=new ci(e).toString()}catch{t=location.href}return t}var gse=new URL("./register",Oi()).toString(),y$=location.hostname==="localhost"?"https://localhost:3000/dev/global/identity-redirect.html":`${location.origin}/_themes/docs.theme/master/en-us/_themes/global/identity-redirect.html`,q6=location.hostname==="localhost"?"https://localhost:3000/dev/global/identity-profile.html":`${location.origin}/_themes/docs.theme/${W6()}/en-us/_themes/global/identity-profile.html`;var B6=C.supportLevel==="production"?"18fbca16-2224-45f6-85b0-f7bf2b39b3f3":"f602d4fb-244f-48be-a746-435fac3917df",Y6="https://login.microsoftonline.com",G6="common",qi,T$=()=>{let e={auth:{clientId:B6,authority:`${Y6}/${G6}`,redirectUri:y$},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(t,o,n)=>{if(!(!C.reviewFeatures||n))switch(t){case vt.Error:console.error(o);return;case vt.Info:console.info(o);return;case vt.Verbose:console.debug(o);return;case vt.Warning:console.warn(o);return}}}}};qi=new DT(e)};function V6(e,t=!1){let o=x$(e),n=q6,r=encodeURIComponent(o),i=FT();return{scopes:["openid","profile","email"],prompt:t?"select_account":null,redirectStartPage:n,nonce:i,redirectUri:y$,state:r}}function S$(e,t=!1){return qi.setActiveAccount(null),qi.loginRedirect(V6(e,t))}var j6={scopes:["openid","profile","email"],prompt:"login"};function E$(){try{let e=Ao(),o=oU(e).preferred_username,n=qi.getAccountByUsername(o);return o?qi.acquireTokenSilent(Object.assign({},j6,{prompt:"none",account:n})).then(r=>(wh(r.idToken),!0)).catch(()=>(Et(),!1)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}function W6(){return nc?(Di(["themebranch","branch"],"master")||"master").replace(/^main$/,"master"):(Di(["themebranch"],"master")||"master").replace(/^main$/,"master")}var r_=class{},i_=class{constructor(t,o,n=new Ye){this.stack=t,this.final=o,this.bus=n}async run(){let t=0,o=!0,n=this.final,r=[],i=this.bus.subscribe(r_,()=>o=!1),a=s=>(this.bus.publish(new r_),n=s||n,!1);try{for(;o&&this.stack[t];){let s=await this.stack[t](a);if(s||r[t]!==!1){r[t]=s,t+=s?-1:1;continue}o=!1}t>=0&&n(),i()}catch(s){throw i(),this.final(),s}}};var w$=re.profile.me,K6=`${w$}?isCPMCalled=true`,Q6=new URL("./register",Oi()).toString(),X6="https://docs.microsoft.com";async function Ya(){let t=location.pathname.split("/").indexOf("edit")!==-1?K6:w$;try{let n=await fetch(we(t,{credentials:"include"}));if(n.ok&&n.status!==204){let r=await n.json();y.readUserProfile(r)}else y.setAnonymous()}catch{y.setAnonymous()}}async function C$(e=()=>{y.setAnonymous()}){if(!Ne.userServices)return y.setAnonymous(),Promise.resolve();await new i_([J6,a_,E$],e).run()}async function J6(e=()=>!1){try{let t=rc();if(t){let o=ya(t);return y.readUserFromToken(o),!0}return!1}catch(t){return t instanceof Er?!1:e()}}async function a_(e=()=>!1){try{let t=Ao();if(t){ya(t);let o=await Rh(t);return Ch(o),!0}return!1}catch(t){return t instanceof Er?!1:t instanceof Op?e(Z6):e()}}function Z6(){if(te("page_kind")!=="register"){y.setAnonymous();let o=Le({redirectUrl:location.href});location.href=`${Q6}?${o}`;return}let e=Ao(),t=ya(e);y.mapIdTokenToProfile(t)}async function $t(e=location.href,t=!1,o=!1){if(t&&await J(re.auth.signOut),IU(),kh(),Et(),!o){let n=wa(e,X6);location.href=`${n.origin}${n.pathname}${n.search}`}}function tr(e=location.href,t=!1){S$(e,t)}function ce(e){return e.status===401&&y.setAnonymous(),e}async function fu(e){let t=`${re.profile.profiles}/${e}`,n=await J(ct(t,{method:"GET"},!1));return ce(n),n.ok?await n.json():(n.status===204,null)}async function k$(e){try{let t=await fetch(ct(re.profile.me,{method:"GET"},!0,"application/json",e));return t.ok&&t.status!==204?await t.json():null}catch{return null}}async function A$(e,t,o){let n=`${re.profile.profiles}/${e}/newactivity?${Le({page:t,pageSize:o,locale:w.data.userLocale})}`,i=await J(ct(n,{method:"GET"},!0));return ce(i),i.ok?await i.json():{totalItems:0,items:[]}}async function Uo(e,t){let o=`${re.profile.profiles}/${e}`,n=JSON.stringify(t),i=await J(ct(o,{credentials:"include",method:"PUT",body:n}));if(ce(i),i.ok){Wo(i,!1);let a=await i.json();return{hasError:!1,profile:a}}else if(i.status===400){let a=await i.json();return{hasError:!0,message:a.message,errors:a.errorCode.split(",")}}return{hasError:!0,message:i.statusText,errors:["somethingWentWrong"]}}async function I$(e){let t=re.profile.avatar,r=ct(t,{credentials:"include",method:"PUT",body:e},!0,"multipart/form-data"),i=await J(r);if(ce(i),i.ok){Wo(i,!1);let a=await i.json();return{hasError:!1,profile:a}}else if(i.status===400){let a=await i.json();return{hasError:!0,message:a.message,errors:a.errorCode.split(",")}}return{hasError:!0,message:i.statusText,errors:["somethingWentWrong"]}}async function P$(){let e=re.profile.avatar,o=await J(ct(e,{credentials:"include",method:"DELETE"}));if(ce(o),o.ok)return Wo(o,!1),{hasError:!1,profile:null};if(o.status===400){let n=await o.json();return{hasError:!0,message:n.message,errors:n.errorCode.split(",")}}return{hasError:!0,message:o.statusText,errors:["somethingWentWrong"]}}async function R$(e){let t=re.profile.profiles,o=JSON.stringify(e),r=ct(t,{credentials:"include",method:"POST",body:o});r.headers.set("Authorization",`Bearer ${Ao()}`);let i=await J(r);if(ce(i),i.ok){Wo(i,!1);let s=await i.json();return{hasError:!1,profile:s}}else if(i.status===400){let s=await i.json();return{hasError:!0,message:s.message,errors:s.errorCode.split(",")}}else if(i.status===409)return{hasError:!0,message:i.statusText,errors:["alreadyRegistered"]};return{hasError:!0,message:i.statusText,errors:["somethingWentWrong"]}}async function c_(){let e=re.privacy.delete,o=await J(ct(e,{credentials:"include",method:"POST"}));return ce(o),o.ok}async function N$(e=w.data.userLocale,t=!0){let o=`${re.privacy.export}?${Le({locale:e,isDownload:t})}`,r=await J(ct(o,{method:"POST"}));if(ce(r),!r.ok)throw new Error(`Unexpected response status ${r.status} for ${o}`);let i=await r.blob(),s=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(r.headers.get("Content-Disposition")||""),c=s?s[0]:"";return{data:i,filename:c}}async function D$(e){let t=re.profile.avert,o=JSON.stringify(e),r=await J(ct(t,{method:"POST",body:o}));if(ce(r),Wo(r,!1),!r.ok)throw new Error(`Unexpected response status ${r.status} for ${t}`)}async function L$(){let e=re.profile.acknowledgePrivacyNotice,o=await J(ct(e,{method:"POST"}));if(ce(o),Wo(o,!1),!o.ok)throw new Error(`Unexpected response status ${o.status} for ${e}`)}async function M$(e){let t=re.profile.link,o={method:"POST",body:`"${e}"`},n=await J(ct(t,o));if(ce(n),n.ok)return Wo(n,!1),{hasError:!1,profile:await n.json()};if(n.status===405){let r=await n.json(),i=["accountLimitReached"];return r.errorCode==="ProfileMergeRunning"&&i.unshift("profileMergeRunning"),{hasError:!0,message:n.statusText,errors:i}}else{if(n.status===409)return{hasError:!0,message:n.statusText,errors:["accountAlreadyRegistered"]};throw new Error(`Unexpected response status ${n.status} for ${t}`)}}async function O$(e,t){let o=`${re.profile.link}/${e}/${t}`,r=await J(ct(o,{method:"DELETE"}));if(ce(r),r.ok)return Wo(r,!1),{hasError:!1,profile:await r.json()};if(r.status===405){let i=await r.json(),a=["needAtLeastOneAccountLinked"];return i.errorCode==="ProfileMergeRunning"&&a.unshift("profileMergeRunning"),{hasError:!0,message:r.statusText,errors:a}}else throw new Error(`Unexpected response status ${r.status} for ${o}`)}async function HT(e){let t=re.profile.merge,o={method:"POST",body:JSON.stringify({sourceIdToken:e})},n=await J(ct(t,o));if(ce(n),n.ok){Wo(n,!1);let r=await n.json();return{hasError:!1,profile:r}}else{if(n.status===405)return{hasError:!0,message:n.statusText,errors:["accountLimitReached"]};if(n.status===409)return{hasError:!0,message:n.statusText,errors:["alreadyHasCertProfileConnected"]};throw new Error(`Unexpected response status ${n.status} for ${t}`)}}async function qT(){let e=re.profile.merge,o=await J(ct(e,{method:"GET"}));if(ce(o),o.ok){let{status:n}=await o.json();return n}return null}async function U$(){let e=re.profile.acknowledgeMergeStatus,o=await J(ct(e,{method:"POST"}));if(ce(o),Wo(o,!1),!o.ok)throw new Error(`Unexpected response status ${o.status} for ${e}`)}async function $$(e){let t=re.profile.validateMerge,o={method:"POST",body:JSON.stringify({sourceIdToken:e})},n=await J(ct(t,o));return ce(n),n.ok?null:n.status===409?"alreadyHasCertProfileConnected":"unexpectedError"}function ct(e,t,o=!0,n="application/json",r=""){t=t||{},t.mode="cors";let i=new Request(e,t);return o&&i.headers.set("Authorization",`Bearer ${r||rc()}`),(i.method==="PUT"||i.method==="POST")&&n!=="multipart/form-data"&&i.headers.set("Content-Type",n),i}async function z$(e,t){let o=`${re.profile.qnaFollowing}/tags?${Le({page:e,pageSize:t,locale:w.data.userLocale})}`,r=await J(ct(o,{method:"GET"},!0));return ce(r),r.ok?await r.json():(r.status===204,null)}async function F$(e,t){let o=`${re.profile.qnaFollowing}/users?${Le({page:e,pageSize:t,locale:w.data.userLocale})}`,r=await J(ct(o,{method:"GET"},!0));return ce(r),r.ok?await r.json():(r.status===204,null)}async function H$(e,t){let o=`${re.profile.qnaFollowing}/threads?${Le({page:e,pageSize:t,locale:w.data.userLocale})}`,r=await J(ct(o,{method:"GET"},!0));return ce(r),r.ok?await r.json():(r.status===204,null)}async function q$(e){let t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}},o=ct(`${re.profile.challenge}/${e}
		`,t);await J(o)}var em=class extends Error{constructor(o,n){let{status:r,statusText:i,url:a}=o;super(`Unexpected response status ${r}: ${i} from "${a}".`);this.status=r,this.statusText=i,this.url=a,this.type=n}},s_=class extends em{constructor(t){super(t,"transcriptUnexpectedError")}};async function B$(){let e=`${re.profile.transcript.private}?${Le({locale:w.data.userLocale})}`,o=await J(ct(e,{method:"GET"},!0));if(ce(o),o.ok)return await o.json();if(o.status===204)return null;throw new s_(o)}var tm=class extends em{constructor(t){super(t,"transcriptNotFoundError")}};async function Y$(e){let t=`${re.profile.transcript.public}/${e}?${Le({locale:w.data.userLocale})}`,n=await J(ct(t,{method:"GET"},!0));if(ce(n),n.ok)return await n.json();if(n.status===204)return null;throw n.status===404?new tm(n):new s_(n)}var om=class extends em{constructor(t){super(t,"transcriptLinkSettingsError")}};async function G$(){let e=`${re.profile.transcript.settings.publicLink}?${Le({locale:w.data.userLocale})}`,o=await J(ct(e,{method:"GET"},!0));if(ce(o),o.ok)return await o.json();if(o.status===204)return null;throw new om(o)}async function V$(){let e=`${re.profile.transcript.settings.publicLink}?${Le({locale:w.data.userLocale})}`,o=await J(ct(e,{method:"POST"},!0));if(ce(o),o.ok)return await o.json();throw new om(o)}async function j$(){let e=`${re.profile.transcript.settings.publicLink}?${Le({locale:w.data.userLocale})}`,o=await J(ct(e,{method:"DELETE"},!0));if(ce(o),!o.ok)throw new om(o)}async function W$(e){let t=`${re.profile.achievement}/${e}?${Le({locale:w.data.userLocale})}`,n=await J(ct(t,{method:"GET"},!0));return ce(n),n.ok?await n.json():(n.status===204,null)}async function K$(){let e=re.profile.migrateMecUserData,o=await J(ct(e,{method:"POST"}));if(ce(o),Wo(o,!1),!o.ok)throw new Error(`Unexpected response status ${o.status} for ${e}`)}async function Q$(){let e=re.profile.deleteMecUserData,o=await J(ct(e,{method:"POST"}));if(ce(o),Wo(o,!1),!o.ok)throw new Error(`Unexpected response status ${o.status} for ${e}`)}var BT=class{constructor(t){this.classes=new Set,this.changed=!1,this.element=t;let o=(t.getAttribute("class")||"").split(/\s+/);for(let n of o)this.classes.add(n)}add(t){this.classes.add(t),this.changed=!0}remove(t){this.classes.delete(t),this.changed=!0}commit(){if(this.changed){let t="";this.classes.forEach(o=>t+=o+" "),this.element.setAttribute("class",t)}}},X$=new WeakMap,YT=un(e=>t=>{if(!(t instanceof Hi)||t instanceof mu||t.committer.name!=="class"||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");let{committer:o}=t,{element:n}=o,r=X$.get(t);r===void 0&&(n.setAttribute("class",o.strings.join(" ")),X$.set(t,r=new Set));let i=n.classList||new BT(n);r.forEach(a=>{a in e||(i.remove(a),r.delete(a))});for(let a in e){let s=e[a];s!=r.has(a)&&(s?(i.add(a),r.add(a)):(i.remove(a),r.delete(a)))}typeof i.commit=="function"&&i.commit()});var GT=new WeakMap,$o=un(e=>t=>{let o=GT.get(t);if(e===void 0&&t instanceof Hi){if(o!==void 0||!GT.has(t)){let n=t.committer.name;t.committer.element.removeAttribute(n)}}else e!==o&&t.setValue(e);GT.set(t,e)});var J$=(e,t)=>{let o=e.startNode.parentNode,n=t===void 0?e.endNode:t.startNode,r=o.insertBefore(Rn(),n);o.insertBefore(Rn(),n);let i=new dn(e.options);return i.insertAfterNode(r),i},Tc=(e,t)=>(e.setValue(t),e.commit(),e),VT=(e,t,o)=>{let n=e.startNode.parentNode,r=o?o.startNode:e.endNode,i=t.endNode.nextSibling;i!==r&&Jh(n,t.startNode,i,r)},jT=e=>{yc(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},Z$=(e,t,o)=>{let n=new Map;for(let r=t;r<=o;r++)n.set(e[r],r);return n},e1=new WeakMap,t1=new WeakMap,WT=un((e,t,o)=>{let n;return o===void 0?o=t:t!==void 0&&(n=t),r=>{if(!(r instanceof dn))throw new Error("repeat can only be used in text bindings");let i=e1.get(r)||[],a=t1.get(r)||[],s=[],c=[],l=[],u=0;for(let v of e)l[u]=n?n(v,u):u,c[u]=o(v,u),u++;let p,m,f=0,h=i.length-1,_=0,g=c.length-1;for(;f<=h&&_<=g;)if(i[f]===null)f++;else if(i[h]===null)h--;else if(a[f]===l[_])s[_]=Tc(i[f],c[_]),f++,_++;else if(a[h]===l[g])s[g]=Tc(i[h],c[g]),h--,g--;else if(a[f]===l[g])s[g]=Tc(i[f],c[g]),VT(r,i[f],s[g+1]),f++,g--;else if(a[h]===l[_])s[_]=Tc(i[h],c[_]),VT(r,i[h],i[f]),h--,_++;else if(p===void 0&&(p=Z$(l,_,g),m=Z$(a,f,h)),!p.has(a[f]))jT(i[f]),f++;else if(!p.has(a[h]))jT(i[h]),h--;else{let v=m.get(l[_]),x=v!==void 0?i[v]:null;if(x===null){let E=J$(r,i[f]);Tc(E,c[_]),s[_]=E}else s[_]=Tc(x,c[_]),VT(r,x,i[f]),i[v]=null;_++}for(;_<=g;){let v=J$(r,s[g+1]);Tc(v,c[_]),s[_++]=v}for(;f<=h;){let v=i[f++];v!==null&&jT(v)}e1.set(r,s),t1.set(r,l)}});var o1=new WeakMap,ie=un(e=>t=>{if(!(t instanceof dn))throw new Error("unsafeHTML can only be used in text bindings");let o=o1.get(t);if(o!==void 0&&qa(e)&&e===o.value&&t.value===o.fragment)return;let n=document.createElement("template");n.innerHTML=e;let r=document.importNode(n.content,!0);t.setValue(r),o1.set(t,{value:e,fragment:r})});var n1=new WeakMap,r1=2147483647,e3=un((...e)=>t=>{let o=n1.get(t);o===void 0&&(o={lastRenderedIndex:r1,values:[]},n1.set(t,o));let n=o.values,r=n.length;o.values=e;for(let i=0;i<e.length&&!(i>o.lastRenderedIndex);i++){let a=e[i];if(qa(a)||typeof a.then!="function"){t.setValue(a),o.lastRenderedIndex=i;break}i<r&&a===n[i]||(o.lastRenderedIndex=r1,r=0,Promise.resolve(a).then(s=>{let c=o.values.indexOf(a);c>-1&&c<o.lastRenderedIndex&&(o.lastRenderedIndex=c,t.setValue(s),t.commit())}))}});var l_=[];function gu(e){l_.push(e)}function i1(e,t,o,n){e.addEventListener(t,o,n);let r=()=>e.removeEventListener(t,o,n);return gu(r),r}function a1(e=document.documentElement,t=document.documentElement||document.body,o=(document.documentElement||document.body).scrollTop){return t.style.left="0",t.style.right="0",t.style.top=`-${o}px`,t.style.position="fixed",(n=!0)=>{t.style.left="",t.style.right="",t.style.top="",t.style.position="",n&&(e.scrollTop=o)}}var u_=["a","area","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'];function d_(e){return e.matches(u_.join(","))}function s1(e,t=!0){return o=>{if(o.target instanceof Element&&!e.contains(o.target)){o.preventDefault();let n,r=Array.from(e.querySelectorAll(u_.join(",")));o.target.compareDocumentPosition(e)&(t?Node.DOCUMENT_POSITION_PRECEDING:Node.DOCUMENT_POSITION_FOLLOWING)&&r.reverse();let i=r.length;for(;i--;){let a=r[i],s=getComputedStyle(a);if(!a.hidden&&s.display!=="none"&&s.visibility!=="hidden"&&(a.offsetWidth>0||a.offsetHeight>0)){n=a;break}}n=n||e,n.focus()}}}function KT(e){let t=e.createElement("span");return t.setAttribute("tabindex","0"),t.classList.add("modal-tab-sentinel"),t}var p_=e=>{let t=e.querySelector("[data-autofocus]");if(t&&d_(t)){t.focus();return}e.focus()},Ge=class{constructor(t){this.restoreScrollbar=()=>{};this.clickHandler=t=>{let o=t.target,n=o.closest(".modal-pop-content"),r=o.closest(".modal-close");r?(t.preventDefault(),this.hide(r.getAttribute("data-modal-result"))):n&&(t.preventDefault(),this.popContent())};this.escHandler=t=>{t.keyCode===27&&(t.preventDefault(),this.hide())};this.setAriaLabelledBy=t=>{let o=t.querySelector("h1")||t.querySelector("h2")||t.querySelector("h3")||t.querySelector("h4")||t.querySelector("p")||t.querySelector("figcaption");o&&(o.id||(o.id="modal-heading"),t.setAttribute("aria-labelledby",o.id))};this.container=Y.createElement("div"),this.container.setAttribute("tabindex","-1"),this.container.setAttribute("role","dialog"),this.container.setAttribute("aria-modal","true"),this.container.classList.add("modal","has-default-focus"),I(d`<div class="modal-background modal-close"></div>
				${t} `,this.container),this.wrapper=Y.createElement("div"),this.wrapper.setAttribute("data-bi-name","modal"),this.wrapper.insertAdjacentElement("afterbegin",this.container),this.contentStack=[t]}static get openCount(){return window.openModalCount||0}static set openCount(t){window.openModalCount=t}show(){return this.container.classList.contains("is-active")?this.openPromise:(Ge.openCount++,Y.body.insertAdjacentElement("afterbegin",KT(Y)),Y.body.insertAdjacentElement("afterbegin",this.wrapper),this.wrapper.addEventListener("click",this.clickHandler),this.wrapper.addEventListener("keydown",this.escHandler),this.restoreScrollbar=a1(Y.documentElement,Y.scrollingElement||Y.documentElement,(Y.scrollingElement||Y.documentElement||Y.body).scrollTop),this.container.classList.add("is-active"),Y.body.insertAdjacentElement("afterbegin",KT(Y)),this.setAriaLabelledBy(this.container),window.dispatchEvent(new CustomEvent("modal-show",{detail:{container:this.container}})),this.lastFocus=Y.activeElement,this.focusHandler=s1(this.wrapper),i1(window,"focus",this.focusHandler,!0),p_(this.container),this.openPromise=new Promise(t=>this.resolveOpen=t),this.openPromise)}hide(t=null){!this.container.classList.contains("is-active")||(Ge.openCount--,this.restoreScrollbar(),this.container.classList.remove("is-active"),this.wrapper.parentElement.removeChild(this.wrapper),Array.from(Y.body.querySelectorAll(".modal-tab-sentinel")).forEach(o=>{Y.body.removeChild(o)}),window.removeEventListener("focus",this.focusHandler),this.wrapper.removeEventListener("click",this.clickHandler),this.wrapper.removeEventListener("keydown",this.escHandler),this.lastFocus&&this.lastFocus instanceof HTMLElement&&this.lastFocus.focus(),this.resolveOpen(t),this.resolveOpen=void 0,this.openPromise=void 0)}updateContent(t,o=!0,n=!1){let r=this.container.querySelector(".modal-slide-container"),i=r.querySelector(".modal-slide:first-of-type");if(r===null||i===null)throw new Error(`The ${r===null?"modal-slide-container":"modal-slide"} class is missing!`);r.appendChild(t);let a={forward:ko.userDir==="ltr"?"slide-right":"slide-left",backward:ko.userDir==="ltr"?"slide-left":"slide-right"},s=n?a.forward:a.backward;o?(setTimeout(()=>{i.classList.add(s),t.classList.add(s)},50),setTimeout(()=>{t.classList.remove(s),c(this)},250)):c(this);function c(l){r.removeChild(i),p_(l.container),l.setAriaLabelledBy(l.container)}}pushContent(t){this.contentStack.push(t),I(d`<div class="modal-background modal-close"></div>
				${this.contentElement} `,this.container),this.setAriaLabelledBy(this.container),p_(this.contentElement)}popContent(){if(this.contentStack&&this.contentStack.length<=1)throw new Error("Error getting modal content");this.contentStack.pop(),I(d`<div class="modal-background modal-close"></div>
				${this.contentElement} `,this.container),p_(this.contentElement)}get contentElement(){return this.contentStack[this.contentStack.length-1]}};var Bi={setItem(e,t,o){try{let n=o.getTime();if(Date.now()>=n)return;let r={value:t,expiry:n};nt.setItem(e,JSON.stringify(r))}catch{}},getItem(e){try{let t=nt.getItem(e);if(!t)return null;let o=JSON.parse(t);return typeof o.expiry!="number"||isNaN(o.expiry)||Date.now()>=o.expiry?(nt.removeItem(e),null):o.value}catch{return null}},removeItem(e){nt.removeItem(e)},clear(){nt.clear()}};var t3={Complete:{color:"success",icon:"docon-status-success-outline",text:IL},Failed:{color:"danger",icon:"docon-status-failure-outline",text:PL},Running:{color:"warning",icon:"docon-status-info-outline",text:RL}};function QT(){let e=new Date(Date.now()+6e5);Bi.setItem("check-merge-status","true",e)}function o3(){return Bi.getItem("check-merge-status")!==null}function n3(){Bi.removeItem("check-merge-status")}async function Sc(e=!1){if(!(!e&&!o3()))try{let t=await qT();if(t===null||(c1(t),t!=="Running"))return;let o=setInterval(async()=>{t=await qT(),c1(t),t!=="Running"&&(clearInterval(o),n3())},3e4)}catch{}}async function r3(){try{await U$()}catch{}let e=document.getElementById("merge-status-alert");if(e===null)return;e.classList.add("disappearing"),document.getElementById("add-account").classList.add("is-sliding-up"),I(d``,e.parentElement)}async function c1(e){if(e==="Acknowledged")return;if(e==="Locked"){i3();return}e==="Complete"&&fo.type==="profile"&&await Ya();let t=t3[e];if(!t)return;let o=document.querySelector("#add-account");if(!o)return;e==="Running"?(o.disabled=!0,o.classList.add("is-disabled")):(o.disabled=!1,o.classList.remove("is-disabled"));let n=document.querySelector(".accounts"),r=n.querySelector(".merging-status");n!==null&&(r===null&&(r=document.createElement("div"),r.classList.add("merging-status"),n.appendChild(r)),I(d`
			<div
				id="merge-status-alert"
				class="alert is-inline-alert is-radiusless is-${t.color}"
			>
				<span class="icon has-text-${t.color}" aria-hidden="true">
					<span class="docon ${t.icon}"></span>
				</span>
				<p class="display-inline">${ie(t.text)}</p>
				${e!=="Running"?d`<button
							class="delete position-absolute right-0 margin-xxs"
							data-dismiss=""
							type="button"
							@click=${()=>r3()}
					  ></button>`:null}
			</div>
		`,r))}function i3(){let e=document.createElement("div"),t=new Ge(e);I(d` <div class="modal-card">
			<section class="modal-card-body">
				<button
					data-dismiss
					type="button"
					class="dismiss delete modal-close position-absolute delete-lg margin-top-xs margin-right-xs top-0 right-0"
					@click="${()=>$t(`https://docs.microsoft.com/${w.data.userLocale}`,!0)}"
					aria-label="${ze}"
				>
					<span class="docon docon-navigate-close" aria-hidden="true"></span>
				</button>
				<h2 class="title margin-top-xxs">${wL}</h2>
				<p>${CL}</p>
				<div
					class="display-flex font-size-sm justify-content-flex-end margin-top-sm margin-bottom-xxs"
				>
					<button
						type="button"
						class="button modal-close align-self-center hmargin-right-xxs font-size-sm button-primary button-filled"
						@click="${()=>$t(`https://docs.microsoft.com/${w.data.userLocale}`,!0)}"
						data-bi-name="merging-block-notice-signin"
					>
						${lh}
					</button>
				</div>
			</section>
		</div>`,e),t.show(),document.querySelector(".modal").addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),$t(`https://docs.microsoft.com/${w.data.userLocale}`,!0)})}function Yi(e){for(let t=0;t<e.elements.length;t++){let o=e.elements.item(t);(o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement)&&(o.onchange=()=>o.setCustomValidity(/^\s+$/.test(o.value)?kP:"")),o instanceof HTMLButtonElement&&o.type==="submit"&&(o.onclick=()=>e.classList.add("show-validation-status"))}}async function pn(e,t){let o=Y.createElement("form");o.action="javascript:",e instanceof Rr?I(e,o):o.appendChild(e),l1(o);let n=Y.createElement("div");n.classList.add("modal-content"),n.appendChild(o);let r=new Ge(n),i=!1,a={hasError:!1,data:null};return o.addEventListener("submit",async s=>{s.preventDefault(),a=t?await t(o):{hasError:!1,data:null},a.hasError===!1&&(i=!0,r.hide())}),Yi(o),await r.show(),{submitted:i,form:o,data:a.hasError?null:a.data}}async function XT(e,t){let o=Y.createElement("form");o.action="javascript:",e instanceof Rr?I(e,o):o.appendChild(e),l1(o);let n=Y.createElement("div");n.classList.add("modal-content"),n.appendChild(o);let r=new Ge(n),i="",a={hasError:!1,data:null};return o.addEventListener("submit",async s=>{s.preventDefault(),a=t?await t(o):{hasError:!1,data:null},a.hasError===!1&&(i=s.submitter.id,r.hide())}),Yi(o),await r.show(),{submitted:i,form:o,data:a.hasError?null:a.data}}function l1(e){if(e.querySelector("form"))throw new Error("The content argument should not contain a form")}function hu(e,t,o=kn){return d` <section class="modal-card is-shadowless-mobile padding-xs padding-sm-tablet">
		<h2 class="title is-3 margin-bottom-xs margin-right-xxs" id="modal-heading">${e}</h2>
		<button
			class="modal-close modal-card-close-button is-large is-sticky"
			aria-label="${ze}"
		></button>
		<div class="flex-grow-0 padding-none">
			<p ?hidden="${!t}" id="modal-text" class="font-size-sm padding-bottom-sm">
				${ie(t)}
			</p>
			<div class="buttons margin-bottom-none">
				<button class="button button-primary button-filled button-sm" type="submit" data-autofocus>
					${o}
				</button>
				<button type="button" class="modal-close button button-sm">${Je}</button>
			</div>
		</div>
	</section>`}async function u1(e){e.isAuthenticated&&Ne.mecMigration&&e.isMecUser&&await c3()}async function c3(){let{submitted:e}=await XT(m_(fp,null,!1,YI,GI,VI,!1,gy,jI,"puppy.svg"));e==="primary"?d1():e==="secondary"&&d3()}async function l3(){await pn(m_(fp,XI,!0,null,ZI,null,!1,ze,null,"success.svg"))}async function u3(){await pn(m_(fp,JI,!0,null,eP,null,!1,ze,null,"desert.svg"))}async function d3(){let{submitted:e}=await XT(m_(fp,WI,!0,null,KI,null,!0,QI,gy,"alert.svg"));e==="primary"?p3():e==="secondary"&&d1()}function d1(){K$(),l3()}function p3(){Q$(),u3()}function m_(e,t,o,n,r,i,a,s,c,l){let u="";o&&(u="has-text-centered padding-left-sm padding-right-sm");let p="";return a&&(p="button-danger button-filled"),d` <section
		class="modal-card justify-content-center is-shadowless-mobile padding-xs padding-sm-tablet"
	>
		<p class="title margin-bottom-xs font-size-h5 has-text-centered" id="mec-modal-heading">
			${e}
		</p>
		<div class="padding-none">
			<div class="display-flex justify-content-center margin-bottom-xs">
				<img
					role="presentation"
					class="padding-sm-tablet"
					src="/en-us/media/mec-migration/${l}?branch=main"
				/>
			</div>
			<p
				?hidden="${!t}"
				id="modal-intro"
				class="title is-3 font-size-h5 padding-inline-xl-desktop padding-inline-xl-tablet ${u}"
			>
				${t}
			</p>
			<p ?hidden="${!n}" id="modal-text-1" class="title is-3 font-size-h5">
				${n}
			</p>
			<p ?hidden="${!r}" id="modal-text-2" class="font-size-md padding-bottom-sm">
				${r}
			</p>
			<p ?hidden="${!i}" id="modal-text-3" class="font-size-md padding-bottom-sm">
				${i}
			</p>
			<div class="buttons margin-bottom-none justify-content-center">
				<button
					?hidden="${!c}"
					type="submit"
					class="button button-md flex-grow-1"
					id="secondary"
				>
					${c}
				</button>
				<button
					?hidden="${!s}"
					class="button button-primary button-filled button-md flex-grow-1 ${p}"
					type="submit"
					id="primary"
				>
					${s}
				</button>
			</div>
		</div>
	</section>`}var f_,g_;async function p1(e){m3(e)&&await f3()}function m3(e){let t=te("page_type")==="profile";if(!e.isAuthenticated||t)return!1;let o=!1;return typeof e.acceptedPrivacyNotice=="boolean"?o=e.acceptedPrivacyNotice:o=new Date(e.acceptedPrivacyNotice)>=rT,!o}async function f3(){if(!f_){let e=Y.createElement("div");e.classList.add("modal-content"),I(d` <div
				id="consentModal"
				class="modal-card is-shadowless-mobile fill-mobile padding-xs padding-sm-tablet"
			></div>`,e),f_=new Ge(e),g_=e.querySelector("#consentModal"),m1()}await Dt,f_.show()}function m1(){let e=y.userType==="microsoft"?nP:Ll,t=()=>L$(),o=d`
		<section class="modal-card-body">
			<h2 class="title is-text-centered">${e}</h2>
			<p>${ie(JT())}</p>
			<button
				id="consent"
				@click="${t}"
				class="modal-close button button-primary button-filled display-block margin-inline-auto margin-top-sm"
				data-autofocus
			>
				${gP}
			</button>
			<button
				id="noThanks"
				@click="${g3}"
				class="link-button margin-inline-auto margin-top-xs"
			>
				${fP}
			</button>
		</section>
	`;I(o,g_)}function g3(){let e=d` <section class="modal-card-body padding-bottom-none">
		<h2>${ti}</h2>
		<p>${aP}</p>
		<p class="margin-top-sm">${lg}</p>
		<div class="display-flex justify-content-flex-end margin-top-lg">
			<button
				id="consent-close"
				class="button border-none padding-inline-sm margin-right-xxs has-text-primary"
				@click="${m1}"
				data-autofocus
			>
				${ze}
			</button>
			<button id="consent-delete-acct" class="button button-danger button-filled padding-inline-sm">
				${Ri}
			</button>
		</div>
		<p
			hidden
			id="error-message"
			class="has-text-danger display-flex justify-content-flex-end margin-bottom-sm"
			aria-live="assertive"
			aria-relevant="text"
		>
			${go}
		</p>
	</section>`;I(e,g_),h3(g_)}async function h3(e){let t=e.querySelector("#error-message"),o=e.querySelector("#consent-delete-acct");t.setAttribute("hidden","hidden"),o.onclick=async()=>{o.classList.add("is-loading");try{await c_()?(f_.hide(),await $t(`https://docs.microsoft.com/${w.data.userLocale}/`,!0)):t.removeAttribute("hidden")}catch(n){throw t.removeAttribute("hidden"),new Error(`error: ${n.message}`)}finally{o.classList.remove("is-loading")}}}function JT(e){return e&&e.length!==0||y.userType==="microsoft"?rP.replace("{email}",e||y.upn):y.authenticationMode==="AAD"||y.userType==="aad"?ZC.replace("{email}",y.upn):eI}async function f1(e,t,o){let n=()=>o.setAttribute("data-authenticated",e.isAuthenticated.toString());n(),e.subscribe(_t,n),await t,o.setAttribute("data-auth-status-determined","true")}var jt={left:37,up:38,right:39,down:40,home:36,end:35,escape:27,enter:13,space:32,eight:56,numPadAsterisk:106,a:65,b:90};var Ec="docs-sign-in",ZT="docs-sign-out";function g1(e){v3(e),e.addEventListener("click",_3)}function _3(e){if(!(e.target instanceof Element))return;let t=e.target.closest(`.${Ec}, .${ZT}`);if(!t)return;let o=t.classList.contains(Ec);e.preventDefault();let n='a[href]:not([href=""]):not([href="#"])',r=t instanceof HTMLAnchorElement&&t.matches(n)?t.href:location.href;o?tr(r):$t(r,!0)}function v3(e){let t=o=>{if(!(o.target instanceof Element))return;let n=o.target.closest(`.${Ec}, .${ZT}`);if(!n)return;let r=n.classList.contains(Ec);o.target.setAttribute("data-m",JSON.stringify({cN:r?Ec:ZT,bhvr:r?100:101}))};e.addEventListener("touchstart",t,!0),e.addEventListener("pointerdown",t,!0),e.addEventListener("keyup",o=>{o.which===jt.enter&&t(o)},!0)}function b3(e){return e!=null&&eU.find(t=>t===e)!=null}function x3(e){if(!e)return!1;try{let t=new URL(e);if(t.host)for(let o of tU){let n=o.trim();if(!!n&&(t.host.endsWith(`.${n}`)||t.host===n))return!0}return!1}catch{return!1}}function y3(e,t){return b3(e)&&x3(t)}async function h1(){let e=it().sso,t=Y.referrer;if(oi({sso:null},"replaceState"),y3(e,t))try{oi({context:"sso",source:e},"replaceState");let o=await qi.ssoSilent({scopes:["openid","profile","email"]});o&&(kh(),wh(o.idToken))}catch(o){o instanceof Gt&&($t("",!1,!0),tr(window.location.href,!0))}}var eS,Ga=new Promise(e=>eS=e);function _1(){if(!Ne.userServices){eS(),Dt.then(()=>{let e=Y.getElementById("docs-sign-in-container-item");e&&(e.hidden=!0)});return}T$(),qi.handleRedirectPromise(),f1(y,Ga,Y.documentElement),g1(Y.documentElement),y.subscribe(_t,async()=>{await Promise.all([tT,Dt]),cc(Y.body,y)}),h1().then(()=>C$().then(eS)),Ga.then(async()=>{y.userType!=="standard"&&p1(y),y.isAuthenticated&&(await Dt,Sc(),u1(y))})}(w.data.pageTemplate==="ModuleUnit"||te("show_latex")==="true")&&(he.MathJax={showMathMenu:!1,showMathMenuMSIE:!1,tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0},AuthorInit:()=>{he.MathJax.Hub.Register.StartupHook("End",()=>{document.documentElement.classList.add("mathjax-complete")})}},w.data.mathjax?.macros&&(he.MathJax.TeX={Macros:w.data.mathjax?.macros}));async function tS(e,t){return he.adobeTarget===void 0||C.accessLevel==="local"?!1:await he.adobeTarget.isExperienceEnabled(e,t)}async function v1(){if(he.adobeTarget===void 0)return;let e=await he.adobeTarget.atRequestSucceeded;if(!e||!e.detail)return;let{analyticsDetails:t,responseTokens:o}=e.detail;if(t&&lT({actionType:"A",behavior:12,content:{},pageTags:{tnta:t[0]&&t[0].payload?t[0].payload.tnta:""}}),o){let n=o.length;for(let r=0;r<n;r++)lT({actionType:"A",behavior:12,content:{},pageTags:{at_activity_name:o[r]?o[r]["activity.name"]:"",at_exp_name:o[r]?o[r]["experience.name"]:"",at_activity_id:o[r]?o[r]["activity.id"]:"",at_exp_id:o[r]?o[r]["experience.id"]:""}})}}var oS="padding-block-xxs padding-inline-xs";function b1(e,t,o,n){let r=n?d`<div class="border-top">${n}</div>`:"";return d`
		<article
			class="border border-radius-lg overflow-hidden ${o?"position-relative":""}"
		>
			${e} ${t} ${r}
		</article>
	`}function x1(e,t){let o=d`<span class="icon margin-right-xxs">
		<span class="docon ${e}"></span>
	</span>`;return d`<div
		class="${oS} font-weight-semibold border-bottom font-size-md display-flex align-items-center background-color-body-medium"
	>
		${o}<span>${t}</span>
	</div>`}function y1(e,t,o,n){let r=n?d` <p class="has-line-height-reset color-text-subtle font-size-xs font-weight-semibold">
				${n}
		  </p>`:"";return d`
		${r}
		<a
			class="has-line-height-reset display-block margin-bottom-xxs ${o?"stretched-link":""}"
			href="${t}"
		>
			<h3 class="display-inline-block color-primary font-size-md">${e}</h3>
		</a>
	`}function nS(e){return d`<p class="font-size-xs has-line-height-reset color-text-subtle line-clamp-3">
		${e}
	</p>`}function rS(e){let t=x1("docon-special-event",lN),o=d`<div class="padding-bottom-xs ${oS}">
		${e.eventTitle?y1(e.eventTitle,e.linkHref,!1):null}
		${nS(e.eventDescription)}
		<div class="display-inline-block margin-top-xxs has-line-height-reset">
			<span class="font-weight-semibold">${e.linkText}:</span>
			<a href="${e.linkHref}" class="margin-top-xs has-text-wrap">
				${e.linkHref}</a>
			</div>
		</div>
	</div>`;return b1(t,o,!1)}function T1(e){let t=d` <figure class="media-card-image">
		<img src="${e.imageSrc}" alt="${e.eventTitle}" />
	</figure>`,o=d`<div class="media-card-content">
		<a class="has-line-height-reset display-block stretched-link" href="${e.linkHref}">
			<h3 class="display-inline-block color-primary font-size-md">${e.eventTitle}</h3>
		</a>
		${nS(e.eventDescription)}
	</div>`;return d`<article
		class="border border-radius-lg overflow-hidden position-relative media-card box-shadow-none"
	>
		${t}${o}
	</article>`}var h_={"ar-sa":"\u0627\u0644\u0639\u0631\u0628\u064A\u0629","eu-es":"Euskara","bs-latn-ba":"Bosanski","bg-bg":"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438","ca-es":"Catal\xE0","zh-cn":"\u4E2D\u6587 (\u7B80\u4F53)","zh-hk":"\u4E2D\u6587 (\u7E41\u9AD4 \u9999\u6E2F\u7279\u5225\u884C\u653F\u5340)","zh-tw":"\u4E2D\u6587 (\u7E41\u9AD4)","hr-hr":"Hrvatski","cs-cz":"\u010Ce\u0161tina","da-dk":"Dansk","nl-be":"Nederlands (Belgi\xEB)","nl-nl":"Nederlands","en-au":"English (Australia)","en-ca":"English (Canada)","en-in":"English (India)","en-ie":"English (Ireland)","en-my":"English (Malaysia)","en-nz":"English (New Zealand)","en-sg":"English (Singapore)","en-za":"English (South Africa)","en-gb":"English (United Kingdom)","en-us":"English (United States)","et-ee":"Eesti","fil-ph":"Filipino","fi-fi":"Suomi","fr-be":"Fran\xE7ais (Belgique)","fr-ca":"Fran\xE7ais (Canada)","fr-fr":"Fran\xE7ais","fr-ch":"Fran\xE7ais (Suisse)","gl-es":"Galego","ka-ge":"Georgian","de-at":"Deutsch (\xD6sterreich)","de-de":"Deutsch","de-ch":"Deutsch (Schweiz)","el-gr":"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC","he-il":"\u05E2\u05D1\u05E8\u05D9\u05EA\u200F","hi-in":"\u0939\u093F\u0902\u0926\u0940","hu-hu":"Magyar","is-is":"\xCDslenska","id-id":"Bahasa Indonesia","ga-ie":"Irish (Ireland)","it-it":"Italiano","it-ch":"Italiano (Svizzera)","ja-jp":"\u65E5\u672C\u8A9E","kk-kz":"\u049A\u0430\u0437\u0430\u049B","ko-kr":"\uD55C\uAD6D\uC5B4","lv-lv":"Latvie\u0161u","lt-lt":"Lietuvi\u0173","lb-lu":"Luxembourgish (Luxembourg)","ms-my":"Bahasa Malaysia","mt-mt":"Maltese (Malta)","nb-no":"Norsk","pl-pl":"Polski","pt-br":"Portugu\xEAs (Brasil)","pt-pt":"Portugu\xEAs (Portugal)","ro-ro":"Rom\xE2n\u0103","ru-ru":"\u0420\u0443\u0441\u0441\u043A\u0438\u0439","sr-cyrl-rs":"\u0421\u0440\u043F\u0441\u043A\u0438 (\u0421\u0440\u0431\u0438\u0458\u0430 \u0438 \u0426\u0440\u043D\u0430 \u0413\u043E\u0440\u0430)","sr-latn-rs":"Srbija - Srpski","sk-sk":"Sloven\u010Dina","sl-si":"Slovenski","es-mx":"Espa\xF1ol (M\xE9xico)","es-es":"Espa\xF1ol (Espa\xF1a)","sv-se":"Svenska","th-th":"\u0E44\u0E17\u0E22","tr-tr":"T\xFCrk\xE7e","uk-ua":"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430","vi-vn":"Ti\xEA\u0301ng Vi\xEA\u0323t"};var _u=/^\/([a-z]{2,3}-(?:[a-z]{4}-)?[a-z]{2})(\/|$)/i,S3="MarketplaceSelectedLocale";function S1(e){return!!h_[e]}function Nr(e,t,o=!0){return!e||!S1(t)||e.indexOf("http://")===0||e.indexOf("https://")===0||e.indexOf("//")===0?e:_u.test(e)?o?E3(e,t):e:"/"+t+e}function wc(e){return e.replace(_u,"/")}function E3(e,t){return e.replace(_u,`/${t}$2`)}function E1(e){Nh.set(S3,e,{expires:365*10})}function w1(e){Array.from(document.querySelectorAll(".locale-selector-link")).forEach(t=>w3(t,e))}function w3(e,t){let o=e.querySelector(".local-selector-link-text"),n=h_[t];o?o.textContent=n:e.textContent=n,e.href=`/${t}/locale?target=${location.href}`}var C3=["ApiBrowserPage","BlogHome","Challenge","Conceptual","ContentBrowserPage","ContentPage","Course","Directory","Home","Hub","HubPage","Landing","LandingPage","LearnHome","LearnTV","LearningPath","Marketing","Reference","Role","Sample","SearchPage","Show","TopicLanding","Welcome"],k3=["/aspnet/core/blazor/globalization-localization","/dotnet/framework/ui-automation/accessibility-best-practices","/learn/modules/intro-accessibility-disability/","/learn/modules/write-inclusive-windows-apps/","/learn/paths/accessibility-fundamentals/","/microsoft-edge/accessibility/","/microsoft-edge/devtools-guide-chromium/accessibility/reference","/windows/uwp/design/accessibility/basic-accessibility-information","/xamarin/android/app-fundamentals/accessibility","/xamarin/ios/app-fundamentals/accessibility","/xamarin/xamarin-forms/app-fundamentals/accessibility/"];function __(e=location.pathname,t=fo.template){return e=wc(e),k3.includes(e)?!1:C3.includes(t)||!t&&e.startsWith("/answers/")}function v_(){let e=document.getElementById("cookie-consent-holder");return!e||document.getElementById("banner-holder")?null:(e.insertAdjacentHTML("afterend",'<div id="banner-holder" class="has-default-focus has-overflow-hidden"></div>'),e.nextElementSibling)}function iS(e,t,o,n,r){let i=ig(),a=i>t.getTime()&&i<=o.getTime(),s=localStorage.getItem(e)==="hide",c=wc(location.pathname).toLowerCase();c=c.startsWith("/")?c.substring(1):c;let l=!!n.find(u=>r?c===u:c.startsWith(u));return a&&!s&&l}var nm=[];function A3({uid:e,startDate:t,endDate:o,cssClass:n,title:r,subtitle:i,description:a,cta:s,theme:c,buttonCss:l=""},u=Date.now()){if(!Ne.marketing||u<t.getTime()||u>=o.getTime()||!__()||nt.getItem(e)==="hide")return!1;let p=v_();if(!p)return!1;p.classList.add(`theme-${c}`);let m=d`<section
		class="tier1-event-banner position-relative padding-top-md padding-bottom-md ${n}"
		data-bi-name="tier1-event-banner"
		data-dismissable="disappearing"
	>
		<div class="uhf-container display-flex-tablet align-items-center">
			<div class="has-backdrop-filter-blur margin-right-xxl-tablet">
				<h2 class="title is-2 margin-bottom-xs">${r}</h2>
				<p class="font-size-sm">${i}</p>
			</div>
			<p
				class="container is-max-mobile display-none display-block-widescreen has-backdrop-filter-blur font-size-sm margin-left-none margin-right-xxl"
			>
				${a}
			</p>
			<a class="button margin-block-sm ${l}" data-bi-name="CTA" href="${s.href}">
				<span>${s.title}</span>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-chevron-right-light"></span>
				</span>
			</a>
		</div>
		<button
			type="button"
			class="button delete delete-lg position-absolute top-0 right-0 margin-xs margin-sm-tablet ${l}"
			data-dismiss
			data-bi-name="close"
			@click=${()=>nt.setItem(e,"hide")}
		>
			<span class="visually-hidden">${Qs}</span>
		</button>
	</section>`;return I(m,p),!0}function I3(e=ig()){let t=new Date("2022-04-26T18:00:00.000Z"),o=new Date("2022-05-26T18:59:00.000Z"),n=new Date("2022-05-24T07:00:00.000Z").getTime(),r="build-2022-05--register",i=Sk,a=wk,s="https://mybuild.microsoft.com?wt.mc_ID=Build2022_corp_bn_oo_bn_Docs_Docs";return e>=n&&(r="build-2022-05--watch-live",i=Ek,a=Ck),A3({uid:r,title:yk,subtitle:Tk,description:i,cta:{title:a,href:s},startDate:t,endDate:o,cssClass:"build-banner",theme:"light",buttonCss:"button-filled"},e)}function C1(){return I3()}var b_="banner-instructions",P3=1e3*60*60*24;function k1(e=Ne.temporaryClientSideEventBanners){if(!!e){try{N3()}catch{nt.removeItem(b_)}R3()}}async function R3(e=J,t=new Date){let o=A1();if(o&&o.date.getTime()+P3>Date.now())return;let n=new URL(`/${w.data.userLocale}/banners/index.json`,location.origin);if(location.hostname!=="docs.microsoft.com"&&location.hostname!=="developer.microsoft.com"){let a=new URLSearchParams(location.search).get("api-branch")??"main";n.searchParams.set("branch",a)}let r=await e(n.href),{banners:i=[]}=r.ok?await r.json():{};nt.setItem(b_,JSON.stringify({date:t,banners:i}))}function N3(){let e=A1();if(!e)return;let t=w.data.userLocale,o=e.banners.filter(n=>n.location==="sectional"&&n.scope.accessLevels.includes("online")&&n.content.link&&(!n.scope.locales||n.scope.locales.includes(t))).map(({uid:n,scope:r,content:i})=>{let[a,s]=i.text.split("|");s||(s=a,a=""),a=a.trim(),s=s.trim();let c=r.paths.map(m=>m.substring(1).replace(/\*/g,"")),l=!r.paths.find(m=>m.endsWith("*")),u=i.link.href.startsWith("/")?`/${t}${wc(i.link.href)}`:i.link.href;return{id:n,startTime:r.startDate,endTime:r.endDate,paths:c,fullPathMatch:l,eventTitle:a,eventDescription:s,linkHref:u,linkText:i.link.title,imageSrc:i.imageUrl??null}});nm.push(...o)}function A1(){let e=nt.getItem(b_);if(!e)return null;try{let t=JSON.parse(e);if(t.date=new Date(t.date),isNaN(t.date.getTime()))return null;for(let o of t.banners)if(o.scope.startDate=new Date(o.scope.startDate),o.scope.endDate=new Date(o.scope.endDate),isNaN(o.scope.startDate.getTime())||isNaN(o.scope.endDate.getTime()))return null;return t}catch{nt.removeItem(b_)}return null}async function I1(){if(!__()||C1())return;k1();let e="DocsExp\u2013452392\u2013A/B\u2013Docs/PostBuildBanner\u2013RightRail\u2013FY22Q4",t="Experience B",o="Experience C",[n,r]=await Promise.all([tS(e,t),tS(e,o)]);if(n||r||Ne.previewRailEventCard||Ne.previewRailEventImageCard){let i=nm.filter(s=>{let{id:c,startTime:l,endTime:u,paths:p,fullPathMatch:m}=s;return iS(c,l,u,p,m)}),a=Array.from(document.querySelectorAll("#right-rail-events, #right-rail-events-mobile"));if(i.length>0)for(let s of a)(r||Ne.previewRailEventImageCard)&&(i[0].imageSrc?I(T1(i[0]),s):I(rS(i[0]),s),s.hidden=!1),(n||Ne.previewRailEventCard)&&(I(rS(i[0]),s),s.hidden=!1)}else for(let i of nm){let{id:a,startTime:s,endTime:c,paths:l,fullPathMatch:u}=i;if(!iS(a,s,c,l,u))continue;let m=v_();if(!m)return;let f=D3(`${a}-banner`,`${a}-event`,i.eventTitle,i.eventDescription,i.linkHref,i.linkText);I(f,m);let h=m.querySelector("[data-dismiss]");h.onclick=()=>nt.setItem(a,"hide")}}function D3(e,t,o,n,r,i){return d`<section
		id=${e}
		data-bi-name=${t}
		data-dismissable="disappearing"
		class="alert is-banner is-info border-bottom padding-inline-none"
	>
		<div class="uhf-container display-flex align-items-center font-size-sm">
			<span class="flex-grow-1">
				${o?d`<span class="font-weight-semibold">${o}</span>:`:null}
				<span class="margin-right-xs">${n}</span>
				<a
					id="${e}-banner-anchor"
					class="font-weight-semibold"
					data-bi-name="CTA"
					href="${r}"
					><span>${i}</span
					><span class="icon" aria-hidden="true"
						><span class="docon docon-chevron-right-light"></span></span
				></a>
			</span>
			<button
				type="button"
				class="delete delete-lg margin-left-xs"
				data-dismiss
				data-bi-name="close"
			>
				<span class="visually-hidden">${Qs}</span>
			</button>
		</div>
	</section>`}function P1(e){e.addEventListener("click",t=>{let o=t.target instanceof HTMLElement&&t.target.closest("button[data-show-more]");if(o||(o=t.target instanceof HTMLElement&&t.target.shadowRoot&&t.target.shadowRoot.activeElement&&t.target.shadowRoot.activeElement.closest("button[data-show-more]")),o||(o=t.target instanceof HTMLElement&&t.target.shadowRoot&&t.target.shadowRoot.activeElement&&t.target.shadowRoot.activeElement.shadowRoot&&t.target.shadowRoot.activeElement.shadowRoot.activeElement.closest("button[data-show-more]")),!o)return;let n=o.getAttribute("aria-controls"),r=document.getElementById(n);if(r||(r=t.target instanceof HTMLElement&&t.target.shadowRoot&&t.target.shadowRoot.activeElement&&t.target.shadowRoot.activeElement.closest(`[id='${n}']`)),r||(r=t.target instanceof HTMLElement&&t.target.shadowRoot&&t.target.shadowRoot.activeElement&&t.target.shadowRoot.activeElement.shadowRoot.activeElement.closest(`[id='${n}']`)),!r)return;let i=o.getAttribute("aria-expanded")==="true";o.setAttribute("aria-expanded",(!i).toString());let a=Array.from(r.querySelectorAll(".expandable")),s=Array.from(document.querySelectorAll(`#${CSS.escape(n)} .expandable .expandable`));a=a.filter(u=>!s.includes(u));for(let u of a)u.classList.toggle("is-expanded");if(o.hasAttribute("data-show-once")){o.remove();return}let c=o.querySelector(".show-more-text");if(!c)return;let l={show:o.getAttribute("data-title")||xy,hide:o.getAttribute("data-expanded-title")||fD};if(c.innerText=i?l.show:l.hide,!i){let u=r.querySelector(".is-expanded");if(!u)return;let p=u.querySelector(u_.join(","));p?o.compareDocumentPosition(p)&Node.DOCUMENT_POSITION_FOLLOWING||p.focus():u.focus()}})}function R1(e,t="show-more-btn",o,n){return d`
		<button
			class="${o||"button button-primary"}"
			aria-controls="${e}"
			aria-expanded="false"
			data-show-more
			data-bi-name="${t}"
			@click=${n}
		>
			<span class="show-more-text">${xy}</span>
			<span class="icon" aria-hidden="true">
				<span class="expanded-indicator docon docon-chevron-down-light"></span>
			</span>
		</button>
	`}function N1(){window.addEventListener("click",({target:e})=>{let t=e instanceof Element&&e.closest("[data-dismiss]");if(!t)return;let o=t.closest("[data-dismissable]");!o||x_(o)},{passive:!0})}async function x_(e){e.getAttribute("data-dismissable")==="disappearing"&&(e.classList.add("disappearing"),await new Promise(t=>setTimeout(t,500))),e.classList.remove("disappearing"),e.remove(),lc()}function D1(e){e.addEventListener("click",t=>{let o=null;if(o=t.target instanceof Element&&t.target.closest(".dropdown-trigger"),o||(o=t.target instanceof Element&&t.target.shadowRoot&&t.target.shadowRoot.activeElement&&t.target.shadowRoot.activeElement.closest(".dropdown-trigger")),!o)return;t.preventDefault();let n=o.parentElement,r=o.getAttribute("aria-expanded")!=="true",i=Array.from(o.parentElement.querySelectorAll(".dropdown-trigger")).filter(s=>s.parentElement===n);i.forEach(s=>{s.setAttribute("aria-expanded",r.toString())});let a;if(r){n.classList.contains("has-centered-menu")||L3(n);let s=p=>{p.target instanceof Element&&(!n.contains(p.target)||p.type==="click"&&p.target.closest(".dropdown-menu-close"))&&(a(),p.target.classList.contains("dropdown-menu-close")&&o.focus())},c=p=>{p.keyCode===jt.escape&&(a(),o.focus())},l=async()=>{(Y.activeElement&&Y.activeElement.nodeName||"").toLowerCase()==="iframe"&&a()};a=()=>{e.removeEventListener("focus",s),e.removeEventListener("click",s),e.removeEventListener("touchstart",s),e.removeEventListener("keydown",c),he.removeEventListener("blur",l),i.forEach(p=>{p.setAttribute("aria-expanded","false")})};let u=!0;e.addEventListener("focus",s,u),e.addEventListener("click",s),e.addEventListener("touchstart",s),e.addEventListener("keydown",c),e.addEventListener("collapse-dropdown",p=>{p.stopPropagation(),a()}),he.addEventListener("blur",l)}})}function L3(e){let t=h=>he.getComputedStyle(h).overflowX,o=e.parentElement;for(;o&&o.nodeName!=="BODY"&&t(o)!=="hidden";)o=o.parentElement;if(o===null)return;let n=e.querySelector(".dropdown-trigger"),r=e.querySelector(".dropdown-menu"),i=e.closest(".dropdown-menu")!==null,a=r.classList.contains("is-vertically-scrollable");r.style.left="",r.style.right="",r.style.maxHeight="";let{left:s,right:c}=o.getBoundingClientRect(),{left:l,right:u,top:p,bottom:m}=n.getBoundingClientRect(),f=r.getBoundingClientRect().width;i?(r.style.top="-1px",w.data.userDir==="ltr"?u+f<=c?(r.style.right="0",r.style.transform="translateX(100%)"):(r.style.left="0",r.style.transform="translateX(-100%)"):u-f>=s?(r.style.left="0",r.style.transform="translateX(-100%)"):(r.style.right="0",r.style.transform="translateX(100%)"),a&&(r.style.maxHeight=`${he.innerHeight-p-8}px`)):(w.data.userDir==="ltr"?l+f<=c?r.style.left="0":r.style.right="0":u-f>=s?r.style.right="0":r.style.left="0",a&&(r.style.maxHeight=`${he.innerHeight-m-8}px`))}function rm(e){if(!e)return"";let{primary:t,secondary:o}=e;return d`
		<ol class="nav-bar-list">
			${L1(o,!0)} ${L1(t)}
		</ol>
	`}function L1(e,t=!1){if(!e)return"";let{href:o,title:n}=e;return d`
		<li class="nav-bar-item ${t?"has-spacing":""}">
			<a
				class="button button-sm button-primary ${t?"":"button-filled"}"
				href="${o}"
			>
				${n}
			</a>
		</li>
	`}var Ae=class{};var y_=class{constructor(){this._contentStack=[];this._titleStack=[]}get stackLength(){return this._contentStack?this._contentStack.length:void 0}get bodyTemplate(){return this.stackLength?this._contentStack[this._contentStack.length-1]:null}push(t){if(!t)throw new Error("Cannot push empty content");this._contentStack.push(t)}pop(){!this._contentStack||this.stackLength<=1||(this._contentStack.pop(),this._titleStack&&this._titleStack?.length>0&&this._titleStack.pop())}pushTitle(t){t&&this._titleStack.push(t)}getTitle(){return!this._titleStack||this._titleStack?.length===0?null:this._titleStack[this._titleStack.length-1]}dispose(){this._contentStack=null}};var Gi=class extends Error{constructor(o){let{status:n,statusText:r,url:i}=o;super(`Unexpected response status ${n}: ${r} from "${i}".`);this.name=this.constructor.name,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,this.constructor),this.status=n,this.statusText=r,this.url=i}};var M3=["All","Documentation","Learn","QnA","Reference","Show","Event"];async function M1(e,t=w.data.userLocale){let o={query:e,suggestions:[]};if(!e)return Promise.resolve(o);let n=`${re.siteSearch}/autocomplete?${Le({locale:t,query:e})}`,r={mode:"cors",credentials:C.supportLevel==="production"&&C.reviewFeatures?"include":"same-origin"},i=await J(n,r);if(i.ok)return i.json();if(i.status===403)return{query:e,suggestions:[]};throw new Gi(i)}function vu(e){let t=new URLSearchParams(e),o=t.get("category")||"All",n=M3.find(r=>r.localeCompare(o,void 0,{sensitivity:"base"})===0)||"All";return{dataSource:t.get("dataSource"),category:n,skip:parseInt(t.get("skip")||"0"),term:t.get("search"),scope:t.get("scope"),preview:t.get("preview")}}var T_=(()=>{let e;return t=>{if(!t&&e!==void 0)return e;let o=it().dataSource;return e=te("is_archived")==="true"||w.data.pageTemplate==="SearchPage"&&o==="previousVersions",e}})();function O1(){let e=w.data.context.searchScope||te("scope");if(w.data.pageTemplate==="SearchPage"&&(e=vu(location.search).scope),te("hideScope")==="true"||!e)return"";let n=e.split(",").map(r=>r.trim()).filter(r=>r.length);return n.length?n[n.length-1]:""}var S_=typeof Blob=="function"&&typeof PerformanceObserver=="function"&&typeof Intl=="object"&&typeof MutationObserver=="function"&&typeof URLSearchParams=="function"&&typeof WebSocket=="function"&&typeof IntersectionObserver=="function"&&typeof queueMicrotask=="function"&&typeof TextEncoder=="function"&&typeof TextDecoder=="function"&&typeof customElements=="object"&&typeof HTMLDetailsElement=="function"&&typeof AbortController=="function"&&typeof AbortSignal=="function"&&"entries"in FormData.prototype&&"toggleAttribute"in Element.prototype&&"replaceChildren"in Element.prototype&&"fromEntries"in Object&&"flatMap"in Array.prototype&&"trimEnd"in String.prototype&&"allSettled"in Promise&&"matchAll"in String.prototype&&"replaceAll"in String.prototype&&!0;var O3=3e4,U3=1e4,$3=4e3,U1=Symbol("scenario timeout"),im=class{constructor(t,o=window.fetch){this.scenario=t;this.fetch=o;this._timeoutHandle=0;this._pingTimeoutHandle=0;this._start=0}succeed(){this.complete(!0,void 0)}fail(t){this.complete(!1,t)}cancel(){this.unsubscribe(),this._start=0,this._diagnostics=null}start(){this.cancel(),this._diagnostics={type:"scenario-health",version:"1",scenario:this.scenario,durationInMilliseconds:0,succeeded:!0,reason:void 0,startConnection:ip.connection?.effectiveType??"unknown",endConnection:"unknown",wasHidden:Y.visibilityState==="hidden",wentOffline:!ip.onLine,supportedBrowser:S_,resources:[],pings:{},startDateTime:new Date().toISOString(),pingStartDateTime:null,endDateTime:null},this._start=performance.now(),addEventListener("visibilitychange",this),addEventListener("offline",this),this._timeoutHandle=setTimeout(this.complete.bind(this),O3,!1,U1),this._pingTimeoutHandle=setTimeout(()=>this.collectPingDiagnostics(),U3)}handleEvent(){var t,o;(t=this._diagnostics).wasHidden||(t.wasHidden=Y.visibilityState==="hidden"),(o=this._diagnostics).wentOffline||(o.wentOffline=!ip.onLine)}complete(t,o){this.unsubscribe();let n=this._start;if(n===0)return;this._start=0;let r=this._diagnostics;r.endDateTime=new Date().toISOString(),r.succeeded=t,r.durationInMilliseconds=performance.now()-n,r.reason=t?void 0:z3(o),r.endConnection=ip.connection?.effectiveType??"unknown",r.resources=Array.from(performance.getEntriesByType("resource")).filter(i=>i.startTime>=n).map(i=>i.toJSON()).filter(i=>i.initiatorType==="fetch"&&i.name.startsWith(location.origin)).map(i=>(i.connectEnd=Math.floor(i.connectEnd),i.connectStart=Math.floor(i.connectStart),i.domainLookupEnd=Math.floor(i.domainLookupEnd),i.domainLookupStart=Math.floor(i.domainLookupStart),i.duration=Math.floor(i.duration),i.fetchStart=Math.floor(i.fetchStart),i.redirectEnd=Math.floor(i.redirectEnd),i.redirectStart=Math.floor(i.redirectStart),i.requestStart=Math.floor(i.requestStart),i.responseEnd=Math.floor(i.responseEnd),i.responseStart=Math.floor(i.responseStart),i.secureConnectionStart=Math.floor(i.secureConnectionStart),i.startTime=Math.floor(i.startTime),i.workerStart=Math.floor(i.workerStart),i)),Po({actionType:Io.OTHER,behavior:ho.OTHER,content:r})}unsubscribe(){removeEventListener("visibilitychange",this),removeEventListener("offline",this),clearTimeout(this._timeoutHandle),clearTimeout(this._pingTimeoutHandle)}collectPingDiagnostics(){this._diagnostics.pingStartDateTime=new Date().toISOString();let t=new AbortController,o=t.signal;setTimeout(()=>t.abort(),$3);let n=async(r,i)=>{let a=performance.now();try{await this.fetch.call(window,i,{cache:"no-store",mode:"no-cors",signal:o}),this._diagnostics.pings[r]={response:!0,duration:Math.floor(performance.now()-a)}}catch{this._diagnostics.pings[r]={response:!1,duration:Math.floor(performance.now()-a)}}};return Promise.all([n("docs","https://docs.microsoft.com/robots.txt")])}};function z3(e){return e===U1?{type:"scenario-timeout"}:e instanceof Response||e instanceof Gi?{type:"dependency",url:e.url,status:e.status,statusText:e.statusText}:e instanceof Error?{type:"exception",name:e.name,message:e.message,stack:e.stack}:{type:"unknown",value:String(e)}}async function $1(e){let t=new im("Commerce.Docs.Discoverability_SiteSearch_Autocomplete");t.start();try{if(e=e.replace(/^[\s`~!@^,]+/,"").replace(/[\s`~!@^,]+$/,""),e.length<2)return t.cancel(),[];let o=await M1(e,w.data.userLocale);return t.succeed(),o.suggestions}catch(o){return t.fail(o),[]}}var z1="display-block font-size-sm padding-inline-xxs";var H3="autocomplete-change-event",q3="autocomplete-displayed-event";function F1(e){e.input.placeholder=e.input.placeholder||"",e.input.type=e.input.type||"text",e.input.required=e.input.required||!1;let{getSuggestions:t,getTitle:o=ae=>ae.toString(),itemTemplate:n=o,noResultsTemplate:r=null,initialValue:i=null,input:{biName:a}}=e,s=document.createElement("div");s.classList.add("autocomplete"),e.input.isFullWidth&&s.classList.add("display-block"),s.setAttribute("data-bi-name","autocomplete");let c=Qo(),l=`${c}-listbox`,u=ae=>ae===-1?"":`${c}-option-${ae}`,p=[],m=-1,f=i?o(i):"",h="",_=i,g=0,v=!1,x=!1,E=!1,O="";e.input.size&&(O=e.input.size==="small"?"input-sm":"input-lg");let k=()=>{let ae=s.querySelector(`#${l}`),Me=ae.children.item(m===-1?0:m);Me?Me.offsetTop+Me.offsetHeight>ae.offsetHeight?ae.scrollTop=Me.offsetTop-ae.offsetHeight+Me.offsetHeight+4:Me.offsetTop<ae.scrollTop&&(ae.scrollTop=Me.offsetTop):ae.scrollTop=0},P=()=>{I(Oo(),s),s.querySelector("input").value=f||h,k()},Te=()=>{E=!1,p=[],m=-1,P()},Se=(ae,Me)=>{let b=h;if(_=ae,f=ae?o(ae):"",h=f,Te(),Me){let R=new CustomEvent(H3,{detail:{suggestion:ae,term:b},bubbles:!0});s.dispatchEvent(R)}};Object.defineProperty(s,"value",{get(){return _},set(ae){Se(ae,!1)}});let fe=async()=>{if(h===""){v=!1,_=null,Te();return}p=await t(h);let ae=new CustomEvent(q3,{detail:p,bubbles:!0});s.dispatchEvent(ae),E=!p.length,m=-1,v=!1,P()},on=ae=>{let Me=ae.url;window.open(Me.href,"_blank")},po=ae=>{let Me=ae.target instanceof Element&&ae.target.closest('[role="option"]');if(!Me)return;ae.preventDefault();let b=Me.parentElement,R=0;for(;R<b.childElementCount&&b.children.item(R)!==Me;R++);let U=p[R];if(ae.ctrlKey&&ae.target instanceof Element&&ae.target.closest("[data-href]")){on(U);return}Se(U,!0)},mo=async ae=>{clearTimeout(g),g=setTimeout(fe,250);let Me=ae.target;h=Me.value,f="",!v&&Me.value!==""&&!x&&(v=!0,P())},Vo=()=>{x=!0},nn=()=>{x=!1},Co=()=>Te(),En=({keyCode:ae,shiftKey:Me,altKey:b,ctrlKey:R})=>{if(!(Me||b||R)){if(ae===jt.down){event.preventDefault(),m<p.length-1?(m++,f=o(p[m])):(m=-1,f=h),P();return}if(ae===jt.up){if(event.preventDefault(),!p.length)return;m===-1?(m=p.length-1,f=o(p[m])):m>0?(m--,f=o(p[m])):(m=-1,f=h),P();return}if(ae===jt.escape){event.preventDefault(),Se(_,!1);return}if(ae===jt.enter){if(m>=0){let U=p[m];Se(U,!0)}return}}};function Oo(){return d`
			<div
				class="control ${e.input.docon?`has-icons-${e.input.doconOrientation||"left"}`:""}"
			>
				<input
					id="${e.input.id}"
					class="autocomplete-input input ${O}
						${e.input.docon?`control has-icons-${e.input.doconOrientation||"left"}`:""}
						${e.input.isFullWidth?"width-full":""}"
					type="${e.input.type}"
					name=${$o(e.input.name)}
					role="combobox"
					maxlength="100"
					@input=${mo}
					@blur=${Co}
					@focus=${fe}
					@keydown=${En}
					aria-autocomplete="list"
					aria-expanded="${p.length?"true":"false"}"
					aria-owns="${l}"
					aria-controls="${l}"
					aria-activedescendant="${u(m)}"
					aria-label="${$o(e.input.label)}"
					placeholder="${e.input.placeholder}"
					autocapitalize="off"
					autocomplete="off"
					autocorrect="off"
					spellcheck="false"
					data-bi-name="${$o(a)}"
					?required=${e.input.required}
					pattern=${e.input.required?"(?!^\\s+$)^.*$":".*"}
				/>

				<span
					class="icon is-small is-${e.input.doconOrientation||"left"}"
					?hidden=${!e.input.docon||v&&e.input.doconOrientation==="right"}
					aria-hidden="true"
				>
					<span
						class="${e.input.doconClasses||"has-text-primary"} docon docon-${e.input.docon}"
					></span>
				</span>

				<span
					class="autocomplete-loader loader has-text-primary ${e.input.size==="large"?"is-large":""}"
					?hidden=${!v}
					aria-hidden="true"
				></span>
			</div>

			<ul
				id="${l}"
				class="autocomplete-suggestions is-vertically-scrollable"
				role="listbox"
				aria-label="${e.input.id}-suggestions"
				@mousedown=${ae=>ae.preventDefault()}
				@click=${po}
				@keyup=${ae=>(ae.key==="Enter"||ae.key==="Spacebar")&&po}
				?hidden=${!h.length||!E&&!p.length}
			>
				${p.map((ae,Me)=>d` <li
						id="${u(Me)}"
						role="option"
						aria-selected=${Me===m}
						class="autocomplete-suggestion ${Me===m?"is-active-descendant":""}"
					>
						${n(ae)}
					</li>`)}
				${E&&r?d`<li role="alert">${r}</li>`:""}
			</ul>
		`}return P(),s.addEventListener("compositionstart",Vo),s.addEventListener("compositionend",nn),s}function H1({suggestion:e,term:t}){Po({behavior:ho.SEARCHAUTOCOMPLETE,actionType:Io.OTHER,content:{srchq:t,srchtype:"auto suggest",resultselected:e.title,resulttype:e.type||"",resulturl:e.url||""}})}function q1(e){let t=[{srchtype:"auto suggest"}];e.forEach((o,n)=>{t.push({cN:o.title,sN:n,type:o.type||"",url:o.url||""})}),Po({content:t})}var B3="https://www.azure.cn/searchresults/";function aS(e,t=!1){let o=p=>{p.keyCode===jt.escape&&e.searchExpanded&&(e.searchExpanded=!1,Y.getElementById("form-expander").focus())},{scope:n,category:r,dataSource:i,preview:a}=G3(),s=We==="Search"?"":r,c=Y3(),l=w.data.brand==="mooncake"?"q":"terms";return d`
		<form
			class="nav-bar-search-form"
			method="GET"
			id="${t?"nav-bar-search-form-desktop":"nav-bar-search-form"}"
			name="nav-bar-search-form"
			aria-label="${tc}"
			role="search"
			action="${c}"
			@keydown=${o}
			@autocomplete-change-event=${Q3}
			@autocomplete-displayed-event=${X3}
		>
			${W3(l,t)}
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" value="${s}" hidden />
			${n?d`<input name="scope" value="${n}" hidden />`:""}
			${i?d`<input name="dataSource" value="${i}" hidden />`:""}
			${a?d`<input name="preview" value="${a}" hidden />`:""}
		</form>
	`}function Y3(){let e;return w.data.brand==="mooncake"?e=B3:C.systemContent?e=`/${w.data.userLocale}/${nc?"test/docs/search/search":"search/"}`:e=`https://docs.microsoft.com/${w.data.userLocale}/search/`,e}function B1(e,t){!e||(t=t||vu(de.search).term,e.value=t)}function G3(){let e=O1(),t=V3(),o=j3();return{scope:e,category:t,dataSource:T_()?"previousVersions":"",preview:o}}function V3(){let e=vu(de.search)?.category;if(e?.toLowerCase()!=="all")return e;let t=J3(de.href);return t&&t!=="All"?t:""}function j3(){return vu(de.search).preview||""}function W3(e,t){let o=t?Qo():"site-search-input";return F1(K3({id:o,name:e,docon:t?"search":null,size:"small"}))}function K3({id:e,name:t,isFullWidth:o=!1,docon:n=null,size:r=null}){return{input:{id:e,type:"search",name:t,placeholder:T_()?aD:tc,label:tc,docon:n||void 0,isFullWidth:o,size:r||void 0},getSuggestions:$1,itemTemplate:i=>d`<span class="${z1}">${i}</span>`}}function Q3(e){let t={suggestion:{title:e.detail.suggestion},term:e.detail.term};H1(t)}function X3(e){let t=e.detail.map(o=>({title:o}));q1(t)}function J3(e){let{pathname:t}=new URL(e);t=wc(t),t=decodeURI(t).toLowerCase();let o=te("page_kind"),n=t.split("/").slice(1),r=n[0];return r==="learn"||o==="learn"||o==="certification"?"Learn":r==="powershell"&&n.length>1&&n[1]==="module"?"Reference":r==="answers"||r==="answersv2"?"QnA":r==="shows"?"Show":r==="events"?"Event":n.indexOf("api")!==-1?"Reference":"All"}function E_(e){if(!Z3())return null;let t=Qo(),o=d`
		<span class="is-visually-hidden-mobile">${tc}</span>
		<span class="icon margin-left-xxs" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	`,n=d`<span class="nav-bar-button-text">${Je}</span>`,r=()=>{if(e.searchExpanded=!e.searchExpanded,e.searchExpanded){let a=document.getElementById("site-search-input");e.mobile&&(a.style.fontSize="16px"),a.focus(),e.mobile&&(a.style.fontSize=""),B1(a)}},i=`${e.searchExpanded?"is-expanded":""}`;return d`
		<div
			class="nav-bar-search ${e.searchExpanded?"is-expanded":""}"
			id="${t}"
			?hidden="${!e.searchExpanded}"
		>
			${aS(e)}
		</div>
		${e.mobile?null:d`
					<div class="nav-bar-search" ?hidden="${!e.desktop}">
						<!-- hidden when the width drops to tablet -->
						${aS(e,!0)}
					</div>
			  `}
		<div class="nav-bar-search ${i}" ?hidden="${e.desktop}">
			<div class="nav-bar-search-form-expander">
				<button
					id="form-expander"
					class="nav-bar-button has-hover-underline ${i}"
					title="${e.searchExpanded?hD:tc}"
					aria-expanded="${e.searchExpanded}"
					aria-controls="${t}"
					@click=${r}
				>
					${e.searchExpanded?n:o}
				</button>
			</div>
		</div>
	`}function Z3(){return te("uhfHeaderId")==="answersv2"||te("uhfHeaderId")==="answersv2MOD"?!0:We!=="Q&A"&&We!=="Startups"}function eG(e,t,o){let n;return o&&(n=[],n.push("font-weight-semibold","font-size-md")),e.kind==="link"?w_(e,!1,n,o):tG(e,t,n)}function w_({href:e,title:t},o=!1,n=[],r=!1){let i=o?"has-text-primary":"",a=r?"":"has-external-link-indicator";return d` <li class="nav-bar-mobile-nav-item ${n.join(" ")}">
		<a
			class="${a} nav-bar-button has-text-wrap ${i}"
			href="${e}"
			data-autofocus
			>${t}</a
		>
	</li>`}function tG(e,t,o=[]){return d`
		<li class="nav-bar-mobile-nav-item">
			<button
				type="button"
				class="nav-bar-button has-text-wrap"
				@click=${()=>t(e)}
				data-autofocus
			>
				<span class="is-text-left ${o.join(" ")}">${e.title}</span>
				<span class="nav-bar-button-chevron" aria-hidden="true">
					<span
						class="docon docon-chevron-${w.data.userDir==="ltr"?"right":"left"}-light"
					></span>
				</span>
			</button>
		</li>
	`}function Y1(e){return d`
		<div id="modal-header" class="nav-bar border-bottom">
			<div class="nav-bar-item">
				<button
					type="button"
					class="nav-bar-button"
					?hidden=${e.searchExpanded}
					data-autofocus
				>
					<span class="icon is-small">
						<span class="docon docon-home" aria-hidden="true"></span>
					</span>
					<h4 class="title font-size-lg padding-left-xxs">${WO}</h4>
				</button>
			</div>
			${E_(e)}
			<div class="nav-bar-item">
				<button
					type="button"
					class="nav-bar-button modal-close border-left"
					?hidden=${e.searchExpanded}
				>
					<span class="visually-hidden">${ze}</span>
					<span class="icon is-small">
						<span class="docon docon-math-multiply" aria-hidden="true"></span>
					</span>
				</button>
			</div>
		</div>
	`}function G1(e,t,o,n,r,i,a,s,c){return d`
		${nG(r,o)&&n>=2&&c?d`
					<div class="border-bottom">
						<button
							type="button"
							class="nav-bar-button pop-content is-text justify-content-flex-start padding-xs is-full-width"
							title=${Kx}
							data-autofocus
						>
							<span class="icon" aria-hidden="true">
								<span
									class="docon docon-arrow-${w.data.userDir==="ltr"?"left":"right"}"
								></span>
							</span>
							<h3 class="font-size-sm margin-inline-xxs">${c}</h3>
							<span class="is-visually-hidden">${Kx}</span>
						</button>
					</div>
			  `:null}
		${r?d`<div class="font-size-md">
					<h2 id="modal-heading" class="padding-xs font-weight-semibold">
						${r}
						${s?d`<span class="tag is-small is-uppercase">${Ug}</span>`:""}
					</h2>
			  </div>`:null}
		<nav class="nav-bar-mobile-nav" role="navigation" aria-label="${Ng}">
			<ul class="nav-bar-mobile-nav-list">
				${i?w_({href:i.href,title:bI},!1,[],!o):null}
				${e&&e.length?e.map(u=>eG(u,t,!o)):null}
				${a?d`
							${a.primary?w_(a.primary,!0):null}
							${a.secondary?w_(a.secondary,!0):null}
					  `:null}
			</ul>
		</nav>
	`}function V1(){let e="#",t=y.isAuthenticated?"font-size-xs padding-xxs":"auth-status-determined not-authenticated button button-filled button-sm has-outer-focus button-primary";We==="Q&A"?e=`/${w.data.userLocale}/answers/users/${y.isAuthenticated?"logout":"login"}.html`:t=`docs-sign-${y.isAuthenticated?"out":"in"} `+t;let o=d`<span class="flex-grow-1 flex-shrink-1 font-size-xs"
		>${ie(YO)}</span
	>`;We==="Startups"&&(o=rm({primary:{kind:"link",href:"https://portal.startups.microsoft.com/",title:"Member sign in"}}));let n=d` ${y.isAuthenticated?oG():o}
		<div>
			${y.isAuthenticated?d`<a
						class="font-size-xs padding-xxs"
						href="${Ut("me","settings")}"
						data-profile-property="settingsUrl"
				  >
						<span class="icon" aria-hidden="true">
							<span class="docon docon-settings"></span>
						</span>
						<span class="visually-hidden">${zl}</span>
				  </a>`:""}

			<a class="${t}" href="${e}"
				>${y.isAuthenticated?Fl:wp}</a
			>
		</div>`;return d`
		<div
			class="border-top display-flex align-items-center padding-xxs justify-content-space-between"
		>
			${Lp?n:o}
		</div>
	`}function oG(){return d`
		<a href="${Ut("me","activity")}" class="display-flex align-items-center">
			<div class="padding-left-xxs">
				<figure class="image is-24x24" aria-hidden="true">
					<img
						class="has-body-background-medium border-radius-rounded"
						aria-labelledby="display-name-mobile"
						alt="${y.userName}"
						data-profile-property="avatarUrl"
						src=${y.avatarUrl}
					/>
				</figure>
			</div>
			<p class="title flex-grow-1 flex-shrink-1 font-size-sm margin-none padding-left-xxs">
				<span
					id="display-name-mobile"
					class="is-inline-truncated has-max-width-200"
					data-profile-property="displayName"
					>${y.displayName}</span
				>
			</p>
		</a>
	`}function nG(e,t){return t||We!=="Docs_Home"&&e}async function W1(e){let t=Y.createElement("div");t.classList.add("modal-content","is-docked-right","display-flex","flex-direction-column");let o=new y_;t.paint=()=>{I(d` ${Y1(e)}
				<div
					id="modal-body"
					class="flex-grow-1 flex-shrink-1 is-full-height is-vertically-scrollable"
				>
					${o.bodyTemplate}
				</div>
				${V1()}`,t)};function n(){t.paint();let g=t.querySelector("#modal-body");rG(g)}function r(g){let v=g.target instanceof HTMLElement&&g.target.closest("button");!v||!v.classList.contains("pop-content")||(o.pop(),n())}let i=e.subscribe(Ae,t.paint);t.dispose=()=>{o.dispose(),i(),t.removeEventListener("click",r)};let a=j1(e.items),s,c,l,u,p;function m(g){a=g.items,s=g.title,c=null,l=null,u=null,p=o.getTitle(),f(!0),n()}function f(g=!1){let v=G1(a,m,g,o.stackLength,s,c,l,u,p);o.push(v),o.pushTitle(s)}function h(){f(),t.paint()}function _(){if(!(o.stackLength<=1)){for(;o.stackLength>1;)o.pop();n()}}if(h(),t.addEventListener("click",r),Ah){await Mp;let g=wr;g&&(c=g.category,l=g.callToAction,u=g.preview,s=g.category?g.category.title:null,a=j1(g.items),f(!0),n())}return t.querySelector("#modal-header button").onclick=_,t}function rG(e){let t=e.querySelector("[data-autofocus]");if(t&&d_(t)){t.focus();return}e.focus()}function j1(e){return e.slice(0,e.length-1)}function sS(e,t){let{leftTemplate:o,rightTemplate:n}=e;return d` ${o(t)} ${n(t)} `}function K1(){return d`
		<div class="nav-bar-profile">
			${uG()} ${lG()}
		</div>
	`}function Q1(){let e=C.accessLevel==="isolated"?Ba():d`
					<a
						class="nav-bar-button"
						itemprop="url"
						href="https://www.microsoft.com"
						aria-label="Microsoft"
					>
						${Ba()}
					</a>
			  `;return d`<div
		class="nav-bar-brand display-flex align-items-center padding-none margin-left-xs margin-left-none-tablet"
	>
		${e}
	</div>`}function X1(e,t,o){if(!t)return"";let{href:n,title:r}=t;return d`
		<a
			class="nav-bar-button is-title has-hover-underline"
			href="${n}"
			?hidden=${e.mobile}
			itemprop="url"
		>
			<span>
				${r}
				${o?d`<span class="tag is-small is-uppercase">${Ug}</span>`:""}
			</span>
		</a>
	`}function iG(e){if(!e)return"";let{href:t,title:o}=e;return d`
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" href="${t}" itemprop="url">
				<span>${o}</span>
			</a>
		</li>
	`}function J1(){return We!=="Learn"?"":d`
		<div
			id="level-status-container"
			class="display-flex align-items-center is-hidden is-hidden-touch"
		>
			<div id="level-status" class="position-relative level margin-inline-xxs"></div>
		</div>
	`}function cS(e,t,o,n){let{items:r}=e;return d`
		<nav class="nav-bar-nav" role="navigation" aria-label="${t}">
			<ul class="nav-bar-nav-list">
				${n?iG(n):null}
				${r.map(i=>ez(i,!1,o))}
			</ul>
		</nav>
	`}function Z1(e){return d`
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button
					class="nav-bar-button is-title"
					title="${cy}"
					aria-expanded="${e.mobileNavExpanded}"
					@click=${()=>aG(e)}
				>
					<span class="nav-bar-menu-title">${Ky}</span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label">${cy}</span>
					</div>
				</button>
			</div>
		</div>
	`}async function aG(e){let t=await W1(e),o=new Ge(t),n=window.outerWidth;function r(){t.dispose(),window.removeEventListener("resize",i),e.mobileNavExpanded=!1}function i(){o.hide(),r()}window.addEventListener("resize",()=>{window.outerWidth!==n&&i()},{passive:!0}),e.mobileNavExpanded=!0,await o.show(),r()}function ez(e,t,o){return e.kind==="link"?sG(e,t,o):cG(e,t,o)}function sG(e,t,o){let n=We==="Docs_Home"||We==="Developer"||We==="Regional Directors"||We==="Legal"||We==="Locale"||We==="Profile"||We==="Search",r=o&&e.title===va&&te("page_type")==="directory",i=o&&e.title===Ky&&!n||r||e.current?"is-active":"",a=Nr(e.href,w.data.userLocale),s=o?"":"has-external-link-indicator";return t?d`
				<li class="nav-bar-item" ?hidden=${e.hidden}>
					<a class="${s} nav-bar-button ${i}" href="${a}">
						${e.title}
					</a>
				</li>
		  `:d`
				<li class="nav-bar-item" ?hidden=${e.hidden}>
					<a
						class="${s} nav-bar-button has-hover-underline ${i}"
						href="${a}"
					>
						<span>${e.title}</span>
					</a>
				</li>
		  `}function cG(e,t,o){let n=Qo(),r=t?w.data.userDir==="ltr"?"chevron-right-light":"chevron-left-light":"chevron-down-light",i=t?"":"expanded-indicator",a=e.current?"is-active":"";return d` <li class="dropdown nav-bar-item" ?hidden=${e.hidden}>
		<button
			class="dropdown-trigger nav-bar-button ${a} ${t?"":"has-hover-underline"}"
			aria-controls="${n}"
			aria-expanded="false"
		>
			<span>${e.title}</span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-${r} ${i}"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="${n}" aria-label="${e.title}">
			${e.items.map(s=>ez(s,!0,o))}
		</ul>
	</li>`}function lG(){return d`
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button
				class="dropdown-trigger button-reset"
				aria-label="${GO}"
				aria-controls="user-menu"
				aria-expanded="false"
			>
				<figure class="image is-36x36">
					<img
						class="has-body-background-medium border-radius-rounded"
						alt=""
						data-profile-property="avatarUrl"
					/>
				</figure>
			</button>
			<div
				class="dropdown-menu box justify-content-flex-start has-body-background"
				id="user-menu"
				role="menu"
			>
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img
								class="has-body-background-medium border-radius-rounded"
								aria-labelledby="displayName"
								alt=""
								data-profile-property="avatarUrl"
							/>
						</figure>
					</div>
					<div class="media-content">
						<h2 class="title font-size-lg">
							<span
								id="displayName"
								class="is-inline-truncated has-max-width-200"
								data-profile-property="displayName"
							></span>
						</h2>
						<p class="subtitle font-size-sm margin-bottom-none">
							<span
								class="is-inline-truncated has-max-width-200"
								data-profile-property="upn"
							></span>
						</p>
					</div>
				</div>
				<ul class="padding-top-xs padding-bottom-xs">
					<li class="padding-bottom-xs">
						<a href="${Ut("me","activity")}" data-profile-property="profileUrl"
							>${vp}</a
						>
					</li>
					<li>
						<a href="${Ut("me","settings")}" data-profile-property="settingsUrl"
							>${zl}</a
						>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out" href="#">${Fl}</a>
				</div>
			</div>
		</div>
	`}function uG(){return d`
		<a class="docs-sign-in auth-status-determined not-authenticated" href="#"> ${wp} </a>
	`}function am(e){return JSON.parse(JSON.stringify(e))}var C_=class extends Ye{constructor(){super();this._items=[{title:Cn,kind:"menu",items:[]}];this._mobile=!1;this._searchExpanded=!1;this._desktop=!1;this._mobileNavExpanded=!1}get items(){return this._items}set items(o){this._items=o&&o.length?o:[{title:Cn,kind:"menu",items:[]}],this.more.items=am(this._items.slice(0,this._items.length-1)),this.resetItemVisibility(),this.notifyPropertyChanged()}get mobile(){return this._mobile}set mobile(o){this._mobile=o,this._mobileNavExpanded=!1,this.notifyPropertyChanged()}get desktop(){return this._desktop}set desktop(o){this._desktop=o,this._searchExpanded=!1,this.notifyPropertyChanged()}get searchExpanded(){return this._searchExpanded}set searchExpanded(o){this._searchExpanded=o,this.notifyPropertyChanged()}get mobileNavExpanded(){return this._mobileNavExpanded}set mobileNavExpanded(o){this._mobileNavExpanded=o,this._searchExpanded=!1,this.notifyPropertyChanged()}get more(){let o=this._items.length;return o?this._items[o-1]:null}resetItemVisibility(){this.items.length!==0&&(this.items.forEach(o=>o.hidden=!1),this.more.hidden=!0,this.more.items.forEach(o=>o.hidden=!0))}notifyPropertyChanged(){this.publish(new Ae)}};function lS(e){let t=document.createElement("div");t.classList.add("nav-bar");let o=new C_;return t.paint=()=>rz(t,o,e),Object.defineProperty(t,"items",{enumerable:!0,get:()=>o.items,set:n=>o.items=n}),o.desktop=Dh.matches,o.mobile=!Up.matches,Dh.addListener(()=>{o.desktop=Dh.matches}),Up.addListener(()=>{o.mobile=!Up.matches}),window.addEventListener("resize",()=>{Up.matches&&dG(t,o,e)},{passive:!0}),t.paint(),Dt.then(()=>{let n=new MutationObserver(r=>{for(let i of r)for(let a=0;a<i.addedNodes.length;a++)if(i.addedNodes[a]===t){n.disconnect(),t.paint();return}});n.observe(document.body,{childList:!0,subtree:!0})}),o.subscribe(Ae,()=>t.paint()),t}var nz=0;function rz(e,t,o){if(nz=Date.now(),t.resetItemVisibility(),I(sS(o,t),e),t.mobile)return;let n=e.querySelector(".nav-bar-spacer"),{more:r,items:i}=t,a=i.length-1;for(;a>0&&n.getBoundingClientRect().width===0;)a--,r.hidden=!1,i[a].hidden=!0,r.items[a].hidden=!1,I(sS(o,t),e)}var tz=0,oz=50;function dG(e,t,o){clearTimeout(tz),Date.now()-nz>oz?e.paint():tz=setTimeout(rz,oz,e,t,o)}var pG=We==="Regional Directors";function uS(e){if(C.systemContent===!0||pG)return e;if(e.kind==="menu"){let o=am(e);return o.items=o.items.map(uS),o}let t=am(e);return t.href=new URL(e.href,re.contentNav).href,t}async function iz(){pU(),mU(),mG()}async function mG(){await Dt;let e=Y.querySelector("#headerAreaHolder > header"),[t,o]=await Promise.all([fG(),gG()]);I(d` ${t} ${o} `,e),dU()}async function fG(){await oT;let e=lS({leftTemplate:()=>Q1(),rightTemplate:t=>{let o=!Lp&&sc.callToAction&&!t.mobile?rm(sc.callToAction):null;return d`
				${Z1(t)}
				${cS(t,Ng,!0,sc.category)}
				<span class="nav-bar-spacer"></span>
				${t.mobile?null:E_(t)}
				${Lp?K1():o}
			`}});return e.items=sc.items.map(uS),e}async function gG(){if(await Mp,!wr)return null;let e=lS(hG());return e.items=wr.items,e.classList.add("border-top","is-hidden-mobile"),e}function hG(){let{category:e,callToAction:t,preview:o}=wr;return{leftTemplate:i=>X1(i,e,o),rightTemplate:i=>d`
		${cS(i,gD,!1)}
		<span class="nav-bar-spacer"></span>
		${rm(t)} ${J1()}
	`}}Object.defineProperty(HTMLElement.prototype,"inlineStyle",{set(e){this.style.cssText=e}});Object.defineProperty(HTMLInputElement.prototype,"customValidity",{set(e){this.setCustomValidity(e)}});var A_="constructor",Vi="prototype",I_="function",P_="_dynInstFuncs",fS="_isDynProxy",bu="_dynClass",_G="_dynCls$",gS="_dynInstChk",sm=gS,uz="_dfOpts",az="_unknown_",dz="__proto__",k_="_dyn"+dz,dS="_dynInstProto",pS="useBaseInst",sz="setInstFuncs",D_=Object,cm=D_.getPrototypeOf,cz=D_.getOwnPropertyNames,lz=0;function ji(e,t){return e&&D_[Vi].hasOwnProperty.call(e,t)}function pz(e){return e&&(e===D_[Vi]||e===Array[Vi])}function hS(e){return pz(e)||e===Function[Vi]}function Cc(e){var t;if(e){if(cm)return cm(e);var o=e[dz]||e[Vi]||(e[A_]?e[A_][Vi]:null);t=e[k_]||o,ji(e,k_)||(delete e[dS],t=e[k_]=e[dS]||e[k_],e[dS]=o)}return t}function R_(e,t){var o=[];if(cz)o=cz(e);else for(var n in e)typeof n=="string"&&ji(e,n)&&o.push(n);if(o&&o.length>0)for(var r=0;r<o.length;r++)t(o[r])}function _S(e,t,o){return t!==A_&&typeof e[t]===I_&&(o||ji(e,t))}function N_(e){throw new TypeError("DynamicProto: "+e)}function vG(e){var t={};return R_(e,function(o){!t[o]&&_S(e,o,!1)&&(t[o]=e[o])}),t}function vS(e,t){for(var o=e.length-1;o>=0;o--)if(e[o]===t)return!0;return!1}function bG(e,t,o,n){function r(c,l,u){var p=l[u];if(p[fS]&&n){var m=c[P_]||{};m[sm]!==!1&&(p=(m[l[bu]]||{})[u]||p)}return function(){return p.apply(c,arguments)}}var i={};R_(o,function(c){i[c]=r(t,o,c)});for(var a=Cc(e),s=[];a&&!hS(a)&&!vS(s,a);)R_(a,function(c){!i[c]&&_S(a,c,!cm)&&(i[c]=r(t,a,c))}),s.push(a),a=Cc(a);return i}function xG(e,t,o,n){var r=null;if(e&&ji(o,bu)){var i=e[P_]||{};if(r=(i[o[bu]]||{})[t],r||N_("Missing ["+t+"] "+I_),!r[gS]&&i[sm]!==!1){for(var a=!ji(e,t),s=Cc(e),c=[];a&&s&&!hS(s)&&!vS(c,s);){var l=s[t];if(l){a=l===n;break}c.push(s),s=Cc(s)}try{a&&(e[t]=r),r[gS]=1}catch{i[sm]=!1}}}return r}function yG(e,t,o){var n=t[e];return n===o&&(n=Cc(t)[e]),typeof n!==I_&&N_("["+e+"] is not a "+I_),n}function TG(e,t,o,n,r){function i(c,l){var u=function(){var p=xG(this,l,c,u)||yG(l,c,u);return p.apply(this,arguments)};return u[fS]=1,u}if(!pz(e)){var a=o[P_]=o[P_]||{},s=a[t]=a[t]||{};a[sm]!==!1&&(a[sm]=!!r),R_(o,function(c){_S(o,c,!1)&&o[c]!==n[c]&&(s[c]=o[c],delete o[c],(!ji(e,c)||e[c]&&!e[c][fS])&&(e[c]=i(e,c)))})}}function SG(e,t){if(cm){for(var o=[],n=Cc(t);n&&!hS(n)&&!vS(o,n);){if(n===e)return!0;o.push(n),n=Cc(n)}return!1}return!0}function mS(e,t){return ji(e,Vi)?e.name||t||az:((e||{})[A_]||{}).name||t||az}function Ie(e,t,o,n){ji(e,Vi)||N_("theClass is an invalid class definition.");var r=e[Vi];SG(r,t)||N_("["+mS(e)+"] is not in class hierarchy of ["+mS(t)+"]");var i=null;ji(r,bu)?i=r[bu]:(i=_G+mS(e,"_")+"$"+lz,lz++,r[bu]=i);var a=Ie[uz],s=!!a[pS];s&&n&&n[pS]!==void 0&&(s=!!n[pS]);var c=vG(t),l=bG(r,t,c,s);o(t,l);var u=!!cm&&!!a[sz];u&&n&&(u=!!n[sz]),TG(r,i,t,c,u!==!1)}var EG={setInstFuncs:!0,useBaseInst:!0};Ie[uz]=EG;var or="function",mn="object",fn="undefined",It="prototype",lm="hasOwnProperty";var Nn=Object,xu=Nn[It],yu=Nn.assign,L_=Nn.create,Tu=Nn.defineProperty,li=xu[lm];var Su=null;function nr(e){return e===void 0&&(e=!0),(!Su||!e)&&(typeof globalThis!==fn&&globalThis&&(Su=globalThis),typeof self!==fn&&self&&(Su=self),typeof window!==fn&&window&&(Su=window),typeof global!==fn&&global&&(Su=global)),Su}function Eu(e){throw new TypeError(e)}function wu(e){var t=L_;if(t)return t(e);if(e==null)return{};var o=typeof e;o!==mn&&o!==or&&Eu("Object prototype may only be an Object:"+e);function n(){}return n[It]=e,new n}var Tfe=(nr()||{}).Symbol,Sfe=(nr()||{}).Reflect;var CG=function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)xu[lm].call(t,r)&&(e[r]=t[r])}return e},zt=yu||CG,bS=function(e,t){return bS=Nn.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var r in n)n[lm](r)&&(o[r]=n[r])},bS(e,t)};function vo(e,t){typeof t!==or&&t!==null&&Eu("Class extends value "+String(t)+" is not a constructor or null"),bS(e,t);function o(){this.constructor=e}e[It]=t===null?wu(t):(o[It]=t[It],new o)}function M_(e,t){for(var o=0,n=t.length,r=e.length;o<n;o++,r++)e[r]=t[o];return e}var Dr="initialize",zo="name",um="getNotifyMgr",Lr="identifier",Ue="push",Dn="isInitialized",ui="config",O_="instrumentationKey",gn="logger",ye="length",kc="time",bt="processNext",U_="getProcessTelContext",Ac="addNotificationListener",Ic="removeNotificationListener",xS="stopPollingInternalLogs",dm="onComplete",Pc="getPlugin",Cu="flush",pm="_extensions",Mr="splice",Ln="teardown",ku="messageId",Va="message",Or="isAsync",Au="_doTeardown",Rc="update",Mn="getNext",rr="diagLog",ja="setNextPlugin",Wi="createNew",$_="cookieCfg",Iu="indexOf",Pu="substring",Ru="userAgent",Wa="split",mm="setEnabled",Ur="replace",Ka="substr",z_="nodeType",di="apply",yS="enableDebugExceptions",TS="logInternalMessage",F_="toLowerCase",io="call",pi="type",H_="handler",Nc="listeners",fm="isChildEvt",Dc="getCtx",$r="setCtx",q_="complete",gm="traceId",B_="spanId",hm="traceFlags",SS="version";var De="",ES="channels",Pt="core",wS="createPerfMgr",_m="disabled",Nu="extensionConfig",mz="extensions",hn="processTelemetry",ir="priority",Du="eventsSent",Qa="eventsDiscarded",Lu="eventsSendRequest",Xa="perfEvent",Y_="errorToConsole",vm="warnToConsole",Lc="getPerfMgr";var yz="toISOString",Tz="endsWith",kG="startsWith",fz="indexOf",gz="map",hz="reduce",kS="trim",Sz="toString",AG="__proto__",G_="constructor",_z=Tu,AS=Nn.freeze,Kfe=Nn.seal,vz=Nn.keys,IS=String[It],IG=IS[kS],PG=IS[Tz],Qfe=IS[kG],RG=Date[It],NG=RG[yz],DG=Array.isArray,Ez=xu[Sz],wz=li[Sz],LG=wz[io](Nn),MG=/-([a-z])/g,OG=/([^\w\d_$])/g,UG=/^(\d+[\w\d_$])/,V_=Object.getPrototypeOf;function PS(e){if(e){if(V_)return V_(e);var t=e[AG]||e[It]||e[G_];if(t)return t}return null}function wt(e){return e===void 0||typeof e===fn}function q(e){return e===null||wt(e)}function RS(e){return!q(e)}function j_(e,t){return!!(e&&li[io](e,t))}function Fo(e){return!!(e&&typeof e===mn)}function be(e){return!!(e&&typeof e===or)}function Mc(e){var t=e;return t&&ge(t)&&(t=t[Ur](MG,function(o,n){return n.toUpperCase()}),t=t[Ur](OG,"_"),t=t[Ur](UG,function(o,n){return"_"+n})),t}function He(e,t){if(e)for(var o in e)li[io](e,o)&&t[io](e,o,e[o])}function NS(e,t){var o=!1;return e&&t&&!(o=e===t)&&(o=PG?e[Tz](t):$G(e,t)),o}function $G(e,t){var o=!1,n=t?t[ye]:0,r=e?e[ye]:0;if(n&&r&&r>=n&&!(o=e===t)){for(var i=r-1,a=n-1;a>=0;a--){if(e[i]!=t[a])return!1;i--}o=!0}return o}function ao(e,t){return e&&t?e[Iu](t)!==-1:!1}var Xe=DG||zG;function zG(e){return!!(e&&Ez[io](e)==="[object Array]")}function bm(e){return!!(e&&Ez[io](e)==="[object Error]")}function ge(e){return typeof e=="string"}function xm(e){return typeof e=="number"}function Cz(e){return typeof e=="boolean"}function bz(e){var t=!1;if(e&&typeof e=="object"){var o=V_?V_(e):PS(e);o?(o[G_]&&li[io](o,G_)&&(o=o[G_]),t=typeof o===or&&wz[io](o)===LG):t=!0}return t}function On(e){if(e)return NG?e[yz]():FG(e)}function FG(e){if(e&&e.getUTCFullYear){var t=function(o){var n=String(o);return n[ye]===1&&(n="0"+n),n};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function se(e,t,o){var n=e[ye];try{for(var r=0;r<n&&!(r in e&&t[io](o||e,e[r],r,e)===-1);r++);}catch{}}function bo(e,t,o){if(e){if(e[fz])return e[fz](t,o);var n=e[ye],r=o||0;try{for(var i=Math.max(r>=0?r:n-Math.abs(r),0);i<n;i++)if(i in e&&e[i]===t)return i}catch{}}return-1}function Mu(e,t,o){var n;if(e){if(e[gz])return e[gz](t,o);var r=e[ye],i=o||e;n=new Array(r);try{for(var a=0;a<r;a++)a in e&&(n[a]=t[io](i,e[a],e))}catch{}}return n}function DS(e,t,o){var n;if(e){if(e[hz])return e[hz](t,o);var r=e[ye],i=0;if(arguments[ye]>=3)n=arguments[2];else{for(;i<r&&!(i in e);)i++;n=e[i++]}for(;i<r;)i in e&&(n=t(n,e[i],i,e)),i++}return n}function Ft(e){return e&&(e=IG&&e[kS]?e[kS]():e[Ur]?e[Ur](/^\s+|\s+$/g,De):e),e}var xz=!{toString:null}.propertyIsEnumerable("toString"),CS=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Xo(e){var t=typeof e;if(t!==or&&(t!==mn||e===null)&&Eu("objKeys called on non-object"),!xz&&vz)return vz(e);var o=[];for(var n in e)e&&li[io](e,n)&&o[Ue](n);if(xz)for(var r=CS[ye],i=0;i<r;i++)e&&li[io](e,CS[i])&&o[Ue](CS[i]);return o}function ar(e,t,o,n){if(_z)try{var r={enumerable:!0,configurable:!0};return o&&(r.get=o),n&&(r.set=n),_z(e,t,r),!0}catch{}return!1}function HG(e){return e}function Ou(e){return AS&&He(e,function(t,o){(Xe(o)||Fo(o))&&AS(o)}),mi(e)}var mi=AS||HG;function xo(){var e=Date;return e.now?e.now():new e().getTime()}function Oe(e){return bm(e)?e[zo]:De}function Ze(e,t,o,n,r){var i=o;return e&&(i=e[t],i!==o&&(!r||r(i))&&(!n||n(o))&&(i=o,e[t]=i)),i}function Mt(e,t,o){var n;return e?(n=e[t],!n&&q(n)&&(n=wt(o)?{}:o,e[t]=n)):n=wt(o)?{}:o,n}function sr(e,t){return q(e)?t:e}function Uu(e){return!!e}function Rt(e){throw new Error(e)}function kz(e,t){var o=null,n=null;return be(e)?o=e:n=e,function(){var r=arguments;if(o&&(n=o()),n)return n[t][di](n,r)}}function LS(e,t,o){if(e&&t&&Fo(e)&&Fo(t)){var n=function(i){if(ge(i)){var a=t[i];be(a)?(!o||o(i,!0,t,e))&&(e[i]=kz(t,i)):(!o||o(i,!1,t,e))&&(j_(e,i)&&delete e[i],ar(e,i,function(){return t[i]},function(s){t[i]=s})||(e[i]=a))}};for(var r in t)n(r)}return e}function $u(e,t,o,n,r){e&&t&&o&&(r!==!1||wt(e[t]))&&(e[t]=kz(o,n))}function fi(e,t,o,n){return e&&t&&Fo(e)&&Xe(o)&&se(o,function(r){ge(r)&&$u(e,r,t,r,n)}),e}function MS(e){return function(){function t(){var o=this;e&&He(e,function(n,r){o[n]=r})}return t}()}function W_(e){return e&&yu&&(e=Nn(yu({},e))),e}function zu(e,t,o,n,r,i){var a=arguments,s=a[0]||{},c=a[ye],l=!1,u=1;for(c>0&&Cz(s)&&(l=s,s=a[u]||{},u++),Fo(s)||(s={});u<c;u++){var p=a[u],m=Xe(p),f=Fo(p);for(var h in p){var _=m&&h in p||f&&li[io](p,h);if(!!_){var g=p[h],v=void 0;if(l&&g&&((v=Xe(g))||bz(g))){var x=s[h];v?Xe(x)||(x=[]):bz(x)||(x={}),g=zu(l,x,g)}g!==void 0&&(s[h]=g)}}}return s}function K_(e){var t={};return He(e,function(o,n){t[o]=n,t[n]=o}),Ou(t)}function OS(e){var t={};return He(e,function(o,n){t[o]=n[1],t[n[0]]=n[1]}),Ou(t)}var Az="window",qG="document",BG="documentMode",YG="navigator",GG="history",VG="location",jG="console",WG="performance",Iz="JSON",KG="crypto",QG="msCrypto",XG="ReactNative",FS="msie",HS="trident/",Pz="XMLHttpRequest",US=null,$S=null,JG=!1,Fu=null,zS=null;function Rz(e,t){var o=!1;if(e){try{if(o=t in e,!o){var n=e[It];n&&(o=t in n)}}catch{}if(!o)try{var r=new e;o=!wt(r[t])}catch{}}return o}function Nt(e){var t=nr();return t&&t[e]?t[e]:e===Az&&Ki()?window:null}function Ki(){return Boolean(typeof window===mn&&window)}function Un(){return Ki()?window:Nt(Az)}function Q_(){return Boolean(typeof document===mn&&document)}function Ht(){return Q_()?document:Nt(qG)}function qS(){return Boolean(typeof navigator===mn&&navigator)}function Jo(){return qS()?navigator:Nt(YG)}function X_(){return Boolean(typeof history===mn&&history)}function BS(){return X_()?history:Nt(GG)}function _n(e){if(e&&JG){var t=Nt("__mockLocation");if(t)return t}return typeof location===mn&&location?location:Nt(VG)}function YS(){return typeof console!==fn?console:Nt(jG)}function cr(){return Nt(WG)}function zr(){return Boolean(typeof JSON===mn&&JSON||Nt(Iz)!==null)}function so(){return zr()?JSON||Nt(Iz):null}function GS(){return Nt(KG)}function VS(){return Nt(QG)}function jS(){var e=Jo();return e&&e.product?e.product===XG:!1}function Hu(){var e=Jo();if(e&&(e[Ru]!==$S||US===null)){$S=e[Ru];var t=($S||De)[F_]();US=ao(t,FS)||ao(t,HS)}return US}function qu(e){if(e===void 0&&(e=null),!e){var t=Jo()||{};e=t?(t[Ru]||De)[F_]():De}var o=(e||De)[F_]();if(ao(o,FS)){var n=Ht()||{};return Math.max(parseInt(o[Wa](FS)[1]),n[BG]||0)}else if(ao(o,HS)){var r=parseInt(o[Wa](HS)[1]);if(r)return r+4}return null}function ue(e){var t=Object[It].toString[io](e),o=De;return t==="[object Error]"?o="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[zo]+"'":zr()&&(o=so().stringify(e)),t+o}function Ja(){return zS===null&&(zS=qS()&&Boolean(Jo().sendBeacon)),zS}function J_(e){var t=!1;try{t=!!Nt("fetch");var o=Nt("Request");t&&e&&o&&(t=Rz(o,"keepalive"))}catch{}return t}function Z_(){return Fu===null&&(Fu=typeof XDomainRequest!==fn,Fu&&Oc()&&(Fu=Fu&&!Rz(Nt(Pz),"withCredentials"))),Fu}function Oc(){var e=!1;try{var t=Nt(Pz);e=!!t}catch{}return e}var WS=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],tv=null,ev;function ZG(e,t){return function(){var o=arguments,n=KS(t);if(n){var r=n.listener;r&&r[e]&&r[e][di](r,o)}}}function e9(){var e=Nt("Microsoft");return e&&(tv=e.ApplicationInsights),tv}function KS(e){var t=tv;return!t&&e.disableDbgExt!==!0&&(t=tv||e9()),t?t.ChromeDbgExt:null}function Nz(e){if(!ev){ev={};for(var t=0;t<WS[ye];t++)ev[WS[t]]=ZG(WS[t],e)}return ev}var t9="AI (Internal): ",o9="AI: ",n9="AITR_";function Dz(e){return e?'"'+e[Ur](/\"/g,De)+'"':De}function Lz(e,t){var o=YS();if(o){var n="log";o[e]&&(n=e),be(o[n])&&o[n](t)}}var Qi=function(){function e(t,o,n,r){n===void 0&&(n=!1);var i=this;i[ku]=t,i[Va]=(n?o9:t9)+t;var a=De;zr()&&(a=so().stringify(r));var s=(o?" message:"+Dz(o):De)+(r?" props:"+Dz(a):De);i[Va]+=s}return e.dataType="MessageData",e}();function Fr(e,t){return(e||{})[gn]||new Uc(t)}var Uc=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var o=0,n={},r,i,a,s;Ie(e,this,function(c){u(t||{}),c.consoleLoggingLevel=function(){return r},c.telemetryLoggingLevel=function(){return i},c.maxInternalMessageLimit=function(){return a},c[yS]=function(){return s},c.throwInternal=function(f,h,_,g,v){v===void 0&&(v=!1);var x=new Qi(h,_,v,g);if(s)throw ue(x);var E=f===1?Y_:vm;if(wt(x[Va]))m("throw"+(f===1?"Critical":"Warning"),x);else{if(v){var O=+x[ku];!n[O]&&r>=f&&(c[E](x[Va]),n[O]=!0)}else r>=f&&c[E](x[Va]);l(f,x)}},c[vm]=function(f){Lz("warn",f),m("warning",f)},c[Y_]=function(f){Lz("error",f),m("error",f)},c.resetInternalMessageCount=function(){o=0,n={}},c[TS]=l;function l(f,h){if(!p()){var _=!0,g=n9+h[ku];if(n[g]?_=!1:n[g]=!0,_&&(f<=i&&(c.queue[Ue](h),o++,m(f===1?"error":"warn",h)),o===a)){var v="Internal events throttle limit per PageView reached for this app.",x=new Qi(23,v,!1);c.queue[Ue](x),f===1?c[Y_](v):c[vm](v)}}}function u(f){r=sr(f.loggingLevelConsole,0),i=sr(f.loggingLevelTelemetry,1),a=sr(f.maxMessageLimit,25),s=sr(f[yS],!1)}function p(){return o>=a}function m(f,h){var _=KS(t||{});_&&_[rr]&&_[rr](f,h)}})}return e.__ieDyn=1,e}();function QS(e){return e||new Uc}function V(e,t,o,n,r,i){i===void 0&&(i=!1),QS(e).throwInternal(t,o,n,r,i)}function lr(e,t){QS(e)[vm](t)}function XS(e,t,o){QS(e)[TS](t,o)}var Bu="ctx",ZS="ParentContextKey",ym="ChildrenContextKey",r9=null,Tm=function(){function e(t,o,n){var r=this,i=!1;if(r.start=xo(),r[zo]=t,r[Or]=n,r[fm]=function(){return!1},be(o)){var a;i=ar(r,"payload",function(){return!a&&be(o)&&(a=o(),o=null),a})}r[Dc]=function(s){return s?s===e[ZS]||s===e[ym]?r[s]:(r[Bu]||{})[s]:null},r[$r]=function(s,c){if(s)if(s===e[ZS])r[s]||(r[fm]=function(){return!0}),r[s]=c;else if(s===e[ym])r[s]=c;else{var l=r[Bu]=r[Bu]||{};l[s]=c}},r[q_]=function(){var s=0,c=r[Dc](e[ym]);if(Xe(c))for(var l=0;l<c[ye];l++){var u=c[l];u&&(s+=u[kc])}r[kc]=xo()-r.start,r.exTime=r[kc]-s,r[q_]=function(){},!i&&be(o)&&(r.payload=o())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}();var eE=function(){function e(t){this.ctx={},Ie(e,this,function(o){o.create=function(n,r,i){return new Tm(n,r,i)},o.fire=function(n){n&&(n[q_](),t&&be(t[Xa])&&t[Xa](n))},o[$r]=function(n,r){if(n){var i=o[Bu]=o[Bu]||{};i[n]=r}},o[Dc]=function(n){return(o[Bu]||{})[n]}})}return e.__ieDyn=1,e}();var JS="CoreUtils.doPerf";function Za(e,t,o,n,r){if(e){var i=e;if(i[Lc]&&(i=i[Lc]()),i){var a=void 0,s=i[Dc](JS);try{if(a=i.create(t(),n,r),a){if(s&&a[$r]&&(a[$r](Tm[ZS],s),s[Dc]&&s[$r])){var c=s[Dc](Tm[ym]);c||(c=[],s[$r](Tm[ym],c)),c[Ue](a)}return i[$r](JS,a),o(a)}}catch(l){a&&a[$r]&&a[$r]("exception",l)}finally{a&&i.fire(a),i[$r](JS,s)}}}return o()}function tE(){return r9}var Mz=4294967296,$c=4294967295,Oz=!1,Sm=123456789,Em=987654321;function i9(e){e<0&&(e>>>=0),Sm=123456789+e&$c,Em=987654321-e&$c,Oz=!0}function a9(){try{var e=xo()&2147483647;i9((Math.random()*Mz^e)+e)}catch{}}function zc(e){var t=0,o=GS()||VS();return o&&o.getRandomValues&&(t=o.getRandomValues(new Uint32Array(1))[0]&$c),t===0&&Hu()&&(Oz||a9(),t=oE()&$c),t===0&&(t=Math.floor(Mz*Math.random()|0)),e||(t>>>=0),t}function oE(e){Em=36969*(Em&65535)+(Em>>16)&$c,Sm=18e3*(Sm&65535)+(Sm>>16)&$c;var t=(Em<<16)+(Sm&65535)>>>0&$c|0;return e||(t>>>=0),t}function Xi(e){e===void 0&&(e=22);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=zc()>>>0,n=0,r=De;r[ye]<e;)n++,r+=t.charAt(o&63),o>>>=6,n===5&&(o=(zc()<<2&4294967295|o&3)>>>0,n=0);return r}var Uz=Tu,$z="2.8.5",s9="."+Xi(6),c9=0;function l9(e,t,o){if(Uz)try{return Uz(e,t,{value:o,enumerable:!1,configurable:!0}),!0}catch{}return!1}function zz(e){return e[z_]===1||e[z_]===9||!+e[z_]}function u9(e,t){var o=t[e.id];if(!o){o={};try{zz(t)&&(l9(t,e.id,o)||(t[e.id]=o))}catch{}}return o}function Lo(e,t){return t===void 0&&(t=!1),Mc(e+c9+++(t?"."+$z:De)+s9)}function ov(e){var t={id:Lo("_aiData-"+(e||De)+"."+$z),accept:function(o){return zz(o)},get:function(o,n,r,i){var a=o[t.id];return a?a[Mc(n)]:(i&&(a=u9(t,o),a[Mc(n)]=r),r)},kill:function(o,n){if(o&&o[n])try{delete o[n]}catch{}}};return t}var Fz="toGMTString",Hz="toUTCString",sE="cookie",nE="expires",iE="enabled",qz="isCookieUseDisabled",Bz="disableCookiesUsage",es="_ckMgr",nv=null,rE=null,Yz=null,wm=Ht(),Gz={},iv={};function d9(e,t){var o=Fc[es]||iv[es];return o||(o=Fc[es]=Fc(e,t),iv[es]=o),o}function rv(e){return e?e.isEnabled():!0}function p9(e){var t=e[$_]=e[$_]||{};if(Ze(t,"domain",e.cookieDomain,RS,q),Ze(t,"path",e.cookiePath||"/",null,q),q(t[iE])){var o=void 0;wt(e[qz])||(o=!e[qz]),wt(e[Bz])||(o=!e[Bz]),t[iE]=o}return t}function Hc(e,t){var o;if(e)o=e.getCookieMgr();else if(t){var n=t[$_];n[es]?o=n[es]:o=Fc(t)}return o||(o=d9(t,(e||{})[gn])),o}function Fc(e,t){var o,n=p9(e||iv),r=n.path||"/",i=n.domain,a=n[iE]!==!1,s=(o={isEnabled:function(){var c=a&&aE(t),l=iv[es];return c&&l&&s!==l&&(c=rv(l)),c}},o[mm]=function(c){a=c!==!1},o.set=function(c,l,u,p,m){var f=!1;if(rv(s)){var h={},_=Ft(l||De),g=_[Iu](";");if(g!==-1&&(_=Ft(l[Pu](0,g)),h=Kz(l[Pu](g+1))),Ze(h,"domain",p||i,Uu,wt),!q(u)){var v=Hu();if(wt(h[nE])){var x=xo(),E=x+u*1e3;if(E>0){var O=new Date;O.setTime(E),Ze(h,nE,Vz(O,v?Fz:Hz)||Vz(O,v?Fz:Hz)||De,Uu)}}v||Ze(h,"max-age",De+u,null,wt)}var k=_n();k&&k.protocol==="https:"&&(Ze(h,"secure",null,null,wt),rE===null&&(rE=!cE((Jo()||{})[Ru])),rE&&Ze(h,"SameSite","None",null,wt)),Ze(h,"path",m||r,null,wt);var P=n.setCookie||Wz;P(c,jz(_,h)),f=!0}return f},o.get=function(c){var l=De;return rv(s)&&(l=(n.getCookie||m9)(c)),l},o.del=function(c,l){var u=!1;return rv(s)&&(u=s.purge(c,l)),u},o.purge=function(c,l){var u,p=!1;if(aE(t)){var m=(u={},u.path=l||"/",u[nE]="Thu, 01 Jan 1970 00:00:01 GMT",u);Hu()||(m["max-age"]="0");var f=n.delCookie||Wz;f(c,jz(De,m)),p=!0}return p},o);return s[es]=s,s}function aE(e){if(nv===null){nv=!1;try{var t=wm||{};nv=t[sE]!==void 0}catch(o){V(e,2,68,"Cannot access document.cookie - "+Oe(o),{exception:ue(o)})}}return nv}function Kz(e){var t={};if(e&&e[ye]){var o=Ft(e)[Wa](";");se(o,function(n){if(n=Ft(n||De),n){var r=n[Iu]("=");r===-1?t[n]=null:t[Ft(n[Pu](0,r))]=Ft(n[Pu](r+1))}})}return t}function Vz(e,t){return be(e[t])?e[t]():null}function jz(e,t){var o=e||De;return He(t,function(n,r){o+="; "+n+(q(r)?De:"="+r)}),o}function m9(e){var t=De;if(wm){var o=wm[sE]||De;Yz!==o&&(Gz=Kz(o),Yz=o),t=Ft(Gz[e]||De)}return t}function Wz(e,t){wm&&(wm[sE]=e+"="+t)}function cE(e){return ge(e)?!!(ao(e,"CPU iPhone OS 12")||ao(e,"iPad; CPU OS 12")||ao(e,"Macintosh; Intel Mac OS X 10_14")&&ao(e,"Version/")&&ao(e,"Safari")||ao(e,"Macintosh; Intel Mac OS X 10_14")&&NS(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||ao(e,"Chrome/5")||ao(e,"Chrome/6")||ao(e,"UnrealEngine")&&!ao(e,"Chrome")||ao(e,"UCBrowser/12")||ao(e,"UCBrowser/11")):!1}var oF="on",Qz="attachEvent",Xz="addEventListener",Jz="detachEvent",Zz="removeEventListener",lE="events",uE="visibilitychange",lv="pagehide";var nF="unload",rF="beforeunload",iF=Lo("aiEvtPageHide"),qge=Lo("aiEvtPageShow"),f9=/\.[\.]+/g,g9=/[\.]+$/,h9=1,av=ov("events"),_9=/^([^.]*)(?:\.(.+)|)/;function eF(e){return e&&e[Ur]?e.replace(/^\s*\.*|\.*\s*$/g,De):e}function dE(e,t){var o;if(t){var n=De;Xe(t)?(n=De,se(t,function(i){i=eF(i),i&&(i[0]!=="."&&(i="."+i),n+=i)})):n=eF(t),n&&(n[0]!=="."&&(n="."+n),e=(e||De)+n)}var r=_9.exec(e||De)||[];return o={},o[pi]=r[1],o.ns=(r[2]||De).replace(f9,".").replace(g9,De)[Wa](".").sort().join("."),o}function aF(e,t,o){o===void 0&&(o=!0);var n=av.get(e,lE,{},o),r=n[t];return r||(r=n[t]=[]),r}function sF(e,t,o,n){e&&t&&t[pi]&&(e[Zz]?e[Zz](t[pi],o,n):e[Jz]&&e[Jz](oF+t[pi],o))}function v9(e,t,o,n){var r=!1;return e&&t&&t[pi]&&o&&(e[Xz]?(e[Xz](t[pi],o,n),r=!0):e[Qz]&&(e[Qz](oF+t[pi],o),r=!0)),r}function tF(e,t,o,n){for(var r=t[ye];r--;){var i=t[r];i&&(!o.ns||o.ns===i.evtName.ns)&&(!n||n(i))&&(sF(e,i.evtName,i[H_],i.capture),t[Mr](r,1))}}function b9(e,t,o){if(t[pi])tF(e,aF(e,t[pi]),t,o);else{var n=av.get(e,lE,{});He(n,function(r,i){tF(e,i,t,o)}),Xo(n)[ye]===0&&av.kill(e,lE)}}function $n(e,t){var o;return t?(Xe(t)?o=[e].concat(t):o=[e,t],o=dE("xx",o).ns[Wa](".")):o=e,o}function ur(e,t,o,n,r){var i;r===void 0&&(r=!1);var a=!1;if(e)try{var s=dE(t,n);if(a=v9(e,s,o,r),a&&av.accept(e)){var c=(i={guid:h9++,evtName:s},i[H_]=o,i.capture=r,i);aF(e,s.type)[Ue](c)}}catch{}return a}function ts(e,t,o,n,r){if(r===void 0&&(r=!1),e)try{var i=dE(t,n),a=!1;b9(e,i,function(s){return i.ns&&!o||s[H_]===o?(a=!0,!0):!1}),a||sF(e,i,o,r)}catch{}}function cF(e,t,o){var n=!1,r=Un();r&&(n=ur(r,e,t,o),n=ur(r.body,e,t,o)||n);var i=Ht();return i&&(n=ur(i,e,t,o)||n),n}function lF(e,t,o){var n=Un();n&&(ts(n,e,t,o),ts(n.body,e,t,o));var r=Ht();r&&ts(r,e,t,o)}function sv(e,t,o,n){var r=!1;return t&&e&&e[ye]>0&&se(e,function(i){i&&(!o||bo(o,i)===-1)&&(r=cF(i,t,n)||r)}),r}function uF(e,t,o,n){var r=!1;return t&&e&&Xe(e)&&(r=sv(e,t,o,n),!r&&o&&o[ye]>0&&(r=sv(e,t,null,n))),r}function cv(e,t,o){e&&Xe(e)&&se(e,function(n){n&&lF(n,t,o)})}function pE(e,t,o){return uF([rF,nF,lv],e,t,o)}function mE(e,t){cv([rF,nF,lv],e,t)}function Cm(e,t,o){function n(a){var s=Ht();e&&s&&s.visibilityState==="hidden"&&e(a)}var r=$n(iF,o),i=sv([lv],e,t,r);return(!t||bo(t,uE)===-1)&&(i=sv([uE],n,t,r)||i),!i&&t&&(i=Cm(e,null,o)),i}function fE(e,t){var o=$n(iF,t);cv([lv],e,o),cv([uE],null,o)}function vn(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],t=De,o,n=0;n<4;n++)o=zc(),t+=e[o&15]+e[o>>4&15]+e[o>>8&15]+e[o>>12&15]+e[o>>16&15]+e[o>>20&15]+e[o>>24&15]+e[o>>28&15];var r=e[8+(zc()&3)|0];return t[Ka](0,8)+t[Ka](9,4)+"4"+t[Ka](13,3)+r+t[Ka](16,3)+t[Ka](19,12)}var gE="00",T9="ff",pF="00000000000000000000000000000000",mF="0000000000000000";function km(e,t,o){return e&&e[ye]===t&&e!==o?!!e.match(/^[\da-f]*$/):!1}function dF(e,t,o){return km(e,t)?e:o}function S9(e){(isNaN(e)||e<0||e>255)&&(e=1);for(var t=e.toString(16);t[ye]<2;)t="0"+t;return t}function Am(e,t,o,n){var r;return r={},r[SS]=km(n,2,T9)?n:gE,r[gm]=qc(e)?e:vn(),r.spanId=Bc(t)?t:vn()[Ka](0,16),r.traceFlags=o>=0&&o<=255?o:1,r}function qc(e){return km(e,32,pF)}function Bc(e){return km(e,16,mF)}function Im(e){if(e){var t=S9(e[hm]);km(t,2)||(t="01");var o=e[SS]||gE;return o!=="00"&&o!=="ff"&&(o=gE),"".concat(o,"-").concat(dF(e.traceId,32,pF),"-").concat(dF(e.spanId,16,mF),"-").concat(t)}return""}var E9=ov("plugin");function Ji(e){return E9.get(e,"state",{},!0)}function uv(e,t){for(var o=[],n=null,r=e[Mn](),i;r;){var a=r[Pc]();if(a){n&&be(n[ja])&&be(a[hn])&&n[ja](a);var s=!1;be(a[Dn])?s=a[Dn]():(i=Ji(a),s=i[Dn]),s||o[Ue](a),n=a,r=r[Mn]()}}se(o,function(c){var l=e[Pt]();c[Dr](e.getCfg(),l,t,e[Mn]()),i=Ji(c),!c[Pt]&&!i[Pt]&&(i[Pt]=l),i[Dn]=!0,delete i[Ln]})}function dv(e){return e.sort(function(t,o){var n=0;if(o){var r=be(o[hn]);be(t[hn])?n=r?t[ir]-o[ir]:1:r&&(n=-1)}else n=t?1:-1;return n})}function fF(e){var t={};return{getName:function(){return t[zo]},setName:function(o){e&&e.setName(o),t[zo]=o},getTraceId:function(){return t[gm]},setTraceId:function(o){e&&e.setTraceId(o),qc(o)&&(t[gm]=o)},getSpanId:function(){return t[B_]},setSpanId:function(o){e&&e.setSpanId(o),Bc(o)&&(t[B_]=o)},getTraceFlags:function(){return t[hm]},setTraceFlags:function(o){e&&e.setTraceFlags(o),t[hm]=o}}}var w9="TelemetryPluginChain",gF="_hasRun",hF="_getTelCtx",_F=0;function C9(e,t,o){for(;e;){if(e[Pc]()===o)return e;e=e[Mn]()}return gi([o],t[ui]||{},t)}function hE(e,t,o,n){var r=null,i=[];n!==null&&(r=n?C9(e,o,n):e);var a={_next:c,ctx:{core:function(){return o},diagLog:function(){return Fr(o,t)},getCfg:function(){return t},getExtCfg:l,getConfig:u,hasNext:function(){return!!r},getNext:function(){return r},setNext:function(m){r=m},iterate:p,onComplete:s}};function s(m,f){for(var h=[],_=2;_<arguments.length;_++)h[_-2]=arguments[_];m&&i[Ue]({func:m,self:wt(f)?a.ctx:f,args:h})}function c(){var m=r;if(r=m?m[Mn]():null,!m){var f=i;f&&f[ye]>0&&(se(f,function(h){try{h.func[io](h.self,h.args)}catch(_){V(o[gn],2,73,"Unexpected Exception during onComplete - "+ue(_))}}),i=[])}return m}function l(m,f,h){f===void 0&&(f={}),h===void 0&&(h=0);var _;if(t){var g=t[Nu];g&&m&&(_=g[m])}if(!_)_=f;else if(Fo(f)&&h!==0){var v=zu(!0,f,_);t&&h===2&&He(f,function(x){if(q(v[x])){var E=t[x];q(E)||(v[x]=E)}}),_=v}return _}function u(m,f,h){h===void 0&&(h=!1);var _,g=l(m,null);return g&&!q(g[f])?_=g[f]:t&&!q(t[f])&&(_=t[f]),q(_)?h:_}function p(m){for(var f;f=a._next();){var h=f[Pc]();h&&m(h)}}return a}function yo(e,t,o,n){var r=hE(e,t,o,n),i=r.ctx;function a(c){var l=r._next();return l&&l[hn](c,i),!l}function s(c,l){return c===void 0&&(c=null),Xe(c)&&(c=gi(c,t,o,l)),yo(c||i[Mn](),t,o,l)}return i[bt]=a,i[Wi]=s,i}function Yu(e,t,o){var n=t[ui]||{},r=hE(e,n,t,o),i=r.ctx;function a(c){var l=r._next();return l&&l.unload(i,c),!l}function s(c,l){return c===void 0&&(c=null),Xe(c)&&(c=gi(c,n,t,l)),Yu(c||i[Mn](),t,l)}return i[bt]=a,i[Wi]=s,i}function Pm(e,t,o){var n=t[ui]||{},r=hE(e,n,t,o),i=r.ctx;function a(c){return i.iterate(function(l){be(l[Rc])&&l[Rc](i,c)})}function s(c,l){return c===void 0&&(c=null),Xe(c)&&(c=gi(c,n,t,l)),Pm(c||i[Mn](),t,l)}return i[bt]=a,i[Wi]=s,i}function gi(e,t,o,n){var r=null,i=!n;if(Xe(e)&&e[ye]>0){var a=null;se(e,function(s){if(!i&&n===s&&(i=!0),i&&s&&be(s[hn])){var c=k9(s,t,o);r||(r=c),a&&a._setNext(c),a=c}})}return n&&!r?gi([n],t,o):r}function k9(e,t,o){var n=null,r=be(e[hn]),i=be(e[ja]),a;e?a=e[Lr]+"-"+e[ir]+"-"+_F++:a="Unknown-0-"+_F++;var s={getPlugin:function(){return e},getNext:function(){return n},processTelemetry:u,unload:p,update:m,_id:a,_setNext:function(f){n=f}};function c(){var f;return e&&be(e[hF])&&(f=e[hF]()),f||(f=yo(s,t,o)),f}function l(f,h,_,g,v){var x=!1,E=e?e[Lr]:w9,O=f[gF];return O||(O=f[gF]={}),f.setNext(n),e&&Za(f[Pt](),function(){return E+":"+_},function(){O[a]=!0;try{var k=n?n._id:De;k&&(O[k]=!1),x=h(f)}catch(Te){var P=n?O[n._id]:!0;P&&(x=!0),(!n||!P)&&V(f[rr](),1,73,"Plugin ["+E+"] failed during "+_+" - "+ue(Te)+", run flags: "+ue(O))}},g,v),x}function u(f,h){h=h||c();function _(g){if(!e||!r)return!1;var v=Ji(e);return v[Ln]||v[_m]?!1:(i&&e[ja](n),e[hn](f,g),!0)}l(h,_,"processTelemetry",function(){return{item:f}},!f.sync)||h[bt](f)}function p(f,h){function _(){var g=!1;if(e){var v=Ji(e),x=e[Pt]||v[Pt];e&&(!x||x===f.core())&&!v[Ln]&&(v[Pt]=null,v[Ln]=!0,v[Dn]=!1,e[Ln]&&e[Ln](f,h)===!0&&(g=!0))}return g}l(f,_,"unload",function(){},h[Or])||f[bt](h)}function m(f,h){function _(){var g=!1;if(e){var v=Ji(e),x=e[Pt]||v[Pt];e&&(!x||x===f.core())&&!v[Ln]&&e[Rc]&&e[Rc](f,h)===!0&&(g=!0)}return g}l(f,_,"update",function(){},!1)||f[bt](h)}return mi(s)}var A9=function(){function e(t,o,n,r){var i=this,a=yo(t,o,n,r);fi(i,a,Xo(a))}return e}();var Rm=500,I9="Channel has invalid priority - ";function vF(e,t,o){t&&Xe(t)&&t[ye]>0&&(t=t.sort(function(n,r){return n[ir]-r[ir]}),se(t,function(n){n[ir]<Rm&&Rt(I9+n[Lr])}),e[Ue]({queue:mi(t),chain:gi(t,o[ui],o)}))}function bF(e,t){function o(){return yo(null,t[ui],t,null)}function n(l,u,p,m){var f=l?l[ye]+1:1;function h(){f--,f===0&&(m&&m(),m=null)}f>0&&se(l,function(_){if(_&&_.queue[ye]>0){var g=_.chain,v=u[Wi](g);v[dm](h),p(v)}else f--}),h()}function r(l,u){var p=u||{reason:0};return n(e,l,function(m){m[bt](p)},function(){l[bt](p)}),!0}function i(l,u){var p=u||{reason:0,isAsync:!1};return n(e,l,function(m){m[bt](p)},function(){l[bt](p),s=!1}),!0}function a(l){var u=null;return e&&e[ye]>0&&se(e,function(p){if(p&&p.queue[ye]>0&&(se(p.queue,function(m){if(m[Lr]===l)return u=m,-1}),u))return-1}),u}var s=!1,c={identifier:"ChannelControllerPlugin",priority:Rm,initialize:function(l,u,p,m){s=!0,se(e,function(f){f&&f.queue[ye]>0&&uv(yo(f.chain,l,u),p)})},isInitialized:function(){return s},processTelemetry:function(l,u){n(e,u||o(),function(p){p[bt](l)},function(){u[bt](l)})},update:r,pause:function(){n(e,o(),function(l){l.iterate(function(u){u.pause&&u.pause()})},null)},resume:function(){n(e,o(),function(l){l.iterate(function(u){u.resume&&u.resume()})},null)},teardown:i,getChannel:a,flush:function(l,u,p,m){var f=1,h=!1,_=null;m=m||5e3;function g(){f--,h&&f===0&&(_&&(clearTimeout(_),_=null),u&&u(h),u=null)}return n(e,o(),function(v){v.iterate(function(x){if(x[Cu]){f++;var E=!1;x[Cu](l,function(){E=!0,g()},p)||E||(l&&_==null?_=setTimeout(function(){_=null,g()},m):g())}})},function(){h=!0,g()}),!0},_setQueue:function(l){e=l}};return c}function xF(e,t,o){var n=[];if(e&&se(e,function(i){return vF(n,i,o)}),t){var r=[];se(t,function(i){i[ir]>Rm&&r[Ue](i)}),vF(n,r,o)}return n}function pv(){var e=[];function t(n){n&&e[Ue](n)}function o(n,r){se(e,function(i){try{i(n,r)}catch(a){V(n[rr](),2,73,"Unexpected error calling unload handler - "+ue(a))}}),e=[]}return{add:t,run:o}}var os="getPlugin",Hr=function(){function e(){var t=this,o,n,r,i,a;l(),Ie(e,t,function(u){u[Dr]=function(p,m,f,h){c(p,m,h),o=!0},u[Ln]=function(p,m){var f,h=u[Pt];if(!h||p&&h!==p[Pt]())return;var _,g=!1,v=p||Yu(null,h,r&&r[os]?r[os]():r),x=m||(f={reason:0},f[Or]=!1,f);function E(){if(!g){g=!0,i.run(v,m);var O=a;a=[],se(O,function(k){k.rm()}),_===!0&&v[bt](x),l()}}return!u[Au]||u[Au](v,x,E)!==!0?E():_=!0,_},u[Rc]=function(p,m){var f=u[Pt];if(!f||p&&f!==p[Pt]())return;var h,_=!1,g=p||Pm(null,f,r&&r[os]?r[os]():r),v=m||{reason:0};function x(){_||(_=!0,c(g.getCfg(),g.core(),g[Mn]()))}return!u._doUpdate||u._doUpdate(g,v,x)!==!0?x():h=!0,h},u._addHook=function(p){p&&(Xe(p)?a=a.concat(p):a[Ue](p))},$u(u,"_addUnloadCb",function(){return i},"add")}),t[rr]=function(u){return s(u)[rr]()},t[Dn]=function(){return o},t.setInitialized=function(u){o=u},t[ja]=function(u){r=u},t[bt]=function(u,p){p?p[bt](u):r&&be(r[hn])&&r[hn](u,null)},t._getTelCtx=s;function s(u){u===void 0&&(u=null);var p=u;if(!p){var m=n||yo(null,{},t[Pt]);r&&r[os]?p=m[Wi](null,r[os]):p=m[Wi](null,r)}return p}function c(u,p,m){u&&Ze(u,Nu,[],null,q),!m&&p&&(m=p[U_]()[Mn]());var f=r;r&&r[os]&&(f=r[os]()),t[Pt]=p,n=yo(m,u,p,f)}function l(){o=!1,t[Pt]=null,n=null,r=null,a=[],i=pv()}}return e.__ieDyn=1,e}();var yF=function(e){vo(t,e);function t(){var o=e.call(this)||this;o.identifier="TelemetryInitializerPlugin",o.priority=199;var n,r;i(),Ie(t,o,function(a,s){a.addTelemetryInitializer=function(c){var l={id:n++,fn:c};r[Ue](l);var u={remove:function(){se(r,function(p,m){if(p.id===l.id)return r[Mr](m,1),-1})}};return u},a[hn]=function(c,l){for(var u=!1,p=r[ye],m=0;m<p;++m){var f=r[m];if(f)try{if(f.fn[di](null,[c])===!1){u=!0;break}}catch(h){V(l[rr](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Oe(h),{exception:ue(h)},!0)}}u||a[bt](c,l)},a[Au]=function(){i()}});function i(){n=0,r=[]}return o}return t.__ieDyn=1,t}(Hr);var wF="Plugins must provide initialize method",TF="_notificationManager",SF="SDK is still unloading...",P9="SDK is not initialized",R9={loggingLevelConsole:1};function N9(e,t){return new eE(t)}function D9(e,t,o){var n,r=[],i={};return se(o,function(a){(q(a)||q(a[Dr]))&&Rt(wF);var s=a[ir],c=a[Lr];a&&s&&(q(i[s])?i[s]=c:lr(e,"Two extensions have same priority #"+s+" - "+i[s]+", "+c)),(!s||s<t)&&r[Ue](a)}),n={all:o},n[Pt]=r,n}function EF(e,t){var o=!1;return se(t,function(n){if(n===e)return o=!0,-1}),o}function L9(){var e;return wu((e={},e[Ac]=function(t){},e[Ic]=function(t){},e[Du]=function(t){},e[Qa]=function(t,o){},e[Lu]=function(t,o){},e))}var CF=function(){function e(){var t,o,n,r,i,a,s,c,l,u,p,m,f,h,_,g,v,x,E,O,k=0;Ie(e,this,function(P){Te(),P[Dn]=function(){return o},P[Dr]=function(b,R,U,$){h&&Rt(SF),P[Dn]()&&Rt("Core should not be initialized more than once"),t=b||{},P[ui]=t,q(b[O_])&&Rt("Please provide instrumentation key"),r=$,P[TF]=$,Co(),En(),Oo(),U&&(P[gn]=U);var ee=Mt(t,mz,[]);l=[],l[Ue].apply(l,M_(M_([],R,!1),ee,!1)),m=Mt(t,ES,[]),fe(null),(!f||f[ye]===0)&&Rt("No "+ES+" available"),o=!0,P.releaseQueue()},P.getTransmissionControls=function(){var b=[];return f&&se(f,function(R){b[Ue](R.queue)}),mi(b)},P.track=function(b){b.iKey=b.iKey||t[O_],b[kc]=b[kc]||On(new Date),b.ver=b.ver||"4.0",!h&&P[Dn]()?Se()[bt](b):n[Ue](b)},P[U_]=Se,P[um]=function(){return r||(r=L9(),P[TF]=r),r},P[Ac]=function(b){r&&r[Ac](b)},P[Ic]=function(b){r&&r[Ic](b)},P.getCookieMgr=function(){return s||(s=Fc(t,P[gn])),s},P.setCookieMgr=function(b){s=b},P[Lc]=function(){if(!i&&!a&&sr(t.enablePerfMgr)){var b=sr(t[wS]);be(b)&&(a=b(P,P[um]()))}return i||a||tE()},P.setPerfMgr=function(b){i=b},P.eventCnt=function(){return n[ye]},P.releaseQueue=function(){if(o&&n[ye]>0){var b=n;n=[],se(b,function(R){Se()[bt](R)})}},P.pollInternalLogs=function(b){g=b||null;var R=sr(t.diagnosticLogInterval);return(!R||!(R>0))&&(R=1e4),k&&clearInterval(k),k=setInterval(function(){Vo()},R),k},P[xS]=function(){k&&(clearInterval(k),k=0,Vo())},fi(P,function(){return _},["addTelemetryInitializer"]),P.unload=function(b,R,U){var $;b===void 0&&(b=!0),o||Rt(P9),h&&Rt(SF);var ee=($={reason:50},$[Or]=b,$.flushComplete=!1,$),S=Yu(po(),P);S[dm](function(){Te(),R&&R(ee)},P);function N(H){ee.flushComplete=H,h=!0,x.run(S,ee),P[xS](),S[bt](ee)}nn(b,N,6,U)||N(!1)},P[Pc]=on,P.addPlugin=function(b,R,U,$){if(!b){$&&$(!1),Me(wF);return}var ee=on(b[Lr]);if(ee&&!R){$&&$(!1),Me("Plugin ["+b[Lr]+"] is already loaded!");return}var S={reason:16};function N(ve){l[Ue](b),S.added=[b],fe(S),$&&$(!0)}if(ee){var H=[ee.plugin],K={reason:2,isAsync:!!U};mo(H,K,function(ve){ve?(S.removed=H,S.reason|=32,N(!0)):$&&$(!1)})}else N(!1)},P.evtNamespace=function(){return v},P[Cu]=nn,P.getTraceCtx=function(b){return O||(O=fF()),O},P.setTraceCtx=function(b){O=b||null},$u(P,"addUnloadCb",function(){return x},"add");function Te(){o=!1,t=zu(!0,{},R9),P[ui]=t,P[gn]=new Uc(t),P[pm]=[],_=new yF,n=[],r=null,i=null,a=null,s=null,c=null,u=null,l=[],p=null,m=null,f=null,h=!1,g=null,v=Lo("AIBaseCore",!0),x=pv(),O=null}function Se(){return yo(po(),t,P)}function fe(b){var R=D9(P[gn],Rm,l);u=R[Pt],c=null;var U=R.all;if(f=mi(xF(m,U,P)),p){var $=bo(U,p);$!==-1&&U[Mr]($,1),$=bo(u,p),$!==-1&&u[Mr]($,1),p._setQueue(f)}else p=bF(f,P);U[Ue](p),u[Ue](p),P[pm]=dv(U),p[Dr](t,P,U),uv(Se(),U),P[pm]=mi(dv(u||[])).slice(),b&&ae(b)}function on(b){var R,U=null,$=null;return se(P[pm],function(ee){if(ee[Lr]===b&&ee!==p&&ee!==_)return $=ee,-1}),!$&&p&&($=p.getChannel(b)),$&&(U=(R={plugin:$},R[mm]=function(ee){Ji($)[_m]=!ee},R.isEnabled=function(){var ee=Ji($);return!ee[Ln]&&!ee[_m]},R.remove=function(ee,S){var N;ee===void 0&&(ee=!0);var H=[$],K=(N={reason:1},N[Or]=ee,N);mo(H,K,function(ve){ve&&fe({reason:32,removed:H}),S&&S(ve)})},R)),U}function po(){if(!c){var b=(u||[]).slice();bo(b,_)===-1&&b[Ue](_),c=gi(dv(b),t,P)}return c}function mo(b,R,U){if(b&&b[ye]>0){var $=gi(b,t,P),ee=Yu($,P);ee[dm](function(){var S=!1,N=[];se(l,function(K,ve){EF(K,b)?S=!0:N[Ue](K)}),l=N;var H=[];m&&(se(m,function(K,ve){var qe=[];se(K,function(Ve){EF(Ve,b)?S=!0:qe[Ue](Ve)}),H[Ue](qe)}),m=H),U&&U(S)}),ee[bt](R)}else U(!1)}function Vo(){var b=P[gn]?P[gn].queue:[];b&&(se(b,function(R){var U,$=(U={},U[zo]=g||"InternalMessageId: "+R[ku],U.iKey=sr(t[O_]),U.time=On(new Date),U.baseType=Qi.dataType,U.baseData={message:R[Va]},U);P.track($)}),b[ye]=0)}function nn(b,R,U,$){return p?p[Cu](b,R,U||6,$):(R&&R(!1),!0)}function Co(){var b=sr(t.disableDbgExt);b===!0&&E&&(r[Ic](E),E=null),r&&!E&&b!==!0&&(E=Nz(t),r[Ac](E))}function En(){var b=sr(t.enablePerfMgr);!b&&a&&(a=null),b&&Mt(t,wS,N9)}function Oo(){var b=Mt(t,Nu,{});b.NotificationManager=r}function ae(b){var R=Pm(po(),P);(!P._updateHook||P._updateHook(R,b)!==!0)&&R[bt](b)}function Me(b){var R=P[gn];R?V(R,2,73,b):Rt(b)}})}return e.__ieDyn=1,e}();function mv(e,t,o,n){se(e,function(r){if(r&&r[t])if(o)setTimeout(function(){return n(r)},0);else try{n(r)}catch{}})}var kF=function(){function e(t){this.listeners=[];var o=!!(t||{}).perfEvtsSendAll;Ie(e,this,function(n){n[Ac]=function(r){n.listeners[Ue](r)},n[Ic]=function(r){for(var i=bo(n[Nc],r);i>-1;)n.listeners[Mr](i,1),i=bo(n[Nc],r)},n[Du]=function(r){mv(n[Nc],Du,!0,function(i){i[Du](r)})},n[Qa]=function(r,i){mv(n[Nc],Qa,!0,function(a){a[Qa](r,i)})},n[Lu]=function(r,i){mv(n[Nc],Lu,i,function(a){a[Lu](r,i)})},n[Xa]=function(r){r&&(o||!r[fm]())&&mv(n[Nc],Xa,!1,function(i){r[Or]?setTimeout(function(){return i[Xa](r)},0):i[Xa](r)})}})}return e.__ieDyn=1,e}();var _E=function(e){vo(t,e);function t(){var o=e.call(this)||this;return Ie(t,o,function(n,r){n[Dr]=function(s,c,l,u){r[Dr](s,c,l||new Uc(s),u||new kF(s))},n.track=function(s){Za(n[Lc](),function(){return"AppInsightsCore:track"},function(){s===null&&(a(s),Rt("Invalid telemetry item")),i(s),r.track(s)},function(){return{item:s}},!s.sync)};function i(s){q(s[zo])&&(a(s),Rt("telemetry name required"))}function a(s){var c=n[um]();c&&c[Qa]([s],2)}}),o}return t.__ieDyn=1,t}(CF);var AF="_aiHooks",IF=["req","rsp","hkErr","fnErr"];function bE(e,t){if(e)for(var o=0;o<e[ye]&&!t(e[o],o);o++);}function vE(e,t,o,n,r){r>=0&&r<=2&&bE(e,function(i,a){var s=i.cbks,c=s[IF[r]];if(c){t.ctx=function(){var p=n[a]=n[a]||{};return p};try{c[di](t.inst,o)}catch(p){var l=t.err;try{var u=s[IF[2]];u&&(t.err=p,u[di](t.inst,o))}catch{}finally{t.err=l}}}})}function M9(e){return function(){var t,o=this,n=arguments,r=e.h,i=(t={},t[zo]=e.n,t.inst=o,t.ctx=null,t.set=l,t),a=[],s=c([i],n);i.evt=Nt("event");function c(p,m){return bE(m,function(f){p[Ue](f)}),p}function l(p,m){n=c([],n),n[p]=m,s=c([i],n)}vE(r,i,s,a,0);var u=e.f;if(u)try{i.rslt=u[di](o,n)}catch(p){throw i.err=p,vE(r,i,s,a,3),p}return vE(r,i,s,a,1),i.rslt}}function xE(e,t,o){var n=null;return e&&(j_(e,t)?n=e:o&&(n=xE(PS(e),t,!1))),n}function yE(e,t,o){return e?Nm(e[It],t,o,!1):null}function PF(e,t,o,n){var r=o&&o[AF];if(!r){r={i:0,n:t,f:o,h:[]};var i=M9(r);i[AF]=r,e[t]=i}var a={id:r.i,cbks:n,rm:function(){var s=this.id;bE(r.h,function(c,l){if(c.id===s)return r.h[Mr](l,1),1})}};return r.i++,r.h[Ue](a),a}function Nm(e,t,o,n){if(n===void 0&&(n=!0),e&&t&&o){var r=xE(e,t,n);if(r){var i=r[t];if(typeof i===or)return PF(r,t,i,o)}}return null}function Gu(e,t,o,n){if(e&&t&&o){var r=xE(e,t,n)||e;if(r)return PF(r,t,r[t],o)}return null}var qr="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Vu="sampleRate",ju="ProcessLegacy",Dm="http.method",ns="https://dc.services.visualstudio.com",Zi="/v2/track",qt="not_specified",fv="iKey";function Yc(e){var t=null;if(be(Event))t=new Event(e);else{var o=Ht();o&&o.createEvent&&(t=o.createEvent("Event"),t.initEvent(e,!0,!0))}return t}var ea="split",Pe="length",hi="toLowerCase",Lm="ingestionendpoint",Br="toString",gv="removeItem",Wt="name",Mm="pathname",TE="correlationHeaderExcludePatterns",Wu="indexOf";var Gc="exceptions",_i="parsedStack",Ho="properties",qo="measurements",Om="stringify",ta="message",Vc="sizeInBytes",vi="typeName",jc="severityLevel",hv="problemGroup",_v="isManual",SE="CreateFromInterface",Um="hasFullStack",$m="level",Wc="method",zm="assembly",Ku="fileName",Qu="line",Kc="duration",EE="receivedResponse",Qc="substring",RF="sanitizeKeyAndAddUniqueness",NF="sanitizeException",DF="sanitizeProperties",LF="sanitizeMeasurements";var Fm="";function dr(e,t){return t===void 0&&(t=!1),e==null?t:e.toString()[hi]()==="true"}function zn(e){(isNaN(e)||e<0)&&(e=0),e=Math.round(e);var t=Fm+e%1e3,o=Fm+Math.floor(e/1e3)%60,n=Fm+Math.floor(e/(1e3*60))%60,r=Fm+Math.floor(e/(1e3*60*60))%24,i=Math.floor(e/(1e3*60*60*24));return t=t[Pe]===1?"00"+t:t[Pe]===2?"0"+t:t,o=o[Pe]<2?"0"+o:o,n=n[Pe]<2?"0"+n:n,r=r[Pe]<2?"0"+r:r,(i>0?i+".":Fm)+r+":"+n+":"+o+"."+t}function wE(e,t,o,n,r){return!r&&ge(e)&&(e==="Script error."||e==="Script error")}var lt=OS({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]});var Xu=K_({LocalStorage:0,SessionStorage:1}),j9=K_({AI:0,AI_AND_W3C:1,W3C:2});var rs=void 0,is=void 0;function CE(){return Hm()?vv(Xu.LocalStorage):null}function vv(e){try{if(q(nr()))return null;var t=new Date()[Br](),o=Nt(e===Xu.LocalStorage?"localStorage":"sessionStorage");o.setItem(t,t);var n=o.getItem(t)!==t;if(o[gv](t),!n)return o}catch{}return null}function kE(){return as()?vv(Xu.SessionStorage):null}function AE(){rs=!1,is=!1}function IE(){rs=Hm(!0),is=as(!0)}function Hm(e){return(e||rs===void 0)&&(rs=!!vv(Xu.LocalStorage)),rs}function PE(e,t){var o=CE();if(o!==null)try{return o.getItem(t)}catch(n){rs=!1,V(e,2,1,"Browser failed read of local storage. "+Oe(n),{exception:ue(n)})}return null}function RE(e,t,o){var n=CE();if(n!==null)try{return n.setItem(t,o),!0}catch(r){rs=!1,V(e,2,3,"Browser failed write to local storage. "+Oe(r),{exception:ue(r)})}return!1}function NE(e,t){var o=CE();if(o!==null)try{return o[gv](t),!0}catch(n){rs=!1,V(e,2,5,"Browser failed removal of local storage item. "+Oe(n),{exception:ue(n)})}return!1}function as(e){return(e||is===void 0)&&(is=!!vv(Xu.SessionStorage)),is}function Ju(e,t){var o=kE();if(o!==null)try{return o.getItem(t)}catch(n){is=!1,V(e,2,2,"Browser failed read of session storage. "+Oe(n),{exception:ue(n)})}return null}function Zu(e,t,o){var n=kE();if(n!==null)try{return n.setItem(t,o),!0}catch(r){is=!1,V(e,2,4,"Browser failed write to session storage. "+Oe(r),{exception:ue(r)})}return!1}function DE(e,t){var o=kE();if(o!==null)try{return o[gv](t),!0}catch(n){is=!1,V(e,2,6,"Browser failed removal of session storage item. "+Oe(n),{exception:ue(n)})}return!1}var bn;function bv(e,t,o){var n=t[Pe],r=LE(e,t);if(r[Pe]!==n){for(var i=0,a=r;o[a]!==void 0;)i++,a=r[Qc](0,150-3)+ME(i);r=a}return r}function LE(e,t){var o;return t&&(t=Ft(t[Br]()),t[Pe]>150&&(o=t[Qc](0,150),V(e,2,57,"name is too long.  It has been truncated to "+150+" characters.",{name:t},!0))),o||t}function at(e,t,o){o===void 0&&(o=1024);var n;return t&&(o=o||1024,t=Ft(t),t.toString()[Pe]>o&&(n=t[Br]()[Qc](0,o),V(e,2,61,"string value is too long. It has been truncated to "+o+" characters.",{value:t},!0))),n||t}function bi(e,t){return Tv(e,t,2048,66)}function ed(e,t){var o;return t&&t[Pe]>32768&&(o=t[Qc](0,32768),V(e,2,56,"message is too long, it has been truncated to "+32768+" characters.",{message:t},!0)),o||t}function xv(e,t){var o;if(t){var n=""+t;n[Pe]>32768&&(o=n[Qc](0,32768),V(e,2,52,"exception is too long, it has been truncated to "+32768+" characters.",{exception:t},!0))}return o||t}function Bo(e,t){if(t){var o={};He(t,function(n,r){if(Fo(r)&&zr())try{r=so()[Om](r)}catch(i){V(e,2,49,"custom property is not valid",{exception:i},!0)}r=at(e,r,8192),n=bv(e,n,o),o[n]=r}),t=o}return t}function Yo(e,t){if(t){var o={};He(t,function(n,r){n=bv(e,n,o),o[n]=r}),t=o}return t}function yv(e,t){return t&&Tv(e,t,128,69)[Br]()}function Tv(e,t,o,n){var r;return t&&(t=Ft(t),t[Pe]>o&&(r=t[Qc](0,o),V(e,2,n,"input is too long, it has been truncated to "+o+" characters.",{data:t},!0))),r||t}function ME(e){var t="00"+e;return t.substr(t[Pe]-3)}var MF=(bn={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},bn[RF]=bv,bn.sanitizeKey=LE,bn.sanitizeString=at,bn.sanitizeUrl=bi,bn.sanitizeMessage=ed,bn[NF]=xv,bn[DF]=Bo,bn[LF]=Yo,bn.sanitizeId=yv,bn.sanitizeInput=Tv,bn.padNumber=ME,bn.trim=Ft,bn);var OF=Ht()||{},UF=0,W9=[null,null,null,null,null];function qm(e){var t=UF,o=W9,n=o[t];return OF.createElement?o[t]||(n=o[t]=OF.createElement("a")):n={host:OE(e,!0)},n.href=e,t++,t>=o[Pe]&&(t=0),UF=t,n}function Sv(e){var t,o=qm(e);return o&&(t=o.href),t}function Ev(e,t){return e?e.toUpperCase()+" "+t:t}function OE(e,t){var o=wv(e,t)||"";if(o){var n=o.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n[Pe]>3&&ge(n[2])&&n[2][Pe]>0)return n[2]+(n[3]||"")}return o}function wv(e,t){var o=null;if(e){var n=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(n!=null&&n[Pe]>2&&ge(n[2])&&n[2][Pe]>0&&(o=n[2]||"",t&&n[Pe]>2)){var r=(n[1]||"")[hi](),i=n[3]||"";(r==="http"&&i===":80"||r==="https"&&i===":443")&&(i=""),o+=i}}return o}var Q9=[ns+Zi,"https://breeze.aimon.applicationinsights.io"+Zi,"https://dc-int.services.visualstudio.com"+Zi];function Xc(e){return bo(Q9,e[hi]())!==-1}var oa={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(e,t,o){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e[TE]){for(var n=0;n<e.correlationHeaderExcludePatterns[Pe];n++)if(e[TE][n].test(t))return!1}var r=qm(t).host[hi]();if(r&&(r[Wu](":443")!==-1||r[Wu](":80")!==-1)&&(r=(wv(t,!0)||"")[hi]()),(!e||!e.enableCorsCorrelation)&&r&&r!==o)return!1;var i=e&&e.correlationHeaderDomains;if(i){var a;if(se(i,function(l){var u=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||u.test(r)}),!a)return!1}var s=e&&e.correlationHeaderExcludedDomains;if(!s||s[Pe]===0)return!0;for(var n=0;n<s[Pe];n++){var c=new RegExp(s[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(c.test(r))return!1}return r&&r[Pe]>0},getCorrelationContext:function(e){if(e){var t=oa.getCorrelationContextValue(e,lt[1]);if(t&&t!==oa.correlationIdPrefix)return t}},getCorrelationContextValue:function(e,t){if(e)for(var o=e[ea](","),n=0;n<o[Pe];++n){var r=o[n][ea]("=");if(r[Pe]===2&&r[0]===t)return r[1]}}};function $F(e,t,o,n){var r,i=n,a=n;if(t&&t[Pe]>0){var s=qm(t);if(r=s.host,!i)if(s[Mm]!=null){var c=s.pathname[Pe]===0?"/":s[Mm];c.charAt(0)!=="/"&&(c="/"+c),a=s[Mm],i=at(e,o?o+" "+c:c)}else i=at(e,t)}else r=n,i=n;return{target:r,name:i,data:a}}function td(){var e=cr();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return xo()}function co(e,t){var o=null;return e!==0&&t!==0&&!q(e)&&!q(t)&&(o=t-e),o}function Jc(e,t){var o=e||{};return{getName:function(){return o[Wt]},setName:function(n){t&&t.setName(n),o[Wt]=n},getTraceId:function(){return o.traceID},setTraceId:function(n){t&&t.setTraceId(n),qc(n)&&(o.traceID=n)},getSpanId:function(){return o.parentID},setSpanId:function(n){t&&t.setSpanId(n),Bc(n)&&(o.parentID=n)},getTraceFlags:function(){return o.traceFlags},setTraceFlags:function(n){t&&t.setTraceFlags(n),o.traceFlags=n}}}var X9=";",J9="=";function UE(e){if(!e)return{};var t=e[ea](X9),o=DS(t,function(r,i){var a=i[ea](J9);if(a[Pe]===2){var s=a[0][hi](),c=a[1];r[s]=c}return r},{});if(Xo(o)[Pe]>0){if(o.endpointsuffix){var n=o.location?o.location+".":"";o[Lm]=o[Lm]||"https://"+n+"dc."+o.endpointsuffix}o[Lm]=o[Lm]||ns}return o}var Cv=function(){function e(t,o,n){var r=this,i=this;i.ver=1,i.sampleRate=100,i.tags={},i[Wt]=at(t,n)||qt,i.data=o,i.time=On(new Date),i.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return r.sampleRate===100?4:1},tags:1,data:1}}return e}();var Fn=function(){function e(t,o,n,r){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var i=this;i.ver=2,i[Wt]=at(t,o)||qt,i[Ho]=Bo(t,n),i[qo]=Yo(t,r)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Event",e.dataType="EventData",e}();var Z9="<no_method>",nd="error",pr="stack",zE="stackDetails",zF="errorSrc",FE="message",qF="description";function HE(e,t){var o=e;return o&&!ge(o)&&(JSON&&JSON[Om]?(o=JSON[Om](e),t&&(!o||o==="{}")&&(be(e[Br])?o=e[Br]():o=""+e)):o=""+e+" - (Missing JSON.stringify)"),o||""}function BF(e,t){var o=e;return e&&(o&&!ge(o)&&(o=e[FE]||e[qF]||o),o&&!ge(o)&&(o=HE(o,!0)),e.filename&&(o=o+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),t&&t!=="String"&&t!=="Object"&&t!=="Error"&&(o||"")[Wu](t)===-1&&(o=t+": "+o),o||""}function eV(e){try{if(Fo(e))return"hasFullStack"in e&&"typeName"in e}catch{}return!1}function tV(e){try{if(Fo(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch{}return!1}function FF(e){return e&&e.src&&ge(e.src)&&e.obj&&Xe(e.obj)}function od(e){var t=e||"";ge(t)||(ge(t[pr])?t=t[pr]:t=""+t);var o=t[ea](`
`);return{src:t,obj:o}}function oV(e){for(var t=[],o=e[ea](`
`),n=0;n<o[Pe];n++){var r=o[n];o[n+1]&&(r+="@"+o[n+1],n++),t.push(r)}return{src:e,obj:t}}function YF(e){var t=null;if(e)try{if(e[pr])t=od(e[pr]);else if(e[nd]&&e[nd][pr])t=od(e[nd][pr]);else if(e.exception&&e.exception[pr])t=od(e.exception[pr]);else if(FF(e))t=e;else if(FF(e[zE]))t=e[zE];else if(window&&window.opera&&e[FE])t=oV(e[ta]);else if(ge(e))t=od(e);else{var o=e[FE]||e[qF]||"";ge(e[zF])&&(o&&(o+=`
`),o+=" from "+e[zF]),o&&(t=od(o))}}catch(n){t=od(n)}return t||{src:"",obj:null}}function nV(e){var t="";return e&&(e.obj?se(e.obj,function(o){t+=o+`
`}):t=e.src||""),t}function rV(e){var t,o=e.obj;if(o&&o[Pe]>0){t=[];var n=0,r=0;se(o,function(h){var _=h[Br]();if(qE.regex.test(_)){var g=new qE(_,n++);r+=g[Vc],t.push(g)}});var i=32*1024;if(r>i)for(var a=0,s=t[Pe]-1,c=0,l=a,u=s;a<s;){var p=t[a][Vc],m=t[s][Vc];if(c+=p+m,c>i){var f=u-l+1;t.splice(l,f);break}l=a,u=s,a++,s--}}return t}function kv(e){var t="";if(e&&(t=e.typeName||e[Wt]||"",!t))try{var o=/function (.{1,200})\(/,n=o.exec(e.constructor[Br]());t=n&&n[Pe]>1?n[1]:""}catch{}return t}function $E(e){if(e)try{if(!ge(e)){var t=kv(e),o=HE(e,!1);return(!o||o==="{}")&&(e[nd]&&(e=e[nd],t=kv(e)),o=HE(e,!0)),o[Wu](t)!==0&&t!=="String"?t+":"+o:o}}catch{}return""+(e||"")}var Mo=function(){function e(t,o,n,r,i,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var s=this;s.ver=2,tV(o)?(s[Gc]=o[Gc]||[],s[Ho]=o[Ho],s[qo]=o[qo],o[jc]&&(s[jc]=o[jc]),o.id&&(s.id=o.id),o[hv]&&(s[hv]=o[hv]),q(o[_v])||(s[_v]=o[_v])):(n||(n={}),s[Gc]=[new HF(t,o,n)],s[Ho]=Bo(t,n),s[qo]=Yo(t,r),i&&(s[jc]=i),a&&(s.id=a))}return e.CreateAutoException=function(t,o,n,r,i,a,s,c){var l,u=kv(i||a||t);return l={},l[ta]=BF(t,u),l.url=o,l.lineNumber=n,l.columnNumber=r,l.error=$E(i||a||t),l.evt=$E(a||t),l[vi]=u,l.stackDetails=YF(s||i||a),l.errorSrc=c,l},e.CreateFromInterface=function(t,o,n,r){var i=o[Gc]&&Mu(o[Gc],function(s){return HF[SE](t,s)}),a=new e(t,zt(zt({},o),{exceptions:i}),n,r);return a},e.prototype.toInterface=function(){var t,o=this,n=o.exceptions,r=o.properties,i=o.measurements,a=o.severityLevel,s=o.problemGroup,c=o.id,l=o.isManual,u=n instanceof Array&&Mu(n,function(p){return p.toInterface()})||void 0;return t={ver:"4.0"},t[Gc]=u,t.severityLevel=a,t.properties=r,t.measurements=i,t.problemGroup=s,t.id=c,t.isManual=l,t},e.CreateSimpleException=function(t,o,n,r,i,a){var s;return{exceptions:[(s={},s[Um]=!0,s.message=t,s.stack=i,s.typeName=o,s)]}},e.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",e.dataType="ExceptionData",e.formatError=$E,e}();var HF=function(){function e(t,o,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var r=this;if(eV(o))r[vi]=o[vi],r[ta]=o[ta],r[pr]=o[pr],r[_i]=o[_i]||[],r[Um]=o[Um];else{var i=o,a=i&&i.evt;bm(i)||(i=i[nd]||a||i),r[vi]=at(t,kv(i))||qt,r[ta]=ed(t,BF(o||i,r[vi]))||qt;var s=o[zE]||YF(o);r[_i]=rV(s),r[pr]=xv(t,nV(s)),r.hasFullStack=Xe(r.parsedStack)&&r.parsedStack[Pe]>0,n&&(n[vi]=n[vi]||r[vi])}}return e.prototype.toInterface=function(){var t,o=this,n=o[_i]instanceof Array&&Mu(o[_i],function(i){return i.toInterface()}),r=(t={id:o.id,outerId:o.outerId,typeName:o[vi],message:o[ta],hasFullStack:o[Um],stack:o[pr]},t[_i]=n||void 0,t);return r},e.CreateFromInterface=function(t,o){var n=o[_i]instanceof Array&&Mu(o[_i],function(i){return qE[SE](i)})||o[_i],r=new e(t,zt(zt({},o),{parsedStack:n}));return r},e}();var qE=function(){function e(t,o){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Vc]=0,typeof t=="string"){var r=t;n[$m]=o,n[Wc]=Z9,n[zm]=Ft(r),n[Ku]="",n[Qu]=0;var i=r.match(e.regex);i&&i[Pe]>=5&&(n[Wc]=Ft(i[2])||n[Wc],n[Ku]=Ft(i[4]),n[Qu]=parseInt(i[5])||0)}else n[$m]=t[$m],n[Wc]=t[Wc],n[zm]=t[zm],n[Ku]=t[Ku],n[Qu]=t[Qu],n[Vc]=0;n.sizeInBytes+=n.method[Pe],n.sizeInBytes+=n.fileName[Pe],n.sizeInBytes+=n.assembly[Pe],n[Vc]+=e.baseSize,n.sizeInBytes+=n.level.toString()[Pe],n.sizeInBytes+=n.line.toString()[Pe]}return e.CreateFromInterface=function(t){return new e(t,null)},e.prototype.toInterface=function(){var t=this;return{level:t[$m],method:t[Wc],assembly:t[zm],fileName:t[Ku],line:t[Qu]}},e.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,e.baseSize=58,e}();var GF=function(){function e(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return e}();var Hn=function(){function e(t,o,n,r,i,a,s,c,l){this.aiDataContract={ver:1,metrics:1,properties:0};var u=this;u.ver=2;var p=new GF;p.count=r>0?r:void 0,p.max=isNaN(a)||a===null?void 0:a,p.min=isNaN(i)||i===null?void 0:i,p[Wt]=at(t,o)||qt,p.value=n,p.stdDev=isNaN(s)||s===null?void 0:s,u.metrics=[p],u[Ho]=Bo(t,c),u[qo]=Yo(t,l)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",e.dataType="MetricData",e}();var Zo=function(){function e(t,o,n,r,i,a,s){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var c=this;c.ver=2,c.id=yv(t,s),c.url=bi(t,n),c[Wt]=at(t,o)||qt,isNaN(r)||(c[Kc]=zn(r)),c[Ho]=Bo(t,i),c[qo]=Yo(t,a)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",e.dataType="PageviewData",e}();var qn=function(){function e(t,o,n,r,i,a,s,c,l,u,p,m){l===void 0&&(l="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var f=this;f.ver=2,f.id=o,f[Kc]=zn(i),f.success=a,f.resultCode=s+"",f.type=at(t,l);var h=$F(t,n,c,r);f.data=bi(t,r)||h.data,f.target=at(t,h.target),u&&(f.target="".concat(f.target," | ").concat(u)),f[Wt]=at(t,h[Wt]),f[Ho]=Bo(t,p),f[qo]=Yo(t,m)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",e.dataType="RemoteDependencyData",e}();var Yr=function(){function e(t,o,n,r,i){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,o=o||qt,a[ta]=ed(t,o),a[Ho]=Bo(t,r),a[qo]=Yo(t,i),n&&(a[jc]=n)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.Message",e.dataType="MessageData",e}();var Gr=function(){function e(t,o,n,r,i,a,s){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var c=this;c.ver=2,c.url=bi(t,n),c[Wt]=at(t,o)||qt,c[Ho]=Bo(t,i),c[qo]=Yo(t,a),s&&(c.domProcessing=s.domProcessing,c[Kc]=s[Kc],c.networkConnect=s.networkConnect,c.perfTotal=s.perfTotal,c[EE]=s[EE],c.sentRequest=s.sentRequest)}return e.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",e.dataType="PageviewPerformanceData",e}();var xi=function(){function e(t,o){this.aiDataContract={baseType:1,baseData:1},this.baseType=t,this.baseData=o}return e}();function cs(e){var t="ai."+e+".";return function(o){return t+o}}var Bm=cs("application"),lo=cs("device"),Av=cs("location"),rd=cs("operation"),BE=cs("session"),ss=cs("user"),Zc=cs("cloud"),Ym=cs("internal"),id=function(e){vo(t,e);function t(){return e.call(this)||this}return t}(MS({applicationVersion:Bm("ver"),applicationBuild:Bm("build"),applicationTypeId:Bm("typeId"),applicationId:Bm("applicationId"),applicationLayer:Bm("layer"),deviceId:lo("id"),deviceIp:lo("ip"),deviceLanguage:lo("language"),deviceLocale:lo("locale"),deviceModel:lo("model"),deviceFriendlyName:lo("friendlyName"),deviceNetwork:lo("network"),deviceNetworkName:lo("networkName"),deviceOEMName:lo("oemName"),deviceOS:lo("os"),deviceOSVersion:lo("osVersion"),deviceRoleInstance:lo("roleInstance"),deviceRoleName:lo("roleName"),deviceScreenResolution:lo("screenResolution"),deviceType:lo("type"),deviceMachineName:lo("machineName"),deviceVMName:lo("vmName"),deviceBrowser:lo("browser"),deviceBrowserVersion:lo("browserVersion"),locationIp:Av("ip"),locationCountry:Av("country"),locationProvince:Av("province"),locationCity:Av("city"),operationId:rd("id"),operationName:rd("name"),operationParentId:rd("parentId"),operationRootId:rd("rootId"),operationSyntheticSource:rd("syntheticSource"),operationCorrelationVector:rd("correlationVector"),sessionId:BE("id"),sessionIsFirst:BE("isFirst"),sessionIsNew:BE("isNew"),userAccountAcquisitionDate:ss("accountAcquisitionDate"),userAccountId:ss("accountId"),userAgent:ss("userAgent"),userId:ss("id"),userStoreRegion:ss("storeRegion"),userAuthUserId:ss("authUserId"),userAnonymousUserAcquisitionDate:ss("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:ss("authUserAcquisitionDate"),cloudName:Zc("name"),cloudRole:Zc("role"),cloudRoleVer:Zc("roleVer"),cloudRoleInstance:Zc("roleInstance"),cloudEnvironment:Zc("environment"),cloudLocation:Zc("location"),cloudDeploymentUnit:Zc("deploymentUnit"),internalNodeName:Ym("nodeName"),internalSdkVersion:Ym("sdkVersion"),internalAgentVersion:Ym("agentVersion"),internalSnippet:Ym("snippet"),internalSdkSrc:Ym("sdkSrc")}));function mr(e,t,o,n,r,i){var a;o=at(n,o)||qt,(q(e)||q(t)||q(o))&&Rt("Input doesn't contain all required fields");var s="";e[fv]&&(s=e[fv],delete e[fv]);var c=(a={},a[Wt]=o,a.time=On(new Date),a.iKey=s,a.ext=i||{},a.tags=[],a.data={},a.baseType=t,a.baseData=e,a);return q(r)||He(r,function(l,u){c.data[l]=u}),c}var VF=function(){function e(){}return e.create=mr,e}();var en={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},ut=new id;var ls="AppInsightsPropertiesPlugin",Gm="AppInsightsChannelPlugin",YE="ApplicationInsightsAnalytics";var Vm="toString",Iv="disableExceptionTracking",jm="autoTrackPageVisitTime",Pv="overridePageViewDuration",Rv="enableUnhandledPromiseRejectionTracking",Wm="samplingPercentage",Km="isStorageUseDisabled",Qm="isBrowserLinkTrackingEnabled",Nv="enableAutoRouteTracking",Dv="namePrefix",Lv="disableFlushOnBeforeUnload";var To="core",na="dataType",us="envelopeType",xn="diagLog",ds="track",ad="trackPageView",Xm="trackPreviousPageVisit",ra="sendPageViewInternal",Jm="sendPageViewPerformanceInternal",sd="populatePageViewPerformanceEvent",ps="href",GE="sendExceptionInternal",Mv="exception",cd="error",Ov="_onerror",Uv="errorSrc",$v="lineNumber",zv="columnNumber",VE="message",Fv="CreateAutoException",Zm="addTelemetryInitializer",yi="duration",ms="length",Hv="isPerformanceTimingSupported",qv="getPerformanceTiming",ld="navigationStart",ef="shouldCollectDuration",Bv="isPerformanceTimingDataReady",jF="getEntriesByType",ud="responseStart",WF="requestStart",tf="loadEventEnd",Yv="responseEnd",of="connectEnd",jE="pageVisitStartTime";var KF=function(){function e(t,o,n,r){Ie(e,this,function(i){var a=null,s=[],c=!1,l;n&&(l=n.logger);function u(m){n&&n.flush(m)}function p(m){s.push(m),a||(a=setInterval(function(){var f=s.slice(0),h=!1;s=[],se(f,function(_){_()?h=!0:s.push(_)}),s[ms]===0&&(clearInterval(a),a=null),h&&u(!0)},100))}i[ad]=function(m,f){var h=m.name;if(q(h)||typeof h!="string"){var _=Ht();h=m.name=_&&_.title||""}var g=m.uri;if(q(g)||typeof g!="string"){var v=_n();g=m.uri=v&&v[ps]||""}if(!r[Hv]()){t[ra](m,f),u(!0),V(l,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");return}var x=!1,E,O=r[qv]()[ld];O>0&&(E=co(O,+new Date),r[ef](E)||(E=void 0));var k;!q(f)&&!q(f[yi])&&(k=f[yi]),(o||!isNaN(k))&&(isNaN(k)&&(f||(f={}),f[yi]=E),t[ra](m,f),u(!0),x=!0);var P=6e4;f||(f={}),p(function(){var Te=!1;try{if(r[Bv]()){Te=!0;var Se={name:h,uri:g};r[sd](Se),!Se.isValid&&!x?(f[yi]=E,t[ra](m,f)):(x||(f[yi]=Se.durationMs,t[ra](m,f)),c||(t[Jm](Se,f),c=!0))}else O>0&&co(O,+new Date)>P&&(Te=!0,x||(f[yi]=P,t[ra](m,f)))}catch(fe){V(l,1,38,"trackPageView failed on page load calculation: "+Oe(fe),{exception:ue(fe)})}return Te})},i.teardown=function(m,f){if(a){clearInterval(a),a=null;var h=s.slice(0),_=!1;s=[],se(h,function(g){g()&&(_=!0)})}}})}return e.__ieDyn=1,e}();var lV=36e5,QF=["googlebot","adsbot-google","apis-google","mediapartners-google"];function JF(){var e=cr();return e&&!!e.timing}function uV(){var e=cr();return e&&e.getEntriesByType&&e.getEntriesByType("navigation")[ms]>0}function dV(){var e=cr(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t[ld]>0&&t[ud]>0&&t[WF]>0&&t[tf]>0&&t[Yv]>0&&t[of]>0&&t.domLoading>0}function XF(){return JF()?cr().timing:null}function pV(){return uV()?cr()[jF]("navigation")[0]:null}function mV(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=Jo()||{},n=o.userAgent,r=!1;if(n)for(var i=0;i<QF[ms];i++)r=r||n.toLowerCase().indexOf(QF[i])!==-1;if(r)return!1;for(var i=0;i<e[ms];i++)if(e[i]<0||e[i]>=lV)return!1;return!0}var ZF=function(){function e(t){var o=this,n=Fr(t);Ie(e,this,function(r){r[sd]=function(i){i.isValid=!1;var a=pV(),s=XF(),c=0,l=0,u=0,p=0,m=0;(a||s)&&(a?(c=a[yi],l=a.startTime===0?a[of]:co(a.startTime,a[of]),u=co(a.requestStart,a[ud]),p=co(a[ud],a[Yv]),m=co(a.responseEnd,a[tf])):(c=co(s[ld],s[tf]),l=co(s[ld],s[of]),u=co(s.requestStart,s[ud]),p=co(s[ud],s[Yv]),m=co(s.responseEnd,s[tf])),c===0?V(n,2,10,"error calculating page view performance.",{total:c,network:l,request:u,response:p,dom:m}):o[ef](c,l,u,p,m)?c<Math.floor(l)+Math.floor(u)+Math.floor(p)+Math.floor(m)?V(n,2,8,"client performance math error.",{total:c,network:l,request:u,response:p,dom:m}):(i.durationMs=c,i.perfTotal=i[yi]=zn(c),i.networkConnect=zn(l),i.sentRequest=zn(u),i.receivedResponse=zn(p),i.domProcessing=zn(m),i.isValid=!0):V(n,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:c,network:l,request:u,response:p,dom:m}))},r[qv]=XF,r[Hv]=JF,r[Bv]=dV,r[ef]=mV})}return e.__ieDyn=1,e}();var e2=function(){function e(t,o){var n="prevPageVisitData";Ie(e,this,function(r){r[Xm]=function(c,l){try{var u=i(c,l);u&&o(u.pageName,u.pageUrl,u.pageVisitTime)}catch(p){lr(t,"Auto track page visit time failed, metric will not be collected: "+ue(p))}};function i(c,l){var u=null;try{u=s(),a(c,l)}catch(p){lr(t,"Call to restart failed: "+ue(p)),u=null}return u}function a(c,l){try{if(as()){Ju(t,n)!=null&&Rt("Cannot call startPageVisit consecutively without first calling stopPageVisit");var u=new fV(c,l),p=so().stringify(u);Zu(t,n,p)}}catch(m){lr(t,"Call to start failed: "+ue(m))}}function s(){var c=null;try{if(as()){var l=xo(),u=Ju(t,n);u&&zr()&&(c=so().parse(u),c.pageVisitTime=l-c[jE],DE(t,n))}}catch(p){lr(t,"Stop page visit timer failed: "+ue(p)),c=null}return c}ar(r,"_logger",function(){return t}),ar(r,"pageVisitTimeTrackingHandler",function(){return o})})}return e.__ieDyn=1,e}();var fV=function(){function e(t,o){this[jE]=xo(),this.pageName=t,this.pageUrl=o}return e}();var WE=function(){function e(t,o){var n=this,r={};n.start=function(i){typeof r[i]<"u"&&V(t,2,62,"start was called more than once for this event without calling stop.",{name:i,key:i},!0),r[i]=+new Date},n.stop=function(i,a,s,c){var l=r[i];if(isNaN(l))V(t,2,63,"stop was called without a corresponding start.",{name:i,key:i},!0);else{var u=+new Date,p=co(l,u);n.action(i,a,p,s,c)}delete r[i],r[i]=void 0}}return e}();var gV="event";function nf(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}function hV(e){if(e&&e.reason){var t=e.reason;return!ge(t)&&be(t[Vm])?t[Vm]():ue(t)}return e||""}var t2=6e4;function o2(e,t){return e=e||t,e<t2&&(e=t2),e}function n2(e){return e||(e={}),e.sessionRenewalMs=o2(e.sessionRenewalMs,30*60*1e3),e.sessionExpirationMs=o2(e.sessionExpirationMs,24*60*60*1e3),e[Iv]=dr(e[Iv]),e[jm]=dr(e[jm]),e[Pv]=dr(e[Pv]),e[Rv]=dr(e[Rv]),(isNaN(e[Wm])||e[Wm]<=0||e[Wm]>=100)&&(e[Wm]=100),e[Km]=dr(e[Km]),e[Qm]=dr(e[Qm]),e[Nv]=dr(e[Nv]),e[Dv]=e[Dv]||"",e.enableDebug=dr(e.enableDebug),e[Lv]=dr(e[Lv]),e.disableFlushOnUnload=dr(e.disableFlushOnUnload,e[Lv]),e}function _V(e){wt(e[Km])||(e[Km]?AE():IE())}var Gv=function(e){vo(t,e);function t(){var o=e.call(this)||this;o.identifier=YE,o.priority=180,o.autoRoutePVDelay=500;var n,r,i,a,s,c,l,u,p,m,f,h,_,g,v=0,x,E,O;return Ie(t,o,function(k,P){var Te=P._addHook;Me(),k.getCookieMgr=function(){return Hc(k[To])},k.processTelemetry=function(b,R){k.processNext(b,R)},k.trackEvent=function(b,R){try{var U=mr(b,Fn[na],Fn[us],k[xn](),R);k[To][ds](U)}catch($){ae(2,39,"trackTrace failed, trace will not be collected: "+Oe($),{exception:ue($)})}},k.startTrackEvent=function(b){try{n.start(b)}catch(R){ae(1,29,"startTrackEvent failed, event will not be collected: "+Oe(R),{exception:ue(R)})}},k.stopTrackEvent=function(b,R,U){try{n.stop(b,void 0,R,U)}catch($){ae(1,30,"stopTrackEvent failed, event will not be collected: "+Oe($),{exception:ue($)})}},k.trackTrace=function(b,R){try{var U=mr(b,Yr[na],Yr[us],k[xn](),R);k[To][ds](U)}catch($){ae(2,39,"trackTrace failed, trace will not be collected: "+Oe($),{exception:ue($)})}},k.trackMetric=function(b,R){try{var U=mr(b,Hn[na],Hn[us],k[xn](),R);k[To][ds](U)}catch($){ae(1,36,"trackMetric failed, metric will not be collected: "+Oe($),{exception:ue($)})}},k[ad]=function(b,R){try{var U=b||{};i[ad](U,zt(zt(zt({},U.properties),U.measurements),R)),k.config[jm]&&s[Xm](U.name,U.uri)}catch($){ae(1,37,"trackPageView failed, page view will not be collected: "+Oe($),{exception:ue($)})}},k[ra]=function(b,R,U){var $=Ht();$&&(b.refUri=b.refUri===void 0?$.referrer:b.refUri);var ee=mr(b,Zo[na],Zo[us],k[xn](),R,U);k[To][ds](ee),v=0},k[Jm]=function(b,R,U){var $=mr(b,Gr[na],Gr[us],k[xn](),R,U);k[To][ds]($)},k.trackPageViewPerformance=function(b,R){var U=b||{};try{a[sd](U),k[Jm](U,R)}catch($){ae(1,37,"trackPageViewPerformance failed, page view will not be collected: "+Oe($),{exception:ue($)})}},k.startTrackPage=function(b){try{if(typeof b!="string"){var R=Ht();b=R&&R.title||""}r.start(b)}catch(U){ae(1,31,"startTrackPage failed, page view may not be collected: "+Oe(U),{exception:ue(U)})}},k.stopTrackPage=function(b,R,U,$){try{if(typeof b!="string"){var ee=Ht();b=ee&&ee.title||""}if(typeof R!="string"){var S=_n();R=S&&S[ps]||""}r.stop(b,R,U,$),k.config[jm]&&s[Xm](b,R)}catch(N){ae(1,32,"stopTrackPage failed, page view will not be collected: "+Oe(N),{exception:ue(N)})}},k[GE]=function(b,R,U){var $=b[Mv]||b[cd]||new Error(qt),ee=new Mo(k[xn](),$,b.properties||R,b.measurements,b.severityLevel,b.id).toInterface(),S=mr(ee,Mo[na],Mo[us],k[xn](),R,U);k[To][ds](S)},k.trackException=function(b,R){b&&!b[Mv]&&b[cd]&&(b[Mv]=b[cd]);try{k[GE](b,R)}catch(U){ae(1,35,"trackException failed, exception will not be collected: "+Oe(U),{exception:ue(U)})}},k[Ov]=function(b){var R=b&&b[cd],U=b&&b.evt;try{if(!U){var $=Un();$&&(U=$[gV])}var ee=b&&b.url||(Ht()||{}).URL,S=b[Uv]||"window.onerror@"+ee+":"+(b[$v]||0)+":"+(b[zv]||0),N={errorSrc:S,url:ee,lineNumber:b[$v]||0,columnNumber:b[zv]||0,message:b[VE]};wE(b.message,b.url,b.lineNumber,b.columnNumber,b[cd])?mo(Mo[Fv]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",ee,b[$v]||0,b[zv]||0,R,U,null,S),N):(b[Uv]||(b[Uv]=S),k.trackException({exception:b,severityLevel:3},N))}catch(K){var H=R?R.name+", "+R[VE]:"null";ae(1,11,"_onError threw exception while logging error, error will not be collected: "+Oe(K),{exception:ue(K),errorString:H})}},k[Zm]=function(b){if(k[To])return k[To][Zm](b);c||(c=[]),c.push(b)},k.initialize=function(b,R,U,$){if(!k.isInitialized()){q(R)&&Rt("Error initializing"),P.initialize(b,R,U,$);try{O=$n(Lo(k.identifier),R.evtNamespace&&R.evtNamespace()),c&&(se(c,function(S){R[Zm](S)}),c=null);var ee=Se(b);_V(ee),a=new ZF(k[To]),i=new KF(o,ee[Pv],k[To],a),s=new e2(k[xn](),function(S,N,H){return on(S,N,H)}),fe(ee,b),n=new WE(k[xn](),"trackEvent"),n.action=function(S,N,H,K,ve){K||(K={}),ve||(ve={}),K.duration=H[Vm](),k.trackEvent({name:S,properties:K,measurements:ve})},r=new WE(k[xn](),"trackPageView"),r.action=function(S,N,H,K,ve){q(K)&&(K={}),K.duration=H[Vm]();var qe={name:S,uri:N,properties:K,measurements:ve};k[ra](qe,K)},Ki()&&(Vo(ee),nn(ee))}catch(S){throw k.setInitialized(!1),S}}},k._doTeardown=function(b,R){i&&i.teardown(b,R),ts(window,null,null,O),Me()};function Se(b){var R=yo(null,b,k[To]),U=k.identifier,$=n2(b),ee=k.config=R.getExtCfg(U);return $!==void 0&&He($,function(S,N){ee[S]=R.getConfig(U,S,N),ee[S]===void 0&&(ee=N)}),ee}function fe(b,R){l=b[Qm]||R[Qm],po()}function on(b,R,U){var $={PageName:b,PageUrl:R};k.trackMetric({name:"PageVisitTime",average:U,max:U,min:U,sampleCount:1},$)}function po(){if(!u&&l){var b=["/browserLinkSignalR/","/__browserLink/"],R=function(U){if(l&&U.baseType===qn[na]){var $=U.baseData;if($){for(var ee=0;ee<b[ms];ee++)if($.target&&$.target.indexOf(b[ee])>=0)return!1}}return!0};k[Zm](R),u=!0}}function mo(b,R){var U=mr(b,Mo[na],Mo[us],k[xn](),R);k[To][ds](U)}function Vo(b){var R=Un(),U=_n(!0);f=b[Iv],!f&&!h&&!b.autoExceptionInstrumented&&(Te(Gu(R,"onerror",{ns:O,rsp:function($,ee,S,N,H,K){!f&&$.rslt!==!0&&k[Ov](Mo[Fv](ee,S,N,H,K,$.evt))}},!1)),h=!0),Oo(b,R,U)}function nn(b){var R=Un(),U=_n(!0);if(p=b[Nv]===!0,R&&p&&X_()){var $=BS();be($.pushState)&&be($.replaceState)&&typeof Event!==fn&&En(b,R,$,U)}}function Co(){var b=null;if(k[To]&&k[To].getTraceCtx&&(b=k[To].getTraceCtx(!1)),!b){var R=k[To].getPlugin(ls);if(R){var U=R.plugin.context;U&&(b=Jc(U.telemetryTrace))}}return b}function En(b,R,U,$){var ee=b[Dv]||"";function S(){p&&nf(R,Yc(ee+"locationchange"))}function N(){if(E?(x=E,E=$&&$[ps]||""):E=$&&$[ps]||"",p){var H=Co();if(H){H.setTraceId(vn());var K="_unknown_";$&&$.pathname&&(K=$.pathname+($.hash||"")),H.setName(at(k[xn](),K))}setTimeout(function(ve){k[ad]({refUri:ve,properties:{duration:0}})}.bind(this,x),k.autoRoutePVDelay)}}m||(Te(Gu(U,"pushState",{ns:O,rsp:function(){p&&(nf(R,Yc(ee+"pushState")),nf(R,Yc(ee+"locationchange")))}},!0)),Te(Gu(U,"replaceState",{ns:O,rsp:function(){p&&(nf(R,Yc(ee+"replaceState")),nf(R,Yc(ee+"locationchange")))}},!0)),ur(R,ee+"popstate",S,O),ur(R,ee+"locationchange",N,O),m=!0)}function Oo(b,R,U){_=b[Rv]===!0,_&&!g&&(Te(Gu(R,"onunhandledrejection",{ns:O,rsp:function($,ee){_&&$.rslt!==!0&&k[Ov](Mo[Fv](hV(ee),U?U[ps]:"",0,0,ee,$.evt))}},!1)),g=!0,b.autoUnhandledPromiseInstrumented=g)}function ae(b,R,U,$,ee){k[xn]().throwInternal(b,R,U,$,ee)}function Me(){n=null,r=null,i=null,a=null,s=null,c=null,l=!1,u=!1,p=!1,m=!1,f=!1,h=!1,_=!1,g=!1,v=0;var b=_n(!0);x=b&&b[ps]||"",E=null,O=null}ar(k,"_pageViewManager",function(){return i}),ar(k,"_pageViewPerformanceManager",function(){return a}),ar(k,"_pageVisitTimeManager",function(){return s}),ar(k,"_evtNamespace",function(){return"."+O})}),o}return t.Version="2.8.5",t.getDefaultConfig=n2,t}(Hr);var fs="duration";var Kt="tags",Vv="deviceType",yn="data",Ti="name",el="traceID",$e="length",gs="stringify",hs="measurements",fr="dataType",_s="envelopeType",ia="toString",rf="onLine",tl="enqueue",vs="count",aa="push",af="emitLineDelimitedJson",bs="clear",ol="batchPayloads",xs="markAsSent",nl="clearSent",dd="BUFFER_KEY",ys="SENT_BUFFER_KEY",pd="MAX_BUFFER_SIZE",sa="namePrefix",jv="maxBatchSizeInBytes",rl="triggerSend",Go="diagLog",KE="onunloadDisableBeacon",Wv="isBeaconApiDisabled",md="_sender",xt="_senderConfig",il="_buffer",QE="enableSessionStorageBuffer",XE="samplingPercentage",sf="instrumentationKey",Ts="endpointUrl",JE="customHeaders",fd="disableXhr",ZE="onunloadDisableFetch",Kv="disableTelemetry",Qv="baseType",gd="sampleRate",ew="convertUndefined",r2="_xhrReadyStateChange",gr="_onError",Xv="_onPartialSuccess",cf="_onSuccess",lf="itemsAccepted",i2="itemsReceived",hd="isRetryDisabled",Jv="setRequestHeader",tw="maxBatchInterval",ow="eventsSendRequest",nw="disableInstrumentationKeyValidation",Zv="getSamplingScore",a2="getHashCodeScore";var rw="baseType",Ct="baseData",So="properties",s2="true";function Qt(e,t,o){return Ze(e,t,o,Uu)}function vV(e,t,o){var n=o[Kt]=o[Kt]||{},r=t.ext=t.ext||{},i=t[Kt]=t[Kt]||[],a=r.user;a&&(Qt(n,ut.userAuthUserId,a.authId),Qt(n,ut.userId,a.id||a.localId));var s=r.app;s&&Qt(n,ut.sessionId,s.sesId);var c=r.device;c&&(Qt(n,ut.deviceId,c.id||c.localId),Qt(n,ut[Vv],c.deviceClass),Qt(n,ut.deviceIp,c.ip),Qt(n,ut.deviceModel,c.model),Qt(n,ut[Vv],c[Vv]));var l=t.ext.web;if(l){Qt(n,ut.deviceLanguage,l.browserLang),Qt(n,ut.deviceBrowserVersion,l.browserVer),Qt(n,ut.deviceBrowser,l.browser);var u=o[yn]=o[yn]||{},p=u[Ct]=u[Ct]||{},m=p[So]=p[So]||{};Qt(m,"domain",l.domain),Qt(m,"isManual",l.isManual?s2:null),Qt(m,"screenRes",l.screenRes),Qt(m,"userConsent",l.userConsent?s2:null)}var f=r.os;f&&Qt(n,ut.deviceOS,f[Ti]);var h=r.trace;h&&(Qt(n,ut.operationParentId,h.parentID),Qt(n,ut.operationName,at(e,h[Ti])),Qt(n,ut.operationId,h[el]));for(var _={},g=i[$e]-1;g>=0;g--){var v=i[g];He(v,function(E,O){_[E]=O}),i.splice(g,1)}He(i,function(E,O){_[E]=O});var x=zt(zt({},n),_);x[ut.internalSdkVersion]||(x[ut.internalSdkVersion]="javascript:".concat(bV.Version)),o[Kt]=W_(x)}function Ss(e,t,o){q(e)||He(e,function(n,r){xm(r)?o[n]=r:ge(r)?t[n]=r:zr()&&(t[n]=so()[gs](r))})}function al(e,t){q(e)||He(e,function(o,n){e[o]=n||t})}function sl(e,t,o,n){var r=new Cv(e,n,t);Qt(r,"sampleRate",o[Vu]),(o[Ct]||{}).startTime&&(r.time=On(o[Ct].startTime)),r.iKey=o.iKey;var i=o.iKey.replace(/-/g,"");return r[Ti]=r[Ti].replace("{0}",i),vV(e,o,r),o[Kt]=o[Kt]||[],W_(r)}function cl(e,t){q(t[Ct])&&V(e,1,46,"telemetryItem.baseData cannot be null.")}var bV={Version:"2.8.5"};function c2(e,t,o){cl(e,t);var n=t[Ct][hs]||{},r=t[Ct][So]||{};Ss(t[yn],r,n),q(o)||al(r,o);var i=t[Ct];if(q(i))return lr(e,"Invalid input for dependency data"),null;var a=i[So]&&i[So][Dm]?i[So][Dm]:"GET",s=new qn(e,i.id,i.target,i[Ti],i[fs],i.success,i.responseCode,a,i.type,i.correlationContext,r,n),c=new xi(qn[fr],s);return sl(e,qn[_s],t,c)}function iw(e,t,o){cl(e,t);var n={},r={};t[rw]!==Fn[fr]&&(n.baseTypeSource=t[rw]),t[rw]===Fn[fr]?(n=t[Ct][So]||{},r=t[Ct][hs]||{}):t[Ct]&&Ss(t[Ct],n,r),Ss(t[yn],n,r),q(o)||al(n,o);var i=t[Ct][Ti],a=new Fn(e,i,n,r),s=new xi(Fn[fr],a);return sl(e,Fn[_s],t,s)}function l2(e,t,o){cl(e,t);var n=t[Ct][hs]||{},r=t[Ct][So]||{};Ss(t[yn],r,n),q(o)||al(r,o);var i=t[Ct],a=Mo.CreateFromInterface(e,i,r,n),s=new xi(Mo[fr],a);return sl(e,Mo[_s],t,s)}function u2(e,t,o){cl(e,t);var n=t[Ct],r=n[So]||{},i=n[hs]||{};Ss(t[yn],r,i),q(o)||al(r,o);var a=new Hn(e,n[Ti],n.average,n.sampleCount,n.min,n.max,n.stdDev,r,i),s=new xi(Hn[fr],a);return sl(e,Hn[_s],t,s)}function d2(e,t,o){cl(e,t);var n,r=t[Ct];!q(r)&&!q(r[So])&&!q(r[So][fs])?(n=r[So][fs],delete r[So][fs]):!q(t[yn])&&!q(t[yn][fs])&&(n=t[yn][fs],delete t[yn][fs]);var i=t[Ct],a;((t.ext||{}).trace||{})[el]&&(a=t.ext.trace[el]);var s=i.id||a,c=i[Ti],l=i.uri,u=i[So]||{},p=i[hs]||{};if(q(i.refUri)||(u.refUri=i.refUri),q(i.pageType)||(u.pageType=i.pageType),q(i.isLoggedIn)||(u.isLoggedIn=i.isLoggedIn[ia]()),!q(i[So])){var m=i[So];He(m,function(_,g){u[_]=g})}Ss(t[yn],u,p),q(o)||al(u,o);var f=new Zo(e,c,l,n,u,p,s),h=new xi(Zo[fr],f);return sl(e,Zo[_s],t,h)}function p2(e,t,o){cl(e,t);var n=t[Ct],r=n[Ti],i=n.uri||n.url,a=n[So]||{},s=n[hs]||{};Ss(t[yn],a,s),q(o)||al(a,o);var c=new Gr(e,r,i,void 0,a,s,n),l=new xi(Gr[fr],c);return sl(e,Gr[_s],t,l)}function m2(e,t,o){cl(e,t);var n=t[Ct].message,r=t[Ct].severityLevel,i=t[Ct][So]||{},a=t[Ct][hs]||{};Ss(t[yn],i,a),q(o)||al(i,o);var s=new Yr(e,n,r,i,a),c=new xi(Yr[fr],s);return sl(e,Yr[_s],t,c)}function f2(e,t){ts(e,null,null,t)}function g2(e){var t=Ht(),o=Jo(),n=!1,r=!0,i=$n(Lo("OfflineListener"),e);try{if(s(Un())&&(n=!0),t){var a=t.body||t;a.ononline&&s(a)&&(n=!0)}n&&o&&!q(o[rf])&&(r=o[rf])}catch{n=!1}function s(m){var f=!1;return m&&(f=ur(m,"online",c,i),f&&ur(m,"offline",l,i)),f}function c(){r=!0}function l(){r=!1}function u(){var m=!0;return n?m=r:o&&!q(o[rf])&&(m=o[rf]),m}function p(){var m=Un();if(m&&n){if(f2(m,i),t){var f=t.body||t;wt(f.ononline)||f2(f,i)}n=!1}}return{isOnline:u,isListening:function(){return n},unload:p}}var h2=function(){function e(t,o){var n=[],r=!1;this._get=function(){return n},this._set=function(i){return n=i,n},Ie(e,this,function(i){i[tl]=function(a){if(i[vs]()>=o.eventsLimitInMem()){r||(V(t,2,105,"Maximum in-memory buffer size reached: "+i[vs](),!0),r=!0);return}n[aa](a)},i[vs]=function(){return n[$e]},i.size=function(){for(var a=n[$e],s=0;s<n[$e];s++)a+=n[s][$e];return o[af]()||(a+=2),a},i[bs]=function(){n=[],r=!1},i.getItems=function(){return n.slice(0)},i[ol]=function(a){if(a&&a[$e]>0){var s=o[af]()?a.join(`
`):"["+a.join(",")+"]";return s}return null}})}return e.__ieDyn=1,e}(),_2=function(e){vo(t,e);function t(o,n){var r=e.call(this,o,n)||this;return Ie(t,r,function(i,a){i[xs]=function(s){a[bs]()},i[nl]=function(s){}}),r}return t.__ieDyn=1,t}(h2);var v2=function(e){vo(t,e);function t(o,n){var r=e.call(this,o,n)||this,i=!1;return Ie(t,r,function(a,s){var c=m(t[dd]),l=m(t[ys]),u=a._set(c.concat(l));u[$e]>t[pd]&&(u[$e]=t[pd]),f(t[ys],[]),f(t[dd],u),a[tl]=function(h){if(a[vs]()>=t[pd]){i||(V(o,2,67,"Maximum buffer size reached: "+a[vs](),!0),i=!0);return}s[tl](h),f(t[dd],a._get())},a[bs]=function(){s[bs](),f(t[dd],a._get()),f(t[ys],[]),i=!1},a[xs]=function(h){f(t[dd],a._set(p(h,a._get())));var _=m(t[ys]);_ instanceof Array&&h instanceof Array&&(_=_.concat(h),_[$e]>t[pd]&&(V(o,1,67,"Sent buffer reached its maximum size: "+_[$e],!0),_[$e]=t[pd]),f(t[ys],_))},a[nl]=function(h){var _=m(t[ys]);_=p(h,_),f(t[ys],_)};function p(h,_){var g=[];return se(_,function(v){!be(v)&&bo(h,v)===-1&&g[aa](v)}),g}function m(h){var _=h;try{_=n[sa]&&n[sa]()?n[sa]()+"_"+_:_;var g=Ju(o,_);if(g){var v=so().parse(g);if(ge(v)&&(v=so().parse(v)),v&&Xe(v))return v}}catch(x){V(o,1,42," storage key: "+_+", "+Oe(x),{exception:ue(x)})}return[]}function f(h,_){var g=h;try{g=n[sa]&&n[sa]()?n[sa]()+"_"+g:g;var v=JSON[gs](_);Zu(o,g,v)}catch(x){Zu(o,g,JSON[gs]([])),V(o,2,41," storage key: "+g+", "+Oe(x)+". Buffer cleared",{exception:ue(x)})}}}),r}return t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}(h2);var b2=function(){function e(t){Ie(e,this,function(o){o.serialize=function(a){var s=n(a,"root");try{return so()[gs](s)}catch(c){V(t,1,48,c&&be(c[ia])?c[ia]():"Error serializing object",null,!0)}};function n(a,s){var c="__aiCircularRefCheck",l={};if(!a)return V(t,1,48,"cannot serialize object because it is null or undefined",{name:s},!0),l;if(a[c])return V(t,2,50,"Circular reference detected while serializing object",{name:s},!0),l;if(!a.aiDataContract){if(s==="measurements")l=i(a,"number",s);else if(s==="properties")l=i(a,"string",s);else if(s==="tags")l=i(a,"string",s);else if(Xe(a))l=r(a,s);else{V(t,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:s},!0);try{so()[gs](a),l=a}catch(u){V(t,1,48,u&&be(u[ia])?u[ia]():"Error serializing object",null,!0)}}return l}return a[c]=!0,He(a.aiDataContract,function(u,p){var m=be(p)?p()&1:p&1,f=be(p)?p()&4:p&4,h=p&2,_=a[u]!==void 0,g=Fo(a[u])&&a[u]!==null;if(m&&!_&&!h)V(t,1,24,"Missing required field specification. The field is required but not present on source",{field:u,name:s});else if(!f){var v=void 0;g?h?v=r(a[u],u):v=n(a[u],u):v=a[u],v!==void 0&&(l[u]=v)}}),delete a[c],l}function r(a,s){var c;if(a)if(!Xe(a))V(t,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:s},!0);else{c=[];for(var l=0;l<a[$e];l++){var u=a[l],p=n(u,s+"["+l+"]");c[aa](p)}}return c}function i(a,s,c){var l;return a&&(l={},He(a,function(u,p){if(s==="string")p===void 0?l[u]="undefined":p===null?l[u]="null":p[ia]?l[u]=p[ia]():l[u]="invalid field: toString() is not defined.";else if(s==="number")if(p===void 0)l[u]="undefined";else if(p===null)l[u]="null";else{var m=parseFloat(p);isNaN(m)?l[u]="NaN":l[u]=m}else l[u]="invalid field: "+c+" is of unknown type.",V(t,1,l[u],null,!0)})),l}})}return e.__ieDyn=1,e}();var xV=8,x2=function(){function e(){}return e.prototype.getHashCodeScore=function(t){var o=this.getHashCode(t)/e.INT_MAX_VALUE;return o*100},e.prototype.getHashCode=function(t){if(t==="")return 0;for(;t[$e]<xV;)t=t.concat(t);for(var o=5381,n=0;n<t[$e];++n)o=(o<<5)+o+t.charCodeAt(n),o=o&o;return Math.abs(o)},e.INT_MAX_VALUE=2147483647,e}();var y2=function(){function e(){var t=this,o=new x2,n=new id;t[Zv]=function(r){var i=0;return r[Kt]&&r[Kt][n.userId]?i=o.getHashCodeScore(r[Kt][n.userId]):r.ext&&r.ext.user&&r.ext.user.id?i=o[a2](r.ext.user.id):r[Kt]&&r[Kt][n.operationId]?i=o.getHashCodeScore(r[Kt][n.operationId]):r.ext&&r.ext.telemetryTrace&&r.ext.telemetryTrace[el]?i=o.getHashCodeScore(r.ext.telemetryTrace[el]):i=Math.random()*100,i}}return e}();var T2=function(){function e(t,o){this.INT_MAX_VALUE=2147483647;var n=o||Fr(null);(t>100||t<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:t},!0),t=100),this[gd]=t,this.samplingScoreGenerator=new y2}return e.prototype.isSampledIn=function(t){var o=this[gd],n=!1;return o==null||o>=100||t.baseType===Hn[fr]?!0:(n=this.samplingScoreGenerator[Zv](t)<o,n)},e}();var ca,yV=65e3;function eb(e){try{return e.responseText}catch{}return null}function S2(){var e,t,o;return e={endpointUrl:function(){return ns+Zi}},e[af]=function(){return!1},e[tw]=function(){return 15e3},e[jv]=function(){return 102400},e[Kv]=function(){return!1},e[QE]=function(){return!0},e[hd]=function(){return!1},e[Wv]=function(){return!0},e[fd]=function(){return!1},e[ZE]=function(){return!1},e[KE]=function(){return!1},e[sf]=function(){return t},e[sa]=function(){return t},e[XE]=function(){return 100},e[JE]=function(){return o},e[ew]=function(){return t},e.eventsLimitInMem=function(){return 1e4},e}var TV=(ca={},ca[Fn.dataType]=iw,ca[Yr.dataType]=m2,ca[Zo.dataType]=d2,ca[Gr.dataType]=p2,ca[Mo.dataType]=l2,ca[Hn.dataType]=u2,ca[qn.dataType]=c2,ca),aw=function(e){vo(t,e);function t(){var o=e.call(this)||this;o.priority=1001,o.identifier=Gm,o._senderConfig=S2();var n,r,i,a,s,c,l,u,p=0,m,f,h,_;return Ie(t,o,function(g,v){ee(),g.pause=function(){En(),a=!0},g.resume=function(){a&&(a=!1,r=null,g._buffer.size()>g._senderConfig[jv]()&&g[rl](!0,null,10),Co())},g.flush=function(S,N,H){if(S===void 0&&(S=!0),!a){En();try{g[rl](S,null,H||1)}catch(K){V(g[Go](),1,22,"flush failed, telemetry will not be collected: "+Oe(K),{exception:ue(K)})}}},g.onunloadFlush=function(){if(!a)if((g._senderConfig[KE]()===!1||g[xt][Wv]()===!1)&&Ja())try{g[rl](!0,k,2)}catch(S){V(g[Go](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Oe(S),{exception:ue(S)})}else g.flush()},g.addHeader=function(S,N){u[S]=N},g.initialize=function(S,N,H,K){g.isInitialized()&&V(g[Go](),1,28,"Sender is already initialized"),v.initialize(S,N,H,K);var ve=g._getTelCtx(),qe=g.identifier;c=new b2(N.logger),n=0,r=null,i=0,g[md]=null,l=0;var Ve=g[Go]();_=$n(Lo("Sender"),N.evtNamespace&&N.evtNamespace()),h=g2(_);var Jt=S2();He(Jt,function(G,Q){g[xt][G]=function(){return ve.getConfig(qe,G,Q())}}),g._buffer=g[xt][QE]()&&as()?new v2(Ve,g[xt]):new _2(Ve,g[xt]),g._sample=new T2(g[xt][XE](),Ve),$(S)||V(Ve,1,100,"Invalid Instrumentation key "+S[sf]),!Xc(g._senderConfig.endpointUrl())&&g._senderConfig.customHeaders()&&g._senderConfig.customHeaders()[$e]>0&&se(g[xt][JE](),function(G){o.addHeader(G.header,G.value)});var A=g[xt],M=null;!A[fd]()&&Z_()?M=Me:!A[fd]()&&Oc()&&(M=Se),!M&&J_()&&(M=on),m=M||Se,!A[Wv]()&&Ja()&&(M=Te),g[md]=M||Se,!A[ZE]()&&J_(!0)?f=fe:Ja()?f=Te:!A[fd]()&&Z_()?f=Me:!A[fd]()&&Oc()?f=Se:f=m},g.processTelemetry=function(S,N){N=g._getTelCtx(N);var H=N[Go]();try{if(g[xt][Kv]())return;if(!S){V(H,1,7,"Cannot send empty telemetry");return}if(S.baseData&&!S[Qv]){V(H,1,70,"Cannot send telemetry without baseData and baseType");return}if(S[Qv]||(S[Qv]="EventData"),!g[md]){V(H,1,28,"Sender was not initialized");return}if(x(S))S[Vu]=g._sample[gd];else{V(H,2,33,"Telemetry item was sampled out and not sent",{SampleRate:g._sample[gd]});return}var K=g[xt][ew]()||void 0,ve=S.iKey||g[xt][sf](),qe=t.constructEnvelope(S,ve,H,K);if(!qe){V(H,1,47,"Unable to create an AppInsights envelope");return}var Ve=!1;if(S[Kt]&&S[Kt][ju]&&(se(S[Kt][ju],function(G){try{G&&G(qe)===!1&&(Ve=!0,lr(H,"Telemetry processor check returns false"))}catch(Q){V(H,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Oe(Q),{exception:ue(Q)},!0)}}),delete S[Kt][ju]),Ve)return;var Jt=c.serialize(qe),A=g[il],M=A.size();M+Jt[$e]>g[xt][jv]()&&g[rl](!0,null,10),A[tl](Jt),Co()}catch(G){V(H,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Oe(G),{exception:ue(G)})}g.processNext(S,N)},g[r2]=function(S,N,H){S.readyState===4&&E(S.status,N,S.responseURL,H,ae(S),eb(S)||S.response)},g[rl]=function(S,N,H){if(S===void 0&&(S=!0),!a)try{var K=g[il];if(g[xt][Kv]())K[bs]();else{if(K[vs]()>0){var ve=K.getItems();U(H||0,S),N?N.call(o,ve,S):g[md](ve,S)}i=+new Date}En()}catch(Ve){var qe=qu();(!qe||qe>9)&&V(g[Go](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+Oe(Ve),{exception:ue(Ve)})}},g._doTeardown=function(S,N){g.onunloadFlush(),h.unload(),ee()},g[gr]=function(S,N,H){V(g[Go](),2,26,"Failed to send telemetry.",{message:N}),g._buffer[nl](S)},g[Xv]=function(S,N){for(var H=[],K=[],ve=N.errors.reverse(),qe=0,Ve=ve;qe<Ve.length;qe++){var Jt=Ve[qe],A=S.splice(Jt.index,1)[0];Oo(Jt.statusCode)?K[aa](A):H[aa](A)}S[$e]>0&&g[cf](S,N[lf]),H[$e]>0&&g[gr](H,ae(null,["partial success",N[lf],"of",N.itemsReceived].join(" "))),K[$e]>0&&(Vo(K),V(g[Go](),2,40,"Partial success. Delivered: "+S[$e]+", Failed: "+H[$e]+". Will retry to send "+K[$e]+" our of "+N[i2]+" items"))},g[cf]=function(S,N){g._buffer[nl](S)},g._xdrOnLoad=function(S,N){var H=eb(S);if(S&&(H+""=="200"||H===""))n=0,g[cf](N,0);else{var K=mo(H);K&&K.itemsReceived&&K.itemsReceived>K[lf]&&!g[xt][hd]()?g[Xv](N,K):g[gr](N,b(S))}};function x(S){return g._sample.isSampledIn(S)}function E(S,N,H,K,ve,qe){var Ve=null;if(g._appId||(Ve=mo(qe),Ve&&Ve.appId&&(g._appId=Ve.appId)),(S<200||S>=300)&&S!==0){if((S===301||S===307||S===308)&&!O(H)){g[gr](N,ve);return}!g[xt][hd]()&&Oo(S)?(Vo(N),V(g[Go](),2,40,". Response code "+S+". Will retry to send "+N[$e]+" items.")):g[gr](N,ve)}else if(h&&!h.isOnline()){if(!g[xt][hd]()){var Jt=10;Vo(N,Jt),V(g[Go](),2,40,". Offline - Response Code: ".concat(S,". Offline status: ").concat(!h.isOnline(),". Will retry to send ").concat(N.length," items."))}}else O(H),S===206?(Ve||(Ve=mo(qe)),Ve&&!g[xt][hd]()?g[Xv](N,Ve):g[gr](N,ve)):(n=0,g[cf](N,K))}function O(S){return l>=10?!1:!q(S)&&S!==""&&S!==g[xt][Ts]()?(g[xt][Ts]=function(){return S},++l,!0):!1}function k(S,N){f?f(S,!1):Te(S,N)}function P(S){var N=Jo(),H=g[il],K=g[xt][Ts](),ve=g._buffer[ol](S),qe=new Blob([ve],{type:"text/plain;charset=UTF-8"}),Ve=N.sendBeacon(K,qe);return Ve&&(H[xs](S),g._onSuccess(S,S[$e])),Ve}function Te(S,N){if(Xe(S)&&S[$e]>0&&!P(S)){for(var H=[],K=0;K<S[$e];K++){var ve=S[K];P([ve])||H[aa](ve)}H[$e]>0&&(m&&m(H,!0),V(g[Go](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function Se(S,N){var H=new XMLHttpRequest,K=g[xt][Ts]();try{H[qr]=!0}catch{}H.open("POST",K,N),H[Jv]("Content-type","application/json"),Xc(K)&&H[Jv](lt[6],lt[7]),se(Xo(u),function(qe){H[Jv](qe,u[qe])}),H.onreadystatechange=function(){return g._xhrReadyStateChange(H,S,S[$e])},H.onerror=function(qe){return g[gr](S,ae(H),qe)};var ve=g._buffer[ol](S);H.send(ve),g._buffer[xs](S)}function fe(S,N){if(Xe(S)){for(var H=S[$e],K=0;K<S[$e];K++)H+=S[K][$e];p+H<=yV?po(S,!1):Ja()?Te(S,N):(m&&m(S,!0),V(g[Go](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function on(S,N){po(S,!0)}function po(S,N){var H,K=g[xt][Ts](),ve=g._buffer[ol](S),qe=new Blob([ve],{type:"application/json"}),Ve=new Headers,Jt=ve[$e],A=!1,M=!1;Xc(K)&&Ve.append(lt[6],lt[7]),se(Xo(u),function(X){Ve.append(X,u[X])});var G=(H={method:"POST",headers:Ve,body:qe},H[qr]=!0,H);N||(G.keepalive=!0,A=!0,p+=Jt);var Q=new Request(K,G);try{Q[qr]=!0}catch{}g._buffer[xs](S);try{fetch(Q).then(function(X){N||(p-=Jt,Jt=0),M||(M=!0,X.ok?X.text().then(function(le){E(X.status,S,X.url,S[$e],X.statusText,le)}):g[gr](S,X.statusText))}).catch(function(X){N||(p-=Jt,Jt=0),M||(M=!0,g[gr](S,X.message))})}catch(X){M||g[gr](S,ue(X))}A&&!M&&(M=!0,g._onSuccess(S,S[$e]))}function mo(S){try{if(S&&S!==""){var N=so().parse(S);if(N&&N.itemsReceived&&N.itemsReceived>=N[lf]&&N.itemsReceived-N.itemsAccepted===N.errors[$e])return N}}catch(H){V(g[Go](),1,43,"Cannot parse the response. "+Oe(H),{response:S})}return null}function Vo(S,N){if(N===void 0&&(N=1),!(!S||S[$e]===0)){var H=g[il];H[nl](S),n++;for(var K=0,ve=S;K<ve.length;K++){var qe=ve[K];H[tl](qe)}nn(N),Co()}}function nn(S){var N=10,H;if(n<=1)H=N;else{var K=(Math.pow(2,n)-1)/2,ve=Math.floor(Math.random()*K*N)+1;ve=S*ve,H=Math.max(Math.min(ve,3600),N)}var qe=xo()+H*1e3;r=qe}function Co(){if(!s&&!a){var S=r?Math.max(0,r-xo()):0,N=Math.max(g[xt][tw](),S);s=setTimeout(function(){s=null,g[rl](!0,null,1)},N)}}function En(){clearTimeout(s),s=null,r=null}function Oo(S){return S===408||S===429||S===500||S===503}function ae(S,N){return S?"XMLHttpRequest,Status:"+S.status+",Response:"+eb(S)||S.response||"":N}function Me(S,N){var H=g[il],K=Un(),ve=new XDomainRequest;ve.onload=function(){return g._xdrOnLoad(ve,S)},ve.onerror=function(A){return g[gr](S,b(ve),A)};var qe=K&&K.location&&K.location.protocol||"";if(g[xt][Ts]().lastIndexOf(qe,0)!==0){V(g[Go](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),H[bs]();return}var Ve=g[xt][Ts]().replace(/^(https?:)/,"");ve.open("POST",Ve);var Jt=H[ol](S);ve.send(Jt),H[xs](S)}function b(S,N){return S?"XDomainRequest,Response:"+eb(S)||"":N}function R(){var S="getNotifyMgr";return g.core[S]?g.core[S]():g.core._notificationManager}function U(S,N){var H=R();if(H&&H[ow])try{H[ow](S,N)}catch(K){V(g[Go](),1,74,"send request notification failed: "+Oe(K),{exception:ue(K)})}}function $(S){var N=q(S[nw])?!1:S[nw];if(N)return!0;var H="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",K=new RegExp(H);return K.test(S[sf])}function ee(){g[md]=null,g[il]=null,g._appId=null,g._sample=null,u={},h=null,n=0,r=null,i=null,a=!1,s=null,c=null,l=0,p=0,m=null,f=null,_=null}}),o}return t.constructEnvelope=function(o,n,r,i){var a;n!==o.iKey&&!q(n)?a=zt(zt({},o),{iKey:n}):a=o;var s=TV[a.baseType]||iw;return s(r,a,i)},t}(Hr);var sw="duration",Bn="properties";var Tn="requestUrl",_d="inst",Si="length",Ei="traceID",wi="spanID",Es="traceFlags",Ci="core",cw="getDefaultConfig",tb="includeCorrelationHeaders",lw="canIncludeCorrelationHeader",uf="getAbsoluteUrl",ws="headers",Sn="requestHeaders",vd="appId",ob="setRequestHeader",nb="distributedTracingMode",la="startTime",ll="toLowerCase",uw="enableRequestHeaderTracking",dw="enableAjaxErrorStatusText",pw="enableAjaxPerfTracking",mw="maxAjaxCallsPerView",fw="enableResponseHeaderTracking",gw="excludeRequestFromAutoTrackingPatterns",hw="addRequestContext",_w="disableAjaxTracking",vw="disableFetchTracking",hr="status",Cs="statusText",ks="headerMap",df="openDone",pf="sendDone",ua="requestSentTime",mf="abortDone",Vr="method",bw="errorStatusText",rb="stateChangeAttached",xw="responseText",ul="responseFinishedTime",ff="CreateTrackItem",ib="response",yw="getAllResponseHeaders",Tw="getCorrelationContext",bd="perfMark",Sw="ajaxPerfLookupDelay",As="name",gf="perfTiming",Ew="ajaxDiagnosticsMessage",hf="correlationContext",ab="ajaxTotalDuration";function E2(e,t,o){var n=0,r=e[t],i=e[o];return r&&i&&(n=co(r,i)),n}function dl(e,t,o,n,r){var i=0,a=E2(o,n,r);return a&&(i=Is(e,t,zn(a))),i}function Is(e,t,o){var n="ajaxPerf",r=0;if(e&&t&&o){var i=e[n]=e[n]||{};i[t]=o,r=1}return r}function SV(e,t){var o=e[gf],n=t[Bn]||{},r=0,i="name",a="Start",s="End",c="domainLookup",l="connect",u="redirect",p="request",m="response",f="startTime",h=c+a,_=c+s,g=l+a,v=l+s,x=p+a,E=p+s,O=m+a,k=m+s,P=u+a,Te=u=s,Se="transferSize",fe="encodedBodySize",on="decodedBodySize",po="serverTiming";if(o){r|=dl(n,u,o,P,Te),r|=dl(n,c,o,h,_),r|=dl(n,l,o,g,v),r|=dl(n,p,o,x,E),r|=dl(n,m,o,O,k),r|=dl(n,"networkConnect",o,f,v),r|=dl(n,"sentRequest",o,x,k);var mo=o[sw];mo||(mo=E2(o,f,k)||0),r|=Is(n,sw,mo),r|=Is(n,"perfTotal",mo);var Vo=o[po];if(Vo){var nn={};se(Vo,function(Co,En){var Oo=Mc(Co[i]||""+En),ae=nn[Oo]||{};He(Co,function(Me,b){(Me!==i&&ge(b)||xm(b))&&(ae[Me]&&(b=ae[Me]+";"+b),(b||!ge(b))&&(ae[Me]=b))}),nn[Oo]=ae}),r|=Is(n,po,nn)}r|=Is(n,Se,o[Se]),r|=Is(n,fe,o[fe]),r|=Is(n,on,o[on])}else e[bd]&&(r|=Is(n,"missing",e.perfAttempts));r&&(t[Bn]=n)}var EV=function(){function e(){var t=this;t[df]=!1,t.setRequestHeaderDone=!1,t[pf]=!1,t[mf]=!1,t[rb]=!1}return e}();var ww=function(){function e(t,o,n){var r=this,i=n,a="responseText";r[bd]=null,r.completed=!1,r.requestHeadersSize=null,r[Sn]=null,r.responseReceivingDuration=null,r.callbackDuration=null,r[ab]=null,r.aborted=0,r.pageUrl=null,r[Tn]=null,r.requestSize=0,r[Vr]=null,r[hr]=null,r[ua]=null,r.responseStartedTime=null,r[ul]=null,r.callbackFinishedTime=null,r.endTime=null,r.xhrMonitoringState=new EV,r.clientFailure=0,r[Ei]=t,r[wi]=o,Ie(e,r,function(s){s.getAbsoluteUrl=function(){return s[Tn]?Sv(s[Tn]):null},s.getPathName=function(){return s[Tn]?bi(i,Ev(s[Vr],s[Tn])):null},s[ff]=function(c,l,u){var p;if(s.ajaxTotalDuration=Math.round(co(s.requestSentTime,s.responseFinishedTime)*1e3)/1e3,s[ab]<0)return null;var m=(p={id:"|"+s[Ei]+"."+s[wi],target:s[uf]()},p[As]=s.getPathName(),p.type=c,p[la]=null,p.duration=s[ab],p.success=+s[hr]>=200&&+s[hr]<400,p.responseCode=+s[hr],p.method=s[Vr],p[Bn]={HttpMethod:s[Vr]},p);if(s[ua]&&(m[la]=new Date,m[la].setTime(s[ua])),SV(s,m),l&&Xo(s.requestHeaders)[Si]>0){var f=m[Bn]=m[Bn]||{};f[Sn]=s[Sn]}if(u){var h=u();if(h){var _=h[hf];if(_&&(m.correlationContext=_),h[ks]&&Xo(h.headerMap)[Si]>0){var f=m[Bn]=m[Bn]||{};f.responseHeaders=h[ks]}if(s.errorStatusText&&s[hr]>=400){var g=h.type,f=m[Bn]=m[Bn]||{};(g===""||g==="text")&&(f.responseText=h.responseText?h[Cs]+" - "+h[a]:h[Cs]),g==="json"&&(f.responseText=h.response?h[Cs]+" - "+JSON.stringify(h[ib]):h[Cs])}}}return m}})}return e.__ieDyn=1,e}();var w2="ai.ajxmn.",vf="diagLog",Yn="ajaxData",bf="fetch",sb="trackDependencyDataInternal",C2=0;function wV(){var e=nr();return!e||q(e.Request)||q(e.Request[It])||q(e[bf])?null:e[bf]}function CV(e){var t=!1;if(Oc()){var o=XMLHttpRequest[It];t=!q(o)&&!q(o.open)&&!q(o.send)&&!q(o.abort)}var n=qu();if(n&&n<9&&(t=!1),t)try{var r=new XMLHttpRequest;r[Yn]={};var i=XMLHttpRequest[It].open;XMLHttpRequest[It].open=i}catch(a){t=!1,xf(e,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:ue(a)})}return t}function cb(e){var t="";try{!q(e)&&!q(e[Yn])&&!q(e[Yn][Tn])&&(t+="(url: '"+e[Yn][Tn]+"')")}catch{}return t}function xf(e,t,o,n,r){V(e[vf](),1,t,o,n,r)}function xd(e,t,o,n,r){V(e[vf](),2,t,o,n,r)}function _f(e,t,o){return function(n){xf(e,t,o,{ajaxDiagnosticsMessage:cb(n[_d]),exception:ue(n.err)})}}function yd(e,t){return e&&t?e.indexOf(t):-1}function kV(e,t,o,n,r,i){var a,s=e[Si];if(s>0){for(var c=(a={},a[Ci]=t,a.xhr=n,a.input=r,a.init=i,a.traceId=o[Ei],a.spanId=o[wi],a.traceFlags=o[Es],a),l=0;l<s;++l){var u=e[l];if(u&&u.fn)try{u.fn.call(null,c)}catch(m){var p=c[Ci];V(p&&p.logger,1,64,"Dependency listener [#"+l+"] failed: "+Oe(m),{exception:ue(m)},!0)}}o[Ei]=c.traceId,o[wi]=c.spanId,o[Es]=c[Es]}}var k2=Ou(["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"]),Cw=function(e){vo(t,e);function t(){var o=e.call(this)||this;o.identifier=t.identifier,o.priority=120;var n,r,i,a,s,c,l,u,p,m,f,h,_,g,v,x,E,O,k,P,Te,Se;return Ie(t,o,function(fe,on){var po=on._addHook;mo(),fe.initialize=function(A,M,G,Q){fe.isInitialized()||(on.initialize(A,M,G,Q),P=$n(Lo("ajax"),M&&M.evtNamespace&&M.evtNamespace()),Vo(A),ae(),En(),nn())},fe._doTeardown=function(){mo()},fe.trackDependencyData=function(A,M){fe[sb](A,M)},fe[tb]=function(A,M,G,Q){var X=fe._currentWindowHost||i;if(kV(Se,fe[Ci],A,Q,M,G),M){if(oa[lw](a,A[uf](),X)){G||(G={});var le=new Headers(G[ws]||(M instanceof Request?M[ws]||{}:{}));if(m){var je="|"+A[Ei]+"."+A[wi];le.set(lt[3],je),s&&(A[Sn][lt[3]]=je)}var Be=a[vd]||u&&u[vd]();if(Be&&(le.set(lt[0],lt[2]+Be),s&&(A[Sn][lt[0]]=lt[2]+Be)),p){var ot=A[Es];q(ot)&&(ot=1);var St=Im(Am(A[Ei],A[wi],ot));le.set(lt[4],St),s&&(A[Sn][lt[4]]=St)}G[ws]=le}return G}else if(Q){if(oa[lw](a,A[uf](),X)){if(m){var je="|"+A[Ei]+"."+A[wi];Q[ob](lt[3],je),s&&(A[Sn][lt[3]]=je)}var Be=a[vd]||u&&u[vd]();if(Be&&(Q[ob](lt[0],lt[2]+Be),s&&(A[Sn][lt[0]]=lt[2]+Be)),p){var ot=A[Es];q(ot)&&(ot=1);var St=Im(Am(A[Ei],A[wi],ot));Q[ob](lt[4],St),s&&(A[Sn][lt[4]]=St)}}return Q}},fe[sb]=function(A,M,G){if(_===-1||l<_){(a[nb]===2||a[nb]===1)&&typeof A.id=="string"&&A.id[A.id[Si]-1]!=="."&&(A.id+="."),q(A[la])&&(A[la]=new Date);var Q=mr(A,qn.dataType,qn.envelopeType,fe[vf](),M,G);fe[Ci].track(Q)}else l===_&&xf(fe,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++l},fe.addDependencyListener=function(A){var M={id:Te++,fn:A};Se.push(M);var G={remove:function(){se(Se,function(Q,X){if(Q.id===M.id)return Se.splice(X,1),-1})}};return G};function mo(){var A=_n();n=!1,r=!1,i=A&&A.host&&A.host[ll](),a=t.getEmptyConfig(),s=!1,c=!1,l=0,u=null,p=!1,m=!1,f=null,h=!1,_=0,g=!1,v={},x=!1,E=!1,O=null,k=null,P=null,Te=0,Se=[]}function Vo(A){var M=yo(null,A,fe[Ci]);a=t.getEmptyConfig();var G=t[cw]();He(G,function(le,je){a[le]=M.getConfig(t.identifier,le,je)});var Q=a[nb];if(s=a[uw],c=a[dw],h=a[pw],_=a[mw],g=a[fw],O=a[gw],k=a[hw],m=Q===0||Q===1,p=Q===1||Q===2,h){var X=A.instrumentationKey||"unkwn";X[Si]>5?f=w2+X.substring(X[Si]-5)+".":f=w2+X+"."}x=!!a[_w],E=!!a[vw]}function nn(){var A=fe[Ci].getPlugin(ls);A&&(u=A.plugin.context)}function Co(A){var M=!0;return(A||a.ignoreHeaders)&&se(a.ignoreHeaders,function(G){if(G[ll]()===A[ll]())return M=!1,-1}),M}function En(){var A=wV();if(!!A){var M=nr(),G=A.polyfill;!E&&!n?(po(Nm(M,bf,{ns:P,req:function(Q,X,le){var je;if(!E&&n&&!Me(null,X,le)&&!(G&&r)){var Be=Q.ctx();je=ve(X,le);var ot=fe[tb](je,X,le);ot!==le&&Q.set(1,ot),Be.data=je}},rsp:function(Q,X){if(!E){var le=Q.ctx().data;le&&(Q.rslt=Q.rslt.then(function(je){return Ve(Q,(je||{})[hr],X,je,le,function(){var Be,ot=(Be={statusText:je[Cs]},Be[ks]=null,Be[hf]=Jt(je),Be);if(g){var St={};je.headers.forEach(function(yr,Wn){Co(Wn)&&(St[Wn]=yr)}),ot[ks]=St}return ot}),je}).catch(function(je){throw Ve(Q,0,X,null,le,null,{error:je.message}),je}))}},hkErr:_f(fe,15,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),n=!0):G&&po(Nm(M,bf,{ns:P,req:function(Q,X,le){Me(null,X,le)}})),G&&(M[bf].polyfill=G)}}function Oo(A,M,G){po(yE(A,M,G))}function ae(){CV(fe)&&!x&&!r&&(Oo(XMLHttpRequest,"open",{ns:P,req:function(A,M,G,Q){if(!x){var X=A[_d],le=X[Yn];!Me(X,G)&&b(X,!0)&&((!le||!le.xhrMonitoringState[df])&&U(X,M,G,Q),$(X))}},hkErr:_f(fe,15,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),Oo(XMLHttpRequest,"send",{ns:P,req:function(A,M){if(!x){var G=A[_d],Q=G[Yn];b(G)&&!Q.xhrMonitoringState[pf]&&(H("xhr",Q),Q[ua]=td(),fe[tb](Q,void 0,void 0,G),Q.xhrMonitoringState[pf]=!0)}},hkErr:_f(fe,17,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),Oo(XMLHttpRequest,"abort",{ns:P,req:function(A){if(!x){var M=A[_d],G=M[Yn];b(M)&&!G.xhrMonitoringState[mf]&&(G.aborted=1,G.xhrMonitoringState[mf]=!0)}},hkErr:_f(fe,13,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),Oo(XMLHttpRequest,"setRequestHeader",{ns:P,req:function(A,M,G){if(!x&&s){var Q=A[_d];b(Q)&&Co(M)&&(Q[Yn][Sn][M]=G)}},hkErr:_f(fe,71,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),r=!0)}function Me(A,M,G){var Q=!1,X=((ge(M)?M:(M||{}).url||"")||"")[ll]();if(se(O,function(Be){var ot=Be;ge(Be)&&(ot=new RegExp(Be)),Q||(Q=ot.test(X))}),Q)return Q;var le=yd(X,"?"),je=yd(X,"#");return(le===-1||je!==-1&&je<le)&&(le=je),le!==-1&&(X=X.substring(0,le)),q(A)?q(M)||(Q=(typeof M=="object"?M[qr]===!0:!1)||(G?G[qr]===!0:!1)):Q=A[qr]===!0||X[qr]===!0,!Q&&X&&Xc(X)&&(Q=!0),Q?v[X]||(v[X]=1):v[X]&&(Q=!0),Q}function b(A,M){var G=!0,Q=r;return q(A)||(G=M===!0||!q(A[Yn])),Q&&G}function R(){var A=null;return fe[Ci]&&fe[Ci].getTraceCtx&&(A=fe[Ci].getTraceCtx(!1)),!A&&u&&u.telemetryTrace&&(A=Jc(u.telemetryTrace)),A}function U(A,M,G,Q){var X=R(),le=X&&X.getTraceId()||vn(),je=vn().substr(0,16),Be=new ww(le,je,fe[vf]());Be[Es]=X&&X.getTraceFlags(),Be[Vr]=M,Be[Tn]=G,Be.xhrMonitoringState[df]=!0,Be[Sn]={},Be.async=Q,Be[bw]=c,A[Yn]=Be}function $(A){A[Yn].xhrMonitoringState[rb]=ur(A,"readystatechange",function(){var M;try{A&&A.readyState===4&&b(A)&&S(A)}catch(Q){var G=ue(Q);(!G||yd(G[ll](),"c00c023f")===-1)&&xf(fe,16,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",(M={},M[Ew]=cb(A),M.exception=G,M))}},P)}function ee(A){try{var M=A.responseType;if(M===""||M==="text")return A[xw]}catch{}return null}function S(A){var M=A[Yn];M[ul]=td(),M[hr]=A[hr];function G(Q,X){var le=X||{};le.ajaxDiagnosticsMessage=cb(A),Q&&(le.exception=ue(Q)),xd(fe,14,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",le)}K("xmlhttprequest",M,function(){try{var Q=M[ff]("Ajax",s,function(){var le,je=(le={statusText:A[Cs]},le[ks]=null,le[hf]=N(A),le.type=A.responseType,le[xw]=ee(A),le.response=A[ib],le);if(g){var Be=A[yw]();if(Be){var ot=Ft(Be).split(/[\r\n]+/),St={};se(ot,function(yr){var Wn=yr.split(": "),np=Wn.shift(),rp=Wn.join(": ");Co(np)&&(St[np]=rp)}),je[ks]=St}}return je}),X=void 0;try{k&&(X=k({status:A[hr],xhr:A}))}catch{xd(fe,104,"Failed to add custom defined request context as configured call back may missing a null check.")}Q?(X!==void 0&&(Q[Bn]=zt(zt({},Q.properties),X)),fe[sb](Q)):G(null,{requestSentTime:M[ua],responseFinishedTime:M[ul]})}finally{try{A[Yn]=null}catch{}}},function(Q){G(Q,null)})}function N(A){var M;try{var G=A[yw]();if(G!==null){var Q=yd(G[ll](),lt[8]);if(Q!==-1){var X=A.getResponseHeader(lt[0]);return oa[Tw](X)}}}catch(le){xd(fe,18,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",(M={},M[Ew]=cb(A),M.exception=ue(le),M))}}function H(A,M){if(M[Tn]&&f&&h){var G=cr();if(G&&be(G.mark)){C2++;var Q=f+A+"#"+C2;G.mark(Q);var X=G.getEntriesByName(Q);X&&X[Si]===1&&(M[bd]=X[0])}}}function K(A,M,G,Q){var X=M[bd],le=cr(),je=a.maxAjaxPerfLookupAttempts,Be=a[Sw],ot=M[Tn],St=0;(function yr(){try{if(le&&X){St++;for(var Wn=null,np=le.getEntries(),rp=np[Si]-1;rp>=0;rp--){var Pi=np[rp];if(Pi){if(Pi.entryType==="resource")Pi.initiatorType===A&&(yd(Pi[As],ot)!==-1||yd(ot,Pi[As])!==-1)&&(Wn=Pi);else if(Pi.entryType==="mark"&&Pi[As]===X[As]){M[gf]=Wn;break}if(Pi[la]<X[la]-1e3)break}}}!X||M[gf]||St>=je||M.async===!1?(X&&be(le.clearMarks)&&le.clearMarks(X[As]),M.perfAttempts=St,G()):setTimeout(yr,Be)}catch(bY){Q(bY)}})()}function ve(A,M){var G=R(),Q=G&&G.getTraceId()||vn(),X=vn().substr(0,16),le=new ww(Q,X,fe[vf]());le[Es]=G&&G.getTraceFlags(),le[ua]=td(),le[bw]=c,A instanceof Request?le[Tn]=A?A.url:"":le[Tn]=A;var je="GET";M&&M[Vr]?je=M[Vr]:A&&A instanceof Request&&(je=A[Vr]),le[Vr]=je;var Be={};if(s){var ot=new Headers((M?M[ws]:0)||(A instanceof Request?A[ws]||{}:{}));ot.forEach(function(St,yr){Co(yr)&&(Be[yr]=St)})}return le[Sn]=Be,H("fetch",le),le}function qe(A){var M="";try{q(A)||(typeof A=="string"?M+="(url: '".concat(A,"')"):M+="(url: '".concat(A.url,"')"))}catch(G){xf(fe,15,"Failed to grab failed fetch diagnostics message",{exception:ue(G)})}return M}function Ve(A,M,G,Q,X,le,je){if(!X)return;function Be(ot,St,yr){var Wn=yr||{};Wn.fetchDiagnosticsMessage=qe(G),St&&(Wn.exception=ue(St)),xd(fe,ot,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",Wn)}X[ul]=td(),X[hr]=M,K("fetch",X,function(){var ot=X[ff]("Fetch",s,le),St;try{k&&(St=k({status:M,request:G,response:Q}))}catch{xd(fe,104,"Failed to add custom defined request context as configured call back may missing a null check.")}ot?(St!==void 0&&(ot[Bn]=zt(zt({},ot.properties),St)),fe[sb](ot)):Be(14,null,{requestSentTime:X[ua],responseFinishedTime:X[ul]})},function(ot){Be(18,ot,null)})}function Jt(A){if(A&&A[ws])try{var M=A[ws].get(lt[0]);return oa[Tw](M)}catch(G){xd(fe,18,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:qe(A),exception:ue(G)})}}}),o}return t.getDefaultConfig=function(){var o,n=(o={},o[mw]=500,o[_w]=!1,o[vw]=!1,o[gw]=void 0,o.disableCorrelationHeaders=!1,o.distributedTracingMode=1,o.correlationHeaderExcludedDomains=k2,o.correlationHeaderDomains=void 0,o.correlationHeaderExcludePatterns=void 0,o[vd]=void 0,o.enableCorsCorrelation=!1,o[uw]=!1,o[fw]=!1,o[dw]=!1,o[pw]=!1,o.maxAjaxPerfLookupAttempts=3,o[Sw]=25,o.ignoreHeaders=["Authorization","X-API-Key","WWW-Authenticate"],o[hw]=void 0,o);return n},t.getEmptyConfig=function(){var o=this[cw]();return He(o,function(n){o[n]=void 0}),o},t.prototype.processTelemetry=function(o,n){this.processNext(o,n)},t.identifier="AjaxDependencyPlugin",t}(Hr);var A2=function(){function e(){}return e}();var I2=function(){function e(){this.id="browser",this.deviceClass="Browser"}return e}();var Td="sessionManager",pl="update",Sd="isUserCookieSet",Ed="isNewUser",lb="getTraceCtx",yf="telemetryTrace",ub="applySessionContext",db="applyApplicationContext",pb="applyDeviceContext",mb="applyOperationContext",fb="applyUserContext",gb="applyOperatingSystemContxt",hb="applyLocationContext",_b="applyInternalContext",jr="accountId",wd="sdkExtension",Cd="getSessionId",ki="namePrefix",kd="sessionCookiePostfix",Ad="userCookiePostfix",Ps="idLength",Rs="getNewId",ml="length",Ns="automaticSession",Ds="authenticatedId",Id="sessionExpirationMs",Tf="sessionRenewalMs",Wr="config",Pd="acquisitionDate",Sf="renewalDate",Ef="cookieDomain",Rd="join",Nd="cookieSeparator",vb="authUserCookieName";var AV="2.8.5",P2=function(){function e(t){this.sdkVersion=(t[wd]&&t[wd]()?t[wd]()+"_":"")+"javascript:"+AV}return e}();var R2=function(){function e(){}return e}();var IV="ai_session",kw=function(){function e(){}return e}();var N2=function(){function e(t,o){var n=this,r,i,a=Fr(o),s=Hc(o);Ie(e,n,function(c){t||(t={}),be(t[Id])||(t[Id]=function(){return e.acquisitionSpan}),be(t[Tf])||(t[Tf]=function(){return e.renewalSpan}),c[Wr]=t;var l=c.config[kd]&&c[Wr][kd]()?c.config[kd]():c.config[ki]&&c[Wr][ki]()?c[Wr][ki]():"";r=function(){return IV+l},c[Ns]=new kw,c[pl]=function(){var _=xo(),g=!1,v=c[Ns];v.id||(g=!u(v,_));var x=c.config[Id]();if(!g&&x>0){var E=c.config[Tf](),O=_-v[Pd],k=_-v[Sf];g=O<0||k<0,g=g||O>x,g=g||k>E}g?m(_):(!i||_-i>e.cookieUpdateInterval)&&f(v,_)},c.backup=function(){var _=c[Ns];h(_.id,_[Pd],_[Sf])};function u(_,g){var v=!1,x=s.get(r());if(x&&be(x.split))v=p(_,x);else{var E=PE(a,r());E&&(v=p(_,E))}return v||!!_.id}function p(_,g){var v=!1,x=", session will be reset",E=g.split("|");if(E[ml]>=2)try{var O=+E[1]||0,k=+E[2]||0;isNaN(O)||O<=0?V(a,2,27,"AI session acquisition date is 0"+x):isNaN(k)||k<=0?V(a,2,27,"AI session renewal date is 0"+x):E[0]&&(_.id=E[0],_[Pd]=O,_[Sf]=k,v=!0)}catch(P){V(a,1,9,"Error parsing ai_session value ["+(g||"")+"]"+x+" - "+Oe(P),{exception:ue(P)})}return v}function m(_){var g=c[Wr]||{},v=(g[Rs]?g[Rs]():null)||Xi;c.automaticSession.id=v(g[Ps]?g[Ps]():22),c[Ns][Pd]=_,f(c[Ns],_),Hm()||V(a,2,0,"Browser does not support local storage. Session durations will be inaccurate.")}function f(_,g){var v=_[Pd];_[Sf]=g;var x=c[Wr],E=x[Tf](),O=v+x[Id]()-g,k=[_.id,v,g],P=0;O<E?P=O/1e3:P=E/1e3;var Te=x[Ef]?x[Ef]():null;s.set(r(),k.join("|"),x[Id]()>0?P:null,Te),i=g}function h(_,g,v){RE(a,r(),[_,g,v][Rd]("|"))}})}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}();var D2=function(){function e(t,o,n,r){var i=this;i.traceID=t||vn(),i.parentID=o;var a=_n();!n&&a&&a.pathname&&(n=a.pathname),i.name=at(r,n)}return e}();function L2(e){return!(typeof e!="string"||!e||e.match(/,|;|=| |\|/))}var M2=function(){function e(t,o){this.isNewUser=!1,this.isUserCookieSet=!1;var n=Fr(o),r=Hc(o),i;Ie(e,this,function(a){a[Wr]=t;var s=a.config[Ad]&&a[Wr][Ad]()?a[Wr][Ad]():"";i=function(){return e.userCookieName+s};var c=r.get(i());if(c){a[Ed]=!1;var l=c.split(e[Nd]);l[ml]>0&&(a.id=l[0],a[Sd]=!!a.id)}function u(){var v=t||{},x=(v[Rs]?v[Rs]():null)||Xi,E=x(v[Ps]?t[Ps]():22);return E}function p(v){var x=On(new Date);a.accountAcquisitionDate=x,a[Ed]=!0;var E=[v,x];return E}function m(v){var x=31536e3;a[Sd]=r.set(i(),v,x)}if(!a.id){a.id=u();var f=p(a.id);m(f[Rd](e[Nd]));var h=t[ki]&&t[ki]()?t[ki]()+"ai_session":"ai_session";NE(n,h)}a[jr]=t[jr]?t[jr]():void 0;var _=r.get(e[vb]);if(_){_=decodeURI(_);var g=_.split(e[Nd]);g[0]&&(a[Ds]=g[0]),g[ml]>1&&g[1]&&(a[jr]=g[1])}a.setAuthenticatedUserContext=function(v,x,E){E===void 0&&(E=!1);var O=!L2(v)||x&&!L2(x);if(O){V(n,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);return}a[Ds]=v;var k=a[Ds];x&&(a[jr]=x,k=[a[Ds],a.accountId][Rd](e[Nd])),E&&r.set(e[vb],encodeURI(k))},a.clearAuthenticatedUserContext=function(){a[Ds]=null,a[jr]=null,r.del(e[vb])},a[pl]=function(v){if(a.id!==v||!a[Sd]){var x=v||u(),E=p(x);m(E[Rd](e[Nd]))}}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}();var bb="ext",xb="tags";function Dd(e,t){e&&e[t]&&Xo(e[t])[ml]===0&&delete e[t]}var O2=function(){function e(t,o,n){var r=this,i=t.logger;this.appId=function(){return null},this[Cd]=function(){return null},Ie(e,this,function(a){if(a.application=new A2,a.internal=new P2(o),Ki()){a[Td]=new N2(o,t),a.device=new I2,a.location=new R2,a.user=new M2(o,t);var s=void 0,c=void 0,l;n&&(s=n.getTraceId(),c=n.getSpanId(),l=n.getName()),a[yf]=new D2(s,c,l,i),a.session=new kw}a[Cd]=function(){var u=a.session,p=null;if(u&&ge(u.id))p=u.id;else{var m=(a[Td]||{})[Ns];p=m&&ge(m.id)?m.id:null}return p},a[ub]=function(u,p){Ze(Mt(u.ext,en.AppExt),"sesId",a[Cd](),ge)},a[gb]=function(u,p){Ze(u.ext,en.OSExt,a.os)},a[db]=function(u,p){var m=a.application;if(m){var f=Mt(u,xb);Ze(f,ut.applicationVersion,m.ver,ge),Ze(f,ut.applicationBuild,m.build,ge)}},a[pb]=function(u,p){var m=a.device;if(m){var f=Mt(Mt(u,bb),en.DeviceExt);Ze(f,"localId",m.id,ge),Ze(f,"ip",m.ip,ge),Ze(f,"model",m.model,ge),Ze(f,"deviceClass",m.deviceClass,ge)}},a[_b]=function(u,p){var m=a.internal;if(m){var f=Mt(u,xb);Ze(f,ut.internalAgentVersion,m.agentVersion,ge),Ze(f,ut.internalSdkVersion,m.sdkVersion,ge),(u.baseType===Qi.dataType||u.baseType===Zo.dataType)&&(Ze(f,ut.internalSnippet,m.snippetVer,ge),Ze(f,ut.internalSdkSrc,m.sdkSrc,ge))}},a[hb]=function(u,p){var m=r.location;m&&Ze(Mt(u,xb,[]),ut.locationIp,m.ip,ge)},a[mb]=function(u,p){var m=a[yf];if(m){var f=Mt(Mt(u,bb),en.TraceExt,{traceID:void 0,parentID:void 0});Ze(f,"traceID",m.traceID,ge),Ze(f,"name",m.name,ge),Ze(f,"parentID",m.parentID,ge)}},a.applyWebContext=function(u,p){var m=r.web;m&&Ze(Mt(u,bb),en.WebExt,m)},a[fb]=function(u,p){var m=a.user;if(m){var f=Mt(u,xb,[]);Ze(f,ut.userAccountId,m[jr],ge);var h=Mt(Mt(u,bb),en.UserExt);Ze(h,"id",m.id,ge),Ze(h,"authId",m[Ds],ge)}},a.cleanUp=function(u,p){var m=u.ext;m&&(Dd(m,en.DeviceExt),Dd(m,en.UserExt),Dd(m,en.WebExt),Dd(m,en.OSExt),Dd(m,en.AppExt),Dd(m,en.TraceExt))}})}return e.__ieDyn=1,e}();var PV=function(e){vo(t,e);function t(){var o=e.call(this)||this;o.priority=110,o.identifier=ls;var n,r,i;return Ie(t,o,function(a,s){c(),a.initialize=function(p,m,f,h){s.initialize(p,m,f,h),l(p)},a.processTelemetry=function(p,m){if(!q(p)){m=a._getTelCtx(m),p.name===Zo.envelopeType&&m.diagLog().resetInternalMessageCount();var f=a.context||{};f.session&&typeof a.context.session.id!="string"&&f[Td]&&f[Td][pl]();var h=f.user;if(h&&!h[Sd]&&h[pl](f.user.id),u(p,m),h&&h[Ed]){h[Ed]=!1;var _=new Qi(72,(Jo()||{}).userAgent||"");XS(m.diagLog(),1,_)}a.processNext(p,m)}},a._doTeardown=function(p,m){var f=(p||{}).core();if(f&&f[lb]){var h=f[lb](!1);h===r&&f.setTraceCtx(i)}c()};function c(){n=null,r=null,i=null}function l(p){var m=a.identifier,f=a.core,h=yo(null,p,f),_=t.getDefaultConfig();n=n||{},He(_,function(g,v){n[g]=function(){return h.getConfig(m,g,v())}}),i=f[lb](!1),a.context=new O2(f,n,i),r=Jc(a.context[yf],i),f.setTraceCtx(r),a.context.appId=function(){var g=f.getPlugin(Gm);return g?g.plugin._appId:null},a._extConfig=n}function u(p,m){Mt(p,"tags",[]),Mt(p,"ext",{});var f=a.context;f[ub](p,m),f[db](p,m),f[pb](p,m),f[mb](p,m),f[fb](p,m),f[gb](p,m),f.applyWebContext(p,m),f[hb](p,m),f[_b](p,m),f.cleanUp(p,m)}}),o}return t.getDefaultConfig=function(){var o,n,r=null,i=(o={instrumentationKey:function(){return n}},o[jr]=function(){return r},o.sessionRenewalMs=function(){return 30*60*1e3},o.samplingPercentage=function(){return 100},o.sessionExpirationMs=function(){return 24*60*60*1e3},o[Ef]=function(){return r},o[wd]=function(){return r},o.isBrowserLinkTrackingEnabled=function(){return!1},o.appId=function(){return r},o[Cd]=function(){return r},o[ki]=function(){return n},o[kd]=function(){return n},o[Ad]=function(){return n},o[Ps]=function(){return 22},o[Rs]=function(){return r},o);return i},t}(Hr),Aw=PV;var U2="AuthenticatedUserContext",Ld="track";var yb="snippet",$2="getCookieMgr",z2="startTrackPage",F2="stopTrackPage",Tb="flush",H2="startTrackEvent",q2="stopTrackEvent",Iw="addTelemetryInitializer",LTe=Iw+"s",Pw="pollInternalLogs",Sb="getPlugin",Eb="evtNamespace",B2=Ld+"Event",Y2=Ld+"Trace",G2=Ld+"Metric",V2=Ld+"PageView",j2=Ld+"Exception",W2=Ld+"DependencyData",K2="set"+U2,Q2="clear"+U2;var X2="updateSnippetDefinitions",J2="loadAppInsights",Rw="endpointUrl";var wf="diagnosticLogInterval";var Z2="disableFlushOnBeforeUnload",eH="disableFlushOnUnload";var da="config",_r="context",Cf="push",wb="version",Ls="queue",Cb="connectionString",Nw="instrumentationKey",kf="appInsights",Dw="disableIkeyDeprecationMessage",Lw="getTransmissionControls",Md="onunloadFlush",Mw="addHousekeepingBeforeUnload",Af="indexOf";var Ow,tH=[yb,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"];var Uw=function(){function e(t){var o=this,n,r,i,a,s,c,l;Ie(e,this,function(u){v(),a=""+(t.sv||t[wb]||""),t[Ls]=t[Ls]||[],t[wb]=t[wb]||2;var p=t[da]||{};if(p[Cb]){var m=UE(p[Cb]),f=m.ingestionendpoint;p[Rw]=f?f+Zi:p[Rw],p[Nw]=m.instrumentationkey||p[Nw]}u[kf]=new Gv,r=new Aw,n=new Cw,i=new aw,l=new _E,u.core=l;var h=q(p[Dw])?!0:p[Dw];!p[Cb]&&!h&&V(l.logger,1,106,"Instrumentation key support will end soon, see aka.ms/IkeyMigrate"),u[yb]=t,u[da]=p,_(),u[Tb]=function(x){x===void 0&&(x=!0),Za(l,function(){return"AISKU.flush"},function(){se(l[Lw](),function(E){se(E,function(O){O[Tb](x)})})},null,x)},u[Md]=function(x){x===void 0&&(x=!0),se(l[Lw](),function(E){se(E,function(O){O[Md]?O[Md]():O[Tb](x)})})},u[J2]=function(x,E,O){x===void 0&&(x=!1);function k(P){if(P){var Te="";q(a)||(Te+=a),x&&(Te+=".lg"),u[_r]&&u[_r].internal&&(u[_r].internal.snippetVer=Te||"-"),He(u,function(Se,fe){ge(Se)&&!be(fe)&&Se&&Se[0]!=="_"&&bo(tH,Se)===-1&&(P[Se]=fe)})}}return x&&u[da].extensions&&u[da].extensions.length>0&&Rt("Extensions not allowed in legacy mode"),Za(u.core,function(){return"AISKU.loadAppInsights"},function(){var P=[];P[Cf](i),P[Cf](r),P[Cf](n),P[Cf](u[kf]),l.initialize(u[da],P,E,O),u[_r]=r[_r],Ow&&u[_r]&&(u[_r].internal.sdkSrc=Ow),k(u[yb]),u.emptyQueue(),u[Pw](),u[Mw](o)}),u},u[X2]=function(x){LS(x,u,function(E){return E&&bo(tH,E)===-1})},u.emptyQueue=function(){try{if(Xe(u.snippet[Ls])){for(var x=u.snippet[Ls].length,E=0;E<x;E++){var O=u.snippet[Ls][E];O()}u.snippet[Ls]=void 0,delete u.snippet[Ls]}}catch(P){var k={};P&&be(P.toString)&&(k.exception=P.toString())}},u[Mw]=function(x){if(Ki()||Q_()){var E=function(){if(x[Md](!1),be(o.core[Sb])){var P=o.core[Sb](ls);if(P){var Te=P.plugin;Te&&Te[_r]&&Te[_r]._sessionManager&&Te[_r]._sessionManager.backup()}}},O=!1,k=x.appInsights[da].disablePageUnloadEvents;c||(c=$n(s,l[Eb]&&l[Eb]())),x.appInsights.config[Z2]||(pE(E,k,c)&&(O=!0),Cm(E,k,c)&&(O=!0),!O&&!jS()&&V(x[kf].core.logger,1,19,"Could not add handler for beforeunload and pagehide")),!O&&!x.appInsights.config[eH]&&Cm(E,k,c)}},u.getSender=function(){return i},u.unload=function(x,E,O){u[Md](x),c&&(mE(null,c),fE(null,c)),l.unload&&l.unload(x,E,O)},fi(u,u[kf],[$2,B2,V2,"trackPageViewPerformance",j2,"_onerror",Y2,G2,z2,F2,H2,q2]),fi(u,g,[W2,"addDependencyListener"]),fi(u,l,[Iw,Pw,"stopPollingInternalLogs",Sb,"addPlugin",Eb,"addUnloadCb","getTraceCtx"]),fi(u,function(){var x=r[_r];return x?x.user:null},[K2,Q2]);function _(){u.config[wf]=u.config[wf]&&u[da][wf]>0?u[da][wf]:1e4}function g(){return n}function v(){s=Lo("AISKU"),c=null,n=null,r=null,i=null,a=null}})}return e.__ieDyn=1,e}();(function(){var e=null,t=!1,o=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(e=n.src)}catch{}if(e)try{var r=e.toLowerCase();if(r){for(var i="",a=0;a<o.length;a++)if(r[Af](o[a])!==-1){i="cdn"+(a+1),r[Af]("/scripts/")===-1&&(r[Af]("/next/")!==-1?i+="-next":r[Af]("/beta/")!==-1&&(i+="-beta")),Ow=i+(t?".mod":"");break}}}catch{}})();var RV={trackEvent:()=>{},trackException:()=>{}},Od=RV;function oH(){if(!Ne.applicationInsights)return;let e={"docs.microsoft.com":"9367385a-f935-4fd9-91da-c734500b5d55","docs.azure.cn":"9367385a-f935-4fd9-91da-c734500b5d55","developer.microsoft.com":"9367385a-f935-4fd9-91da-c734500b5d55","review.docs.microsoft.com":"9367385a-f935-4fd9-91da-c734500b5d55","ppe.docs.microsoft.com":"89ee6297-0550-4fd8-8d37-c2aa8d2ec81c"}[de.hostname];if(!e)return;Od=new Uw({config:{instrumentationKey:e,disableFetchTracking:!1}}),Od.loadAppInsights();let t=()=>{y.isAuthenticated?Od.setAuthenticatedUserContext(y.userId):Od.clearAuthenticatedUserContext()};y.subscribe(_t,t),t()}var Ms,Rf,sH,kb,pa=function(e,t){return{name:e,value:t===void 0?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},Ab=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if(e==="first-input"&&!("PerformanceEventTiming"in self))return;var o=new PerformanceObserver(function(n){return n.getEntries().map(t)});return o.observe({type:e,buffered:!0}),o}}catch{}},Ib=function(e,t){var o=function n(r){r.type!=="pagehide"&&document.visibilityState!=="hidden"||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",o,!0),addEventListener("pagehide",o,!0)},Nf=function(e){addEventListener("pageshow",function(t){t.persisted&&e(t)},!0)},Os=function(e,t,o){var n;return function(r){t.value>=0&&(r||o)&&(t.delta=t.value-(n||0),(t.delta||n===void 0)&&(n=t.value,e(t)))}},If=-1,nH=function(){return document.visibilityState==="hidden"?0:1/0},rH=function(){Ib(function(e){var t=e.timeStamp;If=t},!0)},Fw=function(){return If<0&&(If=nH(),rH(),Nf(function(){setTimeout(function(){If=nH(),rH()},0)})),{get firstHiddenTime(){return If}}},Hw=function(e,t){var o,n=Fw(),r=pa("FCP"),i=function(c){c.name==="first-contentful-paint"&&(s&&s.disconnect(),c.startTime<n.firstHiddenTime&&(r.value=c.startTime,r.entries.push(c),o(!0)))},a=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],s=a?null:Ab("paint",i);(a||s)&&(o=Os(e,r,t),a&&i(a),Nf(function(c){r=pa("FCP"),o=Os(e,r,t),requestAnimationFrame(function(){requestAnimationFrame(function(){r.value=performance.now()-c.timeStamp,o(!0)})})}))},iH=!1,$w=-1,cH=function(e,t){iH||(Hw(function(l){$w=l.value}),iH=!0);var o,n=function(l){$w>-1&&e(l)},r=pa("CLS",0),i=0,a=[],s=function(l){if(!l.hadRecentInput){var u=a[0],p=a[a.length-1];i&&l.startTime-p.startTime<1e3&&l.startTime-u.startTime<5e3?(i+=l.value,a.push(l)):(i=l.value,a=[l]),i>r.value&&(r.value=i,r.entries=a,o())}},c=Ab("layout-shift",s);c&&(o=Os(n,r,t),Ib(function(){c.takeRecords().map(s),o(!0)}),Nf(function(){i=0,$w=-1,r=pa("CLS",0),o=Os(n,r,t)}))},Pf={passive:!0,capture:!0},NV=new Date,aH=function(e,t){Ms||(Ms=t,Rf=e,sH=new Date,uH(removeEventListener),lH())},lH=function(){if(Rf>=0&&Rf<sH-NV){var e={entryType:"first-input",name:Ms.type,target:Ms.target,cancelable:Ms.cancelable,startTime:Ms.timeStamp,processingStart:Ms.timeStamp+Rf};kb.forEach(function(t){t(e)}),kb=[]}},DV=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;e.type=="pointerdown"?function(o,n){var r=function(){aH(o,n),a()},i=function(){a()},a=function(){removeEventListener("pointerup",r,Pf),removeEventListener("pointercancel",i,Pf)};addEventListener("pointerup",r,Pf),addEventListener("pointercancel",i,Pf)}(t,e):aH(t,e)}},uH=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach(function(t){return e(t,DV,Pf)})},dH=function(e,t){var o,n=Fw(),r=pa("FID"),i=function(s){s.startTime<n.firstHiddenTime&&(r.value=s.processingStart-s.startTime,r.entries.push(s),o(!0))},a=Ab("first-input",i);o=Os(e,r,t),a&&Ib(function(){a.takeRecords().map(i),a.disconnect()},!0),a&&Nf(function(){var s;r=pa("FID"),o=Os(e,r,t),kb=[],Rf=-1,Ms=null,uH(addEventListener),s=i,kb.push(s),lH()})},zw={},pH=function(e,t){var o,n=Fw(),r=pa("LCP"),i=function(c){var l=c.startTime;l<n.firstHiddenTime&&(r.value=l,r.entries.push(c),o())},a=Ab("largest-contentful-paint",i);if(a){o=Os(e,r,t);var s=function(){zw[r.id]||(a.takeRecords().map(i),a.disconnect(),zw[r.id]=!0,o(!0))};["keydown","click"].forEach(function(c){addEventListener(c,s,{once:!0,capture:!0})}),Ib(s,!0),Nf(function(c){r=pa("LCP"),o=Os(e,r,t),requestAnimationFrame(function(){requestAnimationFrame(function(){r.value=performance.now()-c.timeStamp,zw[r.id]=!0,o(!0)})})})}},mH=function(e){var t,o=pa("TTFB");t=function(){try{var n=performance.getEntriesByType("navigation")[0]||function(){var r=performance.timing,i={entryType:"navigation",startTime:0};for(var a in r)a!=="navigationStart"&&a!=="toJSON"&&(i[a]=Math.max(r[a]-r.navigationStart,0));return i}();if(o.value=o.delta=n.responseStart,o.value<0||o.value>performance.now())return;o.entries=[n],e(o)}catch{}},document.readyState==="complete"?setTimeout(t,0):addEventListener("load",function(){return setTimeout(t,0)})};var LV=.05,Pb=new Set;function Df(e){Pb.add(e)}function fH(){if(Pb.size>0){let e=Array.from(Pb);OV(e),Pb.clear()}}function MV(e){let t={};for(let o of e){let{name:n,value:r}=o;t[n]=r}return t}function OV(e){let t=MV(e);Po({content:{type:"web-vitals",version:"1",metrics:t}})}function gH(){let e=Ne.reportWebVitalsAlways||Math.random()<=LV;!S_||!e||(cH(Df),Hw(Df),dH(Df),pH(Df),mH(Df),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&fH()}),document.addEventListener("pagehide",fH))}function hH(){UV(),$V(),zV(),FV(),HV(),qV(),BV(),YV(),GV(),VV(),gH()}async function UV(){let e=()=>PU(y.authenticationMode,y.isAuthenticated);y.subscribe(_t,e),e(),await y.whenAuthenticated(),Po({content:{event:"user-is-signed-in"}})}function $V(){function e(t){!t.isTrusted||!(t.target instanceof HTMLSelectElement)||!t.target.hasAttribute(Jl.name)||Zl(t.target,{actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"select-value-changed",name:zp(t.target),value:t.target.value}})}Y.addEventListener("change",e,{passive:!0})}function zV(){let e="";function t(r){!r.isTrusted||e===r.type||(e=r.type,Po({actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"page-focus-changed",value:r.type}}))}let o=0;function n(r){clearTimeout(o),o=setTimeout(()=>t(r),50)}he.addEventListener("focus",n,{passive:!0}),he.addEventListener("blur",n,{passive:!0})}function FV(){function e(){Po({actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"page-visibility-changed",value:Y.hidden?"hidden":"visible"}})}function t(){Y.addEventListener("visibilitychange",e,{passive:!0})}Y.readyState==="interactive"||Y.readyState==="complete"?t():Y.addEventListener("DOMContentLoaded",t)}function HV(){!hU||_U.addListener(e=>{!e.matches||Po({actionType:Io.OTHER,behavior:ho.PRINT,content:{event:"print"}})})}function qV(){function e(o){if(!o.isTrusted||!(o.target instanceof HTMLElement))return;let{width:n,height:r}=o.target.getBoundingClientRect(),{scrollLeft:i,scrollTop:a,scrollWidth:s,scrollHeight:c}=o.target;Zl(o.target,{actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"secondary-content-scroll",name:zp(o.target),viewPortWidth:Math.floor(n),viewPortHeight:Math.floor(r),contentWidth:Math.floor(s),contentHeight:Math.floor(c),horizontalOffset:Math.floor(i),verticalOffset:Math.floor(a)}})}function t(o){if(o.target===Y)return;let n=o.target;clearTimeout(n.reportScrollTimeout),n.reportScrollTimeout=setTimeout(()=>e(o),100)}he.addEventListener("scroll",t,{passive:!0,capture:!0})}function BV(){let e=!1;function t(){Po({actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"unload",anchor:e}})}function o(r){r.target instanceof HTMLAnchorElement&&(e=!0,setTimeout(()=>e=!1))}function n(r){r.target instanceof HTMLAnchorElement&&(e=!0,setTimeout(()=>e=!1))}he.addEventListener("keydown",n,{capture:!0,passive:!0}),he.addEventListener("click",o,{capture:!0,passive:!0}),he.addEventListener("beforeunload",t,{passive:!0})}function YV(){function e(t){let o=t.target;if(o.id!=="nav-bar-search-form"&&o.id!=="nav-bar-search-form-desktop"&&o.id!=="welcome-page-search-form"&&o.id!=="directory-page-search-form"&&o.id!=="facet-search-form")return;let r=Array.from(o.querySelectorAll('input[name="terms"], input[name="facet-search-input"]'))[0].value,i=Y.activeElement&&Y.activeElement instanceof HTMLButtonElement&&Y.activeElement.type==="submit"&&!!o.querySelector(`#${Y.activeElement.id}`);Zl(o,{actionType:Io.OTHER,behavior:ho.SEARCH,content:{event:"uhf-search",value:r,submitButton:i}})}he.addEventListener("submit",e,{passive:!0,capture:!0})}function GV(){function e(t){t.isTrusted&&t.keyCode===70&&t.ctrlKey&&!t.shiftKey&&!t.altKey&&!t.metaKey&&Po({actionType:Io.OTHER,behavior:ho.OTHER,content:{event:"ctrl-f"}})}he.addEventListener("keydown",e,{passive:!0})}function VV(){function e(t){let o={referrerUri:t.referrerUrl.href,requestUri:t.url.href,title:t.title,pageName:te("document_id")||"missing document_id",pageType:te("page_type"),pageTags:{}};Mh(o.pageTags),RU(o),uT()}wn.subscribe(_a,e)}var _H=new Array(100).fill(0).map((e,t)=>({id:`team${t+1}`,name:`Team ${t+1}`,imageUrl:"",hasMembers:!!(t%3)})),vH=({teamAssignmentMethod:e=29,teamList:t=_H,type:o="teams"}={teamAssignmentMethod:29,teamList:_H,type:"teams"})=>o==="teams"?{type:o,teamAssignmentMethod:e,teamList:t}:{type:"solo"},jV=({title:e="Walmart, Azure Fundamentals Team",description:t="Learn all about Azure cloud services while you compete with your team. Every module you complete earns your team entries for a chance to win prizes and sweepstakes that include (......). Complete additional learning to get more sweepstakes entries, which will be awarded as you go.",start:o="2021-06-09T07:00:00Z",end:n="2021-09-30T07:00:00Z",type:r="xp",eventRulesUrl:i="sample/link",isEnrolled:a=!1,enrollment:s=vH({type:"teams",teamAssignmentMethod:2}),challengeCollectionId:c=[""],hasTeamIndividualRank:l=!0,maxTeamMembers:u=12,allowPreRegistration:p=!0}={title:"Walmart, Azure Fundamentals Team",description:"Learn all about Azure cloud services while you compete with your team. Every module you complete earns your team entries for a chance to win prizes and sweepstakes that include (......). Complete additional learning to get more sweepstakes entries, which will be awarded as you go.",start:"2021-06-09T07:00:00Z",end:"2021-09-30T07:00:00Z",type:"xp",eventRulesUrl:"sample/link",isEnrolled:!1,enrollment:vH({type:"teams",teamAssignmentMethod:2}),challengeCollectionId:[""],hasTeamIndividualRank:!0,maxTeamMembers:12,allowPreRegistration:!0})=>r==="xp"?{title:e,description:t,start:o,end:n,type:r,eventRulesUrl:i,isEnrolled:a,enrollment:s,hasTeamIndividualRank:l,maxTeamMembers:u,allowPreRegistration:p}:{title:e,description:t,start:o,end:n,type:r,eventRulesUrl:i,isEnrolled:a,enrollment:s,challengeCollectionId:c,hasTeamIndividualRank:l,maxTeamMembers:u,allowPreRegistration:p};var bH=(e=jV())=>Promise.resolve(e);var WV=500;async function xH(e=!0,t=0,o=WV){let n={method:"GET",headers:{"Content-Type":"application/json"}},r=we(`${re.learn.challenge}/profile?${Le({includePast:e,$skip:t?t.toString():null,$top:o?o.toString():null})}`,n),i=await J(r);if(ce(i),i.ok){let a=await i.json();return a.currentChallenges=a.currentChallenges||[],a.upcomingChallenges=a.upcomingChallenges||[],a.pastChallenges=a.pastChallenges||[],KV(a.pastChallenges),a}throw new Error(`challenge profile api responded with ${i.status} ${i.statusText}`)}async function KV(e){e.sort((t,o)=>{if(!t)return 1;if(!o)return-1;let n=new Date(t.end);return new Date(o.end).getTime()-n.getTime()})}async function yH(e){if(C.reviewFeatures&&e==="mockChallenge")return bH();let t={method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}},o=we(`${re.learn.challenge}/${e}`,t),n=await J(o);ce(n);let r;if(n.ok)return r=await n.json(),QV(r);throw new Error(`challenge api responded with ${n.status} ${n.statusText}`)}function QV(e){let t=e.type;if(t===1||t===2)return e.type="collection",e.visibility="public",qw(e,t);if(t===3||t===4)return e.type="xp",e.visibility="public",qw(e,t);if(t===5)return e.type="collection",e.visibility="private",qw(e,t);throw new Error(`Unsupported collection type: ${t}`)}function qw(e,t){let o;return t===1||t===3?(o={type:"teams",teamAssignmentMethod:e.teamAssignmentMethod,teamList:e.teamList},delete e.teamAssignmentMethod,delete e.teamList):o={type:"solo"},e.enrollment=o,e}function XV(){let t={iPhone:"ios",iPad:"ios",iPod:"ios",Macintosh:"macos",MacIntel:"macos",MacPPC:"macos",Mac68K:"macos",Win32:"windows",Win64:"windows",Windows:"windows",WinCE:"windows"}[navigator.platform];return t!==void 0?t:/Android/.test(navigator.userAgent)?"android":/Linux/.test(navigator.platform)?"linux":null}function JV(e){return/^(?:android|ios|linux|macos|windows)$/.test(e)}var Rb=ZV();function ZV(){let e=!1,t=navigator.userAgent||navigator.vendor,o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,n=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;return(o.test(t)||n.test(t.substr(0,4)))&&(e=!0),e}var NSe=XV(),e5="preferred-platform";function t5(){let e=nt.getItem(e5);return e!==null&&JV(e)?e:null}var DSe=t5();function TH(e){return d`
		<div
			id="contextual-data"
			class="box is-full-height padding-lg has-text-docs-invert has-background-docs has-background-image-right-bottom"
			style="
			background-image: url(${Rb?"/en-us/media/profile/csc-bg-image-mobile.svg?branch=main":"/en-us/media/profile/csc-bg-image.svg?branch=main"});"
		>
			<p
				class="supertitle font-size-xs letter-spacing-wide is-uppercase is-spaced margin-bottom-xxs"
			>
				${PR}
			</p>
			<h2 class="title is-2 is-responsive has-line-height-reset">${e.name}</h2>
			<p class="margin-top-xs margin-bottom-lg-desktop margin-bottom-none">${e.description}</p>
		</div>
	`}function SH(){return d`
		<div
			id="contextual-data"
			class="box is-full-height padding-lg has-text-docs-invert has-background-docs has-background-image-right-bottom"
			style="
			background-image: url(${Rb?"/en-us/media/profile/event-bg-image-mobile.svg?branch=main":"/en-us/media/profile/event-bg-image.svg?branch=main"});"
		>
			<h2 class="font-size-h3 is-responsive has-line-height-reset">
				${e0}
			</h2>
			<h2 class="font-size-h3 is-responsive has-line-height-reset">
				${sh}
			</h2>
			<p class="font-size-sm margin-top-xs margin-bottom-lg-desktop margin-bottom-none">
				${BM}
			</p>
		</div>
	`}function EH(){return d`
		<div
			id="contextual-data"
			class="box is-full-height padding-lg has-text-docs-invert has-background-docs has-background-image-right-bottom"
			style="
			background-image: url(${Rb?"/en-us/media/profile/event-bg-image-mobile.svg?branch=main":"/en-us/media/profile/event-bg-image.svg?branch=main"});"
		>
			<h2 class="font-size-h3 is-responsive has-line-height-reset">
				${zM}
			</h2>
			<p class="font-size-sm margin-top-xs margin-bottom-none">
				${YM}
			</p>
			<p class="font-size-sm margin-top-xs margin-bottom-lg-desktop margin-bottom-none">
				${ie(GM)}
			</p>
		</div>
	`}var wH=it(),Ud=null;function CH(){Ud=ci.getProfileContext(wH.redirectUrl)}var kH=async()=>{let e=ci.getProfileContext(wH.redirectUrl).redirectUrl;if(e.includes("/learn/challenges")){let r=new URL(e),i=it(r.search).id;if(i){let a=await yH(i);if(a)return{type:"csc",challengeId:i,challenge:a,redirectUrl:e}}}let t=new URL(e),o=it(t.search);if(o.context==="sso"){let r=o.source;return delete o.context,delete o.source,t.search=Le(o),{type:"sso",source:r,redirectUrl:t.toString()}}return o.tryIt?(delete o.tryIt,t.search=Le(o),{type:"try-it",redirectUrl:t.toString()}):{type:"none",redirectUrl:e}};function AH(e){return e.type==="csc"?TH({name:e.challenge.title,description:e.challenge.description,locationType:"",startDate:new Date(e.challenge.start),endDate:new Date(e.challenge.end)}):e.type==="try-it"||e.type==="sso"?SH():e.redirectUrl.indexOf("https://www.microsoft.com")!==-1&&e.redirectUrl.indexOf("/learning/dashboard.aspx")!==-1?EH():null}function IH({origin:e,protocol:t,hostname:o,port:n}){return e||(t&&o?`${t}//${o}${n&&n!=="443"&&n!=="80"?":"+n:""}`:location.origin)}function PH(e,{compareOrigin:t}={compareOrigin:!0}){let o=e.target instanceof HTMLElement&&e.target.closest("a"),n=!!o&&IH(o)===de.origin;return!o||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||o.target&&o.target!==window.name&&o.target!=="_self"||o.href.lastIndexOf("javascript:")===0||o.hasAttribute("download")?{anchor:o,shouldHandle:!1,differentOrigin:!n}:t&&!n||n&&o.classList.contains(Ec)||n&&/^#lightbox/.test(o.hash)||n&&!!o.closest("#docs-admin-editor .ProseMirror")||o.classList.contains("following-user-profile")?{anchor:o,shouldHandle:!1,differentOrigin:!n}:{anchor:o,shouldHandle:!0,differentOrigin:!n}}function RH(){let e=document.createElement("progress");return e.classList.add("is-full-width","position-fixed","top-0","left-0","right-0","margin-bottom-none","is-extra-small","progress"),e.setAttribute("max","100"),e.style.zIndex="10",document.body.insertAdjacentElement("afterbegin",e),e}var Bw=class{constructor(){this.referrerStack=[];this.finished=Promise.resolve();this.handleClick=t=>{let{shouldHandle:o,anchor:n}=PH(t);if(!o)return;let r=new URL(n.href);!this.delegate.canHandle(r)||(t.preventDefault(),this.preserveBranch(this.currentUrl,r),this.navigateInternal(r,!0))};this.handlePopstate=()=>{let t=new URL(de.href);this.routeChanged(t,this.currentUrl)?(this.referrerStack.pop(),this.navigateInternal(t,!1)):this.currentUrl=t};this.routeChanged=(t,o)=>{let n=t.pathname===o.pathname;for(let r of this.delegate.params)n=n&&t.searchParams.get(r)===o.searchParams.get(r);return!n}}enable(t,o=new URL(de.href)){this.delegate=t,this.currentUrl=o,he.addEventListener("click",this.handleClick,!0),he.addEventListener("popstate",this.handlePopstate)}disable(){this.delegate=null,he.removeEventListener("click",this.handleClick,!0),he.removeEventListener("popstate",this.handlePopstate)}get enabled(){return!!this.delegate}async finishNavigating(){await this.finished}goto(t,o){if(!this.delegate)throw new Error("Router is not enabled.");if(t.origin!==de.origin)throw new Error("Cross-origin navigation is not permitted");if(!this.delegate.canHandle(t))throw new Error(`Router delegate cannot handle "${t.href}".`);return this.preserveBranch(this.currentUrl,t),this.navigateInternal(t,o==="pushState")}preserveBranch(t,o){(C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online")&&NH(["branch","themebranch","api-branch"],t,o),NH(["preview"],t,o)}navigateInternal(t,o){let n=async()=>{l_.splice(0,l_.length).forEach(s=>s()),wn.publish(new rg(t));let i=RH(),a=await this.delegate.handle(t);Y.title=a.title,o?(Vs.pushState(void 0,a.title,a.url.href),this.referrerStack.push(a.url)):Vs.replaceState(void 0,a.title,a.url.href),he.scrollTo(0,0),Us(t.hash),wn.publish(new _a(a.title,a.url,this.currentUrl)),i.remove(),this.currentUrl=t},r=this.finished.then(n);return this.finished=r.catch(()=>{}),r}},$d=new Bw;function NH(e,t,o){for(let n of e){let r=t.searchParams.get(n);r&&o.searchParams.set(n,r)}}function Us(e){if(e.length<2)return;let t=Y.body.querySelector(e);!t||t.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"})}function DH(e,t=LH,o=n5){let n=Array.from(e.querySelectorAll(".tabs-container")),r=t();n.length||(n=Array.from(document.querySelectorAll("body"))),n.forEach(i=>{let a=Array.from(i.querySelectorAll(":scope > .tabs .tab-control")),s=Array.from(i.querySelectorAll(":scope > [data-tab-content]")),c=a.map(l=>l.id);a.forEach(l=>{typeof r=="string"?c.indexOf(r)!==-1&&Nb(r,l,s):c.indexOf(r[i.id])!==-1?Nb(r[i.id],l,s):c.indexOf(r.tab)!==-1?Nb(r.tab,l,s):Nb(a[0].id,l,s),l.onclick=()=>{o5(l.id,i),o(l.id,i.id||"tab")},l.onkeydown=u=>{let p=u.which;if(!u.altKey&&(p===jt.left||p===jt.right||p===jt.home||p===jt.end)){u.preventDefault();let m=p===jt.left||p===jt.home,f;if(u.ctrlKey||p===jt.home||p===jt.end){let h=m?1:-1;for(f=m?0:a.length-1;a[f].parentElement.getAttribute("hidden");)f+=h}else{let h=m?-1:1;f=a.findIndex(_=>_.id===l.id);do f+=h,f===-1?f=a.length-1:f===a.length&&(f=0);while(a[f].parentElement.getAttribute("hidden"))}a[f].focus();return}}})})}function o5(e,t){let o=t.querySelector(`#${e}`);if(o===null)return;let n=Array.from(t.querySelectorAll(":scope > .tabs .tab-control")),r=Array.from(t.querySelectorAll(":scope > [data-tab-content]"));n.forEach(i=>{i!==o&&(i.parentElement.classList.remove("is-active"),i.setAttribute("aria-selected","false"),i.setAttribute("tabindex","-1"))}),o.parentElement.classList.add("is-active"),o.setAttribute("aria-selected","true"),o.setAttribute("tabindex","0"),MH(o.getAttribute("aria-controls"),r)}function n5(e,t){t||(t="tab");let o=`{"${t}": "${e}"}`;oi(JSON.parse(o),"replaceState")}function LH(){let e=it();for(let t in e)t.slice(0,3)!=="tab"&&delete e[t];return e}function Nb(e,t,o){e===t.id?(t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0"),t.parentElement.classList.add("is-active"),MH(t.getAttribute("aria-controls"),o)):(t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1"),t.parentElement.classList.remove("is-active"))}function MH(e,t){t.forEach(o=>{o.dataset.tabContent===e?(o.hidden=!1,o.setAttribute("aria-hidden","false")):(o.hidden=!0,o.setAttribute("aria-hidden","true"))})}var r5=["jpeg","jpg","png","gif"],i5=1024*1024*5;function OH(e){let t=[];return Array.from(e).forEach(o=>{(o.type.split("/")[0]!=="image"||r5.indexOf(o.type.split("/")[1])===-1)&&t.push(DD.replace("{fileName}",o.name)),o.size>=i5&&t.push(LD.replace("{fileName}",o.name))}),t}var a5={avatarUpdateAllowableLimitsExceeded:YL,somethingWentWrong:Vg},zd=!1;function $H(e){return d` <div
		class="modal-card modal-completed fill-mobile"
		aria-labelledby="change-avatar"
		data-bi-name="change-avatar"
	>
		<div class="modal-card-content">
			<div class="modal-card-head padding-bottom-none">
				<h1 id="change-avatar" class="font-size-h5 margin-none">${Wk}</h1>
			</div>
			<form id="edit-profile-avatar-form">
				<section class="modal-card-body justify-content-center padding-bottom-none">
					<div class="columns margin-none padding-none">
						<div class="column is-full is-one-third-tablet padding-none">
							<figure
								class="image is-128x128 is-center-aligned padding-block-none margin-inline-none-tablet"
							>
								<img
									id="avatar-preview-image"
									class="avatar-url is-square has-background-grey-light border-radius-rounded"
									role="presentation"
									src="${e.avatarUrl||At}"
									aria-hidden="true"
								/>
							</figure>
						</div>
						<div class="column is-full is-two-thirds-tablet padding-none">
							<input
								hidden
								name="file"
								type="file"
								id="profile-avatar"
								data-profile-property="avatarImageBytes"
								accept=".jpeg, .jpg, .png, .gif"
							/>
							<div class="buttons buttons-centered margin-top-xxs">
								<button
									name="upload-image-button"
									id="upload-image-button"
									class="button button-clear"
									type="button"
								>
									<span class="icon">
										<span class="docon docon-upload font-size-h5" aria-hidden="true"></span>
									</span>
									<span>${MO}</span>
								</button>
								<button
									name="delete-image-button"
									id="delete-image-button"
									class="button button-clear"
									type="button"
									?disabled=${!e.avatarUrl||e.avatarUrl.indexOf("data:")===0}
								>
									<span class="icon">
										<span class="docon docon-delete font-size-h5" aria-hidden="true"></span>
									</span>
									<span>${rI}</span>
								</button>
							</div>
							<div hidden id="avatar-validation"></div>
						</div>
					</div>
				</section>
				<div class="modal-card-foot buttons">
					<button
						disabled="disabled"
						name="submit-button"
						id="submit-button"
						class="button is-12 button-primary button-filled is-fullwidth-mobile font-size-md padding-inline-lg"
						name="submit-button"
						type="submit"
					>
						${Bt}
					</button>
					<button
						name="cancel-button"
						id="cancel-button"
						class="button is-12 is-fullwidth-mobile font-size-md padding-inline-sm"
						type="button"
					>
						${Je}
					</button>
				</div>
			</form>
		</div>
	</div>`}function zH(e,t,o){if(o===null)return null;let n=e.elements.namedItem("cancel-button"),r=e.elements.namedItem("submit-button"),i=e.elements.namedItem("upload-image-button"),a=e.elements.namedItem("delete-image-button"),s=e.elements.namedItem("file"),c=e.querySelector("#avatar-preview-image"),l=e.querySelector("#avatar-validation"),u=document.createElement("canvas"),p,m=!1;return s.addEventListener("change",f=>{let h=f.target,_=h.files[0],g=OH(h.files);if(p&&window.URL.revokeObjectURL(p),g.length){let E=g.map(O=>d`<p class="help help-danger">${O}</p>`);I(d`${E}`,l),l.hidden=!1,p=null,c.src=y.avatarUrl||At;return}else l.innerHTML="",l.hidden=!0;let v=new Image,x=window.URL.createObjectURL(_);v.src=x,v.onload=()=>{let E=u.getContext("2d");E.clearRect(0,0,u.width,u.height);let O=Math.min(v.naturalWidth,v.naturalHeight),k=(Math.max(v.naturalWidth,v.naturalHeight)-O)/2,P=v.naturalWidth>v.naturalHeight?k*-1:0,Te=v.naturalHeight>v.naturalWidth?k*-1:0;u.width=u.height=O,E.drawImage(v,P,Te,v.naturalWidth,v.naturalHeight),r.disabled=!1,c.src=p=u.toDataURL(),p&&window.URL.revokeObjectURL(x),m=!1,r.disabled=!1}}),i.addEventListener("click",()=>{s.click()}),a.addEventListener("click",()=>{r.disabled=!1,c.src=At,s.value=null,p&&window.URL.revokeObjectURL(p),m=!0}),n.addEventListener("click",()=>{r.disabled=!0,c.src=o.avatarUrl||At,s.value=null,p&&window.URL.revokeObjectURL(p),m=!1,t()}),zd=!1,e.onsubmit=async f=>{if(!zd){zd=!0,f.preventDefault();try{let h;if(m)h=await UH(r,o,m);else{let _=await s5(u,s.files[0].type);h=await UH(r,o,m,s.files[0].name,_)}h.hasError?(zd=!1,I(h.errors.map(_=>`<p class="help help-danger">${a5[_]||Vg}</p>`),l),l.hidden=!1):(p&&window.URL.revokeObjectURL(p),t())}catch{zd=!1,I(d`<p class="help help-danger">${Vg}</p>`,l),l.hidden=!1}}},e}async function UH(e,t,o=!1,n,r){e.classList.add("is-loading");try{if(o){let i=await P$();return i.hasError===!1&&(t.avatarUrl=null,t.avatarThumbnailUrl=null,y.readUserProfile(t)),i}else{let i=new FormData;i.append("file",r,n);let a=await I$(i);return a.hasError===!1&&y.readUserProfile(a.profile),a}}catch(i){throw i}finally{zd=!1,e.classList.remove("is-loading")}}function s5(e,t="image/png"){return HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value(n,r,i){let a=this;setTimeout(()=>{let s=atob(a.toDataURL(r,i).split(",")[1]),c=s.length,l=new Uint8Array(c);for(let u=0;u<c;u++)l[u]=s.charCodeAt(u);n(new Blob([l],{type:r||"image/png"}))})}}),new Promise(n=>{e.toBlob(r=>n(r),t)})}function Lf(e,t){let o=e.querySelector(`[data-label="${t}"]`);o!==null&&(o.hidden=!0)}function Kr(e){Array.from(e.querySelectorAll("[data-label]")).forEach(t=>{t.hidden=!0})}function st(e,t){let o=e.querySelector(`[data-label="${t}"]`);o!==null&&(o.hidden=!1)}var c5=/pageContext\.csrf\.setToken\('([a-f0-9-]+)'\)/,FH=/^preferences\[(\w+)\].enabled$/,HH=/^preferences\[(\w+)\].value$/,Yw="enableAllNotifications",qH="disableAllNotifications",BH="updateSettings";function YH(){return re.qnaSettings.replace("{username}",y.userName).replace("{qnaId}",y.qnaUserId.toString())}async function Gw(){let e=YH(),t={credentials:"include"},o=await fetch(e+"?_attempt=1",t);return o.url&&o.url.indexOf("/preferences.html")===-1&&(o=await fetch(e+"?_attempt=2",t)),GH(o)}async function GH(e){if(e.status!==200)throw new Error(`Fetching email settings responded with ${e.status}: ${e.statusText}`);let t=await e.text(),o=t.match(c5)[1],i=new DOMParser().parseFromString(t,"text/html").querySelector("#notificationsPanel form");if(!i)throw new Error("Unable to find notifications form.");let a=Array.from(i.elements),s=a.filter(_=>_.type==="checkbox"&&FH.test(_.name)),c=a.filter(_=>_ instanceof HTMLSelectElement&&HH.test(_.name)),l=a.find(_=>_.name===Yw),u=s.map(_=>({name:_.name.match(FH)[1],enabled:!!_.checked,value:"direct-mail"}));for(let _ of c){let g=_.getAttribute("name").match(HH)[1],v=u.find(x=>x.name===g);v.value=_.getAttribute("value")}let p=!!l&&l.type==="submit";u.push({name:qH,enabled:!p,value:"Disable my notifications"},{name:Yw,enabled:p,value:"Enable my notifications"},{name:BH,enabled:!1,value:""});let m=Object.create(null),f=Object.create(null),h=`export interface QnAEmailSettings {
`;for(let _ of u){let g=_.name;m[g]=_,f[g]=_.value,_.enabled&&(f[g]=_.enabled),h+=`	${g}: '${_.value}';
`}return h+=`}
`,{model:m,csrf:o,schema:f}}function l5(e,t){let o=Object.keys(e),n=Object.keys(t);if(n.length!==o.length)throw new Error("Expected model and schema to have the same number of properties");for(let r of n)if(!e[r]||!o.includes(r))throw new Error(`Expected ${r} to be defined and one of ${t[r]}`)}async function VH({model:e,schema:t}){l5(e,t);let o={};o._csrf=(await Gw()).csrf,o.tab="notify",Object.values(e).forEach(r=>{switch(r.name){case qH:r.enabled&&(o.disableAllNotifications="true",o.enableAllNotifications="Enable my notifications");break;case Yw:r.enabled&&(o.disableAllNotifications="Disable my notifications");break;case BH:r.enabled&&(o.updateSettings=r.value);break;default:o[`preferences[${r.name}].value`]=r.value,r.enabled&&(o[`preferences[${r.name}].enabled`]=`${r.enabled.toString()}`);break}});let n=await fetch(YH(),{method:"POST",credentials:"include",redirect:"follow",body:new URLSearchParams(o)});return GH(n)}var Qr,Db,uo,WH,fl=!1,fa,Of=!1,Mf=!1;async function KH(e,t){Qr=e.querySelector("#manage-qa-email-preferences-form"),Fd(!!t.email);let o=await Gw();await QH(o)}async function QH(e){Db=e,uo=Db.model,WH=JH(uo),fa=await XH(),Of=!1,fl=!1,Lb()}function Fd(e){let t=document.getElementById("manage-qa-email-preferences-form"),o=Array.from(document.querySelectorAll('li > a[href="#manage-qa-email-preferences-form"]'));e?(t.classList.remove("is-hidden"),o.forEach(n=>{n.parentElement.classList.remove("is-hidden")})):(t.classList.add("is-hidden"),o.forEach(n=>{n.parentElement.classList.add("is-hidden")})),Mf=e}async function XH(){return Mf?uo.disableAllNotifications.enabled:(uo.disableAllNotifications.enabled&&(fl=!0,fa=!1,Of=!0,await gl(Qr)),!1)}function Lb(){I(u5(uo),Qr),Array.from(Qr.querySelectorAll("input")).forEach(o=>{o.onchange=jH}),Array.from(Qr.querySelectorAll("select")).forEach(o=>{o.onchange=jH}),Qr.onsubmit=async o=>{o.preventDefault(),await gl(Qr)}}function u5(e){return d`
	<div class="padding-xs">
		<h2 id="qna-email" class="title is-3">
			${Gl}
		</h2>
		<div class="columns margin-top-sm">
			<div class="column" id="desc_qaAllEmailOn">
				<div class="font-size-sm font-weight-semibold">
					${o0}
				</div>
				<p>${n0}</p>
			</div>
			<div class="column">
				<div class="checkbox-toggle-container">
					<div class="checkbox-toggle-wrapper">
						<input type="checkbox"
						aria-describedby="desc_qaAllEmailOn"
						id="qaAllEmailOn"
						.checked="${fa}">
						<label class="switch" for="qaAllEmailOn"></label>
					</div>
				</div>
			</div>
		</div>
		<div id="qa_options" ?hidden="${!fa}">
			<div class="columns">
				<div class="column">
					<label for="userFollowsYou">
						<div class="font-size-sm font-weight-semibold">
							${C0}
						</div>
						<p>${k0}</p>
					</label>
				</div>
				<div class="column">
					${ma(e.userFollowsYou,"userFollowsYou")}
				</div>
			</div>
			<div class="columns">
				<div class="column" id="desc_qa_mentions">
					<div class="font-size-sm font-weight-semibold">
						${E0}
					</div>
					<p>${w0}</p>
				</div>
				<div class="column">
					<div class="checkbox-toggle-container">
						<div class="checkbox-toggle-wrapper">
							<input type="checkbox"
							aria-describedby="desc_qa_mentions"
							id="qa_mentions"
							data-qa-property="usernameNotation"
							.checked="${e.usernameNotation.enabled}">
							<label for="qa_mentions" class="switch"></label>
						</div>
					</div>
				</div>
			</div>
			${d5(e)}
			<div class="columns">
				<div class="column" id="desc_qa_unansweredQuestions">
					<div class="font-size-sm font-weight-semibold">
						${P0}
					</div>
					<p>${R0}</p>
				</div>
				<div class="column">
					<div class="checkbox-toggle-container">
						<div class="checkbox-toggle-wrapper">
							<input type="checkbox"
							aria-describedby="desc_qa_unansweredQuestions"
							id="qa_unansweredQuestions"
							data-qa-property="modDailyDigest"
							.checked="${e.modDailyDigest.enabled}">
							<label for="qa_unansweredQuestions" class="switch"></label>
						</div>
					</div>
				</div>
			</div>
			<hr class="hr">
			<h2 id="qna-email-tags" class="title is-3">
				${r0}
			</h2>
			<div class="columns margin-bottom-none">
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox" ?checked="${e.autoQuestionsIPost.enabled}" data-qa-property="autoQuestionsIPost">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${i0}</span>
					</label>
				</div>
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox"  ?checked="${e.autoIdeasIPost.enabled}" data-qa-property="autoIdeasIPost">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${l0}</span>
					</label>
				</div>
			</div>
			<div class="columns margin-bottom-none">
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox"  ?checked="${e.autoQuestionsIAnswer.enabled}" data-qa-property="autoQuestionsIAnswer">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${a0}</span>
					</label>
				</div>
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox"  ?checked="${e.autoIdeasIComment.enabled}" data-qa-property="autoIdeasIComment">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${u0}</span>
					</label>
				</div>
			</div>
			<div class="columns margin-bottom-none">
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox" ?checked="${e.autoQuestionsIComment.enabled}" data-qa-property="autoQuestionsIComment">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${s0}</span>
					</label>
				</div>
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox" ?checked="${e.autoIdeasInTopicsIFollow.enabled}" data-qa-property="autoIdeasInTopicsIFollow">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${d0}</span>
					</label>
				</div>
			</div>
			<div class="columns margin-bottom-none">
				<div class="column">
					<label class="checkbox font-size-sm font-weight-semibold">
						<input type="checkbox" ?checked="${e.autoQuestionsInTopicsIFollow.enabled}" data-qa-property="autoQuestionsInTopicsIFollow">
						<span class="checkbox-check" role="presentation"></span>
						<span class="checkbox-text">${c0}</span>
					</label>
				</div>
			</div>
			<hr class="hr">
			<h2 class="title is-3">
				${p0}
			</h2>
			<div class="columns margin-top-sm">
				<div class="column">
					<label for="followNewQuestion">
						<div class="font-size-sm font-weight-semibold">
							${m0}
						</div>
					<label>
				</div>
				<div class="column">
				${ma(e.followNewQuestion,"followNewQuestion")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followQuestionEdited">
						<div class="font-size-sm font-weight-semibold">
							${f0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followQuestionEdited,"followQuestionEdited")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followNewAnswer">
						<div class="font-size-sm font-weight-semibold">
							${g0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followNewAnswer,"followNewAnswer")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followAnswerAccepted">
						<div class="font-size-sm font-weight-semibold">
							${h0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followAnswerAccepted,"followAnswerAccepted")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followNewComment">
						<div class="font-size-sm font-weight-semibold">
							${_0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followNewComment,"followNewComment")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followNewIdea">
						<div class="font-size-sm font-weight-semibold">
							${v0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followNewIdea,"followNewIdea")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followNewIdeaComment">
						<div class="font-size-sm font-weight-semibold">
							${b0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followNewIdeaComment,"followNewIdeaComment")}
				</div>
			</div>
			<div class="columns">
				<div class="column">
					<label for="followNewKbEntry">
						<div class="font-size-sm font-weight-semibold">
							${x0}
						</div>
					</label>
				</div>
				<div class="column">
				${ma(e.followNewKbEntry,"followNewKbEntry")}
				</div>
			</div>
		</div>
		<div class="margin-top-sm margin-bottom-none columns is-mobile is-gapless">
			<div class="column is-narrow is-half-mobile">
				<div class="margin-right-xxs">
					<button type="submit"
						class="button margin-bottom-none is-fullwidth-mobile button-primary button-filled padding-inline-lg-tablet"
						id="submit-qa-button"
						data-bi-name="save_qa"
						?disabled="${!fl}">${Bt}
					</button>
				</div>
			</div>
			<div class="column is-narrow is-half-mobile">
				<button
					class="button margin-bottom-none is-fullwidth-mobile padding-inline-lg-tablet"
					id="cancel-qa-button"
					?disabled="${!fl}"
					@click=${p5}>${Je}
				</button>
			</div>
		</div>
		<p hidden data-label="saveSuccessful" class="help help-success">${ec}</p>
		<p hidden data-label="somethingWentWrong" class="help help-danger">${go}</p>
	</div>
	<input type="hidden" id="followNewIdeaStatus" data-qa-property="followNewIdeaStatus" value="">
	`}function ma(e,t){return d`
		<div class="select">
			<select id="${t}" data-qa-property="${t}">
				<option value="" ?selected=${!e.enabled}>${pP}</option>
				<option
					value=${"direct-mail"}
					?selected=${e.enabled&&e.value==="direct-mail"}
				>
					${EI}
				</option>
				<option
					value=${"daily-mail"}
					?selected=${e.enabled&&e.value==="daily-mail"}
				>
					${tI}
				</option>
				<option
					value=${"weekly-mail"}
					?selected=${e.enabled&&e.value==="weekly-mail"}
				>
					${qO}
				</option>
			</select>
		</div>
	`}function d5(e){return e.newItemInModeration?d`
			<div class="columns">
				<div class="column" id="desc_qa_newPostModeration">
					<div class="font-size-sm font-weight-semibold">
						${A0}
					</div>
					<p>${I0}</p>
				</div>
				<div class="column">
					<div class="checkbox-toggle-container">
						<div class="checkbox-toggle-wrapper">
							<input
								type="checkbox"
								aria-describedby="desc_qa_newPostModeration"
								id="qa_newPostModeration"
								data-qa-property="newItemInModeration"
								.checked="${e.newItemInModeration.enabled}"
							/>
							<label for="qa_newPostModeration" class="switch"></label>
						</div>
					</div>
				</div>
			</div>
		`:d``}async function jH(e){fl=!0,e.target.id==="qaAllEmailOn"&&(fa=!fa,Of=!0,await gl(Qr)),Lb()}async function p5(){fl=!1,uo=JH(WH),fa=await XH(),m5(),Lb()}async function gl(e,t="saveSuccessful",o="somethingWentWrong"){if(uo===void 0)return;let n=fl,r=Qr.querySelector("#submit-qa-button");if(Mf&&r?.classList.add("is-loading"),Of)uo.disableAllNotifications.enabled=fa,uo.enableAllNotifications.enabled=!fa;else{uo.updateSettings.enabled=!Of,uo.enableAllNotifications.enabled=!1,uo.disableAllNotifications.enabled=!1;for(let i of Array.from(Qr)){let a=i.getAttribute("data-qa-property");i.id!=="qaAllEmailOn"&&(i instanceof HTMLInputElement?i.type==="checkbox"?uo[a].enabled=i.checked:uo[a].value="direct-mail":i instanceof HTMLSelectElement&&(i.value===""?(uo[a].enabled=!1,uo[a].value="direct-mail"):(uo[a].enabled=!0,uo[a].value=i.value)))}}Db.model=uo;try{let i=await VH(Db);await QH(i),Mf&&n&&st(e,t)}catch(i){throw Mf&&st(e,o),Lb(),new Error(`Q and A preferences failed: ${i.message}`)}finally{r?.classList.remove("is-loading")}}function m5(){I(d``,Qr)}function JH(e){return JSON.parse(JSON.stringify(e))}var Mb=!1,Gn,f5=async()=>await gl(Gn),$s;function Vw(e,t){if(t===null)return null;Gn=e.querySelector("#edit-info-form"),cc(Gn,t);let o=Gn.elements.namedItem("submit-button");if(!$s){let n=document.createElement("div");$s=new Ge(n)}if(Gn.elements.namedItem("profile-update-avatar-button")){Gn.querySelector("#profile-update-avatar-section").hidden=!1;let n=Array.from(document.querySelectorAll("button.profile-update-avatar-button"));n.length||n.push(Gn.elements.namedItem("profile-update-avatar-button")),n.forEach(r=>{r.hidden=!1,r.addEventListener("click",()=>jw())})}return Yi(Gn),Mb=!1,Gn.onsubmit=async n=>{n.preventDefault();let r=await Sa(e);t.email&&t.email.length>0&&(r.email=t.email,r.locale=t.locale,r.country=t.country,r.contactPointTopicSetting=t.contactPointTopicSetting),!Mb&&(Mb=!0,await g5(o,r,t.userName,t.qnaUserId))},o}function jw(){!$s||(I($H(y),$s.contentElement),zH($s.contentElement.querySelector("form"),$s.hide.bind($s),y),$s.show())}async function g5(e,t,o,n){e.classList.add("is-loading"),Kr(Gn);try{let r=await Uo(o,t);await f5(),r.hasError===!0?r.errors.forEach(i=>{st(Gn,i)}):(st(Gn,"saveSuccessful"),r.profile.qnaUserId=n,y.readUserProfile(r.profile),cc(Gn,y),o!==t.userName&&(location.href=Ut(y.userName)))}catch(r){throw new Error(`error: ${r.message}`)}finally{Mb=!1,e.classList.remove("is-loading")}}var eq=C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online"?"qs":"path";function tq(){return d` <form id="edit-info-form" class="box" action="javascript:">
		<div class="padding-xs">
			${ZH(!0)}
			<h2 id="info" class="title is-3">${oh}</h2>
			<div class="columns is-gapless">
				<div class="column">
					<div>
						<label for="user-name" class="font-weight-semibold">
							${O0}
						</label>
					</div>
					<div
						class="field margin-bottom-none columns is-mobile margin-top-xxs is-multiline align-items-center"
					>
						<label
							class="server-path font-size-sm font-weight-semibold padding-right-xxs has-text-subtle column is-narrow is-full-mobile padding-bottom-none padding-bottom-xxs-tablet"
							>https://docs.microsoft.com/${w.data.userLocale}/users/</label
						>
						<div
							class="control column padding-left-none-tablet padding-bottom-xxs-tablet is-three-fifths-mobile is-one-quarter-tablet is-one-fifth-desktop"
						>
							<input
								type="text"
								data-profile-property="userName"
								id="user-name"
								name="user-name"
								class="input input-sm"
								value=""
								aria-describedby="user-name-info"
							/>
						</div>
					</div>
					<p class="font-size-sm has-text-subtle margin-top-none">
						${xM}
					</p>
					<p hidden data-label="userNameExists" class="help help-danger margin-top-none">
						${$y}
					</p>
					<p hidden data-label="userNameIsReserved" class="help help-danger margin-top-none">
						${$y}
					</p>
					<p hidden data-label="userNameIsInvalid" class="help help-danger margin-top-none">
						${wM}
					</p>
					<div class="margin-top-sm margin-top-lg-tablet margin-bottom-xs">
						<label for="display-name" class="font-weight-semibold">
							${xa}
							<span class="required-indicator" aria-hidden="true"></span>
						</label>
					</div>
					<input
						type="text"
						id="display-name"
						name="display-name"
						class="input width-auto"
						value=""
						data-profile-property="displayName"
					/>
					<p hidden data-label="displayNameIsInvalid" class="help help-danger">
						${_h.replace("{text}",xa)}
						${vh.replace("{minChars}","2").replace("{maxChars}","50")}
					</p>
					<p class="font-size-sm has-text-subtle margin-top-none">
						${EM}
					</p>
				</div>
				${ZH(!1)}
			</div>
			<nav class="margin-top-sm">
				<button
					type="submit"
					class="button button-primary button-filled is-fullwidth-mobile padding-inline-lg"
					name="submit-button"
					data-bi-name="save"
				>
					${Bt}
				</button>
			</nav>
			<p hidden data-label="saveSuccessful" class="help help-success">${ec}</p>
			<p hidden data-label="somethingWentWrong" class="help help-danger">
				${go}
			</p>
		</div>
	</form>`}function oq(){return d`<form id="account-linking" class="box"></form>`}function nq(){return d`<form id="manage-account-linked" class="box is-hidden"></form>`}function rq(){return d` <form id="manage-email-preferences-form" class="box">
		<div class="padding-xs">
			<h2 id="email" class="title is-3">${Xs}</h2>
		</div>
	</form>`}function iq(){return d` <form id="manage-qa-email-preferences-form" class="box" action="javascript:">
		<div class="padding-xs">
			<h2 id="qna-email" class="title is-3">${Gl}</h2>
			<div class="skeleton margin-bottom-sm">${Ni}</div>
			<div class="skeleton margin-bottom-sm">${Ni}</div>
			<div class="skeleton margin-bottom-sm">${Ni}</div>
			<div class="skeleton margin-bottom-sm">${Ni}</div>
			<div id="qna-email-tags" name="qna-email-tags" class="skeleton">${Ni}</div>
		</div>
	</form>`}function aq(){return d` <form id="download-data-form" class="box">
		<div class="padding-xs">
			<h2 id="download" class="title is-3 margin-top-none margin-bottom-sm">
				${th}
			</h2>
			<p class="font-size-md">${U0}</p>
			<nav class="margin-top-sm">
				<button
					type="button"
					id="download-data"
					class="button button-primary button-filled is-fullwidth-mobile padding-inline-lg"
					data-bi-name="download"
				>
					${iI}
				</button>
			</nav>
			<p
				hidden
				data-label="somethingWentWrong"
				class="help help-danger display-flex justify-content-flex-end"
			>
				${go}
			</p>
		</div>
	</form>`}function sq(){return d` <form id="delete-profile-form" class="box">
		<div class="padding-xs">
			<h2 id="delete-account" class="title is-3 margin-top-none margin-bottom-sm">
				${eh}
			</h2>
			<p class="font-size-md">${TM}</p>
			<nav class="margin-top-sm">
				<button
					type="submit"
					class="button button-danger is-fullwidth-mobile padding-inline-lg"
					id="delete-account-button"
					data-bi-name="delete-account"
				>
					${SM}
				</button>
			</nav>
			<p
				hidden
				data-label="somethingWentWrong"
				class="help help-danger display-flex justify-content-flex-end"
			>
				${go}
			</p>
		</div>
	</form>`}function ZH(e){return d`
		<div
			class="column has-text-centered ${e?"is-hidden-tablet":"is-5-desktop is-3-tablet is-hidden-mobile"}"
		>
			<figure class="image is-max-112x112 is-center-aligned padding-block-none margin-top-xxs">
				<img
					class="avatar-url has-background-grey-light border-radius-rounded"
					role="presentation"
					src="${At}"
				/>
			</figure>
			<button
				type="button"
				@click="${jw}"
				class="button button-clear button-primary font-weight-semibold margin-top-xxs"
			>
				${bM}
			</button>
			${e?ie('<hr class="hr" />'):""}
		</div>
	`}function cq(e,t,o){Array.from(e.querySelectorAll(".report-abuse")).forEach(r=>{r.onclick=()=>{D$({userName:t,displayName:o}).then(()=>!0,()=>!1).then(a=>{a&&h5()})}})}function Hd(){if(C.supportLevel==="production"&&!C.reviewFeatures){let[,,,e]=de.pathname.split("/");return e}return it().username}function h5(){let e=document.createElement("div");I(d`
			<div class="modal-card">
				<div class="modal-card-head padding-xxs">
					<button
						class="modal-close modal-card-close-button is-large"
						data-bi-name="close"
						aria-label="${ze}"
					></button>
				</div>
				<section class="modal-card-body">
					<h2 class="is-text-centered">${RD}</h2>
					<p>${pN}</p>
					<div class="display-flex justify-content-center margin-top-lg margin-bottom-xs">
						<button
							type="button"
							class="button button-primary button-filled modal-close"
							id="response-ok"
							data-autofocus
						>
							${kn}
						</button>
					</div>
				</section>
			</div>
		`,e),new Ge(e).show()}var lq={achievements:[],totalPoints:0,level:{levelNumber:0,pointsHigh:0,pointsLow:0},nextLevelNumber:0,pointsToNextLevel:999999,currentLevelPointsEarned:0},Uf={getStatus(e){let t=`${re.gameStatus}/${e}`;return J(we(t,{mode:"cors"},!0)).then(ce).then(n=>{if(n.ok)return n.json();throw new Gi(n)})},redeemCode(e){let t={mode:"cors",method:"post",credentials:"include"},o=`${re.gameStatus}/redeem/${e}`,n={branch:C.supportLevel==="production"?"main":void 0},r=`${o}?${Le(n,!1)}`,i=we(r,t,!0);return fetch(i,t).then(ce).then(a=>a.json())},requestCode(e,t,o){let n={achievementCategory:e,courseId:t,useCount:o},r=`${re.gameStatus}/code`,i={branch:C.supportLevel==="production"?"main":void 0},a=`${r}?${Le(i,!1)}`,s={mode:"cors",body:JSON.stringify(n),method:"put",credentials:"include"};return J(we(a,s,!0)).then(ce).then(c=>c.json())}};var _5=Y?.queryCommandSupported&&Y?.queryCommandSupported("copy");function Ww(e,t){if(!_5)return!1;let o=Y.createElement("textarea");o.setAttribute(Jl.name,zp(t)),o.textContent=e,o.classList.add("visually-hidden"),Y.body.appendChild(o),o.select();let n=!0;if(!navigator.clipboard)try{return Y.execCommand("copy")}catch{return!1}finally{Y.body.removeChild(o)}return navigator.clipboard.writeText(e).then(()=>{Y.body.removeChild(o)},()=>{Y.body.removeChild(o),n=!1}),n}function uq(e,t){return navigator.clipboard?navigator.clipboard.writeText(e).then(()=>!0,()=>!1):Promise.resolve(Ww(e,t))}var dq=Intl.DateTimeFormat().resolvedOptions().timeZone;function Vn(e){let t=Math.floor(e/60),o=e%60;return t===0?sP.replace("{numberOfMinutes}",o.toString()):o===0?`${t} ${yI}`:TI.replace("{numberOfHours}",t.toString()).replace("{numberOfMinutes}",o.toString())}var xwe=new Intl.DateTimeFormat(w.data.userLocale,{hour:"numeric",minute:"numeric"}),ywe=new Intl.DateTimeFormat(w.data.userLocale,{month:"long",day:"numeric"}),Twe=new Intl.DateTimeFormat(w.data.userLocale,{month:"short",day:"numeric"}),pq=new Intl.DateTimeFormat(w.data.userLocale,{month:"long",year:"numeric"}),Swe=new Intl.DateTimeFormat(w.data.userLocale,{day:"numeric"}),Ewe=new Intl.DateTimeFormat(w.data.userLocale,{month:"short"}),wwe=new Intl.DateTimeFormat(w.data.userLocale,{year:"numeric"}),tn=new Intl.DateTimeFormat(w.data.userLocale,{month:"long",day:"numeric",year:"numeric"}),Cwe=new Intl.DateTimeFormat(w.data.userLocale,{weekday:"long",month:"long",day:"numeric",year:"numeric"});function Kw(e=dq){return new Intl.DateTimeFormat(w.data.userLocale,{month:"long",day:"numeric",year:"numeric",timeZone:e})}function qd(e=dq){return new Intl.DateTimeFormat(w.data.userLocale,{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",timeZone:e})}function Qw(e){return Math.floor(e/1e3/60)}function Xw(e){return Math.floor(e/1e3/60/1440)}function Jw(e){let t="h",o="m",n="s",r=0,i=e.indexOf(t)!==-1,a=e.indexOf(o)!==-1,s=e.indexOf(n)!==-1;return r+=i?Number(e.substring(0,e.indexOf(t)))*3600:0,r+=a?i?Number(e.substring(e.indexOf(t)+1,e.indexOf(o)))*60:Number(e.substring(0,e.indexOf(o)))*60:0,r+=s?Number(a?e.substring(e.indexOf(o)+1,e.indexOf(n)):i?e.substring(e.indexOf(t)+1,e.indexOf(n)):e.substring(0,e.indexOf(n))):0,r}function Bd(e){let t=e.getTimezoneOffset()/60,o=t.toString();return o=Math.abs(t)<10?"0"+o:o,o=t<0?"-"+o:"+"+o,o+=":00",o}var v5=new Intl.NumberFormat(w.data.userLocale);function Xt(e){return v5.format(e)}var Iwe=new Intl.NumberFormat(w.data.userLocale,{notation:"compact",compactDisplay:"short"}),Pwe=new Intl.NumberFormat(w.data.userLocale,{maximumFractionDigits:0});function jn(e,t,o,n=!0,r=()=>!0){return d`
		${n?d`<h2 class="title is-5">${e.title}</h2>`:""}
		<div
			class="${o.cards?"":"box"} ${o.layoutStyle==="smallSpace"?"padding-none border-none margin-bottom-none":o.layoutStyle==="bigSpace"?"margin-bottom-none":"margin-bottom-xs"}"
		>
			${o.columns===0?x5(e,t,r):y5(o,e,t,r)}
		</div>
		${e.supportsPaging&&e.pageCount>1?b5(e,`justify-content-flex-start margin-top-sm ${o.layoutStyle==="bigSpace"?"margin-bottom-lg":"margin-bottom-sm"}`):""}
	`}function mq(e,t,{icon:o="delete",label:n=Zs}){return d` <button
		type="button"
		class="button  button-clear button-primary button-sm"
		aria-label="${n}"
		@click=${()=>e.remove(t)}
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-${o}"></span>
		</span>
	</button>`}function b5(e,t="is-centered margin-top-sm margin-bottom-xs"){if(!e.pageCount)return null;let o=Array.from({length:e.pageCount},(m,f)=>f),n=e.pageIndex,r=!1,i=1,a={first:0,last:o.length-1};o.length>=7&&(r=!0,n<3?(i=3,a.first=0,a.last=3):n>o.length-4?(i=3,a.first=o.length-4,a.last=a.first+i):(i=1,a={first:Math.max(e.pageIndex-i,0),last:Math.min(e.pageIndex+i,o.length-2)}));let s=d`
		<button
			type="button"
			class="pagination-link"
			aria-label="${$g}"
			@click=${()=>e.setPage(e.pageIndex-1)}
			?disabled=${e.busy}
			?hidden=${e.pageIndex===0}
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-arrow-left"></span>
			</span>
		</button>
	`,c=d`
		<button
			type="button"
			class="${e.pageIndex>=3&&r?"pagination-link":"is-hidden"}"
			?disabled=${e.busy}
			data-page="${o[1]}"
			aria-label="${Og.replace("{pageNumber}",String(o[1])).replace("{numberOfPages}",String(o.length))}"
			?aria-current="${$o(e.pageIndex===o.length&&o.length>7?"true":void 0)}"
			3
			@click=${()=>e.setPage(o[0])}
		>
			${o[1]}
		</button>
	`,l=d`
		<button
			type="button"
			class="pagination-link ${o.length>=7&&e.pageIndex<o.length-i?"pagination-next":"is-hidden"}"
			?disabled=${e.busy}
			data-page="${o.length}"
			aria-label="${Og.replace("{pageNumber}",String(o.length)).replace("{numberOfPages}",String(o.length))}"
			?aria-current="${$o(e.pageIndex===o.length||o.length>7?"true":void 0)}"
			@click=${()=>e.setPage(o.length-1)}
		>
			${o.length}
		</button>
	`,u=d` <button
		type="button"
		class="pagination-next"
		aria-label="${Tr}"
		@click=${()=>e.setPage(e.pageIndex+1)}
		?disabled=${e.busy}
		?hidden=${e.pageIndex===o.length-1}
	>
		<span class="icon" aria-hidden="true">
			<span class="docon docon-arrow-right"> </span>
		</span>
	</button>`,p=[];for(let m=a.first;m<=a.last;m++)p.push(d`
			<li>
				<button
					type="button"
					class="pagination-link ${e.pageIndex===m?"is-current":""}"
					?disabled=${e.busy}
					data-page="${m+1}"
					aria-label="${Og.replace("{pageNumber}",String(m+1)).replace("{numberOfPages}",String(o.length))}"
					aria-current="${$o(e.pageIndex===m?"true":void 0)}"
					@click=${()=>e.setPage(m)}
				>
					${m+1}
				</button>
			</li>
		`);return d` <nav
		class="pagination ${t}"
		role="navigation"
		aria-label="${CP}"
	>
		<ul class="pagination-list">
			<li>${s}</li>
			<li>${c}</li>
			<li class="${r&&e.pageIndex>2?"":"is-hidden"}">
				<span>...</span>
			</li>
			${p}
			<li
				class="${r&&e.pageIndex<o.length-(i+1)?"":"is-hidden"}"
			>
				<span>...</span>
			</li>
			<li>${l}</li>
			<li>${u}</li>
		</ul>
	</nav>`}function x5(e,t,o=()=>!0){return d`
		<ol>
			${e.items.filter(o).map(n=>d` <li
						class="is-unstyled display-inline-block margin-bottom-xs margin-right-xs"
					>
						${t(n)}
					</li>`)}
		</ol>
	`}function y5(e,t,o,n=()=>!0){if(e.cards)return d`
			<ol class="columns is-multiline is-full-height" role="none">
				${t.items.filter(n).map(r=>d` <li class="column ${eC(e.columns)}" role="none">
						<div class="card is-full-height">${o(r)}</div>
					</li>`)}
			</ol>
		`;if(e.groupListItems){let r=c=>{let u=new Date(Date.now()-6048e5).getTime(),p=new Date(Date.now()-864e5*30).getTime(),m=c.datetime;return m.getTime()>=u?_p.replace("{numberOfDays}",Xt(7)):m.getTime()>=p?_p.replace("{numberOfDays}",Xt(30)):pq.format(m)},i=t.items.filter(n).reduce((c,l)=>{let u=r(l);return c[u]=c[u]||[],c[u].push(l),c},{}),a=Object.keys(i).sort((c,l)=>i[c][0].datetime>i[l][0].datetime?-1:i[c][0].datetime<i[l][0].datetime?1:0),s=c=>c===_p.replace("{numberOfDays}",Xt(7))?"past-7days-group":c===_p.replace("{numberOfDays}",Xt(30))?"past-30days-group":"per-month-group";return d`
			${a.map(c=>d`<section data-bi-name="${s(c)}">
					<h3 class="font-weight-semibold padding-xs has-background-secondary-light border-none">
						${c}
					</h3>
					<ol class="columns is-multiline is-full-height is-gapless" role="none">
						${i[c].map((l,u)=>d`
								<li class="column ${eC(e.columns)}" role="none">
									<div
										class="${Zw(e,u,t,n)?`border-bottom ${e.layoutStyle==="smallSpace"?"":"margin-bottom-lg"}`:""}"
									>
										<div
											class="columns is-mobile is-centered is-vertically-centered ${Zw(e,u,t,n)?"":"margin-bottom-none"}"
										>
											<div class="column">${o(l)}</div>
											<div
												?hidden=${!(t.supportsRemove||t.supportsSharing)}
												class="column is-narrow"
											>
												<div class="columns is-gapless">
													<div class="column">
														${t.supportsSharing?t.shareTemplate(l):""}
													</div>
													<div class="column">
														${t.supportsRemove?mq(t,l,e.remove||{}):""}
													</div>
												</div>
											</div>
										</div>
									</div>
								</li>
							`)}
					</ol>
				</section>`)}
		`}return d`
		<ol class="columns is-multiline is-full-height is-gapless" role="none">
			${t.items.filter(n).map((r,i)=>d` <li class="column ${eC(e.columns)}" role="none">
					<div
						class="${Zw(e,i,t,n)?` border-bottom ${e.layoutStyle==="smallSpace"?"":"padding-bottom-xs margin-bottom-sm"}`:""}"
					>
						<div class="columns is-mobile is-centered is-vertically-centered">
							<div class="column">${o(r)}</div>
							<div ?hidden=${!(t.supportsRemove||t.supportsSharing)} class="column is-narrow">
								<div class="columns is-gapless">
									<div class="column">${t.supportsSharing?t.shareTemplate(r):""}</div>
									<div class="column">
										${t.supportsRemove?mq(t,r,e.remove||{}):""}
									</div>
								</div>
							</div>
						</div>
					</div>
				</li>`)}
		</ol>
	`}function Zw(e,t,o,n=()=>!0){return!e.cards&&e.columns===1&&t<o.items.filter(n).length-1}function eC(e){switch(e){case 1:return"is-12";case 2:return"is-6";case 3:return"is-6-tablet is-4-desktop";case 4:return"is-6-tablet is-3-desktop";default:return""}}var yt=class extends Ye{constructor(o){super();this.args=o;this._unexpectedError=0;this._items=[];this._pageIndex=0;this._pageCount=1;this._busy=!1}get pageSize(){return this.args.pageSize??10}get supportsRemove(){return!!this.args.remove}get supportsSharing(){return!!this.args.shareTemplate}get supportsPaging(){return!!this.args.paging}get title(){return this.args.title}get items(){return this._items}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}get busy(){return this._busy}get unexpectedError(){return this._unexpectedError}get shareTemplate(){return this.args.shareTemplate}beforeActivate(){return this.setPage(0)}async remove(o){if(!this.supportsRemove)throw new Error("Remove is not supported.");if(!this.busy){this.setBusy();try{let n=this.args.itemTitle?this.args.itemTitle(o):o.toString(),{submitted:r}=await pn(Ob(n));r&&(await this.args.remove(o),this._items=this._items.filter(i=>i!==o))}finally{this.setReady()}}}async setPage(o){if(o>0&&!this.supportsPaging)throw new Error("Paging is not supported.");if(this.busy)throw new Error("Busy");this.setBusy();try{let n=await this.args.load(o,this.pageSize),r=this.getPageCount(n.totalCount);o>=r&&(o=0,n=await this.args.load(o,this.pageSize),r=this.getPageCount(n.totalCount)),this._items=n.items,this._pageIndex=o,this._pageCount=r}finally{window.scrollTo(0,0),Us(window.location.hash),this.setReady()}}setBusy(){this._busy=!0,this.notifyPropertyChanged()}setReady(){this._busy=!1,this.notifyPropertyChanged()}notifyPropertyChanged(){this.publish(new Ae)}getPageCount(o){return Math.max(Math.ceil(o/this.pageSize),1)}};function Ob(e,t=mp,o=Np){return hu(ti,t.replace("{itemTitle}",e),o)}function fq(e=vg,t=Pl){return hu(TA,e,t)}function gq(e=Sg,t=Tg){return hu(Xk,e,t)}var tCe=new Ye;var oCe=d`
	<span
		id="level-status-text"
		class="font-size-xs has-text-wrap is-inline-truncated is-uppercase font-weight-semibold"
	></span>
	<span id="level-status-progress-container" class="hexagonal-progress">
		<progress
			id="level-status-progress"
			class="progress is-hidden-mobile display-inline-block position-relative is-success"
			value="1"
			max="100"
		>
			1%
		</progress>
		<span class="hexagonal-progress-marker"></span>
	</span>
	<span
		id="level-status-points"
		class="font-size-xs has-text-wrap is-inline-truncated is-uppercase"
	>
	</span>
`;function hq(e,t,o){let n=e-t,r=o/n;return Math.floor(r*100)}var Ot={async getExamAppointments(e=0,t=10){let o=`${re.certification.appointments}/?page=${e+1}&pageSize=${t}`,r=we(o,{method:"GET"}),i=await J(r);if(ce(i),i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async getCertifications(e=0,t=10){let o=`${re.certification.certifications}/?page=${e+1}&pageSize=${t}&isExtended=true`,r=we(o,{method:"GET"}),i=await J(r);if(ce(i),i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async getCertificationDetail(e){let t=`${re.certification.certifications}/?id=${e}`,n=we(t,{method:"GET"}),r=await J(n);if(ce(r),r.ok)return await r.json();throw new Error(`${r.status}: ${r.statusText}`)},async getDashboardSummary(){let e=re.certification.dashboardSummary,o=we(e,{method:"GET"}),n=await J(o);if(ce(n),n.ok)return await n.json();throw new Error(`${n.status}: ${n.statusText}`)},async getExams(e=0,t=10){let o=`${re.certification.exams}/?page=${e+1}&pageSize=${t}`,r=we(o,{method:"GET"}),i=await J(r);if(ce(i),i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async getLinkedMSA(){let e=re.certification.linkedMcId,o=we(e,{method:"GET"}),n=await J(o);if(ce(n),n.status===200)return{linkedMSA:await n.json(),status:n.status};if(n.status===400){let r=await n.json();return{errorCode:r.errorCode,linkedMSA:{mcId:r.message},status:n.status}}else{if(n.status===404||n.status===409||n.status===500)return{errorCode:(await n.json()).errorCode,status:n.status};throw new Error(`Unexpected response status ${n.status}`)}},async getPrintableCertification(e){let t=`${re.certification.printableCertification}/?id=${e}`,n=we(t,{method:"GET"}),r=await J(n);if(ce(r),r.ok)return await r.json();throw new Error(`${r.status}: ${r.statusText}`)},async getScoredSnapshots(e=0,t=10){let o=`${re.certification.renewalAssessments}/?page=${e+1}&pageSize=${t}&isExtended=true`,r=we(o,{method:"GET"}),i=await J(r);if(ce(i),i.ok)return await i.json();throw new Error(`${i.status}: ${i.statusText}`)},async postCertificationLink(){let e=re.certification.linkedAccount,o=we(e,{method:"POST"}),n=await J(o);if(ce(n),n.ok)return Wo(n,!1),{status:n.status};if(n.status===404||n.status===400||n.status===409||n.status===500)return{status:n.status};throw new Error(`Unexpected response status ${n.status}`)}};var T5=Di(),kCe=w.data.userLocale;function _q(e=!1){let t={modulesOnly:e},o=`${re.learn.progress.user}?${Le(t)}`;return J(we(o,{method:"GET"})).then(r=>ce(r)).then(r=>r.status===204?[]:r.ok?r.json():[])}async function vq(e,t){let o={method:"GET"},n=XO(e),r=[],i=n.map(async a=>{let s={locale:t,branch:T5,uids:a.join(";")},c=`${re.learn.achievementsByUids}?${Le(s)}`,l=we(c,o),u=await J(l);if(u.ok){let p=await u.json();r.push(...p)}});return await Promise.all(i),r.filter(a=>a!==null)}var bq="2.3.10.1",VCe=`/static/third-party/azure-media-player/${bq}/azuremediaplayer.min.js`,jCe=`/static/third-party/azure-media-player/${bq}/azuremediaplayer.min.css`;var Yd,xq;function E5(){let e=location.href,t="#time=";if(e.includes(t)){let o=e.substring(e.indexOf(t)+t.length);return Jw(o)}return Jw("0s")}function w5(){let e=Yd.paused(),t=E5();t>0&&t<xq/1e3?Yd.currentTime(t):Yd.currentTime(0),Yd.play(),e&&Yd.pause()}window.addEventListener("hashchange",()=>{Yd!==void 0&&w5()});var yq=/(^|\/)index$/i,tke=de.hostname==="localhost"&&w.environment===void 0;function Sq(e){let t=new URL(e,location.origin),o=decodeURIComponent(t.pathname).toLowerCase().replace(yq,"$1").replace(_u,"/"),n=t.searchParams.get("view");if(n&&(t.search="",t.searchParams.set("view",n),o+=t.search),o.indexOf("/learn/challenges")!==-1){let r=t.searchParams.get("id");t.search="",t.searchParams.set("id",r),o+=t.search}return o}function Tq(e){e.type!=="docs"&&e.type!=="qa"&&e.type!=="url"&&(e.type="docs"),e.type!=="url"&&(e.data.url=Sq(e.data.url))}function hl(e){e.items.forEach(Tq),e.sections?.forEach(t=>t.items?.forEach(Tq))}var Eo={baseUrl:re.lists,async getAllLists(){let e=we(this.baseUrl,{}),t=await J(e);if(ce(t),t.ok){let o=await t.json();return o.forEach(hl),o}throw new Error(`${t.status}: ${t.statusText}`)},async getAllListsByUrl(e){let t=[];e.forEach(i=>{t.push(Sq(i))});let o=JSON.stringify(t),n=we(this.baseUrl+"/by-url",{method:"POST",body:o}),r=await J(n);if(ce(r),r.ok)return await r.json();throw new Error(`${r.status}: ${r.statusText}`)},async getList(e){let t={locale:w.data.userLocale},o=`${this.baseUrl}/${e}?${Le(t)}`,n=we(o,{},!0),r=await J(n);if(ce(r),r.ok){let i=await r.json();return hl(i),i}if(r.status===404)return null;throw new Error(`${r.status}: ${r.statusText}`)},async getStudyGuideList(e,t,o=null){let n={locale:w.data.userLocale,branch:C.supportLevel==="production"&&C.reviewFeatures?o:null},r={credentials:C.supportLevel==="production"&&C.reviewFeatures?"include":null},i=`${this.baseUrl}/studyguide/${e}/${t}?${Le(n)}`,a=we(i,r,!0),s=await J(a);if(ce(s),s.ok){let c=await s.json();return hl(c),c}if(s.status===404)return null;throw new Error(`${s.status}: ${s.statusText}`)},async createList(e){let t=JSON.stringify(e),o=we(this.baseUrl,{method:"POST",body:t},!0),n=await J(o);if(ce(n),n.ok){let r=await n.json();return{hasError:!1,data:r}}if(n.status===400){let r=await n.json();return{hasError:!0,error:r}}throw new Error(`${n.status}: ${n.statusText}`)},async deleteList(e){let t=we(this.baseUrl+"/"+e,{method:"DELETE"},!0),o=await J(t);if(ce(o),!o.ok)throw new Error(`${o.status}: ${o.statusText}`)},async copyList(e,t,o){let n=JSON.stringify({name:t,description:o}),r=we(`${this.baseUrl}/copy/${e}`,{method:"POST",body:n},!0),i=await J(r);if(ce(i),i.ok){let a=await i.json();return hl(a),{hasError:!1,data:a}}if(i.status===400){let a=await i.json();return{hasError:!0,error:a}}throw new Error(`${i.status}: ${i.statusText}`)},async convertList(e){let t="true",o=we(`${this.baseUrl}/${e}/official`,{method:"PATCH",body:t},!0),n=await J(o);if(ce(n),n.ok){let r=await n.json();return hl(r),{hasError:!1,data:r}}if(n.status===400){let r=await n.json();return{hasError:!0,error:r}}throw new Error(`${n.status}: ${n.statusText}`)},async updateListMetadata(e,t){let o=JSON.stringify({name:t.name,description:t.description,showUserDisplayName:t.showUserDisplayName}),n=we(this.baseUrl+"/"+e,{method:"PATCH",body:o},!0),r=await J(n);if(ce(r),r.ok){let i=await r.json();return hl(i),{hasError:!1,data:i}}if(r.status===400){let i=await r.json();return{hasError:!0,error:i}}throw new Error(`${r.status}: ${r.statusText}`)},async sortList(e,t){let o={locale:w.data.userLocale},n=`${this.baseUrl}/${e}?${Le(o)}`,r=JSON.stringify(t),i=we(n,{method:"PUT",body:r},!0),a=await J(i);if(ce(a),a.ok){let s=await a.json();return hl(s),{hasError:!1,data:s}}if(a.status===400){let s=await a.json();return{hasError:!0,error:s}}throw new Error(`${a.status}: ${a.statusText}`)},async addItem(e,t){let o=JSON.stringify(t),n=we(this.baseUrl+"/"+e,{method:"POST",body:o},!0),r=await J(n);if(ce(r),r.ok){let i=await r.json();return{hasError:!1,data:i}}if(r.status===400||r.status===403){let i=await r.json();return{hasError:!0,error:i}}throw new Error(`${r.status}: ${r.statusText}`)},async deleteItem(e,t){let o=we(this.baseUrl+"/"+e+"/"+t,{method:"DELETE"},!0),n=await J(o);if(ce(n),!(n.ok||n.status===204))throw new Error(`${n.status}: ${n.statusText}`)},async updateItem(e,t,o){let n=JSON.stringify(o),r=we(`${this.baseUrl}/${e}/${t}`,{method:"PUT",body:n},!0),i=await J(r);if(ce(i),i.ok){let a=await i.json();return{hasError:!1,data:a}}if(i.status===400||i.status===403){let a=await i.json();return{hasError:!0,error:a}}throw new Error(`${i.status}: ${i.statusText}`)},async createSection(e,t,o){let n=JSON.stringify({name:t,description:o}),r=we(`${this.baseUrl}/${e}/section`,{method:"POST",body:n},!0),i=await J(r);if(ce(i),i.ok){let a=await i.json();return{hasError:!1,data:a}}if(i.status===400){let a=await i.json();return{hasError:!0,error:a}}throw new Error(`${i.status}: ${i.statusText}`)},async updateSection(e,t,o,n){let r=JSON.stringify({name:o,description:n}),i=we(`${this.baseUrl}/${e}/section/${t}`,{method:"PATCH",body:r},!0),a=await J(i);if(ce(a),a.ok){let s=await a.json();return{hasError:!1,data:s}}if(a.status===400){let s=await a.json();return{hasError:!0,error:s}}throw new Error(`${a.status}: ${a.statusText}`)},async deleteSection(e,t){let o=we(`${this.baseUrl}/${e}/section/${t}`,{method:"DELETE"},!0),n=await J(o);if(ce(n),n.ok){let r=await n.json();return{hasError:!1,data:r}}if(n.status===400){let r=await n.json();return{hasError:!0,error:r}}throw new Error(`${n.status}: ${n.statusText}`)}};function Eq(e,t){return{type:"url",data:{url:e,rawUrl:"",title:t,docId:"",docVIId:"",pageType:"",pageKind:"",uid:"",challengeId:"",eventUid:"",durationInMillisecond:null,showId:""}}}function zs(e){return y.isAuthenticated&&y.userName.localeCompare(e,void 0,{sensitivity:"base"})===0}var Ub={};function tC(e){return Ne.gamification?(Ub[e]===void 0&&(Ub[e]=Uf.getStatus(e)),Ub[e]):Promise.resolve(lq)}var $b={};function wq(e){return $b[e]===void 0&&($b[e]=tC(e).then(async t=>{let o=t.achievements,n=o.map(i=>i.awardUid),r=await vq(n,w.data.userLocale);return o.map(i=>({award:i,achievement:r.find(a=>a.uid===i.awardUid)})).filter(i=>i.achievement)})),$b[e]}async function Cq(e,t){return t&&(delete $b[e],delete Ub[e]),(await wq(e)).filter(n=>n.achievement.type==="badge")}async function kq(e){return(await wq(e)).filter(o=>o.achievement.type==="trophy")}var _l;function Aq(){return _l===void 0&&(_l=Eo.getAllLists()),_l.then(e=>e.filter(t=>t.type==="collection"))}function Iq(){return _l===void 0&&(_l=Eo.getAllLists()),_l.then(e=>e.filter(t=>t.type==="bookmarks"))}function Pq(e){return _l=void 0,Eo.createList(e)}async function Rq(e=0,t=10){let o=await z$(e+1,t);return{totalCount:o?.totalItems??0,items:o?.items??[]}}async function Nq(e,t){let o=await F$(e+1,t);return{totalCount:o?.totalItems??0,items:o?.items??[]}}async function Dq(e,t){let o=await H$(e+1,t);return{totalCount:o?.totalItems??0,items:o?.items??[]}}var Xr=class extends Ye{constructor(o,n){super();this.user=o;this.isPublic=n;this.hasActivated=!1}beforeActivate(){return this.getCardDetails(this.user.userId).then(()=>{this.hasActivated=!0})}async getCardDetails(o){let[n,r]=await Promise.all([tC(o),fu(this.user.userName)]);this.followingCount=r.followingCount,this.followerCount=r.followerCount,this.acceptedAnswerCount=r.answersAccepted,this.reputationPoints=r.reputationPoints,this.badgeCount=n.achievements.filter(i=>i.awardType==="Badge").length,this.trophyCount=n.achievements.filter(i=>i.awardType==="Trophy").length,this.currentLevel=fy.replace("{number}",n.level.levelNumber.toString()),this.progressPercent=hq(n.level.pointsHigh,n.level.pointsLow,n.currentLevelPointsEarned),this.totalPoints=n.totalPoints,this.nextLevelXP=xh.replace("{totalXP}",n.level.pointsHigh.toString()),this.notifyPropertyChanged()}notifyPropertyChanged(){this.publish(new Ae)}};function kt(e,t=!1){let o=i=>{let a=iT("me","achievements");return a.hash=i,a.toString()},n=e.user.isPrivate&&t,r=n?e.user.userName:e.user.displayName;return d`
		<section id="profile-hero-section">
		<div class="hero has-background-docs ${n?" margin-bottom-sm margin-bottom-md-tablet":""}">
			<div class="hero-background">
				<img src="/en-us/media/profile/profile-card-background.svg?branch=main" alt="" class="display-none display-block-tablet" data-linktype="absolute-path">
				<img src="/en-us/media/profile/profile-card-bg-mobile.svg?branch=main" alt="" class="display-none-tablet" data-linktype="absolute-path">
			</div>
			<div class="hero-card padding-none padding-xxs-tablet has-border-none">
				<div class="padding-inline-xxs padding-block-sm padding-sm-widescreen">
					<div class="media">
						<figure class="media-left image is-64x64 is-96x96-tablet">
							<img
								class="border-radius-rounded is-hidden-mobile" style="border: 5px solid #ffffff;"
								src="${e.user.avatarUrl?e.user.avatarUrl:At}"
								alt
							/>
							<img
								class="border-radius-rounded is-hidden-tablet" style="border: 3px solid #ffffff;"
								src="${e.user.avatarUrl?e.user.avatarUrl:At}"
								alt
							/>
						</figure>
						<div class="media-content font-size-sm has-text-docs-invert margin-top-md is-hidden-mobile">
							<header>
								<h1 class="is-size-h3 display-inline-block padding-left-xxs">
									${r}
								</h1>
								<span
									class="margin-left-xxs-tablet padding-left-xxs padding-right-xxs border-radius-lg has-background-docs"
									?hidden="${e.user.isMicrosoftUser&&e.user.isMvp}">
									${e.user.isMicrosoftUser?d`<span>${Lg}</span>`:null}
									${e.user.isMvp?d`<span>${ah}</span>`:null}
								</span>
								<div>
									${e.user instanceof Cr&&e.user.upn?d`<span class="margin-left-xxs">${e.user.upn}</span>`:""}
									${!t&&e.user instanceof Cr&&e.user.mcid?d` <span
													class="margin-left-xxs-tablet padding-left-xxs padding-right-xxs"
											  >
													<span class="padding-right-xxs">${Rp}</span
													><span>${e.user.mcid}</span>
											  </span>`:""}
								${e.isPublic?Lq("font-size-sm has-text-docs-invert margin-left-xxs"):null}
								</div>
								<div class="display-flex" ?hidden="${!e.user.isMicrosoftUser||!e.user.isMvp}">
									<div class="has-background-docs font-size-xs margin-top-xxs padding-left-xxs padding-right-xxs border-radius-lg is-comma-delimited">
										${e.user.isMicrosoftUser?d`<span>${Lg}</span>`:null}
										${e.user.isMvp?d`<span>${ah}</span>`:null}
									</div>
								</div>
							</header>
						</div>
						<div class="media-content has-text-docs-invert is-hidden-tablet">
							<header>
								<h1 class="is-size-h7 padding-left-xxs">
									${r}
								</h1>
								${e.user instanceof Cr&&e.user.upn?d`<div class="padding-left-xxs font-size-xs">${e.user.upn}</div>`:""}
								${!t&&e.user instanceof Cr&&e.user.mcid?d`<div>
												<span class="font-size-xs padding-left-xxs padding-right-xxs">
													<span class="padding-right-xxs">${Rp}</span
													><span>${e.user.mcid}</span>
												</span>
										  </div>`:""}
								${e.isPublic?Lq("font-size-xs has-text-docs-invert padding-left-xxs"):null}
								<div class="display-flex has-line-height-reset" ?hidden="${!e.user.isMicrosoftUser||!e.user.isMvp}">
									<div class="has-background-docs font-size-xs margin-top-xxs padding-left-xxs padding-right-xxs border-radius-lg is-comma-delimited">
										${e.user.isMicrosoftUser?d`<div>${Lg}</div>`:null}
										${e.user.isMvp?d`<div>${ah}</div>`:null}
									</div>
								</div>
							</header>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="hero-foot box padding-xxs margin-bottom-sm margin-bottom-md-tablet" ?hidden="${n}">
		<div class="columns is-gapless-mobile is-mobile is-multiline has-line-height-reset padding-left-xs">
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet">${Gd(e.badgeCount,kl,_k,e.isPublic,o("badges-section"))}</div>
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet">${Gd(e.trophyCount,Wl,IO,e.isPublic,o("trophies-section"))}</div>
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet">${Gd(e.reputationPoints,qg,Bg,e.isPublic,"https://aka.ms/msftqareputation")}</div>
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet">${Gd(e.acceptedAnswerCount,ag,sg,e.isPublic)}</div>
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet" ?hidden="${e.isPublic}">${Gd(e.followingCount,hI,"",e.isPublic,Ut("me","qna"))}</div>
			<div class="column is-4-mobile is-1-tablet display-flex justify-content-flex-start-tablet">${Gd(e.followerCount,fI,gI)}</div>
			<div class="column is-full-mobile is-6-desktop">${C5(e)}</div>
		</div>
	</div>
	</section>
	`}function Gd(e,t,o="",n=!0,r=""){let i=e&&Xt(e);return n||!r?d`
				<dl
					class="padding-xxs padding-xs-tablet display-flex flex-direction-column-reverse justify-content-flex-end"
				>
					<dt class="font-size-xs subtle">
						<p class="display-flex justify-content-center">
							${i==="1"||i===1||!o?t:o}
						</p>
					</dt>
					<dd class="has-text-weight-bold is-size-large has-no-wrap margin-bottom-xxs">${i}</dd>
				</dl>
		  `:d`
				<dl
					class="padding-xxs padding-xs-tablet display-flex flex-direction-column-reverse justify-content-flex-end"
				>
					<dt class="font-size-xs subtle">
						<p class="display-flex justify-content-center">
							${i==="1"||i===1||!o?t:o}
						</p>
					</dt>
					<dd class="margin-bottom-xxs">
						<a class="display-block" href="${r}">
							<p class="has-text-weight-bold is-size-large has-no-wrap">${i}</p>
						</a>
					</dd>
				</dl>
		  `}function C5(e){if(!e.nextLevelXP)return"";let t=e.nextLevelXP.split(" ");t.splice(0,1,Xt(parseInt(e.nextLevelXP)));let o=t.join(" ");return d`
		<div
			id="level-status-container"
			class="display-flex-tablet justify-content-flex-end-tablet align-items-center is-full-height margin-bottom-xxs margin-top-xs margin-top-none-tablet"
			?hidden=${!Ne.gamification}
		>
			<div
				id="level-status"
				class="position-relative level is-mobile margin-none justify-content-flex-start padding-bottom-sm-mobile padding-bottom-sm-mobile padding-right-md-desktop padding-right-md-tablet padding-top-md-mobile padding-left-xxs padding-left-none-tablet"
			>
				<span
					id="level-status-text"
					class="font-size-xs has-text-wrap is-inline-truncated is-uppercase font-weight-semibold"
				>
					${e.currentLevel}
				</span>
				<span id="level-status-progress-container" class="hexagonal-progress">
					<progress
						id="level-status-progress"
						class="progress display-inline-block position-relative is-success"
						value="${e.progressPercent}"
						max="100"
					>
						${e.progressPercent}%
					</progress>
					<span class="hexagonal-progress-marker"></span>
				</span>
				<span
					id="level-status-points"
					class="font-size-xs has-text-wrap is-inline-truncated is-uppercase"
				>
					<span class="font-weight-semibold">${Xt(e.totalPoints)}</span
					>/${o}
				</span>
			</div>
		</div>
	`}function Lq(e="is-size-small"){return d`
		<button
			class="report-abuse link-button ${e}"
			data-bi-name="report-abuse"
			type="button"
		>
			<span aria-hidden="true">
				<span class="docon docon-flag"></span>
			</span>
			<span>${dN}</span>
		</button>
	`}function $f(e,t,o,n,r,i,a,s,c,l="display-flex-tablet",u="",p="",m="",f="h3"){return d` <article class="padding-block-sm">
		${i&&e?d`<div class="media">
					<div class="media-left width-100">
						<div
							class="is-uppercase is-full-width font-size-xs font-weight-semibold margin-right-xs tag padding-xxs padding-xs-tablet padding-left-sm-tablet justify-content-flex-end"
						>
							${i}
						</div>
					</div>
					<div class="media-content display-flex position-relative align-self-stretch">
						<p
							class="has-text-subtle font-size-sm align-self-center margin-bottom-xxs margin-bottom-xs-tablet margin-right-xxs"
							?hidden="${!e}"
						>
							${e}
						</p>
						${a}
						<div class="width-100 border-bottom position-absolute bottom-0"></div>
					</div>
					<div class="media-right margin-right-sm is-hidden-mobile">
						${u}
					</div>
			  </div>`:""}
		<div
			class="media border-none margin-none padding-left-md padding-right-md padding-left-none-tablet"
		>
			<div class="media-left width-100 is-hidden-mobile ${m}">
				<div class="image is-76x76 is-center-aligned">
					<img src="${t||""}" alt="" />
				</div>
			</div>
			<div class="media-content">
				<div class="justify-content-space-between ${l}">
					<div>
						<div class="media border-none padding-none">
							<p
								class="font-size-xs has-text-subtle is-uppercase letter-spacing-wide media-content"
							>
								${r}
							</p>
							${p}
						</div>
						<a href="${n}" class="display-inline-block font-size-md" ?hidden="${!o}"
							>${k5(f,o)}</a
						>
						${s}
					</div>
					${c}
				</div>
			</div>
		</div>
	</article>`}function zf(e,t,o,n,r,i,a,s,c,l,u="h3"){let p=d`${ie(e==="completed"?HL:e==="inProgress"?UL.replace("{number}",a===1?uP:cP.replace("{numberOfMinutes}",a.toString())):BL)} `,m=(i-a)/i,f=Xt(Math.floor(m*100)),h=jo(t,{month:"short",day:"numeric"}),_=d`
		<ul class="metadata page-metadata font-size-sm has-text-subtle">
			<li>
				<time datetime="${i}M"> ${Vn(i)} </time>
			</li>
		</ul>
	`,g=e==="completed",v=g?d`<div class="margin-left-md is-hidden-mobile">
				<div class="xp-tag completable ${g?"is-complete":""}">
					<div class="xp-tag-hexagon">
						<span class="xp-tag-icon docon docon-check is-shown-complete"></span>
						<span aria-hidden="true" class="xp-tag-xp">
							${xh.replace("{totalXP}",l.toString())}
						</span>
					</div>
				</div>
		  </div>`:"",x;if(!c||c==="notStarted")x=d``;else if(c==="inProgress"||c==="started"){let O=(P="")=>d`
			<progress
				class="progress width-100 margin-none is-success is-extra-small ${P}"
				value="${m}"
			></progress>
		`,k=(P="")=>d`
			<span class="progress-label display-inline-block padding-left-xs font-size-xs ${P}"
				>${f}%
			</span>
		`;x=d`
			<div class="level is-vertically-centered is-full-width is-hidden-mobile">
				<div class="level-left padding-none">
					<div class="level-item">${O()}</div>
				</div>
				<div class="level-right padding-none">
					<div class="level-item">${k()}</div>
				</div>
			</div>
			${O("is-hidden-tablet")}
			${k("is-hidden-tablet")}
		`}else x=d`<span class="progress-label has-text-success font-size-xs"
			><span class="docon docon-check padding-right-xxs" role="presentation"></span
			>${wg}</span
		>`;let E=d`
		<div
			class="width-150 display-flex margin-top-xs margin-top-none-tablet justify-content-flex-end-tablet align-items-center has-no-wrap"
		>
			${x}
		</div>
	`;return $f(p,o,n,Nr(r,ko.userLocale),Fs(s),h,v,_,E,void 0,void 0,void 0,void 0,u)}function oC(e,t,o,n,r,i){let a=n?jo(n,{year:"numeric",month:"long",day:"numeric"}):"",s=r?jo(r,{year:"numeric",month:"long",day:"numeric"}):"",c=n?n.getTime()-new Date().getTime()<=0:!1,l=r?r.getTime()-new Date().getTime()>=0:!1,u=c?_M:l?vM:hM,p=d`
		<ul class="metadata page-metadata font-size-sm has-text-subtle">
			${s?d`<li>${u.replace("{startDate}",s)}</li>`:a?d`<li>${u.replace("{endDate}",a)}</li>`:""}
			${i?d`<li>
						${Eg.replace("{numberOf}",i.toString())}
				  </li>`:""}
		</ul>
	`,m=1e3*60*60*24*7,f=n?n.getTime()<=new Date(Date.now()+m).getTime():!1,h=c?d` <p
				class="tag border-radius-rounded is-secondary-invert font-size-xs padding-left-xs padding-right-xs media-right"
		  >
				${cI}
		  </p>`:f?d` <p
				class="tag border-radius-rounded is-warning font-size-xs padding-left-xs padding-right-xs media-right"
		  >
				${uI}
		  </p>`:"";return $f("",e,t,Nr(o,ko.userLocale),Fs("challenge"),"","",p,"","","",h)}function zb(e,t,o,n,r=0,i="h3"){let a=jo(e,{month:"short",day:"numeric"}),s=d` <ul class="metadata page-metadata font-size-sm has-text-subtle">
		<li>
			${r>1?Ol.replace("{number}",r.toString()):Mg.replace("{number}",r.toString())}
		</li>
	</ul>`;return $f(d`${yM}`,null,n==="bookmarks"?dI:t,Nr(o,ko.userLocale),Fs(n),a,"",s,"",void 0,void 0,void 0,void 0,i)}function Mq(e=new Date){let t=jo(e,{month:"short",day:"numeric"}),o=d`
		<div class="content">
			<ul
				class="font-size-xs has-text-subtle margin-top-none margin-bottom-none margin-left-xs margin-left-lg-tablet"
			>
				<li>${ie(xp)}</li>
				<li>${ie(yp)}</li>
				<li>${ie(zg)}</li>
				<li>${ie(bp)}</li>
			</ul>
		</div>
	`,n=d` <figure class="margin-top-negative-sm is-hidden-mobile">
		<img
			style="width: 137px; height: 113px; transform: scaleX(-1);"
			alt=""
			src="/en-us/media/learn/home/mascot-cloud.png?branch=main"
			class="image"
		/>
	</figure>`;return $f(d`${$L}`,null,"","","",t,"",o,n,"display-flex","","","is-hidden")}function Fs(e){switch(e){case"collection":case"bookmarks":return hg.toLowerCase();case"module":return Js.toLowerCase();case"learningPath":return Dg.toLowerCase();case"challenge":return gg.toLowerCase();case"question":return Hg.toLowerCase();case"feedback":return mI.toLowerCase();case"certification":return Al.toLowerCase();case"badge":return kl.toLowerCase();case"trophy":return Wl.toLowerCase();default:return""}}function vl(e,t,o,n,r,i,a,s="h3"){let c=jo(e,{month:"short",day:"numeric"});return $f(t,o,n,Nr(r,ko.userLocale),Fs(i),c,"",a,"",void 0,void 0,void 0,void 0,s)}function Fb(e,t,o){return d`
		<ul class="metadata page-metadata font-size-sm has-text-subtle">
			<li>${e} ${e===1?zO:FO}</li>
			<li>${t} ${t===1?VA:jA}</li>
			<li>${o} ${o===1?dk:pk}</li>
		</ul>
	`}function k5(e="h3",t){let o={h2:d`<h2>${t}</h2>`,h3:d`<h3>${t}</h3>`,h4:d`<h4>${t}</h4>`,h5:d`<h5>${t}</h5>`,h6:d`<h6>${t}</h6>`};return o[e]||o.h3}var Hb=d`
	<div class="display-flex has-body-background-dark padding-xxs padding-xs-tablet margin-bottom-lg">
		<div>
			<span class="has-text-primary icon" aria-hidden="true">
				<span class="docon docon-status-info-outline"></span>
			</span>
		</div>
		<div>
			<h2>${AP.replace("{productName}","Microsoft Educator Center")}</h2>
			<p>${tP}</p>
			<p>${ie(oP)}</p>
		</div>
	</div>
`;var qb=3;var A5=["activity","training","challenges","certifications","qna","achievements","collections","transcript"],Ai=A5.slice();function Vd(e){switch(e){case"activity":return cg;case"certifications":return rn;case"collections":return _g;case"achievements":return cp;case"settings":return zl;case"qna":return zR;case"training":return Ip;case"transcript":return Pp;case"challenges":return lp;default:throw new Error(`Unsupported section: ${e}`)}}function ga(e){let o=Th(e).redeem,[,,n,r="",i,a="",s="",c=e.hash]=decodeURIComponent(e.pathname).toLowerCase().split("/");(e.hostname!=="docs.microsoft.com"||n!=="users")&&(r=(e.searchParams.get("username")||"").toLowerCase(),i=(e.searchParams.get("section")||"").toLowerCase(),a=(e.searchParams.get("detail")||"").toLowerCase(),s=(e.searchParams.get("id")||"").toLowerCase());let l=null;return i==="bookmarks"?(l="collections",a="favorites"):(Ai.push("settings"),l=Ai.find(u=>u===i)||"activity",Ai.pop(),a&&!(l==="collections"||l==="training"||l==="achievements"||l==="transcript"||l==="certifications")&&(a="")),o?{username:r,section:l,detail:a,hash:c,id:s,code:o}:{username:r,section:l,detail:a,hash:c,id:s}}function dt(e,t,o,n=he.location,r=w.data.userLocale,i){if(e=e.toLowerCase(),o&&!(t==="collections"||t==="training"||t==="achievements"||t==="transcript"||t==="certifications"))throw new Error(`Detail url component is not supported in ${t} section.`);let a=new URL(n.origin+n.pathname+n.search).searchParams;(C.supportLevel==="development"&&C.accessLevel==="online"||C.supportLevel==="production"&&C.reviewFeatures)&&i&&t==="certifications"&&(o==="certification-details"||o==="certification-print")?a.set("id",i):a.delete("id");let s=a.toString();if(s=s.length?"?"+s:"",n.hostname==="docs.microsoft.com"){let u;return t&&t!=="activity"?u=new URL(`/${r}/users/${e}/${t}${o?`/${o}`:""}${i?`/${i}`:""}${s}`,n.origin):u=new URL(`/${r}/users/${e}/${s}`,n.origin),u}let c=`/${r}/test/profile/profile`,l=new URL(c+"?"+a.toString(),n.origin);return l.searchParams.delete("username"),l.searchParams.delete("section"),l.searchParams.delete("detail"),l.searchParams.set("username",e),t&&t!=="activity"?(l.searchParams.set("section",t),t==="certifications"&&!o&&l.searchParams.set("detail","summary"),o&&l.searchParams.set("detail",o)):l.searchParams.delete("section"),l}function Uq(e,t,o,n,r){return e&&!((t==="achievements"||t==="certifications")&&o)?"javascript:void(0)":dt(n,r)}function $q(e,t=he.location.pathname){return{canHandle(o){return ga(o).username.length>0&&(o.hostname==="docs.microsoft.com"||o.pathname===t)&&!(o.pathname===de.pathname&&o.search===de.search)},handle(o){let{username:n,section:r,detail:i,id:a,code:s}=ga(o);e(r,i,a,s);let c=dt(n,r,i,de,w.data.userLocale,a);return c.hash=de.hash,Promise.resolve({url:c,title:zq(n,r)})},params:["username","section","detail"]}}function zq(e,t){return t&&t!=="activity"?`${Vd(t)} - ${e} | Microsoft Docs`:`${e} | Microsoft Docs`}function Ff(e,t,o,n,r){let i=zq(e,t);document.title=i,history.replaceState(void 0,i,`${dt(e,t,o,de,w.data.userLocale,r).toString()}${n||de.hash}`)}var Fq=un(e=>t=>{t.setValue(e)});function Hq(e,t,o,n=500){let r=0,i=(...a)=>{t(r),r=e.apply(null,[o.bind(null,...a),n])};return i.cancel=()=>t(r),i}var Hf={timeout:Hq.bind(null,setTimeout,clearTimeout),animationFrame:Hq.bind(null,he.requestAnimationFrame,he.cancelAnimationFrame)};function I5(){Y.querySelector("#profile-hero-section")?.classList.add("display-none-print"),Y.querySelector("#profile-nav")?.classList.add("display-none-print")}function Bb(e,t,o=""){return d`
		<div
			id="${o}"
			class="position-fixed-print top-0 left-0 right-0 display-flex-print justify-contents-center align-items-center rotate-270-print-portrait container is-max-mobile is-max-tablet is-fullscreen-print-landscape background-color-body"
		>
			<div
				class="padding-none padding-sm-tablet size-a4-print-landscape margin-inline-auto display-flex-print align-items-center"
			>
				<div
					class="theme-light has-background-image color-adjust-exact is-full-width is-full-height image is-center-aligned is-3by2 padding-top-none-mobile"
					style="background-image:url('${t}');"
				>
					<div
						class="is-full-height is-full-width position-absolute-tablet position-absolute-print top-0 left-0 right-0 padding-md padding-xl-desktop padding-xxl-print"
					>
						<div
							class="background-color-body padding-xs padding-sm-tablet border border-radius-lg box-shadow-medium is-full-height position-relative"
						>
							${O5()}
							<div class="columns is-full-height is-vertically-centered is-centered is-gapless">
								<div class="column"></div>
								<div
									class="column is-three-quarters is-three-fifths-desktop position-relative padding-lg"
								>
									${e}
								</div>
								<div class="column"></div>
							</div>
							${$5()}
						</div>
					</div>
				</div>
			</div>
		</div>
	`}function Bq(e){return d`
		<div class="has-line-height-reset is-text-centered">
			<p class="display-none-print font-size-sm margin-bottom-xxs margin-bottom-xs-desktop">
				${e}
			</p>
			<p class="display-none display-block-print font-size-xl margin-bottom-xs">
				${e}
			</p>
		</div>
	`}function Yb(e,t="",o=""){return d` <div class="has-line-height-reset has-text-centered">
		<h3 class="display-none-print font-size-lg font-weight-bold ${t}">
			${e}
		</h3>
		<h3 class="display-none display-block-print font-size-h4 font-weight-bold ${o}">
			${e}
		</h3>
	</div>`}function Gb(e,t){let o="position-relative";return d`
		<div
			class="display-none-print padding-sm margin-bottom-sm margin-bottom-xl-desktop ${o}"
		>
			${t||""} ${e}
		</div>
		<div class="is-hidden display-block-print padding-xl margin-bottom-md ${o}">
			${t||""} ${e}
		</div>
	`}function Yq(e,t="",o=""){return d`
		<div class="has-line-height-reset is-text-centered">
			<h3
				class="display-none-print font-weight-bold margin-bottom-xxs margin-bottom-xs-desktop ${t}"
			>
				${e}
			</h3>
			<h3
				class="display-none display-block-print font-weight-bold margin-bottom-xxs margin-bottom-xs-desktop ${o}"
			>
				${e}
			</h3>
		</div>
	`}function P5(e){return d` <button
		role="${$o(e.isLink?"link":void 0)}"
		data-bi-name="${e.dataBiName}"
		class="button button-lg button-clear ${e.cssClasses??""}"
		@click="${e.clickHandler}"
	>
		<span class="icon margin-none" aria-hidden="true"
			><span class="color-primary docon ${e.icon}"></span
		></span>
		<span class="is-visually-hidden-mobile font-size-sm font-weight-normal margin-left-xxs"
			>${e.title}</span
		>
	</button>`}function bl(e,t,o){let n={title:uh,dataBiName:t,icon:"docon-print",clickHandler:()=>U5(e),cssClasses:"margin-right-sm"},r=o?[...o,n]:[n];return d` <div
		class="buttons buttons-right display-none-print position-absolute top-0 right-0"
	>
		${r.map(P5)}
	</div>`}function R5(e,t,o,n){return d`
		<div class="field ${e.checked===null?"display-none":""}">
			<div
				class="control font-size-sm margin-xs display-flex-tablet justify-content-flex-start-tablet"
			>
				<label for="${e.id}" class="checkbox">
					<input
						id="${e.id}"
						type="checkbox"
						name="print-contact-email"
						.checked="${Fq(e.checked)}"
						?disabled="${o.busy||e.disabled}"
					/>
					<span class="checkbox-check" aria-hidden="true"></span>
					<span class="${e.disabled?"color-secondary":"checkbox-text"}"
						>${e.label}</span
					>
				</label>
				${o.renderLinks&&e.linkTitle&&e.linkHref?d`<div
							class="margin-top-xs margin-top-none-tablet margin-left-md-tablet"
							?hidden="${!e.linkTitle}"
					  >
							<button
								id="${o.id}-settings-link-${t}"
								role="link"
								data-bi-name="${e.dataBiName}"
								@click="${()=>{n.hide(),$d.goto(new URL(e.linkHref),"pushState")}}"
								class="link-button has-text-left"
								type="button"
							>
								${e.linkTitle}
							</button>
					  </div>`:""}
			</div>
		</div>
	`}function N5(e,t,o){let n=async r=>{r.preventDefault();let i=r.target;try{await e.submitHandler(r),t.hide()}catch{st(i,"somethingWentWrong")}};I(d`
			<div class="modal-card padding-xxs padding-xs-tablet" aria-live="polite">
				<header class="modal-card-head padding-none">
					<button
						type="button"
						id="${e.id}-settings-form-close"
						class="modal-close modal-card-close-button is-large"
						aria-label="${ze}"
					></button>
				</header>
				<section class="modal-card-body justify-content-center padding-block-none">
					<h2 class="font-size-h5 margin-bottom-sm">${e.title}</h2>
					<form
						id="edit-${e.id}-settings-form"
						@submit="${n}"
						action="javascript:"
					>
						${e.fieldsets.map((r,i)=>d`
								<fieldset>
									<legend class="label ${i>0?"margin-top-xs":""}">
										${r.subtitle}
									</legend>
									${r.checkboxes.map((a,s)=>R5(a,s,e,t))}
								</fieldset>
							`)}
						<div class="margin-top-sm margin-bottom-xs">
							<p
								hidden
								data-label="somethingWentWrong"
								class="help help-danger display-flex justify-content-flex-end margin-bottom-xxs margin-right-xxs"
							>
								${ph}
							</p>
							<div class="buttons buttons-right">
								<button
									data-bi-name="${e.id}-update-settings"
									id="${e.id}-update-settings"
									class="button button-primary button-filled button-sm ${e.busy?"is-loading":""}"
									type="submit"
									?disabled="${e.busy}"
								>
									${LO}
								</button>
								<button
									data-bi-name="${e.id}-cancel-settings"
									id="${e.id}-cancel-settings"
									class="modal-close cancel-button button button-sm"
									type="button"
								>
									${Je}
								</button>
							</div>
						</div>
					</form>
				</section>
			</div>
		`,o)}function Vb(e,{showContactEmail:t,showLegalName:o,showMCID:n}){Y.getElementById(`#${e}-legal-name`)?.classList?.toggle("display-none-print",!o),Y.getElementById(`#${e}-mcid`)?.classList?.toggle("display-none-print",!n),Y.getElementById(`#${e}-contact-email`)?.classList?.toggle("display-none-print",!t)}async function jb(e,t){let o=Y.createElement("div"),n=new Ge(o),r=()=>{let s=Y.activeElement;return(s instanceof HTMLInputElement||s instanceof HTMLButtonElement)&&s.id?`#${s.id}`:null},i=s=>{let c;if(s){c=n.contentElement.querySelector(s),c?.focus();return}c=n.contentElement.querySelector("div.modal-card"),c?.focus()},a=()=>{let s=r();(()=>{let c=t(e);return N5(c,n,o),o})(),i(s)};return e.subscribe(Ae,()=>{a()}),a(),await n.show()}function Gq(e){let t=n=>{n.editDisplayName=!n.editDisplayName},o=n=>{let r=Y.getElementById("display-name");n.displayName=r.value,n.editDisplayName=!1};return d`<div
		class="buttons buttons-right display-none-print position-absolute top-0 right-0 margin-top-md margin-top-md-tablet"
	>
		<button
			class="button button-lg button-clear margin-top-xxs"
			@click="${()=>{o(e)}}"
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-check-mark"></span>
			</span>
			<span class="is-hidden-mobile font-size-sm">${IM}</span>
		</button>
		<button
			class="button button-lg button-clear margin-top-xxs"
			@click="${()=>{t(e)}}"
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-navigate-close"></span>
			</span>
			<span class="is-hidden-mobile font-size-sm">${kM}</span>
		</button>
	</div>`}function nC(e){let t=Y.querySelectorAll(".display-name-error"),o=Y.querySelector("#display-name");e?(t?.forEach(n=>{n.setAttribute("aria-hidden","false"),n.classList.remove("visually-hidden"),n.setAttribute("role","alert")}),o?.classList.add("input-danger")):(t?.forEach(n=>{n.setAttribute("aria-hidden","true"),n.classList.add("visually-hidden"),n.removeAttribute("role")}),o?.classList.remove("input-danger"))}function Vq(e){return d`
		<div class="display-none-print margin-bottom-xxs margin-bottom-xs-desktop">
			<div class="field display-flex align-items-center justify-content-center">
				<div
					class="border-radius padding-xs alert is-primary margin-none control flex-grow-1 flex-grow-0-tablet margin-left-lg"
				>
					${D5(e,"input is-text-centered font-weight-bold input-sm width-300-tablet")}
				</div>
				${qq(Wx,"is-hidden-tablet is-text-centered font-size-xs")}
				${L5(rk)}
			</div>
			${qq(Wx,"is-hidden-mobile is-text-centered font-size-xs")}
		</div>
		<h4
			class="is-hidden display-block-print has-line-height-reset margin-bottom-xs is-text-centered font-size-h4 font-weight-bold"
		>
			${e.displayName}
		</h4>
	`}function qq(e,t=""){return d`
		<p
			id="display-name-error"
			data-label="displayNameIsInvalid"
			class="help help-danger visually-hidden display-name-error ${t}"
			aria-hidden="true"
		>
			${e}
		</p>
	`}function D5(e,t=""){return d`
		<input
			type="text"
			id="display-name"
			name="display-name"
			class="input ${t}"
			value=${e.displayName}
			data-profile-property="displayName"
			placeholder="${$0}"
			@input=${o=>e.displayName=o.target.value}
			@blur=${M5}
			aria-describedby="transcript-tooltip"
		/>
	`}function L5(e){return d`
		<div class="control dropdown has-caret">
			<button
				class="dropdown-trigger button button-clear button-small"
				aria-controls="display-name-information"
				aria-haspopup="dialog"
				aria-label=${H0}
			>
				<span class="has-text-primary icon" aria-hidden="true">
					<span class="docon docon-status-info-outline"></span>
				</span>
			</button>
			<div
				class="dropdown-menu has-text-wrap width-400-tablet width-200"
				id="display-name-information"
				role="dialog"
			>
				<div id="transcript-tooltip" class="padding-sm">
					<p class="has-line-height-reset margin-bottom-xxs is-size-8">${e}</p>
				</div>
				<div class="padding-right-sm padding-bottom-sm display-flex justify-content-flex-end">
					<button
						aria-controls="display-name-information"
						aria-expanded="true"
						type="button"
						class="button button-sm button-primary button-filled is-text is-small padding-right-sm padding-left-sm dropdown-menu-close"
						aria-label="${kn}"
					>
						${kn}
					</button>
				</div>
			</div>
		</div>
	`}function jq(e){e.editDisplayName=!e.editDisplayName}function M5(e){let t=e.target.value;Wq(t)&&nC(!1)}function O5(){let e="image is-center-aligned top-0 left-0 has-height-auto",t=d`
		<figure class="image is-2by1">
			<img
				src="/media/profile/microsoft-logo.svg?branch=main"
				role="presentation"
				alt=""
				class="object-fit-contain object-position-top"
			/>
		</figure>
	`;return d`
		<div
			class="${e} display-none-print is-64x64 is-76x76-desktop margin-top-xs-tablet margin-left-xs-tablet margin-top-sm-desktop margin-left-sm-desktop position-absolute-tablet"
		>
			${t}
		</div>
		<div
			class="is-hidden display-block-print position-absolute-print is-112x112 margin-top-md margin-left-md ${e}"
		>
			${t}
		</div>
	`}function U5(e){Wq(e.displayName)?(nC(!1),I5(),he.print()):nC(!0)}function $5(){let e="image is-center-aligned bottom-0 right-0 has-height-auto",t=d`
		<figure class="image is-5by3">
			<img src="/media/profile/achievement-signature.png?branch=main" role="presentation" alt="" />
		</figure>
	`;return d`
		<div
			class="display-none-print is-64x64 is-76x76-desktop has-height-auto margin-bottom-xs-tablet margin-right-xs-tablet margin-bottom-sm-desktop margin-right-sm-desktop position-relative position-absolute-tablet ${e}"
		>
			${t}
		</div>
		<div
			class="is-hidden display-block-print position-absolute-print bottom-0 right-0 is-112x112 margin-bottom-md margin-right-md ${e}"
		>
			${t}
		</div>
	`}function jd(){return d`
		<section
			id="unexpected-error-template"
			class="has-background-image padding-top-lg padding-bottom-lg padding-left-xs padding-left-none-tablet padding-right-xs padding-right-none-tablet"
		>
			<div class="display-flex flex-direction-column align-items-center is-text-centered">
				<figure class="image" aria-hidden="true">
					<img alt="" src="/en-us/media/profile/something-went-wrong.svg?branch=main" />
				</figure>
				<h1 class="is-size-3 margin-top-xs margin-bottom-md">
					${q0}
				</h1>
			</div>
		</section>
	`}function Wq(e){return e.length!==0}function ht(e,t=!1){let o;switch(e){case"activity":return rC(!1,"no-in-progress.svg",DR);case"certifications":return o={iconUrl:"no-certifications.svg",message:LR,links:[{url:"/certifications/browse/",text:xk}]},qf(o);case"transcript":return o={iconUrl:"no-achievements.svg",message:$R,links:[{url:"/learn/",text:yy}]},qf(o);case"collections":return o={iconUrl:"no-collections.svg",message:MR,links:[]},qf(o);case"qna":return o={iconUrl:"no-following.svg",message:OR,links:[{url:"/answers/",text:"Q&A"}]},qf(o);case"achievements":return o={iconUrl:"no-achievements.svg",message:RR,links:[{url:"/learn/",text:yy}]},qf(o,t);case"training":let n=d`<li>${ie(xp)}</li>
				<li>${ie(yp)}</li>
				<li>${ie(bp)}</li>`;return rC(!1,"no-in-progress.svg",UR,n);default:throw new Error("Unsupported profile section: "+e)}}function Kq(){return rC()}function rC(e=!0,t="empty-state.svg",o=NR,n=d`<li>${ie(xp)}</li>
		<li>${ie(yp)}</li>
		<li>${ie(zg)}</li>
		<li>${ie(bp)}</li>`){return d` <div class="display-flex flex-direction-column align-items-center">
		<figure class="image is-center-aligned">
			<img alt="" src="https://docs.microsoft.com/en-us/media/profile/${t}" />
		</figure>
		<div class="has-text-subtle" ?hidden="${e}">
			<span class="display-block is-text-centered margin-block-xs">${o}</span>
			<ul class="default margin-left-sm">
				${n}
			</ul>
		</div>
	</div>`}function qf(e,t=!1){return d`
		${t?Hb:""}
		<div
			id="profile-zero-state-template"
			class="display-flex flex-direction-column align-items-center is-text-centered"
		>
			<figure class="image is-center-aligned">
				<img alt="" src="https://docs.microsoft.com/en-us/media/profile/${e.iconUrl}" />
			</figure>
			<span class="has-text-subtle margin-block-xs">${e.message}</span>
			<div>
				${e.links.map(o=>d`<a class="padding-xxs font-size-sm" href="/${w.data.userLocale}${o.url}"
							>${o.text}</a
						>`)}
			</div>
		</div>
	`}var iC=class extends yt{constructor(o,n){super({title:n?cp:hy,load:async()=>{let r=(await Cq(o.userId,this._reset)).map(a=>(a.achievement.iconUrl=Nr(a.achievement.iconUrl,"en-us"),a));this._reset=!1;let i;return n?i=r.slice(0,qb):i=r,{items:i,totalCount:r.length}}});this.user=o}reset(){this._reset=!0}},aC=class extends yt{constructor(o){super({title:my,load:async()=>{let n=(await kq(o.userId)).map(r=>(r.achievement.iconUrl=Nr(r.achievement.iconUrl,"en-us"),r));return{items:n,totalCount:n.length}}});this.user=o}},Wd=class extends Ye{constructor(o,n=!1,r){super();this.user=o;this.isMECUser=n;this.codeToRedeem=r;this.card=new Xr(this.user,!1);this.badges=new iC(this.user,!1);this.trophies=new aC(this.user);this.card.subscribe(Ae,i=>this.publish(i)),this.badges.subscribe(Ae,i=>this.publish(i)),this.trophies.subscribe(Ae,i=>this.publish(i)),this.code=r}get hasAchievements(){return this.badges.items.length>0||this.trophies.items.length>0}renderCodeRedemptionSection(){zs(this.user.userName)&&Ne.systemDrivenAchievement&&Z5(this)}beforeActivate(){return Promise.all([this.card.beforeActivate(),this.badges.beforeActivate(),this.trophies.beforeActivate()]).then(()=>{this.renderCodeRedemptionSection()})}reload(){return this.badges.reset(),Promise.all([this.card.beforeActivate(),this.badges.beforeActivate(),this.trophies.beforeActivate()])}},Wb=class extends Ye{constructor(o,n=""){super();this.user=o;this.achievementUid=n;this._editDisplayName=!1;this._displayName=o.displayName}async beforeActivate(){return W$(this.achievementUid).then(o=>{this._userAchievement=o})}get userAchievement(){return this._userAchievement}get displayName(){return this._displayName}set displayName(o){this._displayName=o,this.notifyPropertyChanged()}get editDisplayName(){return this._editDisplayName}set editDisplayName(o){this._editDisplayName=o,this.notifyPropertyChanged()}notifyPropertyChanged(){this.publish(new Ae)}};function Qq(e,t,o){return d`<section
		class="padding-bottom-md"
		role="tabpanel"
		id="tabpanel-${e}"
		data-tab-content="tabpanel-${e}"
		?hidden=${o}
	>
		${t}
	</section>`}function Xq(e,t){return d` <div class="tab-parent">
		<button
			id="tab-${e}"
			class="tab-control padding-inline-none margin-right-sm"
			role="tab"
			aria-controls="tabpanel-${e}"
		>
			${t}
		</button>
	</div>`}function z5(){return d` <div class="tabs uhf-container margin-top-xs" data-bi-name="achievements-tabs">
		<div class="tab-list is-left" role="tablist">
			${Xq("learning-paths",my)}
			${Xq("modules-courses-more",hy)}
		</div>
	</div>`}function o4(e){return d` <figure class="card-header-image" aria-hidden="true">
		<img src="${e.iconUrl}" role="presentation" alt="" />
	</figure>`}function n4({uid:e}){return d`
		<a
			class="button button-lg button-clear"
			href="${dt(y.userName,"achievements",e)}"
			data-bi-name="achievement-print"
		>
			<span class="visually-hidden">${jx}</span>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-print"></span>
			</span>
		</a>
	`}function r4(e){return e.sourceUrl?d`
			<a class="card-content-title" href="/${w.data.userLocale+e.sourceUrl}">
				<h3>${e.title}</h3>
			</a>
		`:d`<h3 class="card-content-title">${e.title}</h3>`}function i4(e){let t=new Date(e.awardedDateUTC),o=new Intl.DateTimeFormat(w.data.userLocale).format(t);return d` <span class="padding-right-xxs">${WA}</span>
		<time datetime=${t.toUTCString()}> ${o} </time>`}function Kb(e){let t=Qo(),o=dD.replace("{achievementTitle}",`"${e.title}"`).replace("{achievementType}",e.type),n=`https://docs.microsoft.com/${w.data.userLocale}/learn/achievements/${e.uid}?username=${y.userName}`,r=e.type==="badge"?"MSLearnBadge":e.type==="trophy"?"MSLearnTrophy":"",i=encodeURIComponent(Yg).replace(encodeURIComponent("{articleTitle}"),e.title),a=`${encodeURIComponent(o)}${encodeURIComponent(`

`)}`;return d`
		<div class="sharing dropdown has-caret">
			<button
				class="dropdown-trigger button button-clear button-lg"
				aria-controls="${t}"
				aria-expanded="false"
				title="${pD}"
				data-bi-name="share"
			>
				<span class="icon">
					<span class="docon docon-sharing" aria-hidden="true"></span>
				</span>
			</button>
			<div class="dropdown-menu padding-xs" id="${t}">
				<h4 class="padding-left-xxs">${ba}</h4>
				<ul class="color-primary" data-bi-name="share-links">
					<li>
						<a
							href="mailto:?subject=${i}&body=${a}${n}"
							class="button button-clear button-block justify-content-flex-start has-inner-focus button-sm share-email"
							data-bi-name="email"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-mail-message-fill color-primary"></span>
							</span>
							<span>${Ig}</span>
						</a>
					</li>
					<li>
						<a
							href="https://twitter.com/share?url=${n}&text=${a}&hashtags=${r}"
							class="button button-clear button-block justify-content-flex-start has-inner-focus button-sm share-twitter"
							data-bi-name="twitter"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-brand-twitter color-primary"></span>
							</span>
							<span>${gh}</span>
						</a>
					</li>
					<li>
						<a
							href="https://www.facebook.com/sharer/sharer.php?u=${n}&quote=${a}&hashtag=${r}"
							class="button button-clear button-block justify-content-flex-start has-inner-focus button-sm share-facebook"
							data-bi-name="facebook"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-brand-facebook color-primary"></span>
							</span>
							<span>${Rg}</span>
						</a>
					</li>
					<li>
						<button
							class="button button-clear button-block justify-content-flex-start has-inner-focus button-sm share-facebook"
							data-bi-name="copy_url"
							@click="${s=>F5(n,s)}"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-link color-primary"></span>
							</span>
							<span>${jN}</span>
						</button>
					</li>
				</ul>
			</div>
		</div>
	`}function F5(e,t){let o=Ww(e,t.target),n=d`<section
		id="redemption-modal-body"
		class="modal-card-body padding-xs display-flex flex-direction-column"
	>
		<button
			class="modal-close modal-card-close-button is-sticky margin-inline-sm color-text-subtle align-self-flex-start padding-xs"
			aria-label=${ze}
		></button>
		<header class="modal-card-head padding-none justify-content-center margin-bottom-sm">
			<img
				role="presentation"
				class="image is-128x128"
				src="/en-us/media/illustrations/success-code-redeem-or-copy.svg?branch=live"
			/>
		</header>

		<div class="display-flex flex-direction-column align-items-center">
			<h2 id="code-to-redeem" class="font-size-h5 centered margin-bottom-sm">
				${oD}
			</h2>
		</div>
	</section>`,r=d`<div
		id="redemption-modal"
		class="modal is-active width-auto-tablet"
	>
		<div class="modal-background"></div>
		<div class="modal-card modal-content padding-xxs">${n}</div>
	</div>`;if(o){let i=document.createElement("div");I(r,i),new Ge(i).show()}}function H5(e,{achievement:t,award:o},n){let r=zs(e.userName),i=!!t.sourceUrl,a=!w.data.hasShare||!r||!i,s=!r;return d`
		<div class="card-header">
			${o4(t)}
			<div class="card-header-item position-absolute top-0 right-0 margin-xs display-flex">
				${n?"":n4(t)}
				${s?"":Kb(t)}
			</div>
		</div>
		<div class="card-content margin-bottom-sm">
			<p class="card-content-super-title">
				${o.awardType==="Badge"?kl:Wl}
			</p>
			${r4(t)}
			<ul class="card-content-metadata">
				<li>${i4(o)}</li>
			</ul>
		</div>
		<div ?hidden=${a} class="card-footer">
			<div class="card-footer-item">${Kb(t)}</div>
		</div>
	`}function q5(e,{achievement:t,award:o},n){let r=zs(e.userName),i=!!t.sourceUrl,a=!w.data.hasShare||!r||!i,s=!r;return d`
		<div class="card-header">
			${o4(t)}
			<div class="card-header-item position-absolute top-0 right-0 margin-xs display-flex">
				${n?"":n4(t)}
				${s?"":Kb(t)}
			</div>
		</div>
		<div class="card-content">
			<p class="card-content-super-title">
				${o.awardType==="Badge"?kl:Wl}
			</p>
			${r4(t)}
			<ul class="card-content-metadata">
				<li>${i4(o)}</li>
			</ul>
		</div>
		<div ?hidden=${a} class="card-footer">
			<div class="card-footer-item">${Kb(t)}</div>
		</div>
	`}function Jq(e,t){return jn(e,r=>H5(e.user,r,t),{columns:t?4:3,cards:!0},t)}function Zq(e,t){return jn(e,r=>q5(e.user,r,t),{columns:t?4:3,cards:!0},t)}function B5(e,t,o,n){return t?d`<section id="trophies-section" ?hidden=${n} class="padding-bottom-md">
					${Zq(e.trophies,t)}
				</section>
				<section id="badges-section" ?hidden=${o} class="padding-bottom-md">
					${Jq(e.badges,t)}
				</section>`:d`<div class="tabs-container">
				${z5()}
				${Qq("learning-paths",Zq(e.trophies,t),n)}
				${Qq("modules-courses-more",Jq(e.badges,t),o)}
		  </div>`}function Qb(e,t){let o=e.badges.items.length===0,n=e.trophies.items.length===0;return o&&n?ht("achievements",e.isMECUser):d` ${e.isMECUser?Hb:""}
	${B5(e,t,o,n)}`}function Y5(){let e="image is-center-aligned",t=d`
		<img
			src="/media/profile/achievement-icon-background.png?branch=main"
			role="presentation"
			alt=""
		/>
	`;return d`
		<div class="position-absolute top-0 left-0 right-0 margin-inline-auto">
			<figure class="display-none-print is-64x64 is-96x96-desktop ${e}">
				${t}
			</figure>
			<figure class="is-hidden display-block-print is-128x128 ${e}">
				${t}
			</figure>
		</div>
	`}function G5(e){let t="image is-center-aligned",o=d`<img
		src="${e.userAchievement.iconUrl}"
		role="presentation"
		alt=""
	/>`;return d` <div class="position-absolute top-0 left-0 right-0 margin-inline-auto">
		<figure class="display-none-print is-48x48 is-76x76-desktop margin-top-xxs ${t}">
			${o}
		</figure>
		<figure class="is-hidden display-block-print is-96x96 margin-top-xs ${t}">
			${o}
		</figure>
	</div>`}function V5(e){return Gb(Y5(),G5(e))}function j5(e){return Yb(e.displayName,"margin-bottom-xxs margin-bottom-xs-desktop","margin-bottom-xs")}function W5(){return Bq(nk)}function K5(e){return Yq(e.userAchievement.title,"font-size-sm","font-size-h4")}function Q5(e){let t="metadata page-metadata color-text justify-content-center",o=d`
		<li>
			${jo(new Date(e.userAchievement.awardedDateUTC),{year:"numeric",month:"long",day:"numeric"})}
		</li>
		${e.userAchievement.durationInMinutes>-1?d`<li>${Vn(e.userAchievement.durationInMinutes)}</li>`:""}
	`;return d`
		<div class="has-line-height-reset">
			<ul class="display-none-print font-size-xs ${t}">
				${o}
			</ul>
			<ul class="is-hidden display-flex-print font-size-lg ${t}">
				${o}
			</ul>
		</div>
	`}function X5(e){let t=d`
		${V5(e)} ${j5(e)}
		${W5()} ${K5(e)}
		${Q5(e)}
	`;return Bb(t,"/media/profile/achievement-certificate-background.svg?branch=main","achievement-certificate")}function J5(e){return bl(e,"achievement-print",[{title:rh,icon:"docon-edit-outline",dataBiName:"achievement-edit-name",clickHandler:()=>{$d.goto(new URL(`${dt("me","settings").toString()}#edit-info-form`),"pushState")},isLink:!0}])}function a4(e){return d`
		<h2 class="font-size-h5 margin-bottom-xs margin-top-none display-none-print">
			${jx}
		</h2>
		<div class="background-color-body position-relative">
			<div class="padding-xxs border-bottom padding-bottom-md"></div>
			${X5(e)} ${J5(e)}
		</div>
	`}function Z5(e){if(!document.getElementById("code-redemption-section")){let o=d`<div
			id="code-redemption-section"
			class="padding-bottom-md display-none-print"
		>
			<h2 class="font-size-h5 margin-bottom-xs">${cp}</h2>
			<p>
				${iD}
				<button id="redemption-button" class="link-button">
					${BN}
				</button>
			</p>
		</div>`,n=document.querySelector("div.column.is-three-quarters.is-fullwidth-print"),r=document.createElement("div");I(o,r),n.prepend(r),document.getElementById("redemption-button").addEventListener("click",()=>{e4().show(),tj(),t4(e)})}e.code&&(e4(e.code).show(),t4(e))}function ej(e){return e?d`${KN}`:d`<span
			>${WN}&nbsp;
			<span class="icon" aria-hidden="true">
				<span class="docon docon-status-info-outline color-text"></span>
			</span>
		</span>`}function e4(e){let t=e?d`<input
				class="input"
				id="redemption-code-input"
				tabindex="-1"
				value=${e}
				type="text"
				disabled
		  />`:d`<input
				class="input"
				id="redemption-code-input"
				placeholder=${JN}
				type="text"
		  />`,o=document.createElement("div"),n=d`<section
		class="modal-card-body padding-xs justify-content-center"
		id="redemption-modal-card"
	>
		<header class="modal-card-head padding-none">
			<h2 class="font-size-h5 margin-bottom-none">${XN}</h2>
			<button
				class="modal-close modal-card-close-button color-text-subtle padding-xs"
				aria-label=${ze}
			></button>
		</header>
		<div class="margin-bottom-sm">
			<p class="font-size-sm color-text-subtle">
				${eD} ${y.upn}
			</p>
		</div>

		<div class="display-flex flex-direction-column">
			<div class="display-flex">
				<p class="font-weight-semibold font-size-md">${ej(e)}</p>
			</div>
			${t}
			<button
				class="button button-primary button-filled margin-top-sm align-self-flex-start"
				id="code-redemption-button"
			>
				${QN}
			</button>
			<p id="redeem-waiting-text" class="alert width-auto margin-top-sm padding-xxs" hidden>
				${ZN}
			</p>
		</div>
	</section>`,r=d`<div
		id="redemption-modal"
		class="modal is-active width-auto-tablet"
	>
		<div class="modal-background"></div>
		<div class="modal-card modal-content padding-xxs">${n}</div>
	</div>`;return I(r,o),new Ge(o)}function t4(e){let t=document.getElementById("code-redemption-button"),o=document.getElementById("redemption-code-input");t.addEventListener("click",()=>{t.classList.add("is-loading"),o.style.removeProperty("border");let n=document.getElementById("errorText");n&&n.parentElement.removeChild(n);let r=document.getElementById("redeem-waiting-text");r.hidden=!1,Uf.redeemCode(o.value).then(async a=>{let s=document.getElementById("error-text");s&&s.parentElement.removeChild(s);let c=document.createElement("div");c.id="error-text";let l;if(a.errorCode){switch(a.errorCode){case"NotFound":l=d`<p class="help help-danger">
								${VN}
							</p>`;break;case"AlreadyRedeemed":l=d`<p class="help help-danger">
								${YN}
							</p>`;break;case"ExceedsLimit":l=d`<p class="help help-danger">
								${GN}
							</p>`;break;default:l=d`<p class="help help-danger">
								${vy}
							</p>`;break}o.classList.add("input-danger"),I(l,c),o.after(c),t.classList.remove("is-loading")}if(a.redemptionCode){o.classList.remove("input-danger"),t.classList.remove("is-loading");let u=document.createElement("div"),p=d`<section
						id="redemption-modal-body"
						class="modal-card-body padding-xs display-flex flex-direction-column"
					>
						<button
							class="modal-close modal-card-close-button is-sticky margin-inline-sm color-text-subtle align-self-flex-start padding-xs"
							aria-label=${ze}
						></button>
						<header class="modal-card-head padding-none justify-content-center margin-bottom-sm">
							<img
								role="presentation"
								class="image is-128x128"
								src="/en-us/media/illustrations/success-code-redeem-or-copy.svg?branch=live"
							/>
						</header>

						<div class="display-flex flex-direction-column align-items-center">
							<h2 id="code-to-redeem" class="font-size-h5 centered margin-bottom-sm">
								${tD}
							</h2>
							<button id="done-button" class="button button-primary button-filled modal-close">
								${rD}
							</button>
						</div>
					</section>`;I(p,u),document.getElementById("redemption-modal-card").replaceWith(u),e.reload()}}).catch(()=>{let a=document.getElementById("error-text");a&&a.parentElement.removeChild(a);let s=document.createElement("div");s.id="error-text";let c=o.value?vy:nD,l=d`<p class="help help-danger">${c}</p>`;I(l,s),o.classList.add("input-danger"),o.after(s),t.classList.remove("is-loading")})})}function tj(e,t){let o=document.getElementById(e||"tooltip-trigger"),n=document.getElementById(t||"tooltip-area");o&&n&&(o.addEventListener("mouseenter",()=>{n.classList.add("display-flex")}),o.addEventListener("mouseleave",()=>{n.classList.remove("display-flex")}))}var Xb=[{factor:1e3,singular:gk,plural:sD},{factor:1e3*60,singular:ck,plural:lP},{factor:1e3*60*60,singular:uk,plural:xI},{factor:1e3*60*60*24,singular:ik,plural:nI},{factor:1e3*60*60*24*7,singular:hk,plural:BO},{factor:1e3*60*60*24*27,singular:lk,plural:dP}],oj=1.1;function s4(e,t){let o=e-t.getTime();if(o<5e3)return CI;let n=0;for(;Xb[n+1]&&o*oj>Xb[n+1].factor;)n++;let{factor:r,singular:i,plural:a}=Xb[n],s=Math.round(o/r);return s>3&&n===Xb.length-1?xP.replace("{date}",jo(t)):s===1?i:a.replace("{duration}",s.toString())}async function c4(e,t,o){let n=await A$(e.userName,t+1,o),r=nj(n,zs(e.userName)?Sr:e.displayName);return{totalCount:n.totalItems,items:r}}function nj(e,t){let o=[];return!e.items||!e.items.length?[]:(e.items.forEach(n=>{try{switch(n.activityType){case"module":let r=n;o.push({type:"module",datetime:new Date(r.timestamp),displayName:t,data:r.activityData});break;case"qnA":let i=n;o.push({type:i.activityData.parentType?sC(i.activityData.parentType):"question",action:i.type,datetime:new Date(i.timestamp),displayName:t,data:i.activityData});break;case"badge":let a=n;o.push({type:"badge",datetime:new Date(a.timestamp),title:a.activityData.title,iconUrl:a.activityData.iconUrl,url:a.activityData.url});break;case"certification":let s=n;o.push({type:"certification",datetime:new Date(s.timestamp),title:s.title,iconUrl:s.iconUrl,url:s.url});break;case"trophy":let c=n;o.push({type:"trophy",datetime:new Date(c.timestamp),title:c.activityData.title,iconUrl:c.activityData.iconUrl,url:c.activityData.url});break;case"profileCreation":let l=n;o.push({type:"profileCreation",datetime:new Date(l.activityData.createdOn)});break;case"lists":let u=n;o.push({type:"collection",datetime:new Date(u.timestamp),contentType:u.activityData.type.toLowerCase()==="bookmarks"?"bookmarks":"collection",title:u.activityData.title,url:C.reviewFeatures?`/test/profile/profile?username=${y.userName}&section=collections&detail=${u.activityData.id}`:`/users/${y.userName}/collections/${u.activityData.id}`,itemCount:u.activityData.count||0});break;default:break}}catch(r){Od.trackException(r)}}),o)}function sC(e){switch(e){case"idea":return"feedback";case"question":return"question";case"topic":return"topic";default:return null}}var Kd=class extends yt{constructor(t,o){super({title:o?VO:cg,load:(n,r)=>c4(t,n,o?qb:r),paging:!1})}};function l4(e=!1,t=!1,o){switch(o.type){case"module":return zf(o.data.userActivityProgress,o.datetime,o.data.iconUrl,o.data.title,o.data.url,o.data.durationInMinutes,o.data.remainingTime,o.type,o.data.userActivityProgress,o.data.xPPoints,e?"h4":"h3");case"question":case"feedback":return vl(o.datetime,d`${aj(o,t)}`,null,o.data.parentTitle,o.data.uri,o.type,Fb(o.data.nrUpvotes,o.data.nrComments,o.data.nrAnswers),e?"h4":"h3");case"topic":return d` <article class="font-size-sm">
				<h3 class="margin-bottom-xs">
					<span class="display-block margin-bottom-xs font-weight-normal">
						${ie(rj(o))}
						<time datetime="${o.datetime.toUTCString()}">
							${s4(Date.now(),o.datetime)}
						</time>
					</span>
					<a class="display-block font-size-sm" href="${o.data.uri}"> ${o.data.title} </a>
				</h3>
			</article>`;case"profileCreation":return Mq(new Date(o.datetime));case"certification":return vl(o.datetime,d`${qL}`,o.iconUrl,o.title,o.url,o.type,"",e?"h4":"h3");case"badge":return vl(o.datetime,d`${zL}`,o.iconUrl,o.title,o.url,o.type,"",e?"h4":"h3");case"trophy":return vl(o.datetime,d`${FL}`,o.iconUrl,o.title,o.url,o.type,"",e?"h4":"h3");case"collection":let n=o;return zb(n.datetime,n.title,n.url,n.contentType,n.itemCount,e?"h4":"h3");default:throw new Error("Unsupported activity type")}}function rj(e){switch(e.action){case"commented":return rN.replace("{displayName}",e.displayName).replace("{activity}",Bf(u4(e)));case"labeled":return iN.replace("{displayName}",e.displayName).replace("{activity}",Bf("tag"));case"accepted":return nN.replace("{displayName}",e.displayName).replace("{activity}",Bf("question"));case"edited":case"voted":return`${e.displayName} ${d4(e.action)} ${Bf(`${u4(e)}`)}`;default:return`${e.displayName} ${d4(e.action)} ${Bf(`${e.type}`)}`}}function Bf(e){return`<strong class="font-weight-semibold is-lowercase">${ij(e)}</strong>`}function u4(e){switch(e.type){case"question":return"question thread";default:return e.type}}function d4(e){switch(e){case"accepted":return HR;case"answered":return qR;case"asked":return Fg;case"commented":return BR;case"edited":return YR;case"labeled":return GR;case"posted":return VR;case"suggested":return jR;case"voted":return WR;default:return FR}}function ij(e){switch(e){case"tag":return QR;case"feedback":return JR;case"question":return ZR;case"question thread":return eN;case"topic":return XR;default:return KR}}function Jb(e,t=!1,o=!0){return!e.items||e.items.length===0?ht("activity"):d`
		${jn(e,l4.bind(l4,!0,t),{columns:1,cards:!1,layoutStyle:"smallSpace",groupListItems:!0},o)}
		<p class="font-size-sm">${OL}</p>
	`}function aj(e,t){switch(e.data.actionVerb){case"commented":return t?Ay.replace("{displayName}",e.displayName):Ay.replace("{displayName}",Sr);case"accepted":return t?wy.replace("{displayName}",e.displayName):wy.replace("{displayName}",Sr);case"edited":return t?Iy.replace("{displayName}",e.displayName):Iy.replace("{displayName}",Sr);case"voted":return t?Ny.replace("{displayName}",e.displayName):Ny.replace("{displayName}",Sr);case"answered":return t?Cy.replace("{displayName}",e.displayName):Cy.replace("{displayName}",Sr);case"asked":return t?ky.replace("{displayName}",e.displayName):ky.replace("{displayName}",Sr);case"suggested":return t?Ry.replace("{displayName}",e.displayName):Ry.replace("{displayName}",Sr);default:let o=Fs(e.type);return t?Py.replace("{displayName}",e.displayName).replace("{activityType}",o):Py.replace("{displayName}",Sr).replace("{activityType}",o)}}var Zb=class{constructor(t){this.container=document.createElement("div"),this.container.setAttribute("role","alert"),this.container.setAttribute("aria-live","assertive"),this.container.setAttribute("data-dismissable","disappearing"),this.container.classList.add("toast"),this.container.appendChild(t),this.wrapper=document.createElement("div"),this.wrapper.insertAdjacentElement("afterbegin",this.container),this.contentElement=t}show(){let t=document.querySelector(".toast");t&&x_(t),document.body.insertAdjacentElement("afterbegin",this.container),this.container.classList.add("appearing"),setTimeout(()=>{lc()},10),setTimeout(()=>{x_(this.container)},3500)}};function xl(e,t=tr){let o=new URL(e||location.href);o.searchParams.set("account-linking","1"),t(o.href)}function p4({certificationLink:e,modal:t}){let{errorCode:o,linkedMSA:n,status:r}=e,i=n?.mcId,a=n?.msaEmail||y.authenticationModes.find(g=>g.type==="MSA")?.upn,s,c,l,u,p,m,f=!1,h="https://docs.microsoft.com/certifications/aligning-accounts-between-certification-profile-and-learn-profile";r===200?(s=Rk,c=pg,l=dg,u=ug,f=!0,p=async()=>{t.hide(),await yl(e,!0,null)},m=()=>t.hide()):o==="wwlProfileAlreadyLinked"?(s=Ok,c=Uk,l=Xx,f=!0,p=()=>window.open("https://aka.ms/certhelp","_self")):o==="docsProfileMsaNotFound"?(s=Ik,c=Pk,l=Ak,p=()=>{t.hide(),xl()}):o==="wwlProfileNotFound"?(s=Lk,c=Mk.replace("{msaEmail}",a),l=Fk,p=()=>window.open(h,"_self")):o==="docsProfileMergeInProgress"?(s=$k,c=zk,l=Fl,p=()=>$t()):(s=Bk,c=Nk,l=ze,u=Xx,p=()=>t.hide(),m=()=>window.open("https://aka.ms/certhelp","_self"));let _=d`
		<div class="margin-bottom-xs">
			${r===200?d`<p class="font-size-sm">
						${fg}:
				  </p>`:""}
			<p id="linked-email" class="font-size-sm font-weight-semibold">${a}</p>
			${i?d`<p id="linked-mcid" class="font-size-sm font-weight-semibold">
						${Hl}: ${i}
				  </p>`:""}
		</div>
	`;return d`
		<div class="modal-card padding-xs">
			<div class="padding-xs">
				<h1 class="title font-size-h5 margin-bottom-xs">${s}</h1>
				<button
					class="modal-close modal-card-close-button font-size-lg is-sticky"
					aria-label="${ze}"
				></button>
				${f?_:""}
				<p class="font-size-sm margin-bottom-xs">
					${mg}
				</p>
				<p id="description" class="font-size-sm margin-bottom-xs">
					${r===200?ie(c):c}
				</p>
				<div class="buttons">
					<button
						class="button button-primary button-filled font-size-sm margin-none"
						type="submit"
						@click=${Hf.timeout(()=>p())}
					>
						${l}
					</button>
					<button
						class="modal-close link-button font-size-sm font-weight-semibold margin-left-xs"
						@click=${m}
					>
						${u}
					</button>
				</div>
			</div>
		</div>
	`}async function yl(e,t,o){let n=document.createElement("div");n.classList.add("modal-content");let r=new Ge(n),i=e||await Ot.getLinkedMSA();if((fo.kind==="certification"||fo.kind==="certificationrenewal")&&fo.type==="learn"&&await Ya(),t===!0){let a=document.querySelectorAll(".button.button-primary.button-filled")[0];a&&a.classList.add("is-loading");let{status:s}=await Ot.postCertificationLink();if(a&&a.classList.remove("is-loading"),s===204)return(fo.kind==="certification"||fo.kind==="certificationrenewal")&&fo.type==="learn"&&(cj(Dk),setTimeout(function(){location.reload()},1e3)),fo.kind==="detail"&&fo.type==="profile"&&location.reload(),fo.kind==="register"&&o&&o(),null;I(p4({certificationLink:i,modal:r,previousModal:!0}),n)}else I(p4({certificationLink:i,modal:r,previousModal:t}),n);return o?o():sj(),r.show()}var cC=null;function sj(){cC&&(I(d``,cC),cC=null)}function cj(e){let t=d`
		<div class="toast" role="alert" aria-live="assertive" data-dismissable="dissapearing">
			<div
				class="has-background-dark-opacity has-text-overlay-invert container is-max-desktop border-radius-lg"
			>
				<p class="padding-sm has-text-centered">
					<span class="icon" aria-hidden="true">
						<span class=" docon docon-status-success-outline"></span>
					</span>
					<span> ${e} </span>
					<button
						data-dismiss
						type="button"
						class="dismiss delete position-absolute
						top-0 right-0 margin-xxs is-large"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-navigate-close"></span>
						</span>
					</button>
				</p>
			</div>
		</div>
	`,o=document.createElement("div");I(t,o),new Zb(o).show()}function ex(e,t=!1){let o=new URL(location.href);if(C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online")o.searchParams.set("detail",t?"certification-print":"certification-details"),o.searchParams.set("id",e||o.searchParams.get("id"));else{let[,n,r,i,a]=decodeURIComponent(o.pathname).toLowerCase().split("/");o.pathname=`/${n}/${r}/${i}/${a}/${t?"certification-print":"certification-details"}/${e}`}return o.toString()}function Hs(e){let t=w.data?.userLocale?w.data.userLocale:"en-us";return`${location.origin}/${t}${e}`}function Gf(e){let t=new URL(location.href);if(C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online")switch(e){case 3:t.searchParams.set("detail","appointments");break;case 1:t.searchParams.set("detail","certifications");break;case 4:t.searchParams.set("detail","exams");break;case 5:t.searchParams.set("detail","renewal-assessments");break;default:break}else switch(e){case 3:t.pathname+=`/${"appointments"}`;break;case 1:t.pathname+=`/${"certifications"}`;break;case 4:t.pathname+=`/${"exams"}`;break;case 5:t.pathname+=`/${"renewal-assessments"}`;break;default:break}return t.toString()}function lj(e,t){return d`<div class="display-flex justify-content-space-between margin-bottom-xs">
		<div class="font-weight-semibold">${t} ${eM}</div>
		<div class="display-flex justify-content-flex-end align-items-center">
			<p class="font-size-sm margin-right-xxs">
				${e===1?lM:uM}
			</p>
			<span class="docon docon-arrow-down font-size-sm" aria-hidden="true"></span>
		</div>
	</div>`}function Vf(e,t,o,n=!1,r=0){return e.unexpectedError===1?jd():n===void 0?ht("certifications"):n?r===0?ht("certifications"):d`
			<section class="padding-bottom-sm margin-bottom-md">
				<h2 class="font-size-xl margin-top-xs margin-bottom-sm">${e.title}</h2>
				${lj(o,r)}
				${jn(e,t,{columns:1,cards:!1},!1)}
			</section>
		`:d`<section>${Tl()}</section>`}function Tl(){return d`
		<h2 class="title is-5 margin-bottom-xs">${rn}</h2>
		<div id="linking-profile-modal-template" class="container margin-left-none">
			<article
				class="card border-radius-lg padding-xs has-background-image"
				style="background-image: url('/en-us/media/profile/certification-no-linking.svg?branch=main');"
			>
				<div class="card-content padding-top-none padding-bottom-xs  margin-top-none columns">
					<div class="column is-three-quarters">
						<p class="card-content-super-title">
							${Yk}
						</p>
						<h5 class="font-size-h5 margin-top-xxs margin-bottom-md">
							${XD}
						</h5>
						<div class="content">
							<div class="padding-bottom-xs">
								<p>${WD}</p>
								<ul class="margin-left-none">
									<p class="margin-bottom-xxs">
										${QD}
									</p>
									<li class="margin-left-xs margin-bottom-xxs">
										${aL}
									</li>
									<li class="margin-left-xs margin-bottom-xxs">
										${gL}
									</li>
								</ul>
								<p>${JD}</p>
							</div>
							<div class="margin-top-sm">
								<button
									class="button button-primary button-filled margin-right-xs margin-bottom-xs margin-bottom-none-tablet"
									@click=${()=>yl()}
								>
									${Hk}
								</button>
								<a
									class="link-button font-weight-semibold margin-top-xxs"
									href="${`${C.supportLevel==="development"&&C.accessLevel==="online"||C.supportLevel==="production"&&C.reviewFeatures?"/test":""}/certifications/browse/`}"
									>${VD}
								</a>
							</div>
						</div>
					</div>
				</div>
			</article>
		</div>
	`}function g4(e){let t=new Date(e),o=new Date,n=t.getTime()-o.getTime();return{comingUpSoon:Xw(n)<=7}}function tx(e){if(!e)return{expiresDate:"",willExpire:!1,isExpired:!1};let t=new Date(e),o=new Date,n=t.getTime()-o.getTime(),r=Xw(n);return{expiresDate:new Intl.DateTimeFormat(w.data.userLocale).format(new Date(e)),willExpire:r<180,isExpired:n<=0}}var ox=class extends yt{constructor(){super({title:Yl,load:async(o,n)=>{try{let{examAppointments:r,isCertificationLinked:i,totalCount:a}=await Ot.getExamAppointments(o,n),s=r;return this._isLinked=i,this._totalCount=a,this._isLinked&&r!==null?{items:s,totalCount:a}:(s=[],{items:s,totalCount:0})}catch{return this._unexpectedError=1,{items:[],totalCount:0}}},paging:!0,pageSize:10});this._isLinked=!1}get isLinked(){return this._isLinked}get totalCount(){return this._totalCount}};function nx({examAppointmentConfirmationCode:e,examAppointmentTime:t,examDetailsURL:o,examLocation:n,examProvider:r,examTitle:i,examURL:a,isOnline:s,systemCheckURL:c,urlCancel:l,urlReschedule:u},p=!1){let{comingUpSoon:m}=g4(t);return d`
		<article
			class="certifications-appointment card flex-direction-row ${p?"padding-sm":"padding-none"} is-shadowless"
		>
			<div class="flex-grow-1">
				<div class="margin-bottom-xs padding-top-md">
					<div class="card-content padding-none">
						<p class="card-content-super-title">${VL}</p>
						${o?d`
									<a href="${Hs(o)}" class="card-content-title">
										<h3>${i}</h3>
									</a>
							  `:d` <h3>${i}</h3> `}
						<ul class="card-content-metadata has-bullets">
							<li class="margin-none">
								${s?Ly:ZL}
							</li>
							<li>${Zg} ${r}</li>
						</ul>
					</div>
					<div class="width-100 border-bottom position-relative bottom-0" aria-hidden="true"></div>
					${s?d` <div class="margin-top-xs display-none-desktop">
								<a
									type="button"
									data-bi-name="go-to-exam"
									target="_blank"
									href="${a}"
									class="button button-primary button-sm button-filled margin-bottom-xxs"
								>
									${Dy}
								</a>
								<p class="font-size-sm margin-bottom-xxs">
									<a
										data-bi-name="system-check"
										target="_blank"
										href="${c}"
										class="has-external-link-indicator"
									>
										${My}
									</a>
								</p>
								<div
									class="width-100 border-bottom position-relative bottom-0 display-none-desktop"
									aria-hidden="true"
								></div>
						  </div>`:""}
				</div>
				<div class="card-content margin-bottom-xxs padding-none position-relative">
					<h3 class="card-content-title">${oM}</h3>
					${uj(s,n)}
					<h3 class="card-content-title">${dM}</h3>
					<p class="color-text-subtle font-size-sm margin-bottom-xs">
						${`${qd().format(new Date(t))} (UTC ${Bd(new Date(t))})`}
					</p>
					<h3 class="card-content-title">${WL}</h3>
					<p class="color-text-subtle font-size-sm margin-bottom-xs">
						${e}
					</p>

					<div class="width-100 border-bottom position-relative bottom-0" aria-hidden="true"></div>
				</div>
				<div class="card-footer is-left font-size-sm padding-none border-top-none">
					${l?d` <a
								class="margin-right-sm has-external-link-indicator redirect"
								data-bi-name="cancel-appointment"
								role="listitem"
								target="_blank"
								href="${l}"
						  >
								${Je}
						  </a>`:""}
					${u?d` <a
								role="listitem"
								class="has-external-link-indicator redirect"
								data-bi-name="reschedule-appointment"
								target="_blank"
								href="${u}"
						  >
								${sM}
						  </a>`:""}
				</div>
			</div>
			<div class="display-flex flex-direction-column align-items-flex-end padding-right-sm-tablet">
				${m?d`
							<span class="tag is-warning border-radius-rounded is-small margin-top-xxs"
								>${QL}</span
							>
					  `:""}
				${s?d` <div
							class="display-none display-flex-desktop flex-direction-column justify-content-center align-items-flex-end-desktop flex-grow-1"
					  >
							<a
								type="button"
								data-bi-name="go-to-exam"
								target="_blank"
								href="${a}"
								class="button button-primary button-sm button-filled margin-bottom-xxs"
							>
								${Dy}
							</a>
							<p class="font-size-sm">
								<a
									data-bi-name="system-check"
									target="_blank"
									href="${c}"
									class="has-external-link-indicator"
								>
									${My}
								</a>
							</p>
					  </div>`:""}
			</div>
		</article>
	`}function uj(e,t){if(e)return d`<p class="color-text-subtle font-size-sm margin-bottom-xs">
			${Ly}
		</p>`;if(t){let{city:o,country:n,state:r,streetAddress:i,testCenter:a,zip:s}=t;return d`
			<div class="color-text-subtle font-size-sm margin-bottom-xs">
				<p>${a}</p>
				<p>${`${i} ${o}, ${r||""}, ${n}, ${s}`}</p>
			</div>
		`}return d``}var rx=class extends Ye{constructor(o){super();this._isLinked=!1;this._id=o}get certificate(){return this._certificate}get isLinked(){return this._isLinked}async beforeActivate(){let{certifications:o,certificationLinked:n}=await Ot.getCertificationDetail(this._id);this._certificate=o[0],this._isLinked=n}};function _4(e){let{badgeShareUrl:t,certificationNumber:o,certificationRenewURL:n,certificationURL:r,dateEarned:i,expiration:a,extensionDate:s,iconUrl:c,id:l,name:u,renewedDate:p,status:m}=e.certificate,{willExpire:f}=tx(a);return e.isLinked===void 0?ht("certifications"):e.isLinked?e.certificate?d`
		<section class="padding-bottom-sm margin-bottom-md">
			<h2 class="font-size-xl margin-top-xs margin-bottom-sm">
				${gM}
			</h2>
			<div class="card is-shadowless is-horizontal padding-sm padding-md-desktop padding-md-tablet">
				<div class="display-flex width-full width-auto-desktop justify-content-space-between">
					<div
						class="card-header margin-none padding-none padding-right-sm-desktop padding-bottom-xs"
						aria-hidden="true"
					>
						<figure class="image is-128x128-desktop is-128x128-tablet is-64x64">
							<img
								role="presentation"
								alt=""
								src="${c||c!==null?c:"/en-us/media/learn/certification/badges/microsoft-certified-fundamentals-badge.svg"}?branch=main"
							/>
						</figure>
					</div>
					${h4(m,!0)}
				</div>
				<div class="card-content margin-bottom-none padding-left-none padding-right-none">
					<div
						class="display-flex justify-content-space-between align-items-flex-end margin-bottom-md"
					>
						${r?d` <a class="card-content-title font-size-xl" href="${r}">
									<h3>${u}</h3>
							  </a>`:d`<h3 class="card-content-title margin-bottom-md">${u}</h3>`}
						${h4(m)}
					</div>
					${m==="Active"&&f&&n?d`
								<div class="display-flex align-items-center margin-bottom-md">
									<a
										type="button"
										data-bi-name="renew-cert"
										class="button button-primary button-sm button-filled margin-right-sm"
										href="${n}"
									>
										${Sp}
									</a>
									<p class="font-size-sm color-text-subtle">
										${kp}
										${tn.format(new Date(s))}
									</p>
								</div>
						  `:""}
					<div class="font-size-sm margin-bottom-sm">
						<a
							class="margin-right-md"
							role="listitem"
							data-bi-name=" view-printable-certificate"
							href="${ex(l,!0)}"
						>
							${nM}
						</a>
						${t!==""?d` <a
									role="listitem"
									class="has-external-link-indicator"
									target="_blank"
									data-bi-name="share-cert-badge"
									href="${t}"
							  >
									${ba}
							  </a>`:""}
					</div>
					<div
						class="has-width-100 border-bottom position-relative bottom-0 margin-bottom-sm"
						aria-hidden="true"
					></div>

					${a===null?"":d`
								<h3 class="card-content-title">
									${m==="Expired"?mh:fh}
								</h3>
								<p class="color-text-subtle font-size-sm margin-bottom-md">
									${`${qd().format(new Date(a))} (UTC ${Bd(new Date(a))})`}
								</p>
						  `}
					${p?d` <h3 class="card-content-title">${aM}</h3>
								<p class="color-text-subtle font-size-sm margin-bottom-md">
									${tn.format(new Date(p))}
								</p>`:""}

					<h3 class="card-content-title">${Qg}</h3>
					<p class="color-text-subtle font-size-sm margin-bottom-md">
						${tn.format(new Date(i))}
					</p>
					${o?d`
								<h3 class="card-content-title">Certification number</h3>
								<p class="color-text-subtle font-size-sm margin-bottom-md">
									${o}
								</p>
						  `:""}
				</div>
			</div>
		</section>
	`:ht("certifications"):d`<section>${Tl()}</section>`}function h4(e,t=!1){switch(e){case"Expired":return d`
				<span
					class="display-none${t?"-desktop":""} ${t?"":"display-flex-desktop"} tag border-radius-rounded is-small"
				>
					${Cp}
				</span>
			`;case"Retired":return d`
				<span
					class="display-none${t?"-desktop":""} ${t?"":"display-flex-desktop"} tag border-radius-rounded is-small"
				>
					${Ap}
				</span>
			`;default:return d`
				<span
					class="display-none${t?"-desktop":""} ${t?"":"display-flex-desktop"} tag is-success border-radius-rounded is-small"
					>${Ws}
				</span>
			`}}var ix=class extends Ye{constructor(o,n){super();this.id=o;this.user=n;this._busy=!1;this._certificate=null;this._editDisplayName=!1;this._fetchError=!1;this._isLinked=!1;this._displayName=n.displayName,this._id=o,this._printableOptions=n.certificationSettings?.print,this._userProfile=n}async beforeActivate(){let{certification:o,isCertificationLinked:n,profile:r}=await Ot.getPrintableCertification(this._id);this._certificate=o,this._isLinked=n,r!==null&&(this._legalName=`${r.firstName} ${r?.middleName} ${r.lastName}`)}async updatePrintableSettings(o){if(this.busy)throw new Error("Busy");this._userProfile.certificationSettings=o,this._printableOptions=o.print,this.setBusy();try{await Uo(this.userName,this._userProfile),this.clearFetchError()}catch(n){throw this.setFetchError(),n}finally{this.setReady()}}get busy(){return this._busy}get certificate(){return this._certificate}clearFetchError(){this._fetchError=!1}get displayName(){return this._displayName}get editDisplayName(){return this._editDisplayName}set editDisplayName(o){this._editDisplayName=o,this.notifyPropertyChanged()}get fetchError(){return this._fetchError}get isLinked(){return this._isLinked}get legalName(){return this._legalName}notifyPropertyChanged(){this.publish(new Ae)}get printableOptions(){return this._printableOptions}set printableOptions(o){this._printableOptions=o,this.notifyPropertyChanged()}setBusy(){this._busy=!0,this.notifyPropertyChanged()}setReady(){this._busy=!1,this.notifyPropertyChanged()}setFetchError(){this._fetchError=!0}get userName(){return this._userProfile.userName}};function v4(e){if(e.isLinked===void 0)return ht("certifications");if(!e.isLinked)return d`<section>${Tl()}</section>`;if(!e.certificate)return ht("certifications");let t={title:Uy,icon:"docon-document-management",dataBiName:"certificate-settings",clickHandler:()=>pj(e)},o=Ne.inlineEdit?{title:AM,icon:"docon-edit-outline",dataBiName:"edit-name",clickHandler:()=>jq(e)}:{title:rh,icon:"docon-edit-outline",dataBiName:"edit-name",clickHandler:i=>{i.preventDefault(),location.href=`${dt("me","settings").toString()}#edit-info-form`}},n=[t,o],r="/media/profile/certificate-background.svg?branch=main";return d` <h2 class="font-size-h5 margin-bottom-xs margin-top-none display-none-print">
			${rM}
		</h2>
		<div class="background-color-body position-relative">
			<div class="padding-xxs border-bottom padding-bottom-md"></div>
			${Bb(mj(e),r,"dashboard-certificate")}
			${Ne.inlineEdit?e.editDisplayName?Gq(e):bl(e,"print-certificate",n):bl(e,"print-certificate",n)}
		</div>`}async function pj(e){let t=e.user.certificationSettings;await jb(e,()=>({id:"certification",title:Uy,busy:e.busy,submitHandler:async n=>{let i=n.target.querySelectorAll('input[type="checkbox"]'),a={print:{...e.printableOptions,showLegalName:i[0].checked}};await e.updatePrintableSettings(a),Vb("certification",a.print)},fieldsets:[{subtitle:nh,checkboxes:[{id:"choice-print-legal-name",name:"print-legal-name",checked:e.user.certificationSettings.print?e.printableOptions.showLegalName:null,label:cM}]}]})),e.fetchError&&(e.printableOptions=t.print,e.clearFetchError())}function mj(e){return d`
		<div>
			${Gb(fj(e))}
			${e.editDisplayName?Vq(e):Yb(e.displayName)}
			${hj(e.legalName)} ${gj(e.certificate)}
		</div>
	`}function fj({certificate:{iconUrl:e}}){let t="image is-center-aligned";return d`
		<div class="position-absolute top-0 left-0 right-0 margin-inline-auto">
			<figure class="display-none-print is-64x64 is-96x96-desktop ${t}">
				<img
					src="${e||e!==null?e:"/en-us/media/learn/certification/badges/microsoft-certified-fundamentals-badge.svg"}?branch=main"
					role="presentation"
					alt=""
				/>
			</figure>
			<figure class="is-hidden display-block-print is-128x128 ${t}">
				<img
					src="${e||e!==null?e:"/en-us/media/learn/certification/badges/microsoft-certified-fundamentals-badge.svg"}?branch=main"
					role="presentation"
					alt=""
				/>
			</figure>
		</div>
	`}function gj({certificationNumber:e,dateEarned:t,expiration:o,name:n}){return d`
		<div class="font-size-xs has-text-centered">
			<p class="font-size-sm">
				${JL}
			</p>
			<h3 class="font-size-md font-weight-bold margin-top-xxs margin-bottom-xxs">${n}</h3>
			<p>
				${GL.replace("{date}",Kw().format(new Date(t)))}
			</p>
			${o?d`<p>
						${pM.replace("{date}",Kw().format(new Date(o)))}
				  </p>`:""}
			<p>
				${jL.replace("{number}",e)}
			</p>
		</div>
	`}function hj(e=""){return e?d`
			<p id="#${"certification"}-legal-name" class="font-size-xs has-text-centered">
				(${tM}: ${e})
			</p>
		`:d``}var ax=class extends yt{constructor(){super({title:rn,load:async(o,n)=>{try{let r,{certifications:i,certificationLinked:a,totalCount:s}=await Ot.getCertifications(o,n);return r=i,this._isLinked=a,this._totalCount=s,this._isLinked&&i!==null?{items:r,totalCount:s}:(r=[],{items:r,totalCount:0})}catch{return this._unexpectedError=1,{items:[],totalCount:0}}},paging:!0,pageSize:10});this._isLinked=!1}get isLinked(){return this._isLinked}get totalCount(){return this._totalCount}};function sx({certificationURL:e,certificationRenewURL:t,dateEarned:o,expiration:n,extensionDate:r,iconUrl:i,id:a,name:s,status:c,isEligibleForRecertification:l},u=!1){let{willExpire:p}=tx(n);return d`
		<article
			class="certifications-certification card ${u?"padding-sm":"padding-top-none"} flex-direction-row is-shadowless"
		>
			<div class="card-header margin-bottom-none padding-left-none" aria-hidden="true">
				<figure class="card-header-image">
					<img
						role="presentation"
						alt=""
						src="${i||i!==null?i:"/en-us/media/learn/certification/badges/microsoft-certified-general-badge.svg"}?branch=main"
					/>
				</figure>
			</div>
			<div class="card-content margin-bottom-none padding-none">
				<div class="display-flex justify-content-space-between padding-right-sm-tablet">
					<p class="card-content-super-title flex-wrap-wrap margin-right-xxs">
						${Al}
					</p>
					${b4(c,p,r)}
				</div>
				${_j(e,s)}
				${bj(c,l,n,o)}
				${!!r&&!!t||!!a?d`
							<div>
								<div class="width-100 border-bottom margin-bottom-xxs"></div>
								${yj(c,p,r,t)}
								${vj(a)}
							</div>
					  `:""}
			</div>
			${c==="Active"&&!!r&&!!t?b4(c,p,r,t):""}
		</article>
	`}function _j(e,t){return e?d`
		<a
			class="card-content-title margin-bottom-xs"
			href="${Hs(e)}"
		>
			<h3>${t}</h3>
		</a>
	`:d`<h3 class="card-content-title margin-bottom-xs">${t}</h3>`}function vj(e){return e?d`<a
		class="font-size-sm"
		data-bi-name="view-cert-details"
		href="${ex(e)}"
	>
		${UO}
	</a>`:d``}function bj(e,t,o,n){return d`
		<ul class="card-content-metadata has-bullets margin-bottom-xxs">
			${xj(e,t,o)}
			<li>
				${Qg} ${tn.format(new Date(n))}
			</li>
		</ul>
	`}function xj(e,t,o){return!!o&&e==="Active"?d`
			<li
				class="margin-none ${t?"color-danger font-weight-semibold":""} margin-bottom-xxs"
			>
				${Jx.replace("{date}",`${qd().format(new Date(o))} (UTC ${Bd(new Date(o))})`)}
			</li>
		`:d``}function yj(e,t,o,n){return e==="Active"&&t&&!!o&&!!n?d`
			<div class="display-flex display-none-desktop flex-direction-column align-items-flex-start">
				<p class="font-size-sm color-text-subtle margin-right-sm margin-bottom-xs">
					${kp}
					${tn.format(new Date(o))}
				</p>
				<a
					type="button"
					data-bi-name="renew-cert"
					class="button button-primary button-sm button-filled margin-bottom-xs"
					href="${n}"
				>
					${Sp}
				</a>
			</div>
		`:d``}function b4(e,t=!1,o,n){switch(e){case"Expired":return d`
				<span class="display tag border-radius-rounded is-small">
					${Cp}
				</span>
			`;case"Retired":return d`
				<span class="display-flex tag border-radius-rounded is-small">
					${Ap}
				</span>
			`;default:return!!o&&t&&!!n?d`
					<div
						class="display-flex-desktop flex-direction-column align-items-flex-end padding-right-sm-tablet"
					>
						<span class="display-flex-desktop tag is-success border-radius-rounded is-small"
							>${Ws}
						</span>
						<div class="display-none display-flex-desktop align-items-center flex-grow-1">
							<p class="font-size-sm color-text-subtle margin-right-xs">
								${kp}
								${tn.format(new Date(o))}
							</p>
							<a
								type="button"
								data-bi-name="renew-cert"
								class="button button-primary button-sm button-filled"
								href="${n}"
							>
								${Sp}
							</a>
						</div>
					</div>
				`:!!o&&!t&&!!n?d`
					<div class="padding-right-sm-tablet">
						<span class="display-flex tag is-success border-radius-rounded is-small"
							>${Ws}
						</span>
					</div>
				`:!!o&&!n?d``:d`
					<div>
						<span class="display-flex tag is-success border-radius-rounded is-small"
							>${Ws}
						</span>
					</div>
				`}}function x4(){let e=te("original_content_git_url")||te("original_ref_skeleton_git_url")||"",t=e;if(t!==""&&t.substring(0,8)==="https://")try{let o=new URL(e);t=`${o.pathname}${o.search}`}catch{t=t.substring(8)}return t}function y4(){let e=Tj(),t;return nc?t=`/${w.data.userLocale}/test/learn/support/troubleshooting${e}`:t=`/${w.data.userLocale}/learn/support/troubleshooting${e}`,t}function Tj(){let e={uid:te("uid")||"",documentId:te("document_id")||"",versionIndependentDocumentId:te("document_version_independent_id")||"",contentPath:x4(),url:location.href,author:te("ms.author")||""},t=Object.keys(e).reduce((o,n)=>{let r=e[n];return r===void 0||r.trim().length===0||o.push(`${n}=${encodeURIComponent(r)}`),o},[]);return t.length===0?"":`?${t.join("&")}`}var T4=6,Jr={Cancel:{text:Je,clickHandler:Et,modifiers:"button-primary",biName:"add-account-error-cancel"},ContactCustomerSupport:{text:KA,clickHandler:()=>{location.href=y4()},modifiers:"button-primary button-filled",biName:"add-account-error-contact-support"},Ok:{text:kn,clickHandler:Et,modifiers:"button-primary button-filled",biName:"add-account-error-ok"},SelectAccount:{text:hL,clickHandler:()=>xl(),modifiers:"button-primary button-filled",biName:"add-account-error-select-account"}};function Sj(e){return{accountAlreadyRegistered:{title:MD.replace("{account}",e),description:jD,buttons:[Jr.Cancel,Jr.SelectAccount]},alreadyHasCertProfileConnected:{title:_L,description:vL,buttons:[Jr.ContactCustomerSupport]},alreadyLinked:{title:oL,description:Sy,buttons:[Jr.Cancel,Jr.SelectAccount]},moreThanOneAccountPerTenant:{title:FD.replace("{organization}",e.substring(e.indexOf("@"))),description:`${dL} ${Sy}.`,buttons:[Jr.Ok]},moreThanOneMSAAccount:{title:pL,description:nL.replace("{account}",e),buttons:[Jr.Ok]},needAtLeastOneAccountLinked:{title:lL,description:GD,buttons:[Jr.Ok]},numberOfAccounts:{title:OD,description:UD,buttons:[Jr.Ok]},profileMergeRunning:{title:mL,description:fL,buttons:[Jr.Ok]},unexpectedError:{title:go,buttons:[Jr.Ok]}}}function cx(e,t){let o=Sj(e)[t];return d`
		<button
			data-dismiss
			type="button"
			class="dismiss delete modal-close position-absolute delete-lg margin-top-xs margin-right-xs top-0 right-0"
			@click="${Et}"
			aria-label="${ze}"
		>
			<span class="docon docon-navigate-close" aria-hidden="true"></span>
		</button>
		${o.title?d`<h2 class="title margin-top-xs">${o.title}</h2>`:null}
		${o.description?d`<p>${ie(o.description)}</p>`:null}
		${o.buttons?d`<div class="display-flex font-size-sm justify-content-flex-end margin-top-sm">
					${o.buttons.map(n=>d`<button
								type="button"
								class="button modal-close align-self-center margin-right-xxs font-size-sm ${n.modifiers}"
								@click="${n.clickHandler}"
								data-bi-name="${n.biName}"
							>
								${n.text}
							</button>`)}
			  </div>`:null}
	`}function lx(e,t,o,n=[]){return o.credentialId===e?"alreadyLinked":o.authenticationModes.length>=T4||n.length+o.authenticationModes.length>=T4?"numberOfAccounts":(t==="MSA"||n.find(r=>r.type==="MSA")!==void 0)&&o.authenticationModes.find(r=>r.type==="MSA")!==void 0?"moreThanOneMSAAccount":null}function w4(e,t,o,n){let r=e.querySelector("#create-opt-in-checkbox"),i=e.querySelector("#create-opt-in-notice");switch(t){case"opt-in":case"double-opt-in":i.hidden=!0,I(E4(t),r),ux(e,o,n);break;case"opt-out":i.hidden=!0,I(E4(t,!0),r),ux(e,o,n);break;case"notice":i.hidden=!1,I(d``,r),S4(yP,i),ux(e,o,n,t);break;case"none":i.hidden=!1,I(d``,r),S4(TP,i),ux(e,o,n,t);break}}function S4(e,t){return I(d`${ie(e)}`,t)}function E4(e,t=!1){return d` <label class="checkbox">
		<input
			type="checkbox"
			class="opt-in"
			name="${e}"
			.checked=${t}
			aria-label="${SP}"
		/>
		<span class="checkbox-check" role="presentation"></span>
		<span class="checkbox-text">${ie(EP)}</span>
	</label>`}function ux(e,t,o,n){let r=t!==void 0?e.querySelector(`#${t}`):null,i=e.querySelector("#create-country-list"),a=e.querySelector(".opt-in"),s=e.querySelector("#update-email"),c=o!==void 0?r.elements.namedItem(o):null,l=()=>{let u=!(s&&s.value);if(o==="update-profile-button")if(a){let p=a.checked;p?p&&u?(st(r,"emptyEmailForOptIn"),s.setAttribute("required",""),c.setAttribute("disabled","disabled")):p&&!u&&(Lf(r,"emptyEmailForOptIn"),c.removeAttribute("disabled")):c.setAttribute("disabled","disabled")}else a===null&&u?(st(r,"emptyEmailForOptIn"),c.setAttribute("disabled","disabled")):a===null&&!u&&(Lf(r,"emptyEmailForOptIn"),c.removeAttribute("disabled"));else n==="notice"?r&&c&&(Lf(r,"emptyEmailForOptIn"),s.removeAttribute("required"),c.removeAttribute("disabled")):a&&(a.checked&&u?r&&c&&(st(r,"emptyEmailForOptIn"),s.setAttribute("required",""),c.setAttribute("disabled","disabled")):r&&c&&(Lf(r,"emptyEmailForOptIn"),s.removeAttribute("required"),c.removeAttribute("disabled")))};i&&i.addEventListener("change",l),s&&s.addEventListener("input",l),a&&a.addEventListener("change",l)}var Qd,Ej;function C4(e,t){let o,n;switch(t){case"double-opt-in":case"opt-in":case"opt-out":o=!0,n="OptInExplicit";break;case"notice":o=!1,n="OptInImplicit";break;default:o=!1,n=null;break}return o===!0&&e===!1?null:n}function dx(e,t,o){return wj().then(n=>Cj(n,e,t,o))}function wj(){if(Qd===void 0){let e,t="email-opt-in-preferences.json";if(C.accessLevel==="local"){let{branch:o}=it(),n=o?"?"+Le({branch:o}):"";e=`${location.pathname.split("/").slice(0,3).join("/")}/${t}${n}`}else if(C.supportLevel==="development"&&C.accessLevel==="online"){let o=location.pathname.split("/"),n=o.slice(0,o.length-1).join("/");e=`${location.origin}${n}/${t}?branch=main`}else e=`${location.origin}/${w.data.contentLocale}/${t}?branch=main`;Qd=J(e,{credentials:"include",mode:"cors"}).then(o=>o.json()).then(o=>o.preferences),Ej=Qd.then(o=>o[0].countries.reduce((n,r)=>(n[r.countryCode]=r,n),{}))}return Qd}function Cj(e,t,o,n){let r=t!==void 0?t.querySelector("#create-country-list"):null,i=document.createElement("div");i.classList.add("select","is-full-width-mobile");let a=document.createElement("select");a.classList.add("is-full-width-mobile"),a.setAttribute("name","country-list"),a.setAttribute("id","country-list"),a.setAttribute("autocomplete","country"),a.setAttribute("aria-required","true");let s=e[0].countries;if(s.sort((c,l)=>c.country.localeCompare(l.country,void 0,{sensitivity:"base"})),s.length>=1){let c=document.createElement("option");c.value=`${Ul}`,c.selected=!0,c.disabled=!0,c.hidden=!0,c.text=`${Ul}`,a.appendChild(c)}return s.forEach(c=>{let l=document.createElement("option");l.value=c.countryCode,l.text=c.country,l.setAttribute("data-preference",c.email),a.appendChild(l)}),a.onchange=()=>{lC(a.value,s,t,o,n)},a.setAttribute("aria-label",`${uD}`),i.appendChild(a),r!==null&&r.appendChild(i),i}function lC(e,t,o,n,r){let i=t.reduce((a,s)=>s.countryCode===e?s:a).email;w4(o,i,n,r)}var Zr=!1,Ii,rt,uC=!1,dC=async()=>await gl(rt,"optInSaveSuccessful","optInSomethingWentWrong");function pC(e,t){return t===null?null:(Ii=e,rt=e.querySelector("#manage-email-preferences-form"),Sl(t))}function Sl(e){if(cc(Ii,e),!e.email||e.email.length===0){uC=!1;let o=Lj();return I(o,rt),Nj(e),Ii}let t=Mj(e);return I(t,rt),Aj(e),Ii}function kj(e){let t=NO.replace("{email}",e.email),o=rt.querySelector("#unsubscribe-from-microsoft-docs");o.innerHTML=`${t}`;let n=document.createElement("div"),r=new Ge(n);rt.querySelector("#unsubscribe-from-learn-email").addEventListener("click",()=>{event.preventDefault();let a=Oj();I(a,n),Ij(n,e,r.hide.bind(r)),r.show()})}function Aj(e){let t=rt.querySelector("#update-email"),o=rt.querySelector("#update-gsi"),n=rt.querySelector("#save-updated-email"),r=rt.querySelector("#cancel-updated-email");o&&(o.checked=e.gsi),n.disabled=t.value.length===0?!0:px(t,o,e),r.disabled=px(t,o,e);let i=()=>{n.disabled=t.value.length===0?!0:px(t,o,e),r.disabled=px(t,o,e)};kj(e),uC||(o&&o.addEventListener("change",i),t.addEventListener("input",i),n.addEventListener("click",async()=>{event.preventDefault(),Zr=!0;try{let a=await Rj(n,e);a.hasError?st(rt,"optInSomethingWentWrong"):(await dC(),Sl(a.profile),st(rt,"optInSaveSuccessful"))}catch{st(rt,"optInSomethingWentWrong")}finally{Zr=!1,n.classList.remove("is-loading")}}),r.addEventListener("click",()=>{event.preventDefault(),Sl(e)}),uC=!0)}function px(e,t,o){return e.value===o.email&&(t===null||t&&t.checked===o.gsi)}function Ij(e,t,o){let n=e.querySelector("#email-unsubscribe"),r=e.querySelector("#unsubscribe-submit-button");e.querySelector("#unsubscribe-cancel-button").addEventListener("click",()=>{o()}),Zr=!1,n.onsubmit=async a=>{if(!Zr){Zr=!0,a.preventDefault(),r.classList.add("is-loading");try{let s=await Pj(t);s.hasError?(Zr=!1,st(e,"unsubscribeModalSomethingWentWrong")):(Fd(!1),await dC(),Sl(s.profile),o())}catch{Zr=!1,st(e,"unsubscribeModalSomethingWentWrong")}finally{r.classList.remove("is-loading")}}}}async function Pj(e){let t=await Sa(Ii);return t.email=null,t.gsi=null,await mC(t,e)}async function Rj(e,t){e.classList.add("is-loading");let o=rt.querySelector("#update-email"),n=rt.querySelector("#update-gsi"),r=await Sa(Ii);return r.email=o.value,r.locale=t.locale,r.country=t.country,r.contactPointTopicSetting=t.contactPointTopicSetting,r.gsi=n?n.checked:t.gsi,await mC(r,t)}function Nj(e){dx(Ii,"manage-email-preferences-form","update-profile-button");let t=rt.elements.namedItem("update-profile-button"),o=rt.querySelector("#cancel-updated-email");return o.addEventListener("click",()=>{rt.reset(),Kr(rt),rt.elements.namedItem("opt-out").checked=!1,rt.elements.namedItem("country-list").querySelectorAll("option").forEach(n=>n.selected=n.hidden),o.disabled=!0}),rt.addEventListener("change",()=>{o.disabled=!1}),Zr=!1,rt.onsubmit=async n=>{if(!Zr){n.preventDefault(),Zr=!0,t.classList.add("is-loading");try{let r=await Dj(e);r.hasError?st(rt,"optInSomethingWentWrong"):(Fd(!0),await dC(),Sl(r.profile),st(rt,"optInSaveSuccessful"))}catch{st(rt,"optInSomethingWentWrong")}finally{Zr=!1,t.classList.remove("is-loading")}}},Ii}async function Dj(e){let t=rt.querySelector(".user-email"),o=rt.elements.namedItem("country-list"),n=rt.querySelector("#update-gsi"),r=rt.querySelector(".opt-in"),i=r&&r.checked,a=await Sa(Ii),s=()=>{delete a.email,delete a.locale,delete a.country,delete a.contactPointTopicSetting},l=o.options[o.selectedIndex].getAttribute("data-preference");return a.contactPointTopicSetting=C4(i,l),a.country=o.value,a.locale=w.data.userLocale,a.email=t.value,a.gsi=n?n.checked:y.gsi,(o.selectedIndex===0||t.value.length===0)&&s(),await mC(a,e)}async function mC(e,t){Kr(Ii);try{let o=await Uo(t.userName,e);return o.hasError===!0?(o.errors.forEach(n=>{st(rt,n)}),o):(o.profile.qnaUserId=t.qnaUserId,y.readUserProfile(o.profile),o)}catch(o){throw new Error(`error: ${o.message}`)}}function Lj(){return d`
		<div class="padding-xs">
			<div id="user-not-opted-in">
				<h2 id="email" class="title is-3">${Xs}</h2>
				<p class="font-size-md">${iP}</p>
				<div class="columns margin-none">
					<div class="column padding-none">
						<div class="margin-top-sm margin-bottom-xs">
							<label for="email" class="font-weight-semibold">${QA}</label>
						</div>
						<input
							type="email"
							data-profile-property="email"
							id="update-email"
							name="email"
							class="input width-auto-tablet user-email"
							maxlength="50"
							value=""
							required
						/>
						<p
							hidden
							data-label="emptyEmailForOptIn"
							class="help help-danger"
							role="alert"
							aria-live="polite"
						>
							${$l}
						</p>
						<p
							hidden
							data-label="emailIsInvalid"
							class="help help-danger"
							role="alert"
							aria-live="polite"
						>
							${pp}
						</p>
					</div>
				</div>
				<div class="columns margin-none">
					<div class="column padding-none">
						<div class="margin-top-sm margin-bottom-xs">
							<label for="email" class="font-weight-semibold">${Ks}</label>
						</div>
						<div id="create-country-list" class="column padding-none margin-bottom-sm"></div>
						<p id="create-opt-in-notice" class="font-size-sm padding-inline-none"></p>
						<div id="create-opt-in-checkbox" class="margin-top-none"></div>
					</div>
				</div>
				<div class="columns margin-none">
					<div class="column padding-none">${A4(y)}</div>
				</div>
			</div>
			<div class="margin-top-sm">
				<button
					id="save-updated-email"
					type="submit"
					class="button button-primary button-filled is-fullwidth-mobile padding-inline-lg"
					name="update-profile-button"
					data-bi-name="save"
					disabled
				>
					${Bt}
				</button>
				${k4()}
			</div>
			<p
				hidden
				data-label="optInSaveSuccessful"
				class="help has-text-success"
				role="alert"
				aria-live="polite"
			>
				${ec}
			</p>
			<p
				hidden
				data-label="optInSomethingWentWrong"
				class="help help-danger"
				role="alert"
				aria-live="polite"
			>
				${go}
			</p>
		</div>
	`}function Mj(e){return d`
		<div class="padding-xs">
			<div id="user-opted-in">
				<h2 id="email" class="title is-3">${Xs}</h2>
				<p id="unsubscribe-from-microsoft-docs" class="font-size-md"></p>
				<div class="columns margin-none">
					<div class="column padding-none">
						<div class="margin-top-sm margin-bottom-xs">
							<label for="email" class="font-weight-semibold">
								${Rl}
								<span class="required-indicator" aria-hidden="true"></span>
							</label>
						</div>
						<input
							type="email"
							data-profile-property="email"
							id="update-email"
							name="email"
							class="input width-auto-tablet user-email"
							maxlength="50"
							value=${e.email}
						/>
						<p
							hidden
							data-label="emailIsInvalid"
							class="help help-danger"
							role="alert"
							aria-live="polite"
						>
							${pp}
						</p>
					</div>
				</div>
			</div>
			<div class="columns margin-none">
				<div class="column padding-none">${A4(e)}</div>
			</div>
			<div class="margin-top-sm">
				<button
					id="save-updated-email"
					type="submit"
					class="button button-primary button-filled is-fullwidth-mobile padding-inline-lg"
					name="update-profile-button"
					data-bi-name="save"
					disabled
				>
					${Bt}
				</button>
				${k4()}
			</div>
			<p
				hidden
				data-label="optInSaveSuccessful"
				class="help has-text-success"
				role="alert"
				aria-live="polite"
			>
				${ec}
			</p>
			<p
				hidden
				data-label="optInSomethingWentWrong"
				class="help help-danger"
				role="alert"
				aria-live="polite"
			>
				${go}
			</p>
		</div>
	`}function k4(){return d`<button
		id="cancel-updated-email"
		name="update-profile-cancel-button"
		class="button is-fullwidth-mobile font-size-md padding-inline-lg"
		type="button"
		disabled
	>
		${Je}
	</button>`}function Oj(){return d`
		<div
			class="modal-card modal-completed fill-mobile"
			aria-labelledby="unsubscribe-email"
			data-bi-name="unsubscribe-email"
		>
			<div class="modal-card-content">
				<form id="email-unsubscribe" action="javascript:">
					<section
						class="modal-card-body justify-content-center padding-bottom-none padding-top-sm"
					>
						<div class="columns margin-none padding-none is-mobile">
							<div class="column padding-none">
								<h1 id="unsubscribe-email" class="title is-3">${ti}</h1>
								<p>${jO}</p>
							</div>
						</div>
					</section>
					<div class="modal-card-foot display-block">
						<div class="buttons buttons-right">
							<button
								name="unsubscribe-submit-button"
								id="unsubscribe-submit-button"
								class="button button-primary button-filled is-fullwidth-mobile font-size-md padding-inline-lg"
								name="unsubscribe-submit-button"
								type="submit"
								data-autofocus
							>
								${DO}
							</button>
							<button
								name="unsubscribe-cancel-button"
								id="unsubscribe-cancel-button"
								class="button is-fullwidth-mobile font-size-md padding-inline-lg"
								type="button"
							>
								${Je}
							</button>
						</div>
						<p
							hidden
							data-label="unsubscribeModalSomethingWentWrong"
							class="help help-danger"
							role="alert"
							aria-live="polite"
						>
							${go}
						</p>
					</div>
				</form>
			</div>
		</div>
	`}function A4(e){return d`
		<div class="margin-top-xxs">
			<div class="margin-top-sm margin-bottom-xs">
				<label for="update-gsi" class="font-weight-semibold">
					${ly}
				</label>
			</div>
			<div class="columns is-mobile">
				<div class="column">
					<p class="font-size-md">${ie(_I)}</p>
				</div>
				<div class="column is-narrow">
					<div class="checkbox-toggle-container padding-left-none padding-right-xs">
						<div class="checkbox-toggle-wrapper margin-left-none">
							<input
								id="update-gsi"
								type="checkbox"
								data-profile-property="gsi"
								name="gsi"
								aria-label="${ly}"
								.checked=${e.gsi}
							/>
							<label class="switch" for="update-gsi"></label>
						</div>
					</div>
				</div>
			</div>
		</div>
	`}var Uj=/^\S+@\S+\.\S+$/,$j=/^([.]+.*|.*[.]+)$/;function I4(e,t,o){return e.trim().length>=t&&e.trim().length<=o}function P4(e){return $j.test(e.trim())}function R4(e){return Uj.test(e.trim())}function ei(e,t,o){o.removeAttribute("hidden"),t!==null&&(t.classList.add("button-danger","button-filled"),t.setAttribute("aria-invalid","true"),t.focus()),I(d`${ie(e)}`,o)}function Xd(e,t){e!==null&&(e.setAttribute("aria-invalid","false"),e.classList.remove("button-danger","button-filled")),I(d``,t)}async function M4(e,t,o,n){let r=e.shouldOnlyShowEmailNotifications?L4(Cl,n,e.redirectUrl):L4(t,n);I(d`${r}${await zj(e,o,n)}`,e.container),(!Mi()||!(e.hasNewsletterOptIn&&an()))&&fC(e.container)}function fC(e){let t=e.querySelector('select[name="country-list"]');t.value=`${Ul}`,e.onchange=async o=>{if(o.target instanceof HTMLSelectElement){let n=await Qd;lC(t.value,n[0].countries,e),mx(e)}}}async function gC(){let e=await dx();return d`${ie(e.outerHTML)}`}function O4(e,t,o){return e.length===0?!1:t.length!==0&&o.length!==0}async function zj(e,t,o){let n={handleEvent(l){l.preventDefault();let u=jf(e.container),p=Vj(e.container);if(u.length!==0){let m=mx(e.container),f=Wf(e.container);m.length!==0&&f.length!==0&&(D4(),o(u,f,m,p))}}},r=()=>{D4(),o("")},i=()=>jf(e.container),a=()=>Wf(e.container),s=e.shouldOnlyShowEmailNotifications?"":d`<span class="visually-hidden">${t}</span>`,c=e.isEmailRequired&&(!an()||!Mi());return d`
		<form @submit="${n}">
			<h1 class="title is-2 margin-top-lg margin-bottom-sm">${qj(e)} ${s}</h1>
			<p>${Bj(e)}</p>
			<fieldset class="field padding-none margin-top-sm">
				${await Fj(e,i,a)}
				${Hj(e)}
			</fieldset>
			<p
				hidden
				id="email-validation-message"
				class="validation-message has-text-danger margin-block-sm"
				aria-live="assertive"
				aria-relevant="text"
			></p>
			<div class="display-flex justify-content-flex-end margin-top-lg">
				<button
					id="email-notifs-skip"
					data-bi-name="email-notifs-skip"
					class="button is-unstyled font-weight-semibold padding-inline-lg margin-right-xxs"
					type="reset"
					@click="${r}"
					?hidden=${c}
				>
					${Gg}
				</button>
				${Yj(e)}
			</div>
		</form>
	`}async function Fj(e,t,o){let n=e.shouldOnlyShowEmailNotifications&&e.hasNewsletterOptIn&&an(),r=e.isCloudSkillsChallengeContext;return n?"":d`
		<label class="label margin-bottom-xxs" for="user-email">
			${Rl}
			<span class="required-indicator" aria-hidden="true"></span>
		</label>
		<input
			class="input"
			type="text"
			id="user-email"
			name="email"
			placeholder="${$l}"
			autocomplete="email"
			aria-required="true"
			value="${y.email}"
			@keyup="${t}"
			aria-describedby="email-validation-message"
		/>
		<label class="label margin-top-sm margin-bottom-xxs" for="country-list">
			${Ks}
			<span class="required-indicator" aria-hidden="true"></span>
		</label>
		${await gC()}
		<p id="create-opt-in-notice" class="margin-top-xs"></p>
		<div
			id="create-opt-in-checkbox"
			class="margin-top-sm"
			aria-live="polite"
			@change="${o}"
		></div>
		<p ?hidden=${!r} class="margin-top-sm">
			${ie($M)}
		</p>
	`}function Hj(e,t=!1){if(!e.hasNewsletterOptIn)return"";let n={"margin-top-sm":!(e.hasNewsletterOptIn&&an())||!Mi()};return d` <div
		id="challenge-newsletter-opt-in-checkbox"
		class="${YT(n)}"
		aria-live="polite"
	>
		<p class="margin-bottom-sm">
			${ie(UM)}
		</p>
		<label class="checkbox">
			<input
				type="checkbox"
				class="challenge-newsletter-opt-in"
				.checked=${t}
				aria-label="${py}"
			/>
			<span class="checkbox-check" role="presentation"></span>
			<span class="checkbox-text">${ie(py)}</span>
		</label>
	</div>`}function qj(e){return e.isCloudSkillsChallengeContext?XM:JM}function Bj(e){return e.isCloudSkillsChallengeContext?e.hasNewsletterOptIn&&an()&&Mi()?`${t0}: ${y.email}`:e.isEmailRequired?HM:FM:VM}function Yj(e){return d`
		<button
			id="${N4(e)}"
			data-bi-name="${N4(e)}"
			class="button button-primary button-filled font-weight-semibold padding-inline-lg"
			type="submit"
		>
			${Gj(e)}
		</button>
	`}function N4(e){return U4(e)?"email-notifs-next":"email-notifs-save"}function Gj(e){return U4(e)?Tr:Bt}function U4(e){return!e.isInterestOnboarded&&e.source==="learn"||e.shouldOnlyShowEmailNotifications}function D4(){let e=document.getElementById("email-notifs-skip"),t=document.getElementById("email-notifs-save")||document.getElementById("email-notifs-next");!e||!t||(e.disabled=!0,t.disabled=!0)}function L4(e,t,o){let n={handleEvent(r){r.preventDefault(),t()}};return o?d`
			<a href="${o}" class="text-decoration-none" aria-label="${e}">
				<span class="docon docon-arrow-left" aria-hidden="true"></span>
				<span>${Cl}</span>
			</a>
		`:d`
		<a href="#" class="text-decoration-none" @click=${n} aria-label="${e}">
			<span class="docon docon-arrow-left" aria-hidden="true"></span>
			<span>${y.email}</span>
		</a>
	`}function jf(e){let t=document.getElementById("user-email");if(!t)return y.email;let o=t.value.trim(),n=e.querySelector(".validation-message");return o.length===0?(ei(sI,t,n),""):R4(o)?(Xd(t,n),o):(n.removeAttribute("hidden"),ei(pp,t,n),"")}function mx(e){let t=e.querySelector('select[name="country-list"]');if(!t)return y.country;let o=e.querySelector(".validation-message");return t&&t.value.indexOf(Ul)>-1?(ei(bh.replace("{text}",Ks),t,o),""):(Xd(t,o),t.value)}function Wf(e){let t=e.querySelector(".opt-in"),o=e.querySelector("#create-opt-in-checkbox"),n=e.querySelector(".validation-message");return t?t.checked?(Xd(o,n),"OptInExplicit"):(ei(jM,o,n),""):"OptInImplicit"}function Vj(e){let t=e.querySelector("#challenge-newsletter-opt-in-checkbox .challenge-newsletter-opt-in");return t?t.checked:!1}async function z4(){let e=document.createElement("div"),t=new Ge(e);t.show();let o=await hC();if(o===null){Jd(t),Et();return}let n=lx(o.credentialId,o.authenticationMode,y,o.authenticationModes);if(n!==null){Jd(t,n,o.authenticationModes[0].upn),Et();return}let r=await $$(Ao());if(r!==null){Jd(t,r),Et();return}I(Qj(o,t),e)}async function hC(){let e=Ao(),t;if(e===null)return null;try{let o=await Rh(e);t=new Cr,t.readUserProfile(await k$(o))}catch{if(t=Ph(),t===null)return null}return t}function jj(e,t){let o=e.contentElement.querySelector(".modal-card");I(d`<div class="modal-card-head padding-xxs">
				<button
					aria-label="${ze}"
					data-autofocus
					class="modal-close modal-card-close-button is-large"
					@click="${Et}"
				></button>
			</div>
			<section class="modal-card-body padding-top-none justify-content-center has-text-centered">
				<h1 class="title is-4 margin-bottom-sm">${Ll}</h1>
				<p class="is-text-left margin-bottom-xs">${NL}</p>
				${t.length!==0?d`<p class="is-text-left">
							${LL.replace("{email}",t)}
					  </p>`:d`<label class="checkbox">
							<input type="checkbox" id="merge-email-notify" />
							<span class="checkbox-check" aria-hidden="true"></span>
							<span class="checkbox-text"
								>${Ey}</span
							>
					  </label>`}
			</section>
			<div class="modal-card-foot justify-content-flex-end">
				<div class="buttons">
					<button
						id="accept-merge-notice"
						class="button button-primary button-filled"
						type="button"
						data-bi-name="merging-privacy-notice-accept"
						@click="${()=>Wj(e)}}"
					>
						${ok}
					</button>
					<button
						id="decline-merge-notice"
						class="button modal-close"
						type="button"
						data-bi-name="merging-privacy-notice-decline"
						@click="${Et}"
					>
						${Cg}
					</button>
				</div>
			</div>`,o)}async function Wj(e){let t=e.contentElement.querySelector("#merge-email-notify");if(t===null||t!==null&&t.checked===!1){await F4(e);return}await Kj(e)}async function Kj(e){let t=e.contentElement.querySelector(".modal-card");I(d`<div class="modal-card-head padding-xxs">
				<button
					aria-label="${ze}"
					data-autofocus
					class="modal-close modal-card-close-button is-large"
					@click="${Et}"
				></button>
			</div>
			<section class="modal-card-body padding-top-none justify-content-center has-text-centered">
				<h1 class="title is-4 margin-bottom-sm">
					${Ey}
				</h1>
				<p class="is-text-left margin-bottom-xs">
					${yL}
				</p>
				<form @submit="${async n=>{n.preventDefault();let r=n.currentTarget,i=jf(r),a=mx(r),s=Wf(r);if(O4(i,a,s)){let c=r.querySelector(".validation-message"),l=r.querySelector("#skip-notify-merge"),u=r.querySelector("#submit-notify-merge");try{let p=await Sa(r);p.displayName=y.displayName,p.userName=y.userName,p.country=a,u.classList.add("is-loading"),l.disabled=!0;let m=await Uo(y.userName,p);if(!(await HT(Ao())).hasError){e.hide(),QT(),Sc(),Sl(m.profile),Et();return}ei(go,null,c),u.classList.remove("is-loading"),l.disabled=!1}catch(p){throw Jd(e),Et(),new Error(`error: ${p.message}`)}}}}" class="is-text-left">
					<fieldset class="field padding-none margin-top-sm">
						<label class="label margin-bottom-xxs" for="user-email">
							${Rl}
							<span class="required-indicator" aria-hidden="true"></span>
						</label>
						<input
							class="input"
							type="text"
							id="user-email"
							name="email"
							data-profile-property="email"
							placeholder="${$l}"
							autocomplete="email"
							aria-required="true"
							value="${y.email}"
							@keyup="${()=>jf(t)}"
							aria-describedby="email-validation-message"
						/>
						<label class="label margin-top-sm margin-bottom-xxs" for="country-list">
							${Ks}
							<span class="required-indicator" aria-hidden="true"></span>
						</label>
						${await gC()}
						<p id="create-opt-in-notice" class="margin-top-xs"></p>
						<div
							id="create-opt-in-checkbox"
							class="margin-top-sm"
							aria-live="polite"
							@change="${()=>Wf(t)}"
						></div>
					</fieldset>
					<p
						hidden
						id="email-validation-message"
						class="validation-message has-text-danger margin-bottom-sm"
						aria-live="assertive"
						aria-relevant="text"
					></p>
					<div class="buttons justify-content-flex-end">
						<button
							id="submit-notify-merge"
							class="button button-primary button-filled"
							type="submit"
							name="email-submit"
							data-bi-name="merging-email-opt-in-submit"
						>
							${PD}
						</button>
						<button
							id="skip-notify-merge"
							class="button"
							type="button"
							name="skip"
							data-bi-name="merging-email-opt-in-skip"
							@click="${()=>F4(e)}"
						>
							${Gg}
						</button>
					</div>
				</form>
			</section>`,t),fC(t)}async function F4(e){let t=e.contentElement,o=t.querySelector("#accept-merge-notice")||t.querySelector("#skip-notify-merge"),n=t.querySelector("#decline-merge-notice")||t.querySelector("#submit-notify-merge");try{o.classList.add("is-loading"),o.disabled=!0,n.classList.add("is-disabled"),n.disabled=!0;let r=await HT(Ao());if(r.hasError){let i=r.errors[0]||"unexpectedError";Jd(e,i);return}o.classList.remove("is-loading"),o.disabled=!1,n.classList.remove("is-disabled"),n.disabled=!1,e.hide(),QT(),Sc()}catch{Jd(e)}Et()}function Qj(e,t){return d`<div class="modal-card">
		<div class="modal-card-head padding-xxs">
			<button
				aria-label="${ze}"
				data-autofocus
				class="modal-close modal-card-close-button is-large"
				@click="${Et}"
			></button>
		</div>
		<section class="modal-card-body padding-top-none justify-content-center has-text-centered">
			<h1 class="title is-4 margin-bottom-lg">
				${kL}
			</h1>
			<div class="columns align-items-center">
				<div class="column">
					<div class="box border border-radius-lg margin-none">${$4(y)}</div>
				</div>
				<div class="column flex-grow-0 padding-none padding-xxs-tablet">
					<div class="is-hidden-mobile">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-left font-size-xs"></span>
						</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-left font-size-xs"></span>
						</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-left font-size-xs"></span>
						</span>
					</div>
					<div class="is-hidden-tablet">
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-up8 font-size-xs"></span>
						</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-up8 font-size-xs"></span>
						</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-arrow-up8 font-size-xs"></span>
						</span>
					</div>
				</div>
				<div class="column">
					<div class="box border border-radius-lg">${$4(e)}</div>
				</div>
			</div>
			<ul class="is-text-left margin-top-sm">
				<li class="margin-bottom-xs">
					<span class="icon has-text-warning" aria-hidden="true">
						<span class="docon docon-status-info-outline"></span>
					</span>
					${AL}
				</li>
				<li class="margin-bottom-xs">
					<span class="icon has-text-warning" aria-hidden="true">
						<span class="docon docon-status-info-outline"></span>
					</span>
					${DL}
				</li>
				<li class="margin-bottom-xs">
					<span class="icon has-text-success" aria-hidden="true">
						<span class="docon docon-check"></span>
					</span>
					${y.email.length!==0?TL.replace("{email}",y.email):SL}
				</li>
				<li class="margin-bottom-xs">
					<span class="icon has-text-success" aria-hidden="true">
						<span class="docon docon-check"></span>
					</span>
					${xL}
				</li>
				<li class="margin-bottom-xs">
					<span class="icon has-text-success" aria-hidden="true">
						<span class="docon docon-check"></span>
					</span>
					${ML}
				</li>
				<li class="margin-bottom-xs">
					<span class="icon has-text-success" aria-hidden="true">
						<span class="docon docon-check"></span>
					</span>
					${bL}
				</li>
			</ul>
			<p class="is-text-left margin-top-sm">
				${ie(EL)}
			</p>
		</section>
		<div class="modal-card-foot justify-content-flex-end">
			<div class="buttons margin-top-sm">
				<button
					class="button button-primary button-filled"
					type="button"
					data-bi-name="merging-explanation-continue"
					@click="${()=>jj(t,y.email)}"
				>
					${XA}
				</button>
				<button
					class="button modal-close"
					type="button"
					@click="${Et}"
					data-bi-name="merging-explanation-cancel"
				>
					${Je}
				</button>
			</div>
		</div>
	</div>`}function $4(e){let t=e.authenticationModes;return t.length===0&&t.push({dateAdded:e.createdOn,id:e.userId,tenantId:"",type:e.userType==="aad"?"AAD":"MSA",upn:e.upn}),d` <figure class="image is-64x64 margin-inline-auto">
			<img
				class="border-radius-rounded"
				src="${e.avatarThumbnailUrl}"
				alt=""
				aria-hidden="true"
			/>
		</figure>
		${t.map(o=>d`<div class="display-flex align-items-center margin-block-xs">
				<figure class="image is-48x48">
					<img
						class="border-radius-rounded"
						src="${o.type==="AAD"?Xl:Ql}"
						alt=""
						aria-hidden="true"
					/>
				</figure>
				<div class="is-text-left margin-left-xxs">
					<p class="title is-6">${e.displayName}</p>
					<p class="subtitle font-size-sm">${o.upn}</p>
				</div>
			</div>`)}`}function Jd(e,t="unexpectedError",o=""){I(d`
			<div class="modal-card">
				<section class="modal-card-body">${cx(o,t)}</section>
			</div>
		`,e.contentElement),e.show()}var vr;async function Kf(e){let{section:t}=ga(new URL(location.href));t==="settings"&&e&&(I(Jj(),e),_C(y.credentialId,e),y.subscribe(_t,()=>{_C(y.credentialId,e)}),Sc(!0));let o;try{o=Ph()}catch(n){if(n instanceof Er)o=null;else throw n}if(await Ga,Zj(o)){let n=lx(o.credentialId,o.authenticationMode,y);if(n)Qf(o.upn,n);else{try{o=await hC()}catch{}if(o.userType==="standard"&&o.isMvp!==!0||o.authenticationMode==="AAD"&&o.createdOn!==null){Xj(o);return}eW(o)}}}async function Xj(e){let t=document.getElementById("add-account"),o;t&&(o=t.querySelector(".icon"),t.classList.add("is-loading")),o&&(o.hidden=!0);try{let n=await H4();vC(n,e.upn,e.credentialId)}catch{Qf(e.upn)}t&&t.classList.remove("is-loading"),o&&(o.hidden=!1)}function Jj(){let e=t=>{t.preventDefault(),xl()};return d` <div class="padding-xs">
		<h2 id="accounts" class="title is-3 margin-top-none">
			${Wg}
		</h2>
		<p class="font-size-md margin-bottom-sm">
			${ie(zD)}
		</p>
		<p class="font-weight-semibold margin-bottom-xxs">
			${ch}
		</p>
		<div class="display-flex">
			${q4(y.authenticationMode)}
			<p class="user-email is-6 has-text-color" data-profile-property="upn"></p>
		</div>
		<p class="font-weight-semibold margin-top-sm margin-bottom-none">
			${eL}
		</p>
		<div class="accounts margin-bottom-xxs">
			<p hidden class="zero-accounts font-size-sm has-text-subtle margin-top-xxs margin-bottom-xs">
				${uL}
			</p>
			<ul class="linked-accounts"></ul>
		</div>
		<button
			id="add-account"
			data-bi-name="add-account"
			type="button"
			class="button button-clear is-text-undecorated"
			@click="${e}"
		>
			<span class="icon margin-right-xxs" aria-hidden="true">
				<span class="docon docon-math-plus-light has-text-primary"></span>
			</span>
			${YD}
		</button>
	</div>`}function _C(e,t){let o=t.querySelector(".zero-accounts"),n=t.querySelector(".linked-accounts"),r=d`<li hidden id="accounts-changed-alert"></li>`;if(y.authenticationModes.length===1){o.hidden=!1,I(r,n);return}let i=a=>{a.preventDefault();let s=a.target;if(!s)return;let c=s.dataset.accountUpn,l=s.dataset.accountType,u=s.dataset.accountId;tW(c,e,l,u)};o.hidden=!0,I(d`${y.authenticationModes.map(a=>a.upn!==null&&a.id!==e?d` <li class="linked-account level is-mobile margin-bottom-none">
							<div class="level-left">
								${q4(a.type)}
								<div class="linked-account-upn">${a.upn}</div>
							</div>
							<div class="level-right">
								<button
									type="button"
									data-account-upn="${a.upn}"
									data-account-id="${a.id}"
									data-account-type="${a.type}"
									class="button button-clear button-primary remove-account"
									@click="${i}"
									aria-label="${uN.replace("{itemName}",a.upn)}"
								>
									${Zs}
								</button>
							</div>
						</li>
						<hr role="presentation" />`:"")}
		${r} `,n)}function Zj(e){return e!==null&&e.credentialId!==y.credentialId}async function H4(){return await M$(Ao())}function eW(e){vr||bC();let t=vr.contentElement.querySelector(".modal-card"),o=e.isMvp?cL:`${tL.replace("{account}",e.upn)} ${e.userType==="microsoft"?sL:""}`;I(d`
			<section class="modal-card-body">
				<form action="javascript:">
					<button
						type="button"
						class="button button-clear button-primary"
						@click="${()=>xl()}"
					>
						<span class="docon docon-arrow-left" aria-hidden="true"></span>
						<span class="margin-left-xxs">${Cl}</span>
					</button>
					<h2 class="title margin-top-sm">${Ll}</h2>
					<p>${o}</p>
					<div class="display-flex justify-content-flex-end margin-top-xs">
						<button
							type="button"
							class="button button-clear button-primary modal-close font-size-sm align-self-center margin-right-xxs"
							@click="${Et}"
						>
							${Cg}
						</button>
						<button
							type="submit"
							id="consent"
							class="button button-primary button-filled font-size-sm"
							@click="${async r=>{r.preventDefault();let i=r.target;if(!!i){i.classList.add("is-loading");try{let a=await H4();vr.hide(),vC(a,e.upn,e.credentialId)}catch{Qf(e.upn)}i.classList.remove("is-loading")}}}"
							data-autofocus
						>
							${tk}
						</button>
					</div>
				</form>
			</section>
		`,t),vr.show()}function tW(e,t,o,n){vr||bC();let r=async a=>{a.preventDefault();let s=a.target;if(!!s){s.classList.add("is-loading");try{let c=await O$(o,n);vr.hide(),vC(c,e,t)}catch{Qf(t)}s.classList.remove("is-loading")}},i=vr.contentElement.querySelector(".modal-card");I(d`
			<section class="modal-card-body">
				<form action="javascript:">
					<button
						type="button"
						data-dismiss
						type="button"
						class="dismiss delete modal-close position-absolute delete-lg margin-top-xs margin-right-xs top-0 right-0"
						aria-label="${ze}"
					>
						<span class="docon docon-navigate-close" aria-hidden="true"></span>
					</button>
					<h2 class="title">${HD}</h2>
					<p>${qD}</p>
					<div class="display-flex justify-content-flex-end margin-top-sm">
						<button
							type="button"
							class="button button-clear button-primary modal-close align-self-center margin-right-xxs font-size-sm"
						>
							${Je}
						</button>
						<button
							type="button"
							id="confirm-remove-account"
							class="button button-primary button-filled font-size-sm"
							@click="${r}"
							data-autofocus
						>
							${Zs}
						</button>
					</div>
				</form>
			</section>
		`,i),vr.show()}function vC(e,t,o){if(e.hasError){let r=e.errors[0]||"unexpectedError";if(r==="accountAlreadyRegistered"){z4();return}Et(),Qf(o,r);return}let{section:n}=ga(new URL(location.href));if(e.profile){y.readUserProfile(e.profile),(n==="certifications"||fo.kind==="certificationrenewal")&&yl();let r=document.getElementById("account-linking");r&&(_C(y.credentialId,r),oW(t,o),Et())}}function oW(e,t){if(!t)return;let o=document.getElementById("accounts-changed-alert");o.hidden=!1;let n=Ao()!==null&&y.credentialId!==t,r="primary",i="error",a=BD;n&&(r="success",i="success",a=$D),I(d`
			<div
				id="linking-alert"
				class="alert is-inline-alert margin-none padding-xxs is-${r} is-radiusless"
				role="alert"
				aria-live="assertive"
			>
				<span class="icon has-text-${r}" aria-hidden="true">
					<span class="docon docon-status-${i}-outline"></span>
				</span>
				${a.replace("{account}",e)}
			</div>
		`,o),nW()}function nW(){setTimeout(function(){let e=document.getElementById("linking-alert");if(e){e.classList.add("disappearing");let t=document.getElementById("add-account");setTimeout(function(){t.classList.add("is-sliding-up"),I(d``,e.parentElement)},500)}},5e3)}function Qf(e,t="unexpectedError"){vr||bC();let o=vr.contentElement.querySelector(".modal-card");I(d`
			<section class="modal-card-body">${cx(e,t)}</section>
		`,o),vr.show()}function bC(){let e=document.createElement("div");e.classList.add("modal-content"),I(d` <div class="modal-card is-shadowless-mobile padding-xs padding-sm-tablet"></div>`,e),vr=new Ge(e)}function q4(e){return d`<figure class="image is-24x24 margin-right-xxs">
		<img
			class="border-radius-rounded"
			alt=""
			src="${e==="AAD"?Xl:Ql}"
		/>
	</figure>`}var fx=class extends yt{constructor(){super({title:ql,load:async(o,n)=>{try{let{exams:r,isCertificationLinked:i,totalCount:a}=await Ot.getExams(o,n),s=r;return this._isLinked=i,this._totalCount=a,this._isLinked&&r!==null?{items:s,totalCount:a}:(s=[],{items:s,totalCount:0})}catch{return this._unexpectedError=1,{items:[],totalCount:0}}},paging:!0,pageSize:10})}get isLinked(){return this._isLinked}get totalCount(){return this._totalCount}};function gx({examBadgeShareUrl:e,examDateTaken:t,examPassed:o,examProvider:n,examScoreReportType:r,examScoreReportUrl:i,examTitle:a,examType:s,examURL:c},l=!1){return d`
		<article class="certifications-exam card ${l?"padding-sm":""} is-shadowless is-horizontal flex-direction-row">
			<div class="card-header padding-left-none" aria-hidden="true">
				<figure class="card-header-image">
					<img
						role="presentation"
						alt=""
						src="/en-us/media/learn/certification/badges/certification-exam.svg?branch=main"
					/>
				</figure>
			</div>
			<div class="card-content padding-none">
				<div class="display-flex">
					<p class="card-content-super-title flex-grow-1 flex-wrap-wrap margin-right-xxs">
						${Pg}
					</p>
					<span
						class="tag ${o?"is-success":"is-danger"} border-radius-rounded is-small align-items-flex-end"
						>${o?Jg:Xg}</span
					>
				</div>
				${c?d`
								<a
									class="card-content-title margin-bottom-xs"
									href="${Hs(c)}"
								>
									<h3>${a}</h3>
								</a>
						  `:d`<h3>${a}</h3>`}
				<ul class="card-content-metadata has-bullets margin-bottom-xs">
					<li class="margin-none">${tn.format(new Date(t))}</li>
					<li class="margin-none padding-right-none">
						${s==="InPerson"?SI:qk}
					</li>
					<li class="margin-none">${Zg} ${n}</li>
				</ul>
				${i||e?d` <div class="width-100 border-bottom"></div>
								<div class="font-size-sm">
									${i?d` <a
												role="listitem"
												class="margin-right-md has-external-link-indicator redirect"
												target="_blank"
												data-bi-name="view-on-edp"
												href="${i}"
										  >
												${r==="Dashboard"?mM:fM}
										  </a>`:""}
									${e?d` <a
												role="listitem"
												class="has-external-link-indicator"
												data-bi-name="share-exam-badge"
												target="_blank"
												href="${e}"
										  >
												${ba}
										  </a>`:""}
								</div>`:""}

			</div>
		</div>
	`}function B4(e,t,o,n="preview",r="",i=!1,a=!1){return C.supportLevel==="production"?`${de.origin}/${e}${r||`/certifications/${t?.replace(/^certification./,"")}/`}renew/assessment?assessmentId=${o}&skip-verification=true&snapshot-version=${n}&show-all-questions=${a.toString()}&omit-scoring=${i.toString()}&branch=main`:`${de.origin}/${e}/test/learn/certifications/renew/assessment?assessmentId=${o}&skip-verification=true&snapshot-version=${n}&show-all-questions=${a.toString()}&omit-scoring=${i.toString()}&branch=main`}var hx=class extends yt{constructor(){super({title:Bl,load:async(o,n)=>{try{let{isCertificationLinked:r,pastRenewals:i,totalCount:a}=await Ot.getScoredSnapshots(o,n),s=i;return this._isLinked=r,this._totalCount=a,this._isLinked&&i!==null?{items:s,totalCount:a}:(s=[],{items:s,totalCount:0})}catch{return this._unexpectedError=1,{items:[],totalCount:0}}},paging:!0,pageSize:10});this._isLinked=!1}get isLinked(){return this._isLinked}get totalCount(){return this._totalCount}};function _x({certificationName:e,certificationUid:t,passed:o,renewalAssessmentUid:n,scoredAt:r,snapshotURL:i},a=!1){return d`
		<article
			class="certifications-renewal card ${a?"padding-sm":""} is-shadowless is-horizontal flex-direction-row"
		>
			<div class="card-header margin-bottom-none padding-left-none" aria-hidden="true">
				<figure class="card-header-image">
					<img
						role="presentation"
						alt=""
						src="/en-us/media/learn/certification/badges/certification-renewal.svg?branch=main"
					/>
				</figure>
			</div>

			<div class="card-content margin-bottom-none padding-none">
				<div class="display-flex">
					<p class="card-content-super-title flex-grow-1 flex-wrap-wrap margin-right-xxs">
						${iM}
					</p>
					<span
						class="tag ${o?"is-success":"is-danger"} border-radius-rounded is-small align-items-flex-end"
						>${o?Jg:Xg}</span
					>
				</div>
				${i?d`
							<a
								class="card-content-title margin-bottom-sm"
								href="${Hs(i)}"
							>
								<h3>${e}</h3>
							</a>
					  `:d` <h3>${e}</h3> `}

				<p class="font-size-xs margin-bottom-xs">
					${tn.format(new Date(r))}
				</p>
				<div class="width-100 border-bottom"></div>
				<div class="font-size-sm">
					<a
						data-bi-name="view-renewal-details"
						href="${B4(w.data.userLocale,t,n)}"
					>
						${$O}
					</a>
				</div>
			</div>
		</article>
	`}var vx=class extends Ye{constructor(){super();this._isLinked=!1;this._unexpectedError=0}async beforeActivate(){try{let o=await Ot.getDashboardSummary();this._summary=o,this._isLinked=o.isCertificationLinked,Kf()}catch{this._unexpectedError=1}}get unexpectedError(){return this._unexpectedError}get isLinked(){return this._isLinked}get summary(){return this._summary}};function Y4(e){if(e.unexpectedError===1)return jd();if(e.isLinked===void 0)return ht("certifications");if(!e.isLinked)return d`<section>${Tl()}</section>`;let t=e.summary.examAppointments===null||e.summary.examAppointments.examAppointments===null||e.summary.examAppointments.examAppointments.length===0,o=e.summary.certifications===null||e.summary.certifications.certifications.length===0,n=e.summary.pastExams===null||e.summary.pastExams.exams.length===0,r=e.summary.pastRenewals===null||e.summary.pastRenewals.pastRenewals.length===0;return t&&o&&n&&r?ht("certifications"):d`
		<section id="certifications-dashboard" class="padding-bottom-sm margin-bottom-md">
			${t?"":d`<div id="certifications-dashboard-appointments" class="margin-bottom-xl">
				<h2
					id="certifications-dashboard-appointments-title" class="font-size-xl margin-bottom-sm"
				>${Yl}</h2>
				<ul class="margin-bottom-xs">
					${e.summary.examAppointments.examAppointments.map(i=>d`<li class="border-bottom">${nx(i,!0)}</li>`)}
					</li>
				</ul>
				${e.summary.examAppointments.totalCount>2?d`<a
								class="view-all font-size-sm padding-top-sm"
								href="${Gf(3)}"
								>${oc}</a
						  >`:""}
			</div>`}
			${o?"":d`<div id="certifications-dashboard-certifications" class="margin-bottom-xl">
				<h2
					id="certifications-dashboard-certifications-title" class="font-size-xl margin-bottom-sm"
				>${rn}</h2>
				<ul class="margin-bottom-xs">
					${e.summary.certifications.certifications.map(i=>d`<li class="border-bottom">${sx(i,!0)}</li>`)}
					</li>
				</ul>
				${e.summary.certifications.totalCount>2?d` <a
								class="view-all font-size-sm padding-top-sm"
								href="${Gf(1)}"
								>${oc}</a
						  >`:""}
			</div>`}
			${n?"":d`<div id="certifications-dashboard-exams" class="margin-bottom-xl">
						<h2 id="certifications-dashboard-exams-title" class="font-size-xl margin-bottom-sm">
							${ql}
						</h2>
						<ul class="margin-bottom-xs">
							${e.summary.pastExams.exams.map(i=>d`<li class="border-bottom">${gx(i,!0)}</li>`)}
						</ul>
						${e.summary.pastExams.totalCount>2?d`
									<a
										class="view-all font-size-sm"
										href="${Gf(4)}"
										>${oc}</a
									>
							  `:""}
				  </div>`}
			${r?"":d`<div id="certifications-dashboard-renewals" class="margin-bottom-xl">
						<h2 id="certifications-dashboard-renewals-title" class="font-size-xl margin-bottom-sm">
							${Bl}
						</h2>
						<ul class="margin-bottom-xs">
							${e.summary.pastRenewals.pastRenewals.map(i=>d`<li class="border-bottom">${_x(i,!0)}</li>`)}
						</ul>
						${e.summary.pastRenewals.totalCount>2?d`<a
									class="view-all font-size-sm padding-top-sm"
									href="${Gf(5)}"
									>${oc}</a
							  >`:""}
				  </div>`}
			<div id="certifications-dashboard-support" class="margin-bottom-xl">
				<h2 id="certifications-dashboard-support-title" class="font-size-xl">
					${XL}
				</h2>
				<p id="certifications-dashboard-support-message" class="font-size-sm">
					${ie(KL)}
				</p>
			</div>
		</section>
	`}async function G4(e,t){let o=e.elements.namedItem("collection-title").value,n=e.elements.namedItem("collection-description").value;e.querySelector("button[type=submit]").classList.add("is-loading");let r=await Pq({type:"collection",name:o,description:n,items:t});return rW(r,e)}function rW(e,t){if(e.hasError===!0){let o=t.querySelector("button[type=submit]");o&&o.classList.remove("is-loading");let{errorCode:n}=e.error;return iW(n,t),{hasError:!0}}return{hasError:!1,data:e.data}}function iW(e,t){let o=t.elements.namedItem("collection-title"),n=t.elements.namedItem("collection-description");switch(e){case"InvalidBody":case"MissingType":return;case"InvalidTitle":o.setCustomValidity(xg),o.reportValidity();return;case"InvalidDescription":n.setCustomValidity(yg),n.reportValidity();return;case"DuplicateTitle":let r=bg.replace("{title}",o.value);o.setCustomValidity(r),o.reportValidity();return;default:return}}function V4(e,t,o,n,r,i=Vl,a=!0,s=!1,c=!1,l=""){return d`
		<h2
			class="title is-3 margin-none ${w.data.userDir==="rtl"?"margin-left-sm":"margin-right-sm"}"
		>
			${e}
		</h2>
		<button
			class="modal-close modal-card-close-button is-large is-sticky"
			aria-label="${ze}"
		></button>
		<p class="margin-top-xxs" ?hidden="${a}">
			${GA}
		</p>
		<div class="margin-top-xs">
			<div class="field ${l}">
				<label for="collection-title" class="label margin-bottom-xxs"
					>${i}</label
				>
				<div class="control">
					<input
						id="collection-title"
						class="input"
						type="text"
						name="title"
						.value=${t}
						required
						minlength="1"
						maxlength="100"
						data-autofocus
					/>
				</div>
			</div>
			<div class="field" ?hidden="${s}">
				<label for="collection-description" class="label margin-bottom-xxs"
					>${kg}</label
				>
				<div class="control">
					<textarea
						id="collection-description"
						class="textarea"
						name="description"
						maxlength="550"
						.value=${o}
						placeholder="${wP}"
					></textarea>
				</div>
			</div>
			<p class="padding-bottom-xxs" ?hidden="${c}">
				${ie(EA)}
			</p>
			<div class="buttons margin-top-sm">
				<button class="button button-primary button-filled font-weight-semibold" type="submit">
					${n}
				</button>
				<button type="button" class="modal-close button font-weight-semibold">${r}</button>
			</div>
		</div>
	`}function j4(e,t,o){let{title:n,description:r}=t,{submit:i,cancel:a=Je}=o;return d`
		<section class="modal-card is-shadowless-mobile padding-xs padding-sm-tablet">
			${V4(e,n,r,i,a)}
		</section>
	`}function W4(e){let{displayName:t,userName:o}=e.collectionOwner,n=dt(o,"activity"),r=e.collectionOwner.avatarUrl||At;return d`
		<div class="display-flex align-items-center">
			<span>${ry}</span>
			<a
				class="display-flex align-items-center margin-left-xxs ${e.isOfficialOrOverride?"has-text-docs-invert":""}"
				href="${n}"
			>
				<span class="image is-24x24 margin-right-xxs">
					<img class="border-radius-rounded" src="${r}" alt="" aria-hidden="true" />
				</span>
				<span>${t}</span>
			</a>
		</div>
	`}function K4(e){let{displayName:t}=e.collectionOwner,{showUserDisplayName:o}=e.collection;return d` ${aW(o,t)} `}function aW(e,t){return e?d`
				<span class="margin-right-xxs"
					>${String(CA).replace("{name}",t)}
					${qA}</span
				>
				<span class="is-visually-hidden">Microsoft</span>
				${Ba(!1)}
		  `:d`
				<span class="margin-right-xxs">${ry}</span>
				<span class="is-visually-hidden">Microsoft</span>
				${Ba(!1)}
		  `}function Q4(e){let{name:t,description:o,showUserDisplayName:n}=e.collection;return d`
		<span
			class="display-flex columns is-mobile is-gapless is-centered is-vertically-centered"
			?hidden=${e.isPublic}
		>
			<div class="column is-narrow">
				<div class="checkbox-toggle-container padding-left-none">
					<div class="checkbox-toggle-wrapper margin-left-none">
						<input
							type="checkbox"
							id="display-name-checkbox"
							data-bi-name="display-name-checkbox"
							@change=${()=>e.updateCollection(t,o,!n)}
							.checked=${n}
						/>
						<label class="switch" for="display-name-checkbox"></label>
					</div>
				</div>
			</div>
			<span>
				<label for="display-name-checkbox" class="is-6">${IA}</label>
			</span>
		</span>
	`}function Zd(e){return d`
		<progress
			class="progress is-extra-small is-success display-inline-block margin-bottom-xxs margin-right-xxs"
			aria-describedby="${Qo()}"
			value="${e}"
		></progress>
		<span id="${Qo()}" class="progress-label">
			<span>${`${Xt(Math.floor(e*100))}%`}</span>
			<span class="is-visually-hidden-mobile is-lowercase">${wg}</span>
		</span>
	`}function X4(e,t,o,n){let{challengeId:r,name:i}=e.collection,a=Qo();return d`
		<div class="sharing dropdown has-caret">
			<button
				class="button dropdown-trigger button-sm padding-left-none ${e.isOfficialOrOverride||r?`${r?"has-background-purple-hero":"has-background-docs"} has-text-docs-invert button-clear`:"button-clear button-primary"}"
				aria-controls="${a}"
				aria-expanded="false"
				title="${mD}"
				data-bi-name="share"
			>
				<span class="icon">
					<span class="docon docon-share" aria-hidden="true"></span>
				</span>

				<span class="is-hidden-mobile">${ba}</span>
			</button>
			<div class="dropdown-menu padding-xxs" id="${a}" role="menu">
				<ul data-bi-name="share-links">
					<li>
						<a
							href="https://twitter.com/intent/tweet?original_referer=${t.href}&text=${i}&tw_p=tweetbutton&url=${t.href}"
							role="menuitem"
							class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter"
							data-bi-name="twitter"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-brand-twitter has-text-primary"></span>
							</span>
							<span class="has-text-docs">${gh}</span>
						</a>
					</li>
					<li>
						<a
							href="https://www.linkedin.com/cws/share?url=${t.href}"
							role="menuitem"
							class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin"
							data-bi-name="linkedin"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-brand-linkedin has-text-primary"></span>
							</span>
							<span class="has-text-docs">${qI}</span>
						</a>
					</li>
					<li>
						<a
							href="https://www.facebook.com/sharer/sharer.php?u=${t.href}"
							role="menuitem"
							class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook"
							data-bi-name="facebook"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-brand-facebook has-text-primary"></span>
							</span>
							<span class="has-text-docs">${Rg}</span>
						</a>
					</li>
					<li>
						<a
							href="mailto:?subject=${o}&body=${n}"
							role="menuitem"
							class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email"
							data-bi-name="email"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-mail-message-fill has-text-primary"></span>
							</span>
							<span class="has-text-docs">${Ig}</span>
						</a>
					</li>
				</ul>
			</div>
		</div>
	`}function xC(e){let{pathCountFormat:t,moduleCountFormat:o}=e.getAmountStrings(),{challengeId:n,id:r,lastModified:i,name:a,totalDuration:s}=e.collection,c=dt(e.collectionOwner.userName,"collections",r),l=encodeURIComponent(Yg).replace(encodeURIComponent("{articleTitle}"),a),u=`${a}${encodeURIComponent(`

`)}${c.toString()}`,p=n?d` <li>${Vn(s)}</li>
				${t?d`<li>${t}</li>`:""}
				${o?d`<li>${o}</li>`:""}`:d`
				<li>
					${aI}
					${new Intl.DateTimeFormat(w.data.userLocale).format(new Date(i))}
				</li>
		  `;return d`
		<div class="is-mobile margin-bottom-none padding-bottom-xs">
				<ul
					class="metadata page-metadata align-items-center ${e.isOfficialOrOverride||n?"has-text-docs-invert":""}"
				>
					${p}
					${e.isOfficialOrOverride||n?d` <li class="collectionAttribution flex-wrap-wrap flex-wrap-nowrap-tablet">
										${K4(e)}
									</li>
									<li>${Q4(e)}</li>`:""}
					${e.isOfficialOrOverride||n?"":d` <li>${W4(e)}</li>`}
				</ul>
			</div>
			<div class="is-narrow is-3-mobile">
				<div class="buttons buttons-addons">
					${n||y.tenantId!==Ta||r==="bookmarks"?"":d`
									<button
										class="button button-sm button-clear padding-left-none padding-right-xs
										${e.isOfficialOrOverride||n?`${n?"has-background-purple-hero":"has-background-docs"} has-text-docs-invert`:""}"
										type="button"
										aria-label="${ny}"
										title="${kA}"
										@click="${()=>e.copyCollection()}"
									>
										<span class="icon" aria-hidden="true">
											<span class="docon docon-edit-copy"></span>
										</span>
										<span class="is-hidden-mobile">${ny}</span>
									</button>
							  `}
					${e.isPublic||e.isOfficialOrOverride&&e.collectionOwner!==y||n||r==="bookmarks"?"":d`
									<button
										class="button button-sm padding-left-none padding-right-xs
									${e.isOfficialOrOverride||n?`${n?"has-background-purple-hero":"has-background-docs"} has-text-docs-invert button-clear`:"button-clear "}"
										type="button"
										aria-label="${Ri}"
										title="${AA}"
										@click="${()=>e.deleteCollection()}"
									>
										<span class="icon" aria-hidden="true">
											<span class="docon docon-delete"></span>
										</span>
										<span class="is-hidden-mobile">${Ri}</span>
									</button>
							  `}
					${!Ne.shareLink||r==="bookmarks"?"":d` ${X4(e,c,l,u)} `}
				</div>
			</div>
		</div>
	`}var bx="5d6ea118-ff48-4612-a205-7c65e11e49ca",ep="379d1859-15d0-4803-81ed-eb51a2e4945d";var br=class{constructor({errorCode:t}){this.errorCode=t}};function Xf(e,t,o,n){switch(e){case"InvalidTitle":t.setCustomValidity(mA),t.reportValidity();break;case"TitleMissing":t.setCustomValidity(pA),t.reportValidity();break;case"UrlFormatIncorrect":o.setCustomValidity(hA),o.reportValidity();break;case"Malformed":o.setCustomValidity(_A),o.reportValidity();break;case"Unofficial":n.textContent=gA,n.hidden=!1;break;default:n.textContent=fA,n.hidden=!1;break}}function sW(e,t){let r=[...e.value.trim()].length;return r===0?(Xf("TitleMissing",e,t),!1):r<2||r>100?(Xf("InvalidTitle",e,t),!1):t.value.startsWith("http://")||t.value.startsWith("https://")?!0:(Xf("UrlFormatIncorrect",e,t),!1)}function Jf(e,t=-1,o){let n=async a=>{a.preventDefault();let s=a.target,c=s.elements.namedItem("add-edit-url-title"),l=s.elements.namedItem("add-edit-url");if(!!sW(c,l))try{let u=c.value.trim(),p=encodeURI(l.value.trim());await e.commitUrlItem(u,p,t,o?.id),e.editingId=null}catch(u){let p=s.querySelector("#generic-error-container");u instanceof br?Xf(u.errorCode,c,l,p):Xf("UnexpectedError",c,l,p)}},r=()=>{e.editingId=null},i=a=>{a.key==="Escape"&&r(),a.target instanceof HTMLInputElement&&yx(a)};return d`
		<form
			id="add-edit-url-form"
			class="box is-full-width"
			@submit="${n}"
			action="javascript:"
			@keyup="${a=>{i(a)}}"
		>
			<div class="field">
				<label class="label margin-bottom-xxs" for="add-edit-url-title"> ${Vl} </label>
				<div class="control">
					<input
						id="add-edit-url-title"
						class="input"
						type="text"
						placeholder="${dA}"
						value="${o?o.data.title:""}"
						aria-required="true"
						@input=${a=>a.target.setCustomValidity("")}
					/>
				</div>
			</div>
			<div class="field">
				<label class="label margin-bottom-xxs" for="add-edit-url"> ${hh} </label>
				<div class="control">
					<input
						id="add-edit-url"
						class="input"
						type="url"
						placeholder="https://"
						value="${o?o.data.url:""}"
						aria-required="true"
						@input=${a=>a.target.setCustomValidity("")}
					/>
				</div>
			</div>
			<div class="field is-grouped is-grouped-right">
				<div class="control margin-right-sm">
					<button type="button" class="button button-clear button-primary" @click="${r}">
						${Je}
					</button>
				</div>
				<div class="control">
					<button
						type="submit"
						class="button button-primary button-filled ${e.busy?"is-loading":""}"
					>
						${Bt}
					</button>
				</div>
			</div>
			<p id="generic-error-container" class="help help-danger" hidden></p>
		</form>
	`}function xx(e,t,o,n){switch(e){case"InvalidTitle":t.setCustomValidity(sA),t.reportValidity();break;case"DuplicateTitle":t.setCustomValidity(nA),t.reportValidity();break;case"InvalidDescription":o.setCustomValidity(oA),o.reportValidity();break;case"Invalid":n.textContent=cA,n.hidden=!1;break;default:n.textContent=lA,n.hidden=!1;break}}function cW(e,t){let r=[...e.value.trim()].length,i=[...t.value.trim()].length;return r>100?(xx("InvalidTitle",e,t),!1):i>550?(xx("InvalidDescription",e,t),!1):!0}function SC(e,t){let o=async s=>{s.preventDefault();let c=s.target,l=c.elements.namedItem("add-edit-section-title"),u=c.elements.namedItem("add-edit-section-description");if(!!cW(l,u))try{let p=l.value.trim(),m=u.value.trim();await e.commitSection(p,m),e.editingSectionId=null}catch(p){let m=c.querySelector("#generic-error-container");p instanceof br?xx(p.errorCode,l,u,m):xx("UnexpectedError",l,u,m)}},n=()=>{e.editingSectionId=null},r=s=>{s.key==="Escape"&&n()},i=s=>{yx(s),s.target.setCustomValidity("")},a=async()=>{event.preventDefault(),e.editingSectionId=null;let{submitted:s}=await pn(hu(ti,eA,Ri));s&&await e.deleteSection(t?.id)};return d` <form
		tabindex="-1"
		id="add-edit-section-form"
		class="box is-full-width"
		@submit="${o}"
		action="javascript:"
		@keyup="${s=>{r(s)}}"
		aria-labelledby="add-edit-section-form-heading"
	>
		<span id="add-edit-section-form-heading" class="label margin-bottom-xxs">
			${t?tA:rA}
		</span>
		<div class="field">
			<div class="control">
				<label class="visually-hidden" for="add-edit-section-title">${Vl}</label>
				<input
					id="add-edit-section-title"
					class="input"
					type="text"
					placeholder="${aA}"
					value="${t?.name||""}"
					@input=${i}
				/>
			</div>
		</div>
		<div class="field">
			<div class="control">
				<label class="visually-hidden" for="add-edit-section-description">${kg}</label>
				<textarea
					id="add-edit-section-description"
					class="textarea textarea-fixed-height"
					placeholder="${Jk}"
					@change=${i}
					rows="3"
				>
${t?.description.trim()||""}</textarea
				>
			</div>
		</div>
		<div class="field is-grouped is-grouped-right">
			${t?d`
						<div class="control margin-right-sm">
							<button
								type="button"
								class="button button-clear button-primary"
								@click="${a}"
							>
								${Zk}
							</button>
						</div>
				  `:""}
			<div class="control margin-right-sm">
				<button type="button" class="button button-clear button-primary" @click="${n}">
					${Je}
				</button>
			</div>
			<div class="control">
				<button
					type="submit"
					class="button button-primary button-filled ${e.busy?"is-loading":""}"
					aria-label="${iA}"
				>
					${Bt}
				</button>
			</div>
		</div>
		<p id="generic-error-container" class="help help-danger" hidden></p>
	</form>`}function yx(e){let o=e.target.closest("form").querySelector("#generic-error-container");o.hidden||(o.textContent="",o.hidden=!0)}function yC(e,t,o){switch(e){case"InvalidTitle":t.setCustomValidity(xg),t.reportValidity();break;case"DuplicateTitle":let n=bg.replace("{title}",t.value.trim());t.setCustomValidity(n),t.reportValidity();break;default:o.textContent=PA,o.hidden=!1;break}}function lW(e){let n=[...e.value.trim()].length;return n<1||n>100?(yC("InvalidTitle",e),!1):!0}function EC(e,t="",o=""){let n=async a=>{a.preventDefault();let s=a.target,c=s.elements.namedItem("edit-summary-title");lW(c);try{let l=c.value.trim();await e.updateCollection(l,e.collection.description.trim(),e.showUserDisplayName),e.isEditingSummaryTitle=!1}catch(l){let u=s.querySelector("#generic-error-container");l instanceof br?yC(l.errorCode,c,u):yC("UnexpectedError",c,u)}},r=()=>{e.isEditingSummaryTitle=!1},i=a=>{a.key==="Escape"&&r(),a.target instanceof HTMLInputElement&&yx(a)};return d`
		<form
			id="edit-summary-title-form"
			class="is-full-width"
			@submit="${n}"
			action="javascript:"
			@keyup="${a=>{i(a)}}"
		>
			<label class="label margin-bottom-xxs ${t}">
				${dp}
			</label>
			<div class="field">
				<div class="control">
					<input
						id="edit-summary-title"
						class="input"
						type="text"
						placeholder="${ty}"
						value="${e.collection?.name.trim()||""}"
						aria-required="true"
						@input=${a=>a.target.setCustomValidity("")}
					/>
				</div>
			</div>
			<div class="field is-grouped is-grouped-right">
				<div class="control margin-right-xs">
					<button
						type="button"
						class="button button-sm button-clear button-primary ${o}"
						@click="${r}"
					>
						${Je}
					</button>
				</div>
				<div class="control">
					<button
						type="submit"
						class="button button-sm button-primary button-filled ${e.busy?"is-loading":""}"
						aria-label="${Bt}"
					>
						${Bt}
					</button>
				</div>
			</div>
			<p id="generic-error-container" class="help help-danger" hidden></p>
		</form>
	`}function TC(e,t,o){switch(e){case"InvalidDescription":t.setCustomValidity(yg),t.reportValidity();break;default:o.textContent=RA,o.hidden=!1;break}}function uW(e){return[...e.value.trim()].length>550?(TC("InvalidDescription",e),!1):!0}function wC(e,t="",o=""){let n=async a=>{a.preventDefault();let s=a.target,c=s.elements.namedItem("edit-summary-description");uW(c);try{let l=c.value.trim();await e.updateCollection(e.collection.name.trim(),l,e.showUserDisplayName),e.isEditingSummaryDescription=!1}catch(l){let u=s.querySelector("#generic-error-container");l instanceof br?TC(l.errorCode,c,u):TC("UnexpectedError",c,u)}},r=()=>{e.isEditingSummaryDescription=!1},i=a=>{a.key==="Escape"&&r(),a.target instanceof HTMLTextAreaElement&&yx(a)};return d`
		<form
			id="edit-summary-description-form"
			class="is-full-width"
			@submit="${n}"
			action="javascript:"
			@keyup="${a=>{i(a)}}"
		>
			<label class="label margin-bottom-xxs ${t}">
				${up}
			</label>
			<div class="field">
				<div class="control">
					<textarea
						id="edit-summary-description"
						class="textarea textarea-fixed-height"
						placeholder="${ty}"
						.value="${e.collection?.description.trim()||""}"
						aria-required="true"
						@change=${a=>a.target.setCustomValidity("")}
						rows="3"
					></textarea>
				</div>
			</div>
			<div class="field is-grouped is-grouped-right">
				<div class="control margin-right-xs">
					<button
						type="button"
						class="button button-sm button-clear button-primary ${o}"
						@click="${r}"
					>
						${Je}
					</button>
				</div>
				<div class="control">
					<button
						type="submit"
						class="button button-sm button-primary button-filled ${e.busy?"is-loading":""}"
						aria-label="${Bt}"
					>
						${Bt}
					</button>
				</div>
			</div>
			<p id="generic-error-container" class="help help-danger" hidden></p>
		</form>
	`}function J4(e,t="learningpath"){let o=it();return o["ns-enrollment-type"]||(o["ns-enrollment-type"]=t),o["ns-enrollment-id"]||(o["ns-enrollment-id"]=e),o}function Z4(e,t,o=!0,n=null){let r=document.createElement("div");r.classList.add("star-rating-display");let i=dW(e),a=n?d`<div class="before-text">${n+" "}</div>`:"",s=Xt(t),c=d`<span
		class="explanation-text"
		aria-label="${sN.replace("{averageScore}",e.toString())}"
		role="img"
		>${e} (${s})</span
	>`;e||(c=d`<span class="explanation-text">(${s})</span>`);let u=d`${a}
		<div class="rating-stars">${i} ${o?c:""}</div>`;return I(u,r),r}function dW(e){let t=[];for(let o=0;o<5;o++)e<o+.3?t.push(d`<span aria-hidden="true" class="star docon docon-star-outline"></span>`):o+.3<=e&&o+.7>e?t.push(d`<span aria-hidden="true" class="star docon docon-star-half"></span>`):t.push(d`<span aria-hidden="true" class="star docon docon-star"></span>`);return t}function eB(e){let{pageKind:t,moduleCount:o,durationInMinutes:n}=e;if(t!=="module"&&t!=="path")return"";let r=o?d`<li>
				${o} ${o===1?Js.toLowerCase():Ml.toLowerCase()}
		  </li>`:"",i=n?d`<li>${Vn(n)}</li>`:"";return d` ${r} ${i} `}function tB(e){let{pageKind:t,start:o,end:n,moduleCount:r}=e;if(t!=="challenge"||(!o||!n)&&r===void 0)return"";let i=o&&n?d`<li>
					${Gk.replace("{start}",tn.format(new Date(o))).replace("{end}",tn.format(new Date(n)))}
			  </li>`:"",a=r?d`<li>
				${r} ${r===1?Js.toLowerCase():Ml.toLowerCase()}
		  </li>`:"";return d`${i}${a}`}function oB(e){let{url:t,submitterUsername:o,answerCount:n,commentCount:r,votes:i}=e;if(!t||!t.startsWith("/answers/questions")||!o&&n===void 0&&r===void 0&&i===void 0)return"";let a=o?d`<li>${o} ${Fg}</li>`:"",s=i!==void 0?d`<li>${i} ${aN}</li>`:"",c=n!==void 0?d`<li>${n} ${tN}</li>`:"",l=r!==void 0?d`<li>${r} ${oN}</li>`:"";return d`${a}${s}${c}${l}`}function nB(e){let{pageKind:t,hoursToComplete:o}=e;return t!=="course"?"":o?d`<li>${pW(o)}</li>`:""}function rB(e){let{pageKind:t,start:o,end:n}=e;if(t!=="lifecycle"||!o&&!n)return"";let r=o?d`<li>
				${_D.replace("{startDate}",new Date(o).toLocaleDateString())}
		  </li>`:"",i=n?d`<li>${lI.replace("{endDate}",new Date(n).toLocaleDateString())}</li>`:"";return d`${r}${i}`}function iB(e){let{pageKind:t,lastEpisode:o,episodeCount:n,pageType:r}=e;if(r!=="show"&&t!=="series"||!o&&!n)return"";let i=o?d`<li>
				${DI.replace("{date}",new Date(o).toLocaleDateString())}
		  </li>`:"",a=n?d`<li>${PI.replace("{count}",n.toString())}</li>`:"";return d`${i}${a}`}function aB(e){let{showName:t,uploadDate:o,pageType:n,durationInMillisecond:r}=e;if(n!=="episode"||!t&&!o&&!r)return"";let i=r?Qw(r):null,a=t?d`<li>${t}</li>`:"",s=o?d`<li>
				${LI.replace("{date}",new Date(o).toLocaleDateString())}
		  </li>`:"",c=i?d`<li>${Vn(i)}</li>`:"";return d`${a}${s}${c}`}function sB(e){let{startDate:t,endDate:o,pageType:n}=e;if(n!=="event"||!t&&!o)return"";let r=t&&o?d`<li>
					${new Date(t).toLocaleDateString()} - ${new Date(o).toLocaleDateString()}
			  </li>`:"";return d`${r}`}function cB(e){let{eventTitle:t,startDate:o,pageType:n,durationInMillisecond:r}=e;if(n!=="eventsession"||!t&&!o&&!r)return"";let i=r?Qw(r):null,a=t?d`<li>${t}</li>`:"",s=o?d`<li>${new Date(o).toLocaleDateString()}</li>`:"",c=i?d`<li>${Vn(i)}</li>`:"";return d`${a}${s}${c}`}function pW(e){let t=Math.floor(e/168),o=Math.floor(e%168/24),n=e-t*168-o*24,r=t>0?`${t.toString()} ${t===1?jy:Wy}`:null,i=o>0?`${o.toString()} ${o===1?iy:ay}`:null,a=n>0?`${n.toString()} ${n===1?uy:dy}`:null;return[r,i,a].filter(s=>s!==null).join(", ")}var lB={architecture:mk,conceptual:fk,tutorial:PO,certification:Al,challenge:gg,sample:Kk,course:JA,examination:Pg,faq:pI,path:Dg,knownissue:kI,lifecycle:FI,module:Js,apiconnector:An,"azure-cli":An,cli:An,dotnet:An,java:An,javascript:An,odata:An,powerconnector:An,powershell:An,python:An,rest:An,typescript:An,show:OI,series:MI,episode:II,event:RI,eventsession:NI};function uB(e,t,o){return e==="certification"||e==="challenge"||e==="course"||e==="examination"||e==="path"||e==="knownissue"||e==="lifecycle"||e==="module"||e==="series"?lB[e]:t==="architecture"||t==="conceptual"||t==="tutorial"||t==="sample"||t==="faq"||t==="azure-cli"||t==="cli"||t==="dotnet"||t==="java"||t==="javascript"||t==="odata"||t==="powerconnector"||t==="python"||t==="rest"||t==="typescript"||t==="episode"||t==="event"||t==="eventsession"||t==="show"?lB[t]:o&&o.startsWith("/answers/questions")?Hg:""}function CC(e,t,o,n=0,r=-1,i="h3"){let{userLocale:a}=w.data,{pageKind:s,pageType:c,rating:l,title:u,url:p}=t.data,m=l?d`<ul class="card-content-metadata">
				<li>${Z4(l.average,l.total)}</li>
		  </ul>`:"",f=O=>{let k=J4(O.id,"Collection");return s==="challenge"&&t.data.challengeId&&(k.id=t.data.challengeId),`${Le(k)}`},h=uB(s,c,p),_=t.type==="url"?`${hW(p)}`:h,g=s==="challenge"&&t.data.challengeId?p.split("?")[0]:p,v=t.type==="url"?p:`/${a}${g}?${f(e.collection)}`,x=async()=>{e.editingId=t.id},E=t.type==="url"?d`<div class="display-flex">
					<div class="flex-direction-column">
						<a href="${v}" class="card-content-title" target="_blank">
							${dB(i,u)}
						</a>
					</div>
					<div class="flex-direction-column">
						<button
							type="button"
							class="button button-sm button-clear button-primary"
							aria-label="${Ag}"
							@click="${()=>x()}"
							?hidden="${e.isPublic}"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-edit-outline"></span>
							</span>
						</button>
					</div>
			  </div>`:d`
					<a href="${v}" class="card-content-title">
						${dB(i,u)}
					</a>
			  `;return e.editingId===t.id?Jf(e,r,t):d`
			<li
				class="position-relative padding-bottom-sm ${n!==0&&o>n-1?"expandable":""}"
			>
				<article class="card is-horizontal">
					<div class="card-content margin-bottom-xxs margin-bottom-xs-tablet margin-left-sm-tablet">
						<p class="card-content-super-title">${_}</p>
						${E}
						<div>
							<ul class="metadata page-metadata">
								${eB(t.data)}
								${tB(t.data)}
								${oB(t.data)}
								${nB(t.data)}
								${rB(t.data)}
								${iB(t.data)}
								${aB(t.data)}
								${sB(t.data)}
								${cB(t.data)}
							</ul>
						</div>
						${m}
					</div>
					${mW(e,o,t,r)}
				</article>
			</li>
		`}function mW(e,t,o,n=-1){let{challengeId:r,userId:i}=e.collection;return d`${e.isPublic||e.isOfficialOrOverride&&i!==y.userId||r?gW(e.isUserAuthenticated,o):fW(e,t,o,n)}`}function fW(e,t,o,n=-1){let{progress:r}=o.data,i=n>=0?!(n===0&&t===0):t!==0,a=n>-1?!(n>=e.collection.sections?.length-1&&t>=e.collection.sections[n]?.items.length-1):t<e.collection.items.length-1,s=r?d`<div class="card-footer-item">${Zd(r)}</div>`:"";return d`
		<div class="card-footer">
			${s}
			<div class="card-footer-item">
				<div class="buttons">
					${i?d` <button
								class="button button-sm button-clear button-primary"
								aria-label="${zA}"
								?disabled=${e.busy}
								@click="${()=>e.moveItem(t,-1,n)}"
						  >
								<span class="icon" aria-hidden="true">
									<span class="docon docon-arrow-up8"></span>
								</span>
						  </button>`:""}
					${a?d` <button
								class="button button-sm button-clear button-primary"
								aria-label="${$A}"
								?disabled=${e.busy}
								@click="${()=>e.moveItem(t,1,n)}"
						  >
								<span class="icon" aria-hidden="true">
									<span class="docon docon-arrow-down8"></span>
								</span>
						  </button>`:""}
					<button
						class="button button-sm button-clear button-primary"
						aria-label="${Zs}"
						@click="${()=>e.deleteItem(o,n)}"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-delete"></span>
						</span>
					</button>
				</div>
			</div>
		</div>
	`}function gW(e,t){let{progress:o}=t.data;return e&&o?d` <div class="card-footer is-left">
				<div class="card-footer-item">${Zd(o)}</div>
		  </div>`:""}function dB(e="h3",t){let o={h3:d`<h3 class="title is-4 margin-bottom-xxs">${t}</h3>`,h4:d`<h4 class="title is-4 margin-bottom-xxs">${t}</h4>`};return o[e]||o.h3}function hW(e){let t=new URL(e).hostname;switch(t=t.replace("www.","").toLocaleLowerCase(),t){case"github.com":return"Github";case"support.microsoft.com":return"Microsoft Support";case"techcommunity.microsoft.com":return"Microsoft Tech Community";case"youtube.com":return"YouTube";default:return HO}}function mB(e,t=0){return d`
		${!e.collection?.items.length&&!e.collection?.sections?.length?vW(e):_W(e,t)}
	`}function _W(e,t=0){return d`
		<div>
			${e.collection?.sections?.length?e.collection.sections.map((o,n)=>bW(e,o,n,t)):d` <ul id="items-list">
						${e.collection.items.map((o,n)=>CC(e,o,n,t))}
				  </ul>`}
			${e.editingId===bx?d`<div class="position-relative padding-bottom-sm">
						${Jf(e)}
				  </div>`:""}
			${e.editingSectionId===ep?d` <div class="position-relative padding-bottom-sm">${SC(e)}</div>`:""}
			${t===0||e.collection.items.length<=t?"":d`<button
						id="showMoreButton"
						class="button button-primary margin-left-xxs margin-top-xxs"
						aria-controls="items-list"
						data-show-more=""
						aria-expanded="false"
						data-title="${by}"
						data-expanded-title="${lD}"
				  >
						<span class="show-more-text">${by}</span>
				  </button>`}
			${fB(e)}
		</div>
	`}function vW(e){let t=`/${w.data.userLocale}/learn/browse/`;return d`
		${e.isOfficialOrOverride?d`<ul id="items-list">
					${e.editingId===bx?d`<li class="position-relative padding-bottom-sm">
								${Jf(e)}
						  </li>`:""}
			  </ul>`:""}
		<p
			class="padding-bottom-sm font-size-lg"
			?hidden="${e.isOfficialOrOverride&&e.editingId!==null}"
		>
			${LA}
		</p>
		${e.isPublic?"":d` <a href="${t}" class="button button-primary button-filled">
					<span>${vA}</span>
			  </a>`}
		${fB(e,"margin-top-xl")}
	`}function fB(e,t="margin-top-xxs"){if(e.isPublic)return"";let o={handleEvent(r){r.preventDefault(),e.editingId=bx}},n={handleEvent(r){r.preventDefault(),e.editingSectionId=ep}};return d`
		${d`<div
			id="editSection"
			class="display-flex justify-content-flex-start buttons ${t}"
			?hidden="${e.editingId!==null||e.editingSectionId!==null}"
		>
			${e.isOfficialOrOverride?d`<button
						id="url"
						class="button"
						data-bi-name="add-url"
						@click=${o}
						aria-label="${uA}"
						?disabled="${e.isEditing}"
				  >
						<span class="icon has-text-primary" aria-hidden="true">
							<span class="docon docon-link"></span>
						</span>
						<span>${hh}</span>
				  </button>`:""}
			${e.collection?.items.length>0||e.collection?.sections?.length>0?d`<button
						id="section"
						class="button"
						data-bi-name="add-section"
						@click=${n}
						?disabled="${e.isEditing}"
				  >
						<span class="icon has-text-primary" aria-hidden="true">
							<span class="docon docon-section"></span>
						</span>
						<span>${cD}</span>
				  </button>`:""}
		</div>`}
	`}function bW(e,t,o=-1,n=0){let r=o<e.collection.sections.length-1,i=o>0;return d`
		<section class="margin-top-md margin-bottom-md">
			<header class="margin-bottom-md">
				${e.editingSectionId===t.id?SC(e,t):d`
								<h3>
									<strong>${t.name}</strong>

									<button
										type="button"
										id="edit-section-${t.id}"
										class="button button-sm button-clear"
										@click=${()=>e.editingSectionId=t.id}
										?disabled="${e.isEditing}"
										?hidden=${e.isPublic}
									>
										<span class="icon" aria-hidden="true">
											<span class="docon docon-edit-outline has-text-primary"></span>
										</span>
										<span class="visually-hidden">${Ag}</span>
									</button>
								</h3>
								${t.description?d` <p class="margin-top-xs margin-bottom-sm">${t.description}</p>`:""}
						  `}
					  <div class="buttons display-flex justify-content-flex-end">
					${i?d` <button
									class="button button-sm button-clear button-primary"
									aria-label="${HA}"
									?disabled=${e.busy}
									?hidden=${e.isPublic}
									@click="${()=>e.moveSection(o,-1)}"
							  >
									<span class="icon" aria-hidden="true">
										<span class="docon docon-arrow-up8"></span>
									</span>
							  </button>`:""}
					${r?d` <button
									class="button button-sm button-clear button-primary"
									aria-label="${FA}"
									?disabled=${e.busy}
									?hidden=${e.isPublic}
									@click="${()=>e.moveSection(o,1)}"
							  >
									<span class="icon" aria-hidden="true">
										<span class="docon docon-arrow-down8"></span>
									</span>
							  </button>`:""}
			</header>
			<ul>
				${t.items.map((a,s)=>CC(e,a,s,n,o,"h4"))}
			</ul>
		</section>
	`}function kC(e){return e.collection?e.collection.userId!==e.collectionOwner.userId?EW(e):d`
		${e.isOfficialOrOverride||e.collection.challengeId?yW(e):TW(e)}
		${xW(e)}
	`:ht("collections")}function xW(e,t=0){return e.collection?d`
		<div class="modular-content-container">
			<div class="section is-small is-uniform padding-block-sm padding-inline-xs padding-sm-tablet">
				<div class="columns">
					<div class="column">
						<header>
							<h2 class="title is-4 margin-bottom-sm">${DA}</h2>
						</header>
						${mB(e,t)}
					</div>
				</div>
			</div>
		</div>
	`:""}function yW(e){let{challengeId:t,description:o,items:n,name:r,remainingDuration:i,totalDuration:a}=e.collection,s=t?"has-background-purple-hero":"has-background-docs",c=t?"/en-us/media/learn/topics/purple-hero-background-01.svg?branch=main":"/en-us/media/learn/topics/blue-hero-background-01.svg?branch=main",l=e.isPublic?"":d`
				<button
					class="button button-sm button-clear button-primary
			${e.isOfficialOrOverride||t?`${t?"has-background-purple-hero":"has-background-docs"} has-text-docs-invert`:""}"
					aria-label="${up}"
					@click="${()=>e.isEditingSummaryDescription=!0}"
					?disabled="${e.isEditing}"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-edit-outline"></span>
					</span>
				</button>
		  `;return d`
		<section
			class="hero ${s} has-background-image has-text-docs-invert"
			style="background-image: url(${c});"
		>
			<div class="hero-body">
				<div class="modular-content-container">
					<div
						class="section is-small is-uniform padding-block-sm padding-inline-xs padding-md-tablet margin-bottom-sm"
					>
						<header>
							<p class="card-content-super-title">${Qk}</p>
							<h1 class="title font-size-h2 margin-bottom-xs" ?hidden="${e.isEditingSummaryTitle}">
								${r}
								<button
									class="button button-sm button-clear button-primary
												${e.isOfficialOrOverride||t?`${t?"has-background-purple-hero":"has-background-docs"} has-text-docs-invert`:""}"
									aria-label="${dp}"
									@click="${()=>e.isEditingSummaryTitle=!0}"
									?disabled="${e.isEditing}"
									?hidden="${e.isPublic}"
								>
									<span class="icon" aria-hidden="true">
										<span class="docon docon-edit-outline"></span>
									</span>
								</button>
							</h1>
							${e.isEditingSummaryTitle?EC(e,e.isOfficialOrOverride||t?"has-text-docs-invert":"",e.isOfficialOrOverride||t?t?"has-background-purple-hero has-text-docs-invert":"has-background-docs has-text-docs-invert":""):""}
						</header>
						${o?d`<div class="column is-two-thirds-tablet is-9-desktop padding-bottom-sm">
									<p ?hidden="${e.isEditingSummaryDescription}">
										${o} ${l}
									</p>
							  </div>`:!e.isEditingSummaryDescription&&!e.isPublic?d`<div class="font-style-italic font-weight-light">
									${ey} ${l}
							  </div>`:""}
						${e.isEditingSummaryDescription?wC(e,e.isOfficialOrOverride||t?"has-text-docs-invert":"",e.isOfficialOrOverride||t?t?"has-background-purple-hero has-text-docs-invert":"has-background-docs has-text-docs-invert":""):""}
						${xC(e)}
						${t?d`
									<div class="margin-top-xs margin-bottom-lg">
										<a
											href="/${w.data.userLocale}/${C.supportLevel==="production"&&C.reviewFeatures?"test/":""}learn/challenges?id=${t}"
											}
											class="button button-clear border has-text-docs-invert"
										>
											${Vk}
										</a>
									</div>
							  `:""}
						${e.isUserAuthenticated&&n.length&&a&&i&&t?d`<div class="margin-top-xs">
									${Zd((a-i)/a)}
							  </div>`:""}
					</div>
				</div>
			</div>
		</section>
	`}function TW(e){let{description:t,items:o,name:n,remainingDuration:r,totalDuration:i,type:a,challengeId:s}=e.collection,c=a!=="bookmarks"&&!e.isPublic?d`
					<button
						class="button button-sm button-clear button-primary"
						aria-label="${up}"
						@click="${()=>e.isEditingSummaryDescription=!0}"
						?disabled="${e.isEditing}"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-edit-outline"></span>
						</span>
					</button>
			  `:"";return d`
		<div class="has-body-background">
			<div class="modular-content-container">
				<div
					class="section is-small is-uniform padding-block-sm padding-inline-xs padding-sm-tablet"
				>
					<header>
						<p class="card-content-super-title">${hg}</p>
						<h1 class="title font-size-h2 margin-bottom-xs" ?hidden="${e.isEditingSummaryTitle}">
							${a==="bookmarks"?oy:n}

							<button
								class="button button-sm button-clear button-primary"
								aria-label="${dp}"
								@click="${()=>e.isEditingSummaryTitle=!0}"
								?disabled="${e.isEditing}"
								?hidden="${a==="bookmarks"||e.isPublic}"
							>
								<span class="icon" aria-hidden="true">
									<span class="docon docon-edit-outline"></span>
								</span>
							</button>
						</h1>
						${e.isEditingSummaryTitle?EC(e):""}
					</header>
					${t?d`<div class="column is-two-thirds-tablet is-9-desktop margin-bottom-xs">
								<p ?hidden="${e.isEditingSummaryDescription}">
									${t} ${c}
								</p>
						  </div>`:!e.isEditingSummaryDescription&&!e.isPublic&&a!=="bookmarks"?d`<div class="font-style-italic font-weight-light">
								${ey} ${c}
						  </div>`:""}
					${e.isEditingSummaryDescription?wC(e):""}
					${xC(e)} ${l(e)}
					${e.isUserAuthenticated&&o.length&&i&&r&&s?d`<div class="margin-top-xs">
								${Zd((i-r)/i)}
						  </div>`:""}
				</div>
			</div>
		</div>
	`;function l(u){return!u.isOfficialOrOverride&&y.tenantId===Ta&&u.collectionOwner.userId===y.userId&&u.collection.id!=="bookmarks"?d`<p
					class="font-size-sm font-weight-semibold padding-block-xs display-flex align-items-center"
			  >
					<button class="link-button font-weight-semibold" @click="${()=>u.convertCollection()}">
						${Pl}
					</button>
					${SW(bA)}
			  </p>`:""}}function SW(e){return d`
		<span class="control dropdown has-caret">
			<button
				class="dropdown-trigger button button-clear button-sm"
				aria-controls="convert-collection-information"
				aria-haspopup="dialog"
				aria-label=${xA}
			>
				<span class="has-text-primary icon" aria-hidden="true">
					<span class="docon docon-status-info-outline"></span>
				</span>
			</button>
			<div
				class="dropdown-menu has-text-wrap width-400-tablet width-200"
				id="convert-collection-information"
				role="dialog"
			>
				<div id="convert-collection-tooltip" class="padding-sm">
					<p class="has-line-height-reset margin-bottom-xxs is-size-8">${e}</p>
				</div>
			</div>
		</span>
	`}function EW(e){let t=dt(e.collectionOwner.userName,"collections").toString(),o=YA.replace("{url}",t);return d`
		<section
			class="has-background-image padding-top-lg-tablet padding-bottom-lg padding-left-xs padding-left-none-tablet padding-right-xs padding-right-none-tablet"
		>
			<div class="display-flex flex-direction-column align-items-center centered">
				<h1 class="has-line-height-reset font-size-h2">${yA}</h1>
				<div class="columns width-300 width-auto-tablet justify-content-center">
					<p class="column margin-top-xs margin-bottom-md">
						${BA}
						${NA}
					</p>
				</div>
				<figure class="image" aria-hidden="true">
					<img alt="" src="/en-us/media/illustrations/no-results.svg?branch=main" />
				</figure>
				<div class="padding-top-md">${ie(o)}</div>
			</div>
		</section>
	`}var Zf=class extends Ye{constructor(o=null,n=null,r=!0){super();this.id=o;this.collectionOwner=n;this.isPublic=r;this.isUserAuthenticated=y.isAuthenticated;this._busy=!1;this._editingId=null;this._editingSectionId=null;this._isEditingSummaryTitle=!1;this._isEditingSummaryDescription=!1;this._isOfficialOrOverride=!1;this._showUserDisplayName=!1}get breadcrumbTitle(){return this.collection?this.collection.name:""}get editingId(){return this._editingId}set editingId(o){this._editingId=o,this.notifyPropertyChanged()}get editingSectionId(){return this._editingSectionId}set editingSectionId(o){let n=this._editingSectionId;this._editingSectionId=o,this.notifyPropertyChanged(),o?document.getElementById("add-edit-section-form")?.focus():document.getElementById(n===ep?"section":`edit-section-${n}`)?.focus()}get isEditingSummaryTitle(){return this._isEditingSummaryTitle}set isEditingSummaryTitle(o){this._isEditingSummaryTitle=o,this.notifyPropertyChanged()}get isEditingSummaryDescription(){return this._isEditingSummaryDescription}set isEditingSummaryDescription(o){this._isEditingSummaryDescription=o,this.notifyPropertyChanged()}get isEditing(){return this.editingId!==null||this.editingSectionId!==null||this.isEditingSummaryTitle||this.isEditingSummaryDescription}get isOfficialOrOverride(){return this._isOfficialOrOverride}get busy(){return this._busy}get showUserDisplayName(){return this._showUserDisplayName}async beforeActivate(o=null){this.collection=o||await Eo.getList(this.id);let n=new URLSearchParams(location.search),r=n.has("force-official-collection")?n.get("force-official-collection")==="true":!1;this._isOfficialOrOverride=this.collection?.isOfficial||r,this.notifyPropertyChanged()}async updateCollection(o,n,r){if(this.busy)throw new Error("Busy");this.setBusy();try{let i=await Eo.updateListMetadata(this.id,{name:o,description:n,showUserDisplayName:r});if(i.hasError===!1){let{data:a}=i;this.collection=a}else throw new br({errorCode:i.error.errorCode})}finally{this.setReady()}}async deleteCollection(){if(this.busy)throw new Error("Busy");this.setBusy();try{let{submitted:o}=await pn(Ob(this.collection.name,mp,Np));o&&(await Eo.deleteList(this.id),location.href=`${Ut(y.userName,"collections")}`)}finally{this.setReady()}}async copyCollection(){if(this.busy)throw new Error("Busy");this.setBusy();try{let o=await Eo.copyList(this.collection.id,this.collection.name,this.collection.description);if(o.hasError===!1){let{data:n}=o,{submitted:r}=await pn(gq(Sg,Tg));r&&(location.href=dt(y.userName,"collections",n.id).toString())}else throw new br({errorCode:o.error.errorCode})}finally{this.setReady()}}async convertCollection(){if(this.busy)throw new Error("Busy");this.setBusy();try{let{submitted:o}=await pn(fq(vg,Pl));o&&(await Eo.convertList(this.collection.id),location.reload())}finally{this.setReady()}}async commitUrlItem(o,n,r=-1,i){if(this.busy)throw new Error("Busy");this.setBusy();try{let a=Eq(n,o),s=await(i?Eo.updateItem(this.id,i,a):Eo.addItem(this.id,a));if(s.hasError===!1){let{data:c}=s;if(this.collection.sectionCount){let l=r!==-1?r:this.collection.sectionCount-1;if(i){let u=this.collection.sections[l].items.findIndex(p=>p.id===i);this.collection.sections[l].items[u]=c}else this.collection.sections[l].items.push(c),this.collection.sections[l].itemCount=this.collection.sections[l].items.length;return}if(i){let l=this.collection.items.findIndex(u=>u.id===i);this.collection.items[l]=c}else this.collection.items.push(c),this.collection.itemCount=this.collection.items.length}else throw new br({errorCode:s.error.errorCode})}finally{this.setReady()}}async moveItem(o,n,r=-1){if(this.busy)throw new Error("Busy");this.setBusy();try{if(n===0)return;let i=r!==-1?{sectionId:this.collection.sections[r].id,items:this.collection.sections[r].items.map(l=>l.id)}:{sectionId:null,items:this.collection.items.map(l=>l.id)},a=r!==-1&&this.collection.sections[r+n]?{sectionId:this.collection.sections[r+n].id,items:this.collection.sections[r+n].items.map(l=>l.id)}:null,s=wW(o,n,i,a),c=await Eo.sortList(this.id,s);if(c.hasError===!1)this.collection=c.data;else throw new Error(c.error.message)}finally{this.setReady()}}async moveSection(o,n){if(this.busy)throw new Error("Busy");this.setBusy();try{if(n===0)return;if(n===-1){if(o===0)return;let a=this.collection.sections[o],s=this.collection.sections[o-1];this.collection.sections[o]=s,this.collection.sections[o-1]=a}if(n===1){if(o===this.collection.sections.length-1)return;let a=this.collection.sections[o],s=this.collection.sections[o+1];this.collection.sections[o]=s,this.collection.sections[o+1]=a}let r=this.collection.sections.map(a=>({sectionId:a.id,items:a.items.map(s=>s.id)})),i=await Eo.sortList(this.id,r);if(i.hasError===!1)this.collection=i.data;else throw new Error(i.error.message)}finally{this.setReady()}}async deleteItem(o,n=-1){if(!this.busy){this.setBusy();try{let{submitted:r}=await pn(Ob(o.data.title,mp,Np));if(r){if(await Eo.deleteItem(this.id,o.id),this.collection.sectionCount&&n!==-1){this.collection.sections[n].items=this.collection.sections[n].items.filter(i=>i.id!==o.id),this.collection.sections[n].itemCount=this.collection.sections[n].items.length;return}this.collection.itemCount&&(this.collection.items=this.collection.items.filter(i=>i.id!==o.id),this.collection.itemCount=this.collection.items.length)}}finally{this.setReady()}}}async commitSection(o,n){if(this.busy)throw new Error("Busy");this.setBusy();try{let r=await(this.editingSectionId===ep?Eo.createSection(this.id,[...o?.trim()].length!==0?o:this.getDefaultSectionName(),n):Eo.updateSection(this.id,this.editingSectionId,o,n));if(r.hasError===!1){let{data:i}=r;this.collection=i}else throw new br({errorCode:r.error.errorCode})}finally{this.setReady()}}async deleteSection(o){if(this.busy)throw new Error("Busy");this.setBusy();try{let n=await Eo.deleteSection(this.id,o);if(n.hasError===!1){let{data:r}=n;this.collection=r}}finally{this.setReady()}}getAmountStrings(){let o="",n="";if(this.collection.items.length===0)return{pathCountFormat:o,moduleCountFormat:n};let{path:r,module:i}=this.getCollectionItemsAmount();return r!==0&&(o=(r===1?OA:MA).replace("{numberOf}",r.toString())),i!==0&&(n=(i===1?UA:Eg).replace("{numberOf}",i.toString())),{pathCountFormat:o,moduleCountFormat:n}}getCollectionItemsAmount(){return this.collection.items.reduce((o,n)=>((n.data.pageKind==="path"||n.data.pageKind==="module")&&o[n.data.pageKind]++,o),{path:0,module:0})}setBusy(){this._busy=!0,this.notifyPropertyChanged()}setReady(){this._busy=!1,this.notifyPropertyChanged()}notifyPropertyChanged(){this.publish(new Ae)}getDefaultSectionName(){if(!this.collection.sectionCount)return Zx.replace("{number}",Xt(1));let o=this.collection.sectionCount+1,n="";do n=Zx.replace("{number}",Xt(o)),o+=1;while(this.collection.sections.findIndex(r=>r.name===n)!==-1);return n}};function wW(e,t,o,n){if(!o)throw new Error("Initial section is undefined.");let r={sectionId:o.sectionId,items:o.items},i=e+t;if(i>=0&&i<r.items.length){let s=r.items[i];return r.items[i]=r.items[e],r.items[e]=s,[r]}if(!n)throw new Error("Invalid move operation");let a={sectionId:n.sectionId,items:n.items};return t===-1?a.items.push(r.items.shift()):a.items.unshift(r.items.pop()),[r,a]}var Tx=class extends yt{constructor(o){super({title:_g,load:async()=>{let n=await Aq();return n=(await Iq()).concat(n),{totalCount:n.length,items:n}},remove:null,itemTitle:n=>n.name,shareTemplate:null});this.user=o}async addNew(){let o=wA.replace("{userDisplayName}",this.user.displayName).replace("{index}",(this.items.length+1).toString()),n=j4(SA,{title:o,description:""},{submit:ZA});this.setBusy();let{submitted:r,data:i}=await pn(n,G4);r&&this.items.unshift(i),this.setReady()}};function gB(e){let t=e.items.length?"padding-left-none padding-right-none":"",o=()=>d`
		<button
			class="button button-clear button-primary ${t}"
			type="button"
			@click=${()=>e.addNew()}
		>
			<span class="icon has-text-primary" aria-hidden="true">
				<span class="docon docon-math-plus"></span>
			</span>
			<span>${mP}</span>
		</button>
	`,n=e.items.find(i=>i.id==="bookmarks"),r=e.items.filter(i=>i.type!=="bookmarks").map(i=>i.lastModified.substr(0,4)).filter(function(i,a,s){return s.indexOf(i)===a});return d`
		<h2 class="title is-5">${e.title}</h2>
		${n?.id==="bookmarks"?CW(n):""}
		${e.items.length>1?d`${r.map(i=>d`
							${kW(e,i)}
							<div class="box margin-bottom-xs padding-none border-bottom">
								<ol class="is-unstyled">
									${e.items.filter(a=>a.type!=="bookmarks"&&a.lastModified.substr(0,4)===i).map(a=>d`<div class="border-bottom">${hB(a)}</div>`)}
								</ol>
							</div>
						`)}`:""}
		${o()}
	`}function CW(e){return d` <div class="box padding-none">${hB(e)}</div> `}function hB(e){if(!e)return d``;let t=Hd(),o=dt(t,"collections",e.id);return d`${zb(new Date(e.lastModified),e.name,o.toString(),e.type,e.totalItems)}`}function kW(e,t){let o=e.items.filter(r=>r.type!=="bookmarks");if(o.length===0)return d``;let n=new Date().getFullYear().toString();return t!==n?d`<p class="font-weight-semibold padding-left-xs padding-bottom-xs">${t}</p>`:d`<div class="level margin-bottom-xs margin-top-lg font-size-sm">
		<div class="level-left padding-none">
			<div class="level-item justify-content-flex-start">
				<p class="font-weight-semibold">
					${o.length>1?Ol.replace("{number}",o.length.toString()):Mg.replace("{number}",o.length.toString())}
				</p>
			</div>
		</div>
		<div class="level-right padding-none">
			<div class="level-item justify-content-flex-start">
				<p class="margin-right-xxs">${jg}</p>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-arrow-down"></span>
				</span>
			</div>
		</div>
	</div>`}var Sx=class extends yt{constructor(t){super({title:S0,load:(o,n)=>Dq(o,n),paging:!t})}};function AW(e){let{title:t,voteCount:o,commentCount:n,timestamp:r,answerCount:i}=e,a=sC(e.type);return vl(r,d`${D0.replace("{activityType}",Fs(a))}`,null,t,IW(e),a,Fb(o,n,i))}function IW(e){let{type:t,nodeId:o,slug:n}=e;switch(t){case"question":return`/${w.data.userLocale}/answers/questions/${o}/${n}.html`;case"idea":return`/${w.data.userLocale}/answers/idea/${o}/${n}.html`;case"kbentry":return`/${w.data.userLocale}/answers/articles/${o}/${n}.html`;default:return"javascript:void(0)"}}function _B(e){return jn(e,AW,{columns:1,cards:!1,layoutStyle:"smallSpace"})}var Ex=class extends yt{constructor(){super({title:y0,load:async(t,o)=>await Rq(t,o),paging:!0})}};function PW(e){let{topicName:t}=e;return d` <a
		href="/${w.data.userLocale}/answers/topics/${t}.html"
		class="tags font-size-sm"
	>
		<div class="tag">${t}</div>
	</a>`}function vB(e){return e.items.length===0?ht("qna"):jn(e,PW,{columns:0,cards:!1,layoutStyle:"bigSpace"})}var wx=class extends yt{constructor(t){super({title:T0,load:async(o,n)=>await Nq(o,n),paging:!t})}};function RW(e){let{userId:t,username:o,acceptedAnswers:n,reputation:r}=e;return d` <div class="is-full-height margin-xxs margin-bottom-sm-desktop">
		<article class="media">
			<div class="media-left image">
				<img
					src="https://${C.supportLevel==="development"&&C.accessLevel==="online"||C.accessLevel==="local"?"ppe.":""}docs.microsoft.com/${w.data.userLocale}/answers/users/${t}/photo/view.html?s=48"
					alt="${o} profile avatar"
					class="border-radius-rounded is-48x48"
				/>
			</div>
			<div class="media-content">
				<h2 class="font-size-h5">
					<a class="has-text-color following-user-profile" href="${Ut(o)}">
						${o}
					</a>
				</h2>
				<ul class="has-text-subtle font-size-sm metadata page-metadata">
					<li>
						${Xt(r)}
						${r===1?qg:Bg}
					</li>
					${NW(n)}
				</ul>
			</div>
		</article>
	</div>`}function NW(e){return e>0?d`<li>
				${Xt(e)}
				${e===1?ag:sg}
		  </li>`:""}function bB(e){return jn(e,RW,{columns:2,cards:!1,twoColumnMobile:!0,layoutStyle:"bigSpace"})}var Cx=class extends Ye{constructor(o){super();this.user=o;this.topics=new Ex;this.followingUsers=new wx(!1);this.threads=new Sx(!1);this.topics.subscribe(Ae,n=>this.publish(n)),this.followingUsers.subscribe(Ae,n=>this.publish(n)),this.threads.subscribe(Ae,n=>this.publish(n))}beforeActivate(){return Promise.all([this.topics.beforeActivate(),this.followingUsers.beforeActivate(),this.threads.beforeActivate()]).then(()=>{})}};function xB(e){let t=e.topics.items.length===0,o=e.followingUsers.items.length===0,n=e.threads.items.length===0;return t&&o&&n?ht("qna"):d`
		<section ?hidden=${t} class="margin-bottom-sm">
			${vB(e.topics)}
		</section>
		<section ?hidden=${o} class="margin-bottom-sm">
			${bB(e.followingUsers)}
		</section>
		<section ?hidden=${n} class="margin-bottom-sm">
			${_B(e.threads)}
		</section>
		<p class="font-size-sm">${ie(N0)}</p>
	`}var AC,kx=()=>(AC===void 0&&(AC=Ya()),AC);var IC=`${dt("me","settings").toString()}#manage-email-preferences-form`;var eg=class extends Ye{constructor(o,n){super();this.user=o;this.isPublic=n;this._editDisplayName=!1;this._busy=!1;this._publicLinkUrl="";this._transcriptError=0;this._fetchError=!1;this._userProfile=o,this._displayName=o.displayName,this._cardViewModel=n?new Xr(this.user,!0):void 0}async beforeActivate(){await(this._cardViewModel?this._cardViewModel.beforeActivate():Promise.resolve());let n="",r=new URL(de.href);[,,,,,n]=decodeURIComponent(r.pathname).toLowerCase().split("/"),C.reviewFeatures&&(n=(r.searchParams.get("detail")||"").toLowerCase());let i=this.isPublic?Y$(n):B$(),a=this.isPublic?Promise.resolve():G$();return Promise.all([i,a]).then(s=>{let c=s[0];this._userTranscript=c,this._userProfile?.transcriptSettings?.print.showContactEmail&&(this._userProfile.transcriptSettings.print.showContactEmail=!!c.contactEmail&&this._userProfile?.transcriptSettings.print.showContactEmail),this._userProfile?.transcriptSettings?.publicLink.showContactEmail&&(this._userProfile.transcriptSettings.publicLink.showContactEmail=!!c.contactEmail&&!!this._userProfile?.transcriptSettings.publicLink.showContactEmail);let l=s[1];this._publicLinkUrl=l?.transcriptId?this.createPublicLinkUrl(l.transcriptId):""}).catch(s=>{this.isPublic&&n&&s instanceof tm?this._transcriptError=1:this._transcriptError=2})}async updatePrintableSettings(o){if(this.busy)throw new Error("Busy");this._userProfile.transcriptSettings=o,this.setBusy();try{await Uo(this.userName,this._userProfile),this.clearFetchError()}catch(n){throw this.setFetchError(),n}finally{this.setReady()}}async createPublicLink(){if(this.busy)throw new Error("Busy");this.setBusy();try{let o=await V$();this._publicLinkUrl=this.createPublicLinkUrl(o.transcriptId)}finally{this.setReady()}}async removePublicLink(){if(this.busy)throw new Error("Busy");this.setBusy();try{await j$(),this._publicLinkUrl=""}finally{this.setReady()}}get publicLinkUrl(){return this._publicLinkUrl}get displayName(){return this._displayName}set displayName(o){this._displayName=o,this.notifyPropertyChanged()}get editDisplayName(){return this._editDisplayName}set editDisplayName(o){this._editDisplayName=o,this.notifyPropertyChanged()}get userTranscript(){return this._userTranscript}get userTranscriptLinkSettings(){return this._userTranscriptLinkSettings}get userTranscriptVisiblitySettings(){return this._userProfile.transcriptSettings??{publicLink:{showLegalName:!0,showMCID:!0,showContactEmail:!!this._userTranscript.contactEmail},print:{showLegalName:!0,showMCID:!0,showContactEmail:!!this._userTranscript.contactEmail}}}set userTranscriptVisiblitySettings(o){this._userProfile.transcriptSettings=o}get userName(){return this._userProfile.userName}get cardViewModel(){return this._cardViewModel}get busy(){return this._busy}get transcriptError(){return this._transcriptError}get fetchError(){return this._fetchError}clearFetchError(){this._fetchError=!1}setFetchError(){this._fetchError=!0}setBusy(){this._busy=!0,this.notifyPropertyChanged()}setReady(){this._busy=!1,this.notifyPropertyChanged()}notifyPropertyChanged(){this.publish(new Ae)}createPublicLinkUrl(o){return dt(this.userName,"transcript",o).toString()}};function Ax(e){return e.transcriptError===2?jd():[e.userTranscript.certificationData?.activeCertifications,e.userTranscript.certificationData?.passedExams,e.userTranscript.certificationData?.qualifications,e.userTranscript.certificationData?.certifiedTrainerHistory,e.userTranscript.certificationData?.historicalCertifications,e.userTranscript.modulesCompleted].every(t=>t===void 0||t.length===0)?ht("transcript"):d`
		<h2
			class="title is-5 ${e.isPublic?"margin-bottom-sm":"margin-bottom-xxs"} display-none-print"
		>
			${Pp}
		</h2>
		<p class="margin-bottom-sm display-none-print" ?hidden="${e.isPublic}">
			${e.userTranscript.certificationData?W0:""}
		</p>
		<div class="position-relative background-color-body box padding-none">
			<div
				class="padding-xxs border-bottom padding-bottom-md display-none-print ${e.isPublic?"display-none":""}"
			></div>
			${DW(e)} ${LW(e)} ${MW(e)}
			${HW(e)}
		</div>
	`}function DW(e){return e.isPublic?d``:bl(e,"transcript-print",[{title:qy,icon:"docon-document-management",dataBiName:"transcript-settings",clickHandler:()=>qW(e)},{title:dh,icon:"docon-link",dataBiName:"transcript-share-link",clickHandler:()=>YW(e)}])}function LW(e){return d`
		<div
			class="display-flex flex-wrap-wrap align-items-center margin-bottom-none padding-sm padding-top-xxs border-bottom"
		>
			<div
				class="display-flex flex-nowrap flex-grow-1 padding-right-sm padding-top-xs"
				role="presentation"
			>
				${Ba()}
				<span
					class="margin-left-xxs margin-left-xs-tablet padding-left-xxs padding-left-xs-tablet border-left-md font-size-h7 font-size-h4-tablet font-weight-normal"
				>
					${Pp}
				</span>
			</div>
			${e.userTranscript.certificationData?.legalName||e.userTranscript.certificationData?.mcid?d`
						<dl class="display-flex flex-wrap-wrap font-size-sm">
							${e.userTranscript.certificationData?.legalName&&(!e.isPublic||e.userTranscriptVisiblitySettings.publicLink.showLegalName)?d`<div
										id="transcript-legal-name"
										class="display-flex flex-wrap-wrap padding-top-xs padding-right-sm ${e.userTranscriptVisiblitySettings.print.showLegalName?"":"display-none-print"}"
								  >
										<dt class="padding-right-xxs">${F0}</dt>
										<dd>${e.userTranscript.certificationData.legalName}</dd>
								  </div>`:d``}
							${e.userTranscript.certificationData?.mcid&&(!e.isPublic||e.userTranscriptVisiblitySettings.publicLink.showMCID)?d`<div
										id="transcript-mcid"
										class="display-flex flex-wrap-wrap padding-top-xs ${e.userTranscriptVisiblitySettings.print.showMCID?"":"display-none-print"}"
								  >
										<dt class="padding-right-xxs">${Rp}</dt>
										<dd>${e.userTranscript.certificationData.mcid}</dd>
								  </div> `:d``}
						</dl>
				  `:d``}
		</div>
	`}function MW(e){let t=[{label:X0,data:e.userTranscript.certificationData?.totalActiveCertifications},{label:J0,data:e.userTranscript.certificationData?.totalHistoricalCertifications},{label:Z0,data:e.userTranscript.certificationData?.totalExamsPassed},{label:eO,data:e.userTranscript.certificationData?.totalQualificationsEarned},{label:tO,data:e.userTranscript.certificationData?.mctStatus},{label:oO,data:e.userTranscript.totalModulesCompleted},{label:Q0,data:e.userTranscript.modulesCompleted.length>0?Vn(e.userTranscript.totalTrainingMinutes):null}],o=n=>n.data?d`
					<div>
						<dt class="font-weight-semibold">${n.label}</dt>
						<dd class="font-size-sm">${n.data}</dd>
					</div>
			  `:d``;return d`
		<div class="font-size-sm margin-bottom-none padding-sm border-bottom">
			<div class="display-flex flex-wrap-wrap align-items-baseline margin-bottom-xxs">
				<h3 class="font-size-h4 font-weight-normal margin-right-sm">${e.displayName}</h3>
				<a
					data-bi-name="transcript-edit-name"
					class="margin-top-xxs display-none-print"
					?hidden="${e.isPublic}"
					href="${dt("me","settings").toString()}#edit-info-form"
				>
					${ie(V0)}
				</a>
			</div>

			<div>
				<span class="padding-right-xxs">${j0}</span>
				<span>${e.userName}</span>
			</div>
			${e.userTranscript.contactEmail&&(!e.isPublic||e.userTranscriptVisiblitySettings.publicLink.showContactEmail)?d`<div
						id="transcript-contact-email"
						class="display-flex flex-wrap-wrap ${e.userTranscriptVisiblitySettings.print.showContactEmail?"":"display-none-print"}"
				  >
						<span class="padding-right-xxs">${Y0}</span>
						<span
							class="has-text-wrap padding-right-sm"
							?hidden="${!e.userTranscript.contactEmail}"
						>
							${e.userTranscript.contactEmail}
						</span>
						<a
							?hidden="${e.isPublic}"
							data-bi-name="transcript-edit-email"
							href="${IC}"
							class="display-none-print"
						>
							${ie(G0)}
						</a>
				  </div>`:d``}
			<dl class="margin-bottom-none padding-top-sm grid is-2">
				${t.map(o)}
			</dl>
		</div>
	`}function OW(e,t){let{name:o,dateEarned:n,expiration:r}=t,i=[{heading:Hy,value:n??""},{heading:mh,value:r??""}],a=i.some(({value:s})=>!!s);return d`<p>${o??jl}</p>
		${a?d` <p
					class="display-flex flex-direction-row padding-top-xxs padding-top-none-tablet align-items-center"
			  >
					<span class="icon margin-none margin-right-xxs" aria-hidden="true">
						<span class="docon docon-calendar"></span>
					</span>
					<span class="display-flex flex-wrap-wrap is-comma-delimited">
						${i.map(({heading:s,value:c},l)=>c?d`
										<span class="${l!==i.length?"margin-right-xxs":""}"
											>${s} ${qs(c)}</span
										>
								  `:d``)}
					</span>
			  </p>`:d``}`}function qs(e){if(e){let t=new Date(e);return jo(t)}return jl}function UW(e){return e>0?Vn(e):jl}function $W(e){return d`<span class="is-capitalized">${e}</span>`}function yB(e,t){return e===t-1}function zW(e,t,o){let n=TB(e.caption+"-list");return e.rows.length===0?d``:d`
		<div
			id="${n}"
			class="padding-none padding-bottom-md ${yB(t,o.length)?"":"border-bottom"}"
		>
			<h4 class="font-size-xl font-weight-semibold padding-sm padding-top-md">${e.caption}</h4>
			<ol>
				${e.rows.map((r,i)=>d`
						<li
							value="${i}"
							aria-setsize="${e.rows.length}"
							aria-posinset="${i+1}"
							class="is-vertically-centered background-color-alternating-grey margin-none font-size-sm color-adjust-exact is-unstyled break-inside-avoid padding-block-xxs ${i>=e.initialRows?"expandable":""}"
						>
							${e.columns.map(({template:a,heading:s,key:c})=>d` <div class="padding-xs padding-left-sm">
									<h5 class="font-size-sm font-weight-semibold">${s}</h5>
									<p>
										${a?a(r[c],r):r[c]??jl}
									</p>
								</div>`)}
						</li>
					`)}
			</ol>
			${e.rows.length>e.initialRows?EB(n,"border-none color-primary margin-top-sm margin-left-sm font-size-sm display-none-print padding-none"):d``}
		</div>
	`}function FW(e,t,o){let n=TB(e.caption+"-table");return e.rows.length===0?d``:d`
		<div
			id="${n}"
			class="padding-none padding-bottom-xs-tablet ${yB(t,o.length)?"":"border-bottom"}"
		>
			<h4 class="font-size-xl font-weight-semibold padding-sm padding-top-md">${e.caption}</h4>
			<table class="table border-none">
				<thead>
					<tr>
						${e.columns.map(({heading:r})=>d` <th
									class="padding-left-sm padding-top-xxs padding-bottom-xs font-size-md font-weight-semibold border-none"
								>
									${r}
								</th>`)}
					</tr>
				</thead>
				<tbody id="${n}-record-list">
					${e.rows.map((r,i)=>d`
							<tr
								value="${i}"
								class="background-color-alternating-grey font-size-sm color-adjust-exact break-inside-avoid ${i>=e.initialRows?"expandable":""}"
							>
								${e.columns.map(({template:a,key:s})=>d` <td
										class="padding-left-sm padding-block-xs border-none is-vertically-aligned-middle"
									>
										${a?a(r[s],r):r[s]??jl}
									</td>`)}
							</tr>
						`)}
				</tbody>
			</table>
			${e.rows.length>e.initialRows?EB(n,"border-none color-primary margin-top-sm margin-left-sm font-size-sm display-none-print padding-none"):d``}
		</div>
	`}function HW(e){let t=[{caption:nO,initialRows:3,rows:e.userTranscript.certificationData?.activeCertifications,columns:[{heading:Fy,key:"name"},{heading:zy,key:"certificationNumber"},{heading:Hy,key:"dateEarned",template:qs},{heading:fh,key:"expiration",template:qs}]},{caption:sO,initialRows:3,rows:e.userTranscript.certificationData?.passedExams,columns:[{heading:gO,key:"examTitle"},{heading:fO,key:"examNumber"},{heading:vO,key:"examDateTaken",template:qs}]},{caption:cO,initialRows:3,rows:e.userTranscript.certificationData?.qualifications,columns:[{heading:bO,key:"title"},{heading:lO,key:"achievementDate",template:qs}]},{caption:rO,initialRows:1,rows:e.userTranscript.certificationData?.certifiedTrainerHistory,columns:[{heading:hO,key:"title"},{heading:uO,key:"activeFrom",template:qs},{heading:yO,key:"activeTo",template:qs}]},{caption:iO,initialRows:3,rows:e.userTranscript.certificationData?.historicalCertifications,columns:[{heading:Fy,key:"name",template:OW},{heading:zy,key:"certificationNumber"},{heading:xO,key:"status",template:$W}]},{caption:aO,initialRows:6,rows:e.userTranscript.modulesCompleted,columns:[{heading:_O,key:"title"},{heading:pO,key:"description"},{heading:dO,key:"completedOn",template:qs},{heading:mO,key:"durationInMinutes",template:UW}]}];return d` <div class="padding-none">
		<div class="is-hidden-tablet">
			${t.map((o,n,r)=>o.rows?zW(o,n,r):d``)}
		</div>
		<div class="is-hidden-mobile">
			${t.map((o,n,r)=>o.rows?FW(o,n,r):d``)}
		</div>
	</div>`}function TB(e){return e.trim().replace(/\s+/g,"-").toLowerCase()}async function qW(e){let t=e.user.transcriptSettings;await jb(e,()=>({id:"transcript",title:qy,busy:e.busy,renderLinks:!e.userTranscript.contactEmail,submitHandler:async n=>{let i=n.target.querySelectorAll('input[type="checkbox"]'),a={publicLink:{showLegalName:i[0].checked,showMCID:i[1].checked,showContactEmail:i[2].checked},print:{showLegalName:i[3].checked,showMCID:i[4].checked,showContactEmail:i[5].checked}};await e.updatePrintableSettings(a),Vb("transcript",a.print)},fieldsets:[{subtitle:dh,checkboxes:[{id:"choice-link-legal-name",name:"link-legal-name",checked:e.userTranscript.certificationData?e.userTranscriptVisiblitySettings.publicLink.showLegalName:null,label:Yy},{id:"choice-link-mcid",name:"link-mcid",checked:e.userTranscript.certificationData?e.userTranscriptVisiblitySettings.publicLink.showMCID:null,label:Gy},{id:"choice-link-contact-email",name:"link-contact-email",checked:e.userTranscriptVisiblitySettings.publicLink.showContactEmail,label:Vy,linkTitle:By,linkHref:IC,disabled:!e.userTranscript.contactEmail,dataBiName:"transcript-add-email"}]},{subtitle:uh,checkboxes:[{id:"choice-print-legal-name",name:"print-legal-name",checked:e.userTranscript.certificationData?e.userTranscriptVisiblitySettings.print.showLegalName:null,label:Yy},{id:"choice-print-mcid",name:"print-mcid",checked:e.userTranscript.certificationData?e.userTranscriptVisiblitySettings.print.showMCID:null,label:Gy},{id:"choice-print-contact-email",name:"print-contact-email",checked:e.userTranscriptVisiblitySettings.print.showContactEmail,label:Vy,linkTitle:By,linkHref:IC,disabled:!e.userTranscript.contactEmail,dataBiName:"transcript-add-email"}]}]})),e.fetchError&&(e.userTranscriptVisiblitySettings=t,e.clearFetchError())}async function BW(e,t){let o=async r=>{r.preventDefault();let i=Y.querySelector("#edit-transcript-settings-form"),a=i?.querySelector("#public-link-to-copy"),s=i?.querySelector("#public-link-to-copy-container");await uq(a.textContent,a)?(s?.classList?.add("border-color-success"),st(i,"linkCopiedSuccessfully")):(s?.classList?.add("border-color-danger"),st(i,"linkCopiedUnsuccessfully"))};return I(d`
			<div class="modal-card padding-xxs padding-xs-tablet" aria-live="polite">
				<header class="modal-card-head padding-none">
					<button
						class="modal-close modal-card-close-button is-large"
						aria-label="${ze}"
					></button>
				</header>
				<section class="modal-card-body justify-content-center padding-block-none">
					<h2 class="font-size-h5 margin-right-xxs">${dh}</h2>
					<form id="edit-transcript-settings-form" @submit="${async r=>{r.preventDefault();let i=r.submitter.value,a=r.target;Y.querySelector("#public-link-to-copy-container")?.classList?.remove("border-color-success","border-color-danger"),Kr(a);try{i==="create"?await e.createPublicLink():await e.removePublicLink()}catch{st(a,"somethingWentWrong")}}}" action="javascript:">
						<div class="field">
							<div class="margin-top-xs font-size-sm margin-bottom-xs">
								<span
									>${ie(kO)}</span
								>
							</div>
							<div class="control margin-top-sm margin-bottom-xs">
								<p
									hidden
									data-label="somethingWentWrong"
									class="help help-danger margin-bottom-xxs margin-right-xxs"
								>
									${ph}
								</p>
								<button
									id="create-link"
									data-bi-name="transcript-create-link"
									type="submit"
									class="button button-filled button-primary ${e.busy?"is-loading":""}"
									value="create"
									?disabled="${!!e.publicLinkUrl}"
								>
									${SO}
								</button>
							</div>
							<fieldset
								id="hidden-public-link"
								class="field margin-top-sm margin-bottom-sm"
								?hidden="${!e.publicLinkUrl}"
							>
								<legend class="label margin-bottom-xxs">
									${EO}
								</legend>
								<div class="field display-flex flex-wrap-wrap flex-wrap-nowrap-tablet">
									<div
										id="public-link-control"
										class="control width-full width-auto-tablet margin-right-xxs margin-bottom-xxs overflow-hidden"
									>
										<div
											id="public-link-to-copy-container"
											class="has-cursor-default has-text-overflow-ellipsis has-line-height-reset border border-radius border-color-secondary padding-xxs"
										>
											<span id="public-link-to-copy" class="has-no-wrap" name="public-link-to-copy"
												>${e.publicLinkUrl}</span
											>
										</div>
										<p
											hidden
											class="help help-success has-line-height-reset"
											data-label="linkCopiedSuccessfully"
										>
											${wO}
										</p>
										<p
											hidden
											class="help help-danger has-line-height-reset"
											data-label="linkCopiedUnsuccessfully"
										>
											${CO}
										</p>
									</div>
									<div class="control margin-right-xxs margin-bottom-xxs">
										<button
											id="copy-link"
											class="button has-no-wrap has-line-height-reset border-radius padding-xxs"
											type="button"
											data-bi-name="transcript-copy-link"
											@click="${o}"
										>
											<span class="icon" aria-hidden="true">
												<span class="docon docon-link"></span>
											</span>
											<span>${TO}</span>
										</button>
									</div>
									<div class="control margin-bottom-xxs">
										<button
											id="remove-link"
											class="button has-no-wrap has-line-height-reset border-radius padding-xxs ${e.busy?"is-loading":""}"
											type="submit"
											value="remove"
											data-bi-name="transcript-remove-link"
										>
											<span class="icon" aria-hidden="true">
												<span class="docon docon-delete"></span>
											</span>
											<span>${AO}</span>
										</button>
									</div>
								</div>
							</fieldset>
						</div>
					</form>
				</section>
			</div>
		`,t),t}async function YW(e){let t=Y.createElement("div"),o=new Ge(t),n=()=>Y.activeElement.closest("button")&&!e.publicLinkUrl?'button[id="create-link"]':'button[id="copy-link"]',r=a=>{let s=o.contentElement.querySelector(a);if(s){s.focus();return}s=o.contentElement.querySelector("div.modal-card"),s?.focus()},i=()=>{let a=n();BW(e,t),r(a)};e.subscribe(Ae,()=>{i()}),i(),await o.show()}function SB(e){return d`
		<section
			class="has-background-image padding-top-lg-tablet padding-bottom-lg padding-left-xs padding-left-none-tablet padding-right-xs padding-right-none-tablet"
		>
			<div class="display-flex flex-direction-column align-items-center is-text-centered">
				<h1 class="has-line-height-reset font-size-h2">
					${B0}
				</h1>
				<div class="columns is-mobile justify-content-center">
					<p class="column is-size-3 margin-top-xs margin-bottom-md is-three-quarters">
						${z0}
					</p>
				</div>
				<figure class="image" aria-hidden="true">
					<img alt="" src="/en-us/media/illustrations/no-results.svg?branch=main" />
				</figure>
				<div class="padding-top-md">
					<a
						class="button button-primary button-filled"
						href="${dt(e.userName).toString()}"
					>
						${K0}
					</a>
				</div>
			</div>
		</section>
	`}function EB(e,t){return R1(e,"transcript-show-more",t,n=>{let r=n.target instanceof HTMLElement&&n.target.closest("button[data-show-more]");if(r){let i=r.getAttribute("data-bi-name")==="transcript-show-less";r.setAttribute("data-bi-name",i?"transcript-show-more":"transcript-show-less")}})}function wo(e,t,o){let n=new URL(location.href),[,,r,,i,a]=decodeURIComponent(n.pathname).toLowerCase().split("/");return(n.hostname!=="docs.microsoft.com"||r!=="users")&&(i=(n.searchParams.get("section")||"").toLowerCase(),a=(n.searchParams.get("detail")||"").toLowerCase()),d` <div class="has-uhf-padding padding-top-sm ">
		${o}

		<div class="columns">
			<div
				class="column is-one-quarter position-sticky-tablet top-0 align-self-flex-start"
				id="profile-nav"
			>
				<nav aria-label="${vp}" class="is-hidden-mobile">
					<ul class="tree font-size-lg">
						${Ai.map((s,c)=>{let l=s===e.section;return d`<li
								class="${c!==0?"margin-top-sm margin-bottom-sm":"margin-bottom-sm"}"
							>
								<a
									class="tree-item is-leaf padding-left-none ${s===e.section?"font-size-xl is-selected":""}"
									aria-current="${$o(l?"page":void 0)}"
									href="${Uq(l,i,a,e.user.userName,s)}"
								>
									${Vd(s)}
								</a>
							</li>`})}
					</ul>
				</nav>
				<nav class="is-hidden-tablet dropdown" role="navigation" aria-label="${vp}">
					<button
						type="button"
						class="dropdown-trigger button is-full-width justify-content-space-between"
						aria-controls="profile-navigation-mobile"
						aria-expanded="false"
					>
						<span>${Vd(e.section)}</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-chevron-down-light expanded-indicator"></span>
						</span>
					</button>
					<div
						id="profile-navigation-mobile"
						class="dropdown-menu is-full-width padding-xs font-size-sm has-body-background-medium"
						role="menu"
					>
						<ul class="margin-none">
							<li>
								${Ai.map(s=>d`
										<a
											class="dropdown-menu-close padding-xxs display-block"
											href="${dt(e.user.userName,s)}"
										>
											<span>${Vd(s)}</span>
										</a>
									`)}
							</li>
						</ul>
					</div>
				</nav>
			</div>

			<div class="column is-three-quarters is-fullwidth-print">
				<nav id="cert-breadcrumb-holder"></nav>
				<section class="margin-bottom-sm">${t}</section>
			</div>
		</div>
	</div>`}function wB(e){let o=e.activity.items?e.activity.items.length===0:!0,n=!e.achievements.hasAchievements;return o&&n?d` <div class="has-uhf-padding padding-top-sm">
			${kt(e.card,!0)} ${Kq()}
		</div>`:d` <div class="has-uhf-padding padding-top-sm">
		<section class="padding-top-xs">${kt(e.card)}</section>
		<section class="margin-bottom-sm" ?hidden=${o}>
			${Jb(e.activity,!0)}
		</section>
		${n?null:Qb(e.achievements,!0)}
	</div>`}function PC(e){return d` <div class="has-uhf-padding padding-top-sm">
		${kt(e,!0)}
		<div class="display-flex flex-direction-column align-items-center">
			<figure class="image is-center-aligned margin-bottom-lg">
				<img alt="" class="${"margin-top-sm"}" src="/media/profile/private-mode.svg?branch=main" />
				<figcaption class="has-text-centered ${"margin-top-lg"}">
					${CM.replace("{name}",e.user.isPrivate?e.user.userName:e.user.displayName)}
				</figcaption>
			</figure>
		</div>
	</div>`}function CB(e){return Array.from(document.querySelectorAll("#headerAreaHolder, .content-header, #footer")).forEach(o=>{o.setAttribute("hidden","")}),d`<div class="uhf-container padding-xs">
		<h1>${e}</h1>
	</div>`}function Ix(e){let t=document.querySelector("#profile-settings-navigation > ol > li.selected");t&&(t.classList.remove("selected","padding-left-xxs"),t.classList.add("padding-left-none")),e.parentElement.classList.remove("padding-left-none"),e.parentElement.classList.add("selected","padding-left-xxs")}function kB(e,t){let o=[{displayName:`${oh}`,id:"edit-info-form"},{displayName:`${Wg}`,id:"account-linking"},{displayName:`${Kg}`,id:"manage-account-linked",hidden:!0},{displayName:`${Xs}`,id:"manage-email-preferences-form"},{displayName:`${Gl}`,id:"manage-qa-email-preferences-form"},{displayName:`${ih}`,id:"privacy-prefs-form"},{displayName:`${th}`,id:"download-data-form"},{displayName:`${eh}`,id:"delete-profile-form"}],n=i=>{let a=i.target instanceof Element&&i.target.closest("a");!a||Ix(a)},r=i=>{if(i.key==="Spacebar"||i.key==="Enter"){let a=i.target instanceof Element&&i.target.closest("a");if(!a)return;Ix(a)}};return d` <div class="has-uhf-padding padding-top-sm">
		${t}

		<div class="columns">
			<div class="column is-one-quarter position-sticky-tablet top-0 align-self-flex-start">
				<nav
					id="profile-settings-navigation"
					aria-label="${hp}"
					class="is-hidden-mobile"
				>
					<h2 class="title is-4 margin-bottom-xs">${hp}</h2>
					<ol class="doc-outline tree">
						${o.map(i=>d`<li
								class="is-unstyled padding-bottom-xxs padding-top-xxs padding-left-none ${i.hidden?"is-hidden":""}"
								@click="${n}"
								@keyup="${r}"
							>
								<a href="#${i.id}" class="tree-item is-leaf padding-left-none font-size-sm"
									>${i.displayName}</a
								>
							</li>`)}
					</ol>
				</nav>
				<nav
					id="profile-settings-navigation-mobile"
					class="is-hidden-tablet dropdown"
					role="navigation"
					aria-label="${hp}"
				>
					<button
						type="button"
						class="dropdown-trigger button is-full-width justify-content-space-between"
						aria-controls="profile-settings-navigation-mobile"
						aria-expanded="false"
					>
						<span>${hp}</span>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-chevron-down-light expanded-indicator"></span>
						</span>
					</button>
					<div
						id="profile-settings-navigation-mobile"
						class="dropdown-menu is-full-width padding-xs font-size-sm has-body-background-medium"
						role="menu"
					>
						<ol class="margin-none">
							${o.map(i=>d`<li class="is-unstyled">
									<a
										class="dropdown-menu-close padding-bottom-xxs padding-top-xxs display-block"
										href="#${i.id}"
									>
										${i.displayName}</a
									>
								</li>`)}
						</ol>
					</div>
				</nav>
			</div>

			<div class="column is-three-quarters">
				<section class="margin-bottom-lg">${e}</section>
			</div>
		</div>
	</div>`}function AB(e){return d` <div class="has-uhf-padding padding-top-sm">
		<section class="padding-top-xs">${kt(e.cardViewModel,!0)}</section>
		${e.transcriptError===1?SB(e):d`<section class="margin-bottom-sm">${Ax(e)}</section>`}
	</div>`}var Px=class extends Ye{constructor(o){super();this.user=o;this.card=new Xr(this.user,!0);this.activity=new Kd(this.user,!1);this.achievements=new Wd(this.user);this.card.subscribe(Ae,n=>this.publish(n)),this.activity.subscribe(Ae,n=>this.publish(n)),this.achievements.subscribe(Ae,n=>this.publish(n))}beforeActivate(){return Promise.all([this.card.beforeActivate(),this.activity.beforeActivate(),this.achievements.beforeActivate()]).then(()=>{})}};var tg=!1;function RC(e){Yi(e),tg=!1,e.onsubmit=t=>{t.preventDefault(),GW(e)}}function GW(e){let t=document.createElement("div");I(d`
			<div class="modal-card">
				<section class="modal-card-body">
					<h2 class="title">${ti}</h2>
					<p>${lg}</p>
					<div class="buttons buttons-right">
						<button
							type="button"
							class="button font-weight-semibold modal-close"
							id="cancel-delete"
							data-autofocus
						>
							${ze}
						</button>
						<button
							type="button"
							class="button font-weight-semibold button-danger"
							id="confirm-delete"
							data-bi-name="confirm-delete"
						>
							${Ri}
						</button>
					</div>
				</section>
			</div>
		`,t);let o=new Ge(t);o.show();let n=t.querySelector("#cancel-delete"),r=t.querySelector("#confirm-delete"),i=e.querySelector("#delete-account-button");return r.onclick=async()=>{if(!tg){tg=!0,r.classList.add("is-loading"),i.classList.add("is-loading"),Kr(e);try{let a=await c_();tg=!1,r.classList.remove("is-loading"),a?await $t(`https://docs.microsoft.com/${w.data.userLocale}`,!0):(o.hide(),st(e,"somethingWentWrong"))}catch(a){throw new Error(`error: ${a.message}`)}finally{tg=!1,r.classList.remove("is-loading"),i.classList.remove("is-loading")}}},{cancelDeleteButton:n,confirmDeleteButton:r}}var NC=!1;function DC(e){Yi(e);let t=e.querySelector("#download-data");t.onclick=async()=>{if(!NC){NC=!0,t.classList.add("is-loading"),Kr(e);try{let{data:o,filename:n}=await N$(),r=URL.createObjectURL(o),i=n||`${y.userName}.json`,a=document.createElement("a");a.download=i,a.target="_blank",a.href=r,a.hidden=!0,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(r)}catch{st(e,"somethingWentWrong")}finally{NC=!1,t.classList.remove("is-loading")}}}}function IB(e,t){Array.from(e.querySelectorAll(".avatar-url")).forEach(n=>{n.src=t.avatarUrl||At}),t.subscribe(_t,()=>{Array.from(e.querySelectorAll(".avatar-url")).forEach(r=>{r.src=t.avatarUrl||At})})}async function RB(e){PB(e),y.subscribe(_t,()=>PB(e))}async function PB(e){let{section:t}=ga(new URL(location.href)),o=await Ot.getLinkedMSA(),{linkedMSA:n}=o;if(t==="settings"&&n?.isLinked&&e){let r=document.querySelector('a[href="#manage-account-linked"]'),i=document.querySelector(`[data-account-upn='${n?.msaEmail}']`),a=document.querySelector(".user-email"),s=document.querySelectorAll(".linked-account-upn");a&&y.authenticationMode==="MSA"&&(a.innerHTML=`${y.upn} <strong>(${Ty})</strong>`),s&&s.forEach(c=>{c.innerText===n?.msaEmail&&(c.innerHTML=`${n?.msaEmail} <strong>(${Ty})</strong>`)}),i&&(i.disabled=!0),I(d`<div class="padding-xs">
				<h2 class="title margin-top-none">
					${Kg}
				</h2>
				<p class="margin-bottom-md">${rL}</p>
				<div class="display-flex flex-direction-row margin-bottom-md">
					<div class="margin-right-xl">
						<p class="font-weight-semibold">
							${KD}
						</p>
						<p>${n?.msaEmail}</p>
					</div>
					<div>
						<p class="font-weight-semibold">${Hl}</p>
						<p id="linked-mcid" class="font-size-sm font-weight-semibold">${n?.mcId}</p>
					</div>
				</div>
				<a
					href="https://examregistration.microsoft.com/MyProfile/?locale=en-us"
					class="button button-primary button-filled margin-bottom-sm"
				>
					${iL}
				</a>
				<p>${ie(ZD)}</p>
			</div>`,e),r.parentElement.classList.remove("is-hidden"),e.classList.remove("is-hidden")}}function NB(e){let t=e.isPrivate,o=!0,n=!1,r=!1,i=document.createElement("div");i.classList.add("box","padding-none"),i.tabIndex=-1,gu(e.subscribe(_t,()=>{t=e.isPrivate,I(u(),i)}));function a(p){t=p.target.checked,I(u(),i)}function s(){o=!0,I(u(),i)}async function c(p){p.preventDefault(),n=!0,I(u(),i);let m=document.createElement("div"),f=new Ge(m),h=Promise.resolve(!0);if(t&&(h=VW(m),f.show()),await h){let g={userName:e.userName,locale:e.locale,email:e.email,displayName:e.displayName,country:e.country,isPrivate:t,avatarImageBytes:null,avatarExtension:null,source:null,interests:e.interests,contactPointTopicSetting:e.contactPointTopicSetting,gsi:e.gsi},v=await Uo(e.userId,g);r=v.hasError,r||(e.readUserProfile(v.profile),o=!1)}n=!1,I(u(),i),f.hide()}function l(){t=e.isPrivate,i.focus(),I(u(),i)}function u(){return d`
			<form id="privacy-prefs-form" action="javascript:" @submit=${c}>
				<div
					.hidden=${o}
					class="alert is-radiusless is-success margin-top-none padding-xxs has-line-height-reset"
					role="alert"
					aria-live="assertive"
				>
					<div class="columns is-mobile is-gapless is-centered is-vertically-centered">
						<div class="column is-narrow">
							<span class="icon has-text-success margin-right-xxs" aria-hidden="true">
								<span class="docon docon-status-success-outline"></span>
							</span>
						</div>
						<div class="column">
							<span class="font-size-sm"
								>${e.isPrivate?DM:LM}</span
							>
						</div>
						<div class="column is-narrow">
							<button
								type="button"
								@click=${s}
								class="button button-clear"
								aria-label="${Qs}"
							>
								<span class="docon docon-navigate-close" aria-hidden="true"></span>
							</button>
						</div>
					</div>
				</div>
				<div class="padding-md">
					<h2 id="privacy" class="title is-3 margin-top-none margin-bottom-sm">
						${ih}
					</h2>
					<p class="font-size-md">${NM}</p>
					<div
						class="columns is-mobile is-gapless margin-top-sm is-centered is-vertically-centered"
					>
						<div class="column is-narrow">
							<div class="checkbox-toggle-container padding-left-none padding-right-xs">
								<div class="checkbox-toggle-wrapper margin-left-none">
									<input
										type="checkbox"
										id="privacy-prefs-checkbox"
										data-bi-name="privacy-prefs-checkbox"
										@change=${a}
										.checked=${t}
									/>
									<label class="switch" for="privacy-prefs-checkbox"></label>
								</div>
							</div>
						</div>
						<div class="column">
							<label for="privacy-prefs-checkbox" class="is-6">
								${MM}
							</label>
						</div>
					</div>
					<div class="margin-top-sm margin-bottom-none columns is-mobile is-gapless">
						<div class="column is-narrow is-half-mobile">
							<div class="margin-right-xxs">
								<button
									type="submit"
									id="save-privacy-prefs"
									class="button margin-bottom-none is-fullwidth-mobile button-primary button-filled padding-inline-lg-tablet ${n?"is-loading":""}"
									data-bi-name="save"
									.disabled=${t===e.isPrivate||n}
								>
									${Bt}
								</button>
							</div>
						</div>
						<div class="column is-narrow is-half-mobile">
							<button
								type="button"
								id="cancel-privacy-prefs"
								class="button margin-bottom-none is-fullwidth-mobile padding-inline-lg-tablet"
								data-bi-name="cancel"
								@click=${l}
								.disabled=${t===e.isPrivate||n}
							>
								${Je}
							</button>
						</div>
					</div>
					<p
						.hidden=${!r}
						data-label="somethingWentWrong"
						class="help help-danger display-flex justify-content-flex-end"
					>
						${go}
					</p>
				</div>
			</form>
		`}return I(u(),i),i}function VW(e){return new Promise(t=>{let o=!1;function n(){t(!1)}function r(){o=!0,I(i(),e),t(!0)}function i(){return d`
				<div class="modal-card">
					<div class="modal-card-head">
						<h2 class="title margin-none">${RM}</h2>
						<button
							@click=${n}
							class="modal-close modal-card-close-button is-large"
							data-bi-name="close"
							aria-label="${ze}"
						></button>
					</div>
					<section class="modal-card-body padding-top-none">
						<p>${PM}</p>
					</section>
					<div class="modal-card-foot buttons buttons-right padding-top-none margin-bottom-none">
						<button
							type="button"
							@click=${r}
							class="button button-primary button-filled is-fullwidth-mobile font-size-md padding-inline-lg ${o?"is-loading":""}"
							id="confirm-privacy"
							data-bi-name="confirm-privacy"
							.disabled=${o}
							data-autofocus
						>
							${kn}
						</button>
						<button
							type="button"
							@click=${n}
							class="button is-fullwidth-mobile font-size-md padding-inline-lg"
							id="cancel-privacy"
							.disabled=${o}
						>
							${Je}
						</button>
					</div>
				</div>
			`}I(i(),e)})}var Rx=class extends Ye{constructor(){super(...arguments);this.activated=new Promise((o,n)=>{this.resolveActivated=o,this.rejectActivated=n})}async beforeActivate(){try{await kx(),this.resolveActivated()}catch{this.rejectActivated()}}},xr;function DB(e){return y.isAuthenticated?(jW(e),d`${xr}`):d``}async function jW(e){if(xr)return;xr=document.createElement("div");let t=d`
		${tq()} ${oq()} ${nq()}
		${rq()} ${iq()} ${NB(y)}
		${aq()} ${sq()}
	`;I(t,xr);let o=xr.querySelector("#download-data-form"),n=xr.querySelector("#delete-profile-form"),r=xr.querySelector("#account-linking");Vw(xr,y),DC(o),RC(n),IB(xr,y),await e.activated,Kf(r);let i=xr.querySelector("#manage-account-linked");RB(i),pC(xr,y),await KH(xr,y)}var Dx=class extends yt{constructor(o){super({title:Ml,load:async()=>{let n=await _q(!0);return{items:n,totalCount:n.length}},paging:!1});this.user=o}},ha=class extends yt{constructor(o,n=!1,r=!1,i=!1){super({title:n?M0:r?jk:i?lp:L0,load:async()=>{let a=await xH(),s=n?a.pastChallenges:i?a.currentChallenges.concat(a.upcomingChallenges).concat(a.pastChallenges):r?a.upcomingChallenges:a.currentChallenges;return{items:s,totalCount:s.length}},paging:!1});this.user=o}},Lx=class extends Ye{constructor(o){super();this.user=o;this.modulesAndPaths=new Dx(this.user);this.challenges=new ha(this.user,!1,!1,!0);this.modulesAndPaths.subscribe(Ae,n=>this.publish(n)),this.challenges.subscribe(Ae,n=>this.publish(n))}beforeActivate(){return Promise.all([this.modulesAndPaths.beforeActivate(),this.challenges.beforeActivate()]).then(()=>{})}},Mx=class extends Ye{constructor(o){super();this.user=o;this.modulesAndPaths=new Dx(this.user);this.modulesAndPaths.subscribe(Ae,n=>this.publish(n))}beforeActivate(){return Promise.all([this.modulesAndPaths.beforeActivate()]).then(()=>{})}},ng=class extends Ye{constructor(o){super();this.user=o;this.allChallenges=new ha(this.user,!1,!1,!0);this.currentChallenges=new ha(this.user);this.upcomingChallenges=new ha(this.user,!1,!0);this.pastChallenges=new ha(this.user,!0,!1);this.allChallenges.subscribe(Ae,n=>this.publish(n)),this.currentChallenges.subscribe(Ae,n=>this.publish(n)),this.upcomingChallenges.subscribe(Ae,n=>this.publish(n)),this.pastChallenges.subscribe(Ae,n=>this.publish(n))}beforeActivate(){return Promise.all([this.allChallenges.beforeActivate(),this.currentChallenges.beforeActivate(),this.upcomingChallenges.beforeActivate(),this.pastChallenges.beforeActivate()]).then(()=>{})}};function LB(e){let t=new Date(Date.now()).getFullYear().toString();return e!==t?d`<h3
				class="font-weight-semibold padding-xs has-background-secondary-light has-border-none"
		  >
				${e}
		  </h3>`:""}function MB(e){return Object.keys(e).sort((t,o)=>t>o?-1:t<o?1:0)}function OB(e){return Object.keys(e).sort((t,o)=>t>o?1:t<o?-1:0)}function UB(e,t=!0,o=!0){if(o){let n=e.reduce((i,a)=>{let s=a.latestActivity.substr(0,4);return i[s]=i[s]||[],i[s].push(a),i},{});return d`<div class="box margin-bottom-xs padding-none border-bottom">
			${(t?MB:OB)(n).map(i=>d`<div>
					${LB(i)}
					<ol class="is-unstyled">
						${n[i].map(a=>d`<li class="border-bottom">
								${zf(a.status,a.latestActivity?new Date(a.latestActivity):void 0,a.iconUrl,a.title,a.url?a.url:"",a.durationInMinutes,a.remainingTime,a.type,a.status,a.xpPoints)}
							</li>`)}
					</ol>
				</div>`)}
		</div>`}else return d` <div class="box margin-bottom-xs padding-none border-bottom">
			<ol class="is-unstyled">
				${e.map(n=>d`<li class="border-bottom">
						${zf(n.status,n.latestActivity?new Date(n.latestActivity):void 0,n.iconUrl,n.title,n.url?n.url:"",n.durationInMinutes,n.remainingTime,n.type,n.status,n.xpPoints)}
					</li>`)}
			</ol>
		</div>`}function $B(e=0){return d` <div class="level margin-bottom-xs font-size-sm">
		<div class="level-left padding-none">
			<div class="level-item justify-content-flex-start font-weight-semibold">
				${Ol.replace("{number}",e.toString())}
			</div>
		</div>
		<div class="level-right padding-none margin-top-xxs">
			<div class="level-item justify-content-flex-start">
				<p class="margin-right-xxs">${jg}</p>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-arrow-down"></span>
				</span>
			</div>
		</div>
	</div>`}function zB(e){if(!e.items||e.items.length===0)return d``;let t=Hd(),o=dt(t,"training");return d`
		<nav class="breadcrumb-holder margin-bottom-xxs" role="navigation" aria-label="${Qx}">
			<ul class="breadcrumbs-deprecated padding-none border-none">
				<li>
					<a href="${o}">${Ip}</span></a>
				</li>
				<li>
					<span>${Ml}</span>
				</li>
			</li>
		</nav>
		<h2 class="title is-5 margin-bottom-xs">${e.title}</h2>
		${$B(e.items.length)}
		${UB(e.items)}`}function Nx(e,t=!0,o=!0){if(o){let n=e.reduce((i,a)=>{let s=a.end.substr(0,4);return i[s]=i[s]||[],i[s].push(a),i},{});return d` <div class="box margin-bottom-xs padding-none border-bottom">
			${(t?MB:OB)(n).map(i=>d`<div>
					${LB(i)}
					<ol class="is-unstyled">
						${n[i].map(a=>{let s=a.end?new Date(a.end):void 0,c=a.start?new Date(a.start):void 0,l=`/${ko.userLocale}/${C.supportLevel==="production"&&C.reviewFeatures?"test/":""}learn/challenges?id=${a.id}`;return d`<li class="border-bottom">
								${oC("",a.title,l,s,c,0)}
							</li>`})}
					</ol>
				</div>`)}
		</div>`}else return d` <div class="box margin-bottom-xs padding-none border-bottom">
			<ol class="is-unstyled">
				${e.map(n=>{let r=n.end?new Date(n.end):void 0,i=n.start?new Date(n.start):void 0,a=`/${ko.userLocale}/${C.supportLevel==="production"&&C.reviewFeatures?"test/":""}learn/challenges?id=${n.id}`;return d`<li class="border-bottom">
						${oC("",n.title,a,r,i,0)}
					</li>`})}
			</ol>
		</div>`}function LC(e,t,o,n=!1){let r=e.items.length===0,i=t.items.length===0,a=o.items.length===0;if(r&&i&&a)return ht("training");let s=Hd(),c=dt(s,"training");return d`
		<nav class="breadcrumb-holder margin-bottom-xxs" role="navigation" aria-label="${Qx}" ?hidden="${n}">
			<ul class="breadcrumbs-deprecated padding-none border-none">
				<li>
					<a itemprop="item" href="${c}">${Ip}</span></a>
				</li>
				<li>
					<span>${lp}</span>
				</li>
			</li>
		</nav>
		${og(e,Nx,r,!1,!0,"active-csc-group",void 0,void 0,!1)}
		${og(t,Nx,i,!1,!1,"upcoming-csc-group")}
		${og(o,Nx,a,!0,!1,"past-csc-group")}
	`}function og(e,t,o,n,r,i,a,s,c=!0){if(o)return d``;let l=a&&e.items.length>a,u=l?e.items.slice(0,a):e.items,p=Hd(),m=dt(p,"training",s);return d`<div class="padding-bottom-sm" data-bi-name="${$o(i)}">
		<h2 class="title is-5 margin-bottom-xs">${e.title}</h2>
		${n?$B(u.length):""}
		${t(u,c,r)}
		<a href="${m}" class="link-button is-size-small" ?hidden="${!l}">
			${oc}
		</a>
	</div>`}function FB(e){let t=!e.modulesAndPaths.items||e.modulesAndPaths.items.length===0,o=!e.challenges.items||e.challenges.items.length===0;if(t&&o)return ht("training");let n=3,r=2;return d`
		${og(e.modulesAndPaths,UB,t,!1,!0,"training-modules-group",n,"modules")}
		${og(e.challenges,Nx,o,!1,!1,"training-csc-group",r,"challenges")}
	`}function HB(){let e=new URL(location.href),{username:t,section:o,detail:n,id:r,code:i}=ga(e);t.length===0&&(t="me");let a=document.createElement("div");return a.classList.add("is-full-height","has-body-background-medium"),Ga.then(async()=>{let s=it()["show-only-username"]==="true"||!1,c=zs(t==="me"?y.userName:t);if(c){let l=new ha(y,!1,!1,!0);if(await l.beforeActivate(),l.items.length===0){let u=Ai.findIndex(p=>p==="challenges");Ai.splice(u,1)}}if(c&&!s)XW(a,o,n,r,i);else{if(t==="me"&&!c){tr(location.href);return}if(s){ZW(a,t);return}let l=await fu(t);if(l==null){let p=(e.searchParams.get("userid")||"").toLowerCase();p!==""&&(l=await fu(`id:${p}`),l!==null&&(location.href=C.supportLevel==="production"?`/${w.data.userLocale}/users/${l.userName}/`:`/${w.data.userLocale}/test/profile/profile?username=${l.userName}`))}if(l===null){location.href=`/${w.data.userLocale}/404`;return}let u=o==="transcript"&&n;l.isPrivate&&!u?eK(a,l):JW(a,l,o,n)}}),a}function WW(e,t,o,n,r){let i=document.getElementById("code-redemption-section");i&&e!=="achievements"&&i.parentElement.removeChild(i);let a=!1,s=y;if(e==="activity"){let c=new Kd(s,!1);return{vm:c,template:()=>wo({user:s,section:e},Jb(c,a,!1),kt(o))}}else if(e==="certifications")if(t==="certification-details"){let c=new rx(n);return{vm:c,template:()=>wo({user:s,section:e},_4(c),kt(o))}}else if(t==="certifications"){let c=new ax;return{vm:c,template:()=>wo({user:s,section:e},Vf(c,sx,1,c.isLinked,c.totalCount),kt(o))}}else if(t==="appointments"){let c=new ox;return{vm:c,template:()=>wo({user:s,section:e},Vf(c,nx,3,c.isLinked,c.totalCount),kt(o))}}else if(t==="exams"){let c=new fx;return{vm:c,template:()=>wo({user:s,section:e},Vf(c,gx,4,c.isLinked,c.totalCount),kt(o))}}else if(t==="renewal-assessments"){let c=new hx;return{vm:c,template:()=>wo({user:s,section:e},Vf(c,_x,5,c.isLinked,c.totalCount),kt(o))}}else if(t==="certification-print"){let c=new ix(n,s);return{vm:c,template:()=>wo({user:s,section:e},v4(c),kt(o))}}else{let c=new vx;return{vm:c,template:()=>wo({user:s,section:e},Y4(c),kt(o))}}else if(e==="collections")if(t){let c=new Zf(t,s,!1);return{vm:c,template:()=>kC(c)}}else{let c=new Tx(s);return{vm:c,template:()=>wo({user:s,section:e},gB(c),kt(o))}}else if(e==="achievements")if(t){let c=new Wb(s,t);return{vm:c,template:()=>wo({user:s,section:e},a4(c),kt(o))}}else{let c=new URLSearchParams(location.search),l=new Wd(s,(c.get("source")||"").toLowerCase()==="mec"||s.source==="mec",r);return{vm:l,template:()=>wo({user:s,section:e},Qb(l,a),kt(l.card,!1))}}else if(e==="qna"){let c=new Cx(s);return{vm:c,template:()=>wo({user:s,section:e},xB(c),kt(o))}}else if(e==="settings"){let c=new Rx;return{vm:c,template:()=>kB(DB(c),kt(o))}}else if(e==="training")if(t)if(t==="modules"){let c=new Mx(s);return{vm:c,template:()=>wo({user:s,section:e},zB(c.modulesAndPaths),kt(o))}}else if(t==="challenges"){let c=new ng(s);return{vm:c,template:()=>wo({user:s,section:e},LC(c.currentChallenges,c.upcomingChallenges,c.pastChallenges),kt(o))}}else throw new Error(`Unsupported detail: ${t}`);else{let c=new Lx(s);return{vm:c,template:()=>wo({user:s,section:e},FB(c),kt(o))}}else if(e==="transcript"){let c=new eg(s,a);return{vm:c,template:()=>wo({user:s,section:e},Ax(c),kt(o))}}else if(e==="challenges"){let c=new ng(s);return{vm:c,template:()=>wo({user:s,section:e},LC(c.currentChallenges,c.upcomingChallenges,c.pastChallenges,!0),kt(o))}}else throw new Error(`Unsupported section: ${e}`)}function KW(){let e=document.getElementById("cert-breadcrumb-holder");if(e){I("",e);return}}async function QW(e,t){let o=document.getElementById("cert-breadcrumb-holder"),n=[];if(e){let i=new URL(location.href),a,s,c,l=t||i.searchParams.get("id");if(i.searchParams.delete("id"),C.supportLevel==="development"&&C.accessLevel==="online"||C.supportLevel==="production"&&C.reviewFeatures){let p=new URL(i),m=new URL(i),f=new URL(i);p.searchParams.set("detail","summary"),m.searchParams.set("detail","certifications"),l&&(f.searchParams.set("detail","certification-details"),f.searchParams.set("id",l)),a=p.toString(),s=m.toString(),c=l?f.toString():m.toString()}else{let[,p,m="users",f]=decodeURIComponent(i.pathname).toLowerCase().split("/"),h=i.searchParams.toString();a=`/${p}/${m}/${f}/certifications/?${h}`,s=`/${p}/${m}/${f}/certifications/${"certifications"}/?${h}`,c=`/${p}/${m}/${f}/certifications/${"certification-details"}/${l}?${h}`}n[0]={url:a,title:rn};let u={title:Oy,url:s};switch(e){case"appointments":n.push({title:Yl});break;case"certifications":n.push({title:Oy});break;case"certification-details":n.push(u),n.push({title:sy});break;case"exams":n.push({title:ql});break;case"renewal-assessments":n.push({title:Bl});break;case"certification-print":n.push(u),n.push({title:sy,url:c}),n.push({title:nh});break;case"summary":default:n=[]}}else n=[];let r=n.length===0?"":d`
					<ul class="breadcrumbs">
						${WT(n,i=>i.title,i=>d`
									${i.url?d` <a class="breadcrumbs-item" href="${i.url}"> ${i.title} </a> `:d`<span class="breadcrumbs-item-slashless"> ${i.title} </span>`}
								`)}
					</ul>
			  `;I(r,o)}async function XW(e,t,o,n,r){y.subscribe(_t,()=>{y.isAuthenticated||$t()}),await kx(),Ff(y.userName,t,o,"",n);let i=new Xr(y,!1);await i.beforeActivate();let a=async(s,c,l,u)=>{let{template:p,vm:m}=WW(s,c,i,l,u),f=()=>{I(p(),e),s==="achievements"&&DH(e,()=>({tab:"tab-learning-paths"}),()=>{})},h=m.beforeActivate();h.then(async()=>{switch(await Dt,window.scrollTo(0,0),Us(window.location.hash),KW(),s){case"settings":if(location.hash){let _=document.querySelector(`nav#profile-settings-navigation>ol>li>a[href="${location.hash}"]`);Ix(_)}Fd(an());break;case"certifications":QW(c,l);break}}),gu(m.subscribe(Ae,f)),gu(y.subscribe(_t,f)),await h,f()};$d.enable($q(a)),a(t,o,n,r)}async function JW(e,t,o,n){let r,i;if(o==="collections"&&n&&n!=="bookmarks"){let c=new Zf(n,t,!0);r=c,i=()=>kC(c)}else if(o==="transcript"&&n){let c=new eg(t,!0);r=c,i=()=>AB(c)}else{o="activity",n=void 0;let c=new Px(t);r=c,i=()=>wB(c)}Ff(t.userName,o,n);let s=()=>{I(i(),e)};r.subscribe(Ae,s),await r.beforeActivate(),cq(e,t.userName,t.displayName),window.scrollTo(0,0),Us(window.location.hash),s()}function ZW(e,t){let o=t.toLowerCase()==="me"?y.userName:t;Ff(o),I(CB(o),e)}function eK(e,t){let o=new Xr(t,!0);I(PC(o),e),o.beforeActivate(),Ff(t.userName,"activity",void 0),o.subscribe(Ae,()=>{I(PC(o),e)})}var Ox=["levels","products","subjects","roles"];var Ux="docs.userInterests",tK=30;function qB(){let e=XB();return e&&MC(e)}function BB(){let e=Fx();return e&&MC(e)}function YB(e){if(!e||!e.length)return!1;let t=!1;for(let o of e)if(o.checked){t=!0;break}return t}function MC(e){if(e){for(let t of Ox)if(!e[t])return!1;return!0}return!1}function GB(e){if(e)for(let t in e){let o=t;if(e[o]&&e[o].length>=0)return!0}return!1}function VB(e,t){if(!t)return;Array.from(e.querySelectorAll('input[type="checkbox"]')).forEach(n=>{n.checked=t.find(r=>r===n.name)!==void 0})}function jB(e,t){if(!t)return t;let o=Array.from(e.querySelectorAll('input[type="checkbox"]'));return t=$x(o,t),t}function $x(e,t){return e.forEach(o=>{t=oK(o,t)}),t}function oK(e,t){return e.checked?(t.find(o=>o===e.name)||t.push(e.name),t):t.filter(o=>o!==e.name)}function WB(e,t){let o=XB();if(!o||!o[t])return;Array.from(e.querySelectorAll('input[type="checkbox"]')).forEach(r=>{r.checked=o[t].find(i=>i===r.name)!==void 0})}function KB(e,t,o=null){if(!e||!e.length)return!1;let n=o||Fx()||{};n[t]=$x(e,n[t]||[]);let r=ZB();return Bi.setItem(Ux,JSON.stringify(n),r),!0}function QB(e){if(!e)return;let t=ZB();Bi.setItem(Ux,JSON.stringify(e),t)}function XB(){return Fx()||y.interests}async function zx(e){if(!y.isAuthenticated)return;let t=Fx();!MC(t)||await nK(t,e)}async function nK(e,t){let o=await rK(e,t);return!o.hasError&&o.profile&&(y.readUserProfile(o.profile),Bi.removeItem(Ux)),o}function Fx(){let e=null,t=Bi.getItem(Ux);try{t&&(e=JSON.parse(t))}catch{e=null}return e}async function JB(e){let t={branch:Di(["contentnav-branch"],"main"),locale:w.data.userLocale,facet:"products",$orderBy:"popularity desc,last_modified desc,title",$top:1,hideCompleted:!0,showHidden:C.reviewFeatures.toString()},o=`${re.browse.learn}?${Le(t,!0)}`,n={method:"GET"},r;try{let a=await J(we(o,n));a.ok&&(r=await a.json())}catch{}if(!r||!r.facets||!r.facets.products)return e;let i=r.facets.products;return e.filter(a=>i.find(s=>s.value===a)!==void 0)}function rK(e,t){if(!e)return{hasError:!0,profile:null};let o={userName:y.userName,locale:y.locale,email:y.email,displayName:y.displayName,country:y.country,contactPointTopicSetting:y.contactPointTopicSetting,isPrivate:y.isPrivate,avatarImageBytes:null,avatarExtension:null,source:t,interests:e,gsi:y.gsi};return Uo(y.userId,o)}function ZB(){let e=new Date(Date.now());return e.setDate(e.getDate()+tK),e}var Hx={advanced:ak,beginner:vk,intermediate:wI},OC={advanced:UI,beginner:$I,intermediate:zI};var qx={altspacevr:IP,azure:PP,bing:RP,bonsai:NP,clarity:DP,"connected-services-framework":LP,consumer:MP,"customer-care-framework":OP,dotnet:UP,dynamics:$P,"dynamics-365":zP,expression:FP,flipgrid:HP,github:qP,hololens:BP,"industry-solutions":YP,"internet-explorer":GP,"javascript-api":VP,kinect:jP,m365:WP,makecode:KP,mdatp:QP,mem:XP,"microsoft-advertising":JP,"microsoft-authentication-library":ZP,"microsoft-defender":eR,"microsoft-edge":tR,"microsoft-education-center":oR,"microsoft-managed-desktop":nR,"microsoft-mesh":rR,"microsoft-partner-center":iR,"microsoft-servers":aR,minecraft:sR,mrtk:cR,"ms-build-openjdk":lR,"ms-graph":uR,msc:dR,office:pR,"office-365":mR,"office-teams":fR,"power-platform":gR,priva:hR,"project-acoustics":_R,qdk:vR,silverlight:bR,skype:xR,"sql-server":yR,surface:TR,"take-lessons":SR,viva:ER,vs:wR,"vs-app-center":CR,"vs-code":kR,windows:AR,xbox:IR};var UC={administrator:mN,"ai-edge-engineer":fN,"ai-engineer":gN,auditor:hN,"business-analyst":_N,"business-owner":vN,"business-user":bN,"data-analyst":xN,"data-engineer":yN,"data-scientist":TN,"database-administrator":SN,developer:Ep,"devops-engineer":EN,"functional-consultant":wN,"higher-ed-educator":CN,"identity-access-admin":kN,"ip-admin":AN,"k-12-educator":IN,maker:PN,"network-engineer":RN,"parent-guardian":NN,"privacy-manager":DN,"risk-practitioner":LN,"school-leader":MN,"security-engineer":ON,"security-operations-analyst":UN,"service-adoption-specialist":$N,"solution-architect":zN,student:FN,"support-engineer":HN,"technology-manager":qN};var $C={"business-applications":xD,"data-ai":yD,"digital-application-innovation":TD,gaming:SD,infrastructure:ED,"modern-life":wD,"modern-work":CD,"professional-social-network":kD,"search-ads-news":AD,security:ID};var iK=()=>{let e=Object.keys(UC).map(r=>[r,UC[r]]).sort(zC),t=Object.keys(qx).map(r=>[r,qx[r]]).sort(zC),o=Object.keys($C).map(r=>[r,$C[r]]).sort(zC),n=[];return n.push(["beginner",Hx.beginner]),n.push(["intermediate",Hx.intermediate]),n.push(["advanced",Hx.advanced]),{roles:e,products:t,subjects:o,levels:n}},Bx=iK(),FC,eY=e=>{Bx.products=Bx.products.filter(t=>e.find(o=>t[0]===o)!==void 0)};function tY(){FC=JB(Object.keys(qx)).then(e=>e)}function zC(e,t){return e[1].localeCompare(t[1])}function oY(e,t,o,n,r){let i=d`${aK(n)}${sK(t,o)}${cK()}${lK(r)}`;I(i,e)}function aK(e){return d`
		<h1 class="title is-2 margin-bottom-lg">
			${ch}
			<span class="visually-hidden">${e}</span>
		</h1>
	`}function sK(e,t){return d`
		<hr role="presentation" />
		<div class="padding-block-sm">
			<div class="columns margin-none">
				<div class="column is-2 is-hidden-mobile padding-none">
					<figure class="image is-hidden-mobile is-48x48 is-center-aligned padding-block-none">
						<img
							class="avatar-url has-background-grey-light border-radius-rounded x-hidden-focus"
							role="presentation"
							src="${t==="AAD"?Xl:Ql}"
							aria-hidden="true"
						/>
					</figure>
				</div>
				<div
					class="column display-flex align-self-center padding-none margin-block-sm margin-block-none-tablet"
				>
					${e}
				</div>
			</div>
		</div>
		<hr role="presentation" />
	`}function cK(){return d`
		<div class="margin-top-lg font-size-sm">
			<p class="margin-bottom-xs">
				${OM}
			</p>
			<a id="sign-in-different-acct" href="#" @click="${t=>{t.preventDefault(),$t()}}">
				${lh}
			</a>
		</div>
	`}function lK(e){return d`
		<div class="display-flex justify-content-flex-end margin-top-lg">
			<button
				id="acct-confirmation-cancel"
				class="button is-unstyled font-weight-semibold border-none padding-inline-lg margin-right-xxs has-text-primary"
				@click=${{handleEvent(n){n.preventDefault(),$t(`https://docs.microsoft.com/${w.data.userLocale}`)}}}
			>
				${Je}
			</button>
			<button
				id="acct-confirmation-next"
				data-bi-name="acct-confirmation-next"
				class="button button-primary button-filled font-weight-semibold padding-inline-lg"
				@click=${{handleEvent(n){n.preventDefault(),e()}}}
			>
				${Tr}
			</button>
		</div>
	`}var Ys={},El={},Bs={RoleInterests:"roles",SkillLevel:"levels",ProductInterests:"products"},uK={RoleInterests:bP,SkillLevel:_P,ProductInterests:vP},nY="#error-message";function dK(e){return e.step==="ProductInterests"}function pK(e){return e.step==="RoleInterests"}function rY(e,t){let{roles:o,levels:n,products:r}=Bx,i=[];switch(e.step){case"RoleInterests":o.forEach(a=>{i.push(HC(t,a[0],a[1]))});break;case"SkillLevel":n.forEach(a=>{i.push(HC(t,a[0],a[1],OC[a[0]]))});break;case"ProductInterests":r.forEach(a=>{i.push(HC(t,a[0],a[1]))});break}return i}function HC(e,t,o,n){let r=document.createElement("li");n?e.classList.remove("grid","is-3"):(e.classList.add("grid","is-3"),r.classList.add("grid-item"));let i=d`
		<label class="checkbox">
			<input name="${t}" type="checkbox" .value="${o}" />
			<span class="checkbox-check" role="presentation"></span>
			<span class="checkbox-text ${n?"font-weight-semibold":""}"
				>${o}</span
			>
		</label>
		${n?d`
					<p class="margin-top-xxs margin-bottom-xs margin-left-sm padding-left-xxs">
						${n}
					</p>
			  `:""}
	`;return I(i,r),r}function iY(e,t,o,n){let r=!1,i=()=>{!dK(e)||!GB(El)||(Ox.forEach(c=>{El[c]=El[c]||[]}),QB(El),zx(e.source),El=null,Ys=null)},a=()=>{r||(i(),n(e,!1),o())};return d`
		<form @submit="${{async handleEvent(c){if(c.preventDefault(),r)return;let l=Array.from(e.container.querySelectorAll('input[type="checkbox"]'));if(r=YB(l),!r){let f=e.container.querySelector(nY);f.textContent=hP,f.parentElement.classList.remove("is-hidden"),Us(nY);return}let u=Bs[e.step],p=e.container.querySelector(`#${u}-interests-next`);p?.classList.add("is-loading"),KB(l,u)&&(El[u]=$x(l,El[u]||[]),i(),n(e,!1),o()),r=!1,p?.classList.remove("is-loading")}}}">
			<h1 class="title is-2 margin-block-lg">
				${uK[e.step]}
				<span class="visually-hidden">${t}</span>
			</h1>
			<ul id="facet-grid" class="margin-block-lg"></ul>
			<div class="display-flex justify-content-flex-end margin-top-lg">
				<button
					id="${Bs[e.step]}-interests-skip"
					class="button is-unstyled font-weight-semibold border-none padding-inline-lg margin-right-xxs margin-top-lg has-text-primary"
					type="button"
					@click="${a}"
					.disabled=${r}
				>
					${_y}
				</button>
				<button
					id="${Bs[e.step]}-interests-next"
					class="button button-primary button-filled font-weight-semibold padding-inline-lg margin-top-lg"
					type="submit"
					.disabled=${r}
				>
					${Tr}
				</button>
			</div>
			<div class="alert display-flex is-hidden is-warning margin-bottom-xs">
				<span aria-hidden="true" class="icon">
					<span class="docon docon-status-info-outline"></span>
				</span>
				<p id="error-message" role="alert" aria-live="assertive"></p>
			</div>
		</form>
	`}function aY(e,t,o,n){let r={handleEvent(i){i.preventDefault(),n(e,!0),o(!0)}};return pK(e)?"":d`
				<a href="#" aria-label="${t}" class="text-decoration-none" @click=${r}>
					<span class="docon docon-arrow-left" aria-hidden="true"></span>
					<span>${$g}</span>
				</a>
		  `}function cY(e,t,o,n){return qC(n.container,e,t,o,n)}function lY(e,t,o,n){return qC(n.container,e,t,o,n)}async function uY(e,t,o,n){let r=await FC;return eY(r),qC(n.container,e,t,o,n)}function qC(e,t,o,n,r){I(d`${aY(r,t,n,sY)}${iY(r,o,n,sY)}`,e);let i=e.querySelector("#facet-grid");I(d`${rY(r,i)}`,i),WB(i,Bs[r.step]),Ys[Bs[r.step]]&&VB(i,Ys[Bs[r.step]])}function sY(e,t){let o=Bs[e.step];t?Ys[o]=jB(e.container,Ys[o]||[]):Ys&&delete Ys[o]}async function dY(e,t,o){I(n(),e.container);function n(){let{linkedMSA:r}=e.certLink;return d`
			<a href="#" aria-label="${t}" class="text-decoration-none" @click=${a=>{a.preventDefault(),o()}}>
				<span class="docon docon-arrow-left" aria-hidden="true"></span>
				<span>${r?.msaEmail}</span>
			</a>
			<h1 class="title font-size-h2 margin-top-lg margin-bottom-sm">
				${kk}
			</h1>
			<div class="margin-bottom-xs">
				<p class="font-size-sm">${fg}:</p>
				<p class="font-size-sm font-weight-semibold">${r?.msaEmail}</p>
				<p class="font-size-sm font-weight-semibold">
					${Hl}: ${r?.mcId}
				</p>
			</div>
			<p class="font-size-sm margin-bottom-xs">
				${mg}
			</p>
			<p class="font-size-sm margin-bottom-xs">
				${ie(pg)}
			</p>
			<div class="buttons">
				<button
					class="button button-primary button-filled font-size-sm margin-none"
					type="submit"
					@click=${Hf.timeout(()=>yl(e.certLink,!0,o))}
				>
					${dg}
				</button>
				<button
					type="button"
					class="link-button font-size-sm font-weight-semibold margin-left-xs"
					@click=${o}
				>
					${ug}
				</button>
			</div>
		`}}var BC=50;function pY(e,t,o,n,r){I(d`${gK(o,r)}${fK(e,t,n,r)}`,e)}function mK(e,t){let o=mY(e);o.length!==0&&t(o)}function mY(e){let t=document.getElementById("display-name"),o=t.value.trim(),n=e.querySelector(".validation-message"),r=2;return o.length===0?(ei(`${bh.replace("{text}",xa)}`,t,n),""):I4(o,r,BC)?P4(o)?(ei(`${_h.replace("{text}",xa)}`,t,n),""):(Xd(t,n),o):(ei(`${vh.replace("{text}",xa).replace("{minChars}",r.toString()).replace("{maxChars}",BC.toString())}`,t,n),"")}function fK(e,t,o,n){let r=`${OO.replace("{maxChars}",BC.toString())} ${WM}`,i={handleEvent(c){c.preventDefault(),mK(e,n)}},a=()=>$t(`https://docs.microsoft.com/${w.data.userLocale}`),s=()=>mY(e);return d`
		<form @submit="${i}">
			<h1 class="title is-2 margin-top-lg margin-bottom-sm">
				${sh}
				<span class="visually-hidden">${o}</span>
			</h1>
			<p>
				${ie(JT(t))}
				${KM}
			</p>
			<fieldset class="field padding-none margin-block-sm">
				<label class="label margin-bottom-xxs" for="display-name">
					${xa}
					<span class="required-indicator" aria-hidden="true"></span>
				</label>
				<input
					class="input"
					type="text"
					id="display-name"
					name="display-name"
					placeholder="${r}"
					aria-required="true"
					autocomplete="name"
					value="${y.userName||""}"
					@keyup=${s}
					aria-describedby="display-name-error"
				/>
			</fieldset>
			<p
				hidden
				id="display-name-error"
				class="validation-message has-text-danger margin-block-sm"
				aria-live="assertive"
				aria-relevant="text"
			></p>
			<div class="display-flex justify-content-flex-end margin-top-lg">
				<button
					id="profile-creation-cancel"
					class="button is-unstyled font-weight-semibold border-none padding-inline-lg margin-right-xxs has-text-primary"
					type="reset"
					@click="${a}"
				>
					${Je}
				</button>
				<button
					id="profile-creation-next"
					data-bi-name="profile-creation-next"
					class="button button-primary button-filled font-weight-semibold padding-inline-lg"
					type="submit"
				>
					${Tr}
				</button>
			</div>
		</form>
	`}function gK(e,t){return d`
		<a href="#" aria-label="${e}" class="text-decoration-none" @click=${{handleEvent(n){n.preventDefault(),t()}}}>
			<span class="docon docon-arrow-left" aria-hidden="true"></span>
			<span>${y.email}</span>
		</a>
	`}function fY(e,t,o){I(hK(t,o),e)}function hK(e,t){t=wa(t).href;let o=t?d`
		<div class="display-flex justify-content-center margin-top-sm">
			<a href="${t}" class="button button-primary button-filled font-weight-semibold padding-inline-lg">${kn}</button>
		</div>`:d``;return d`
		<h1 class="title is-2 margin-block-sm display-flex justify-content-center">
			${sk}
			<span class="visually-hidden">${e}</span>
		</h1>
		<p class="display-flex justify-content-center">
			${RO} ${qM}
		</p>
		${o}
		<a
			href="${y.profileUrl}"
			class="font-size-sm display-flex margin-top-xs justify-content-center"
			>${ZM}</a
		>
	`}function gY(e,t){return{authenticationMode:"MSA",certLink:{errorCode:"",linkedMSA:{isLinked:!1,mcId:"",msaEmail:""},status:null},challengeId:null,confirmedAccount:"",contactPointTopicSetting:null,container:e,country:"",displayName:"",email:"",hasNewsletterOptIn:!1,isCloudSkillsChallengeContext:!1,isEmailRequired:!1,isInterestOnboarded:qB(),locale:"",microsoftUser:"",redirectUrl:"",shouldOnlyShowEmailNotifications:!1,source:t,step:"AccountConfirmation",stepCount:{stepNumber:1,totalStepCount:7},upn:""}}function YC(e,t=!1){return{avatarExtension:null,avatarImageBytes:null,contactPointTopicSetting:e.contactPointTopicSetting,country:e.country,displayName:t?y.displayName:e.displayName,email:e.contactPointTopicSetting?e.email:"",gsi:t?y.gsi:null,interests:t?y.interests:null,isPrivate:t?y.isPrivate:!1,locale:e.locale,source:e.source,userName:t?y.userName:null}}var _e,hY=7;async function VC(e,t){_e=gY(e,Ud.source),_e.upn=y.upn,_e.locale=w.data.contentLocale,_e.microsoftUser=y.upn.match(/@microsoft\.com$/i)?y.upn:Ud.microsoftUser,_e.source=Ud.source,_e.redirectUrl=t.redirectUrl??Ud.redirectUrl,_e.stepCount.totalStepCount=hY,_e.authenticationMode=y.authenticationMode,t.type==="csc"&&(_e.isEmailRequired=t.challenge.emailRequired===!0,_e.hasNewsletterOptIn=t.challenge.dotSourceNewsletterReg===!0,_e.challengeId=t.challengeId,_e.isCloudSkillsChallengeContext=!0,Mi()&&(!an()||_e.hasNewsletterOptIn)&&(_e.shouldOnlyShowEmailNotifications=!0,_e.step="EmailNotifications"));let o=AH(t);I(d`
			<div
				class="columns is-centered is-vertically-centered is-full-height padding-block-lg-tablet"
			>
				<div
					class="column ${o?"is-10 is-8-widescreen":"is-10-tablet is-8-desktop is-half-widescreen"}"
				>
					<div class="columns is-gapless">
						${o?d`<div class="column is-4-desktop is-5-tablet">${o}</div>`:""}
						<div class="column ${o?"is-8-desktop is-7-tablet":""}">
							<div id="register" class="box is-full-height padding-lg"></div>
						</div>
					</div>
				</div>
			</div>
		`,_e.container),_e.container=_e.container.querySelector("#register"),op(_e)}function wl(e){return`${cN} ${bD.replace("{step-index}",e.stepNumber.toString()).replace("{step-count}",e.totalStepCount.toString())}`}function tp(e){return QM.replace("{stepnumber}",(e.stepNumber-1).toString())}var _K=function(e){_e.confirmedAccount=e,_e.step=e!==void 0?"AccountConfirmation":"ProfileCreation",op(_e)},vK=function(e){_e.displayName=e,_e.step=e!==void 0?"EmailNotifications":"AccountConfirmation",op(_e)},bK=async function(e,t,o,n){if(_e.email=e,_e.country=o,_e.contactPointTopicSetting=t,_e.email!==void 0){if(_e.shouldOnlyShowEmailNotifications?an()||await yK():await TK(),_e.hasNewsletterOptIn&&n&&an()&&await q$(_e.challengeId),_e.shouldOnlyShowEmailNotifications){let r=it(),i=`${ci.getProfileContext(r.redirectUrl).redirectUrl}&enrollUser=true`;window.location.href=i;return}_e.source==="learn"&&!_e.isInterestOnboarded?((C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online")&&await a_(),_e.step="RoleInterests",tY()):(BB()&&zx(_e.source),_e.step=await xK())}else _e.step="ProfileCreation";op(_e)};async function xK(){(C.supportLevel==="production"&&C.reviewFeatures||C.supportLevel==="development"&&C.accessLevel==="online")&&await a_();let e=await Ot.getLinkedMSA(),{status:t}=e;return t===200?(_e.certLink=e,_e.step="LinkCertAccount"):_e.step="RegisterConfirmation"}var GC=function(e=!1){switch(_e.step){case"RoleInterests":_e.step="SkillLevel";break;case"SkillLevel":_e.step=e?"RoleInterests":"ProductInterests";break;case"ProductInterests":e?_e.step="SkillLevel":_e.step="RegisterConfirmation";break}op(_e)};async function yK(){let e=await Uo(y.userId,YC(_e,!0));!e.hasError&&e.profile!==null&&y.readUserProfile(e.profile)}async function TK(){try{let e=await R$(YC(_e));!e.hasError&&e.profile!==null&&y.readUserProfile(e.profile)}catch(e){if(e.status!==401)throw new Error(`error: ${e.message}`)}SK(!1,_e.country,_e.contactPointTopicSetting)}function SK(e,t,o){Po({behavior:ho.OTHER,actionType:Io.OTHER,content:{type:"register",country:t,optIn:o,passed:e}})}function EK(e){if(_e.isCloudSkillsChallengeContext){let t=new URL(e);return t.searchParams.get("checkRegistration")==="true"&&(t.searchParams.delete("checkRegistration"),t.searchParams.set("enrollUser","true")),t.toString()}return e}var wK=()=>{_e.step="RegisterConfirmation",op(_e)};async function op(e){let t=hY;switch(e.step){case"AccountConfirmation":e.stepCount.stepNumber=1,oY(e.container,e.upn,e.authenticationMode,wl(e.stepCount),_K);break;case"ProfileCreation":e.stepCount.stepNumber=2,pY(e.container,e.microsoftUser,tp(e.stepCount),wl(e.stepCount),vK);break;case"EmailNotifications":e.stepCount.stepNumber=3,M4(e,tp(e.stepCount),wl(e.stepCount),bK);break;case"RoleInterests":e.stepCount.stepNumber=4,cY(tp(e.stepCount),wl(e.stepCount),GC,e);break;case"SkillLevel":e.stepCount.stepNumber=5,lY(tp(e.stepCount),wl(e.stepCount),GC,e);break;case"ProductInterests":e.stepCount.stepNumber=6,await uY(tp(e.stepCount),wl(e.stepCount),GC,e);break;case"LinkCertAccount":e.stepCount.stepNumber=7,await dY(e,tp(e.stepCount),wK);break;case"RegisterConfirmation":e.stepCount.stepNumber=t,fY(e.container,wl(e.stepCount),EK(e.redirectUrl));break;default:break}}async function vY(){if(!Ne.userServices)return;let e=te("page_kind"),t=Y.getElementById("main");if(e==="detail"){t.innerHTML="",t.appendChild(HB());return}await Ga;let o=new URL(de.href);if(e==="register"){if(!y.isAuthenticated){tr(o.href);return}let r=await kH();if(Mi())switch(r.type){case"csc":if(await Ya(),!an()||r.challenge.dotSourceNewsletterReg===!0){VC(t,r);return}de.href=r.redirectUrl;return;default:if(r.redirectUrl){de.href=r.redirectUrl;return}_Y();return}VC(t,r);return}if(y.isAuthenticated&&y.profileUrl==="#"){o=new URL("./register",Oi()),de.href=o.toString();return}let n=null;if(de.href.includes("/settings")){if(!y.isAuthenticated){o=new URL("./settings",Oi()),o.hash=de.hash,tr(o.href);return}eq==="qs"?oi({tab:"tab-settings"},"pushState"):n="settings"}if(e==="home"&&!y.isAuthenticated){tr(o.href);return}_Y(n)}function _Y(e){de.href=Ut(y.userName,e)}hH();AU();SU();v1();iz();_1();oH();xU(wn);N1();var jC=it();jC["set-locale-cookie"]==="true"&&(jC["set-locale-cookie"]=null,oi(jC,"replaceState"),E1(w.data.userLocale));CH();Dt.then(()=>{let e=document.getElementById("main");w1(w.data.userLocale),D1(document.body),vY(),P1(e),I1()});})();
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
/*!
 * Microsoft Dynamic Proto Utility, 1.1.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! @azure/msal-browser v2.27.0 2022-07-05 */
/*! @azure/msal-common v7.1.0 2022-07-05 */
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
